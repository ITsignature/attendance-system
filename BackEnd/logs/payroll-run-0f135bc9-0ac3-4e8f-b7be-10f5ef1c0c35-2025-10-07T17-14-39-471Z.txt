[2025-10-07T17:14:39.493Z] [INFO] 🚀 Payroll calculation logging started for run: 0f135bc9-0ac3-4e8f-b7be-10f5ef1c0c35
[2025-10-07T17:14:39.493Z] [INFO] 📁 Log file: E:\smart_attendance_system\BackEnd\logs\payroll-run-0f135bc9-0ac3-4e8f-b7be-10f5ef1c0c35-2025-10-07T17-14-39-471Z.txt
[2025-10-07T17:14:39.493Z] [INFO] ⏰ Started at: 2025-10-07T17:14:39.493Z
[2025-10-07T17:14:39.493Z] [INFO] ================================================================================
[2025-10-07T17:14:39.495Z] [LOG] 🚀 Starting payroll calculation for run: 0f135bc9-0ac3-4e8f-b7be-10f5ef1c0c35
[2025-10-07T17:14:39.503Z] [LOG] 👤 Client ID: it-signature, User ID: 059304ea-24a5-4d78-a290-cf09b9e53c4c
[2025-10-07T17:14:39.956Z] [LOG] ✅ Payroll run verified: august (MONTHLY_2025_08_REGULAR)
[2025-10-07T17:14:40.181Z] [LOG] 📊 Status updated to 'calculating'
[2025-10-07T17:14:40.542Z] [LOG] 👥 Processing 34 employee records:
[2025-10-07T17:14:40.542Z] [LOG] ============================================================
[2025-10-07T17:14:40.542Z] [LOG] 
🧮 Processing: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-07T17:14:40.543Z] [LOG] 📋 Record ID: 02c62ff8-c8c7-48f3-9590-5091d1f7e8e8
[2025-10-07T17:14:41.568Z] [LOG] 🔍 Component filtering for employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-07T17:14:41.568Z] [LOG]    Total components: 8
[2025-10-07T17:14:41.569Z] [LOG]    Applicable components: 8
[2025-10-07T17:14:41.569Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-07T17:14:43.064Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:43.287Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:43.521Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:43.758Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:43.995Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:44.232Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:44.588Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:44.824Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:45.057Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:45.284Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:45.499Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:45.715Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:46.001Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:46.219Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:46.434Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:46.650Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:46.866Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:47.111Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:47.326Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:47.540Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:14:47.837Z] [LOG] 🔍 Fetched 23 attendance records for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-07T17:14:48.052Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:14:49.315Z] [LOG] Employee 0144461e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:14:49.315Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:14:49.317Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:14:49.318Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:14:49.405Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-07T17:14:49.406Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:14:49.406Z] [LOG] ================================================================================
[2025-10-07T17:14:49.407Z] [LOG] 📅 2025-08-01 (WEEKDAY): 8.96h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.407Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.408Z] [LOG] 📅 2025-08-02 (WEEKEND): 6.83h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:14:49.408Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:14:49.409Z] [LOG] 📅 2025-08-06 (WEEKDAY): 8.72h worked → 7.916388888888889h counted → OVERLAP 09:05-17:00 = 7.916h (attendance table)
[2025-10-07T17:14:49.409Z] [LOG]    ✅ Added to weekday total: 7.916388888888889h
[2025-10-07T17:14:49.410Z] [LOG] 📅 2025-08-07 (WEEKDAY): 9.06h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.410Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.410Z] [LOG] 📅 2025-08-09 (WEEKEND): 4.9h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:14:49.410Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:14:49.411Z] [LOG] 📅 2025-08-11 (WEEKDAY): 10.15h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.411Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.412Z] [LOG] 📅 2025-08-12 (WEEKDAY): 9.56h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.412Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.412Z] [LOG] 📅 2025-08-13 (WEEKDAY): 9.21h worked → 8.451944444444445h counted → OVERLAP 08:32-17:00 = 8.452h (attendance table)
[2025-10-07T17:14:49.413Z] [LOG]    ✅ Added to weekday total: 8.451944444444445h
[2025-10-07T17:14:49.413Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.86h worked → 8.462222222222222h counted → OVERLAP 08:32-17:00 = 8.462h (attendance table)
[2025-10-07T17:14:49.414Z] [LOG]    ✅ Added to weekday total: 8.462222222222222h
[2025-10-07T17:14:49.414Z] [LOG] 📅 2025-08-15 (WEEKDAY): 9.01h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.415Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.415Z] [LOG] 📅 2025-08-16 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:14:49.416Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:14:49.416Z] [LOG] 📅 2025-08-18 (WEEKDAY): 9.95h worked → 8.374444444444444h counted → OVERLAP 08:37-17:00 = 8.374h (attendance table)
[2025-10-07T17:14:49.417Z] [LOG]    ✅ Added to weekday total: 8.374444444444444h
[2025-10-07T17:14:49.417Z] [LOG] 📅 2025-08-19 (WEEKDAY): 9.06h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.417Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.417Z] [LOG] 📅 2025-08-20 (WEEKDAY): 10.1h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.418Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.418Z] [LOG] 📅 2025-08-21 (WEEKDAY): 9.25h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.418Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.419Z] [LOG] 📅 2025-08-22 (WEEKDAY): 8.83h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.419Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.419Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:14:49.420Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:14:49.420Z] [LOG] 📅 2025-08-25 (WEEKDAY): 10.63h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.421Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.421Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.98h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.421Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.422Z] [LOG] 📅 2025-08-27 (WEEKDAY): 9.1h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.422Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.423Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.59h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.423Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.423Z] [LOG] 📅 2025-08-29 (WEEKDAY): 9.56h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:14:49.424Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:14:49.424Z] [LOG] 📅 2025-08-30 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:14:49.424Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:14:49.425Z] [LOG] ================================================================================
[2025-10-07T17:14:49.425Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:14:49.425Z] [LOG]    Sum of all daily counted hours (rounded): 152.205h
[2025-10-07T17:14:49.426Z] [LOG]    Expected hours: 170h
[2025-10-07T17:14:49.426Z] [LOG]    Shortfall: 17.79h
[2025-10-07T17:14:49.426Z] [LOG] ================================================================================
[2025-10-07T17:14:49.666Z] [LOG] 🔄 Processing financial records for employee 0144461e-7105-11f0-a50f-98e743540430...
[2025-10-07T17:14:49.673Z] [LOG] 🔄 Processing financial records for employee 0144461e-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:14:49.903Z] [LOG] 📊 Found 0 active loans for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-07T17:14:50.141Z] [LOG] 📊 Found 0 active advances for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-07T17:14:50.376Z] [LOG] 📊 Found 0 approved bonuses for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-07T17:14:50.378Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:14:50.392Z] [LOG] 💰 GROSS CALCULATION for Ashen Nirmal Wadugodapitiya null:
[2025-10-07T17:14:50.393Z] [LOG]    Base Salary: 50000
[2025-10-07T17:14:50.393Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:14:50.610Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:14:51.084Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:14:51.320Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:14:51.555Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:14:51.664Z] [LOG] Employee 0144461e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:14:51.664Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:14:51.665Z] [LOG] ============================================================
[2025-10-07T17:14:51.665Z] [LOG] 👤 Employee ID: 0144461e-7105-11f0-a50f-98e743540430
[2025-10-07T17:14:51.902Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:14:51.903Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:14:51.903Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:14:51.904Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:14:51.904Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:14:51.904Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:14:51.904Z] [LOG] 
[2025-10-07T17:14:51.904Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:14:51.904Z] [LOG]    Expected Hours: 170
[2025-10-07T17:14:51.904Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:14:51.904Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:14:51.905Z] [LOG]    Worked Hours: 152.205
[2025-10-07T17:14:51.905Z] [LOG]    ⚠️  Shortfall Hours: 17.794999999999987
[2025-10-07T17:14:51.905Z] [LOG]    💸 Shortfall Deduction: 17.794999999999987h × 235.29 = 4187.06
[2025-10-07T17:14:51.905Z] [LOG] ============================================================
[2025-10-07T17:14:52.287Z] [LOG] ✅ Weekend Day Met: 2025-08-02 (Saturday)
[2025-10-07T17:14:52.287Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:14:52.288Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:14:52.288Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:14:52.288Z] [LOG] ✅ Weekend Day Met: 2025-08-16 (Saturday)
[2025-10-07T17:14:52.288Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:14:52.288Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:14:52.288Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:14:52.288Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:14:52.288Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:14:52.683Z] [LOG] 📅 Weekend absence check for employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-07T17:14:52.684Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:14:52.684Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:14:52.684Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:14:52.686Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:14:52.686Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:14:52.686Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:14:52.687Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:14:52.687Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:52.688Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:14:52.688Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:52.689Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:14:52.689Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:52.689Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:14:52.690Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:52.690Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:14:52.691Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:52.691Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:14:52.691Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:52.691Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:14:52.692Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:52.692Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:14:52.692Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:52.692Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:14:52.692Z] [LOG] Regular deductions for Ashen Nirmal Wadugodapitiya null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:14:52.693Z] [LOG] Combined deductions for Ashen Nirmal Wadugodapitiya null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 4187.058823529409,
      "details": "17.794999999999987 hours × 235.29"
    }
  ],
  "total": 4187.058823529409
}
[2025-10-07T17:14:52.913Z] [LOG] Creating components for record 02c62ff8-c8c7-48f3-9590-5091d1f7e8e8: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-07T17:14:52.914Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 4187.058823529409
}
[2025-10-07T17:14:53.139Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:14:53.357Z] [LOG] Created payroll_record_component: 98694555-a221-4e94-bc65-652f70bd83b3 for Working Hours Shortfall
[2025-10-07T17:14:53.843Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:14:53.844Z] [ERROR] ❌ Error updating financial balances for employee 0144461e-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:14:53.846Z] [LOG] ✅ Ashen Nirmal Wadugodapitiya null: Calculation completed successfully
[2025-10-07T17:14:53.846Z] [LOG] 📊 Progress: 1/34 (2.9%)
[2025-10-07T17:14:53.846Z] [LOG] 
🧮 Processing: customer null (EMP000036)
[2025-10-07T17:14:53.847Z] [LOG] 📋 Record ID: 0da2d6fb-3948-48f5-b545-2f7126fb9c80
[2025-10-07T17:14:54.289Z] [LOG] 🔍 Component filtering for employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-07T17:14:54.289Z] [LOG]    Total components: 8
[2025-10-07T17:14:54.290Z] [LOG]    Applicable components: 8
[2025-10-07T17:14:54.290Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-07T17:14:54.863Z] [LOG] 🔍 Fetched 0 attendance records for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-07T17:14:54.864Z] [LOG] ⚠️  ATTENTION: Employee 014409a2-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:14:54.979Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:14:55.928Z] [LOG] Employee 014409a2-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:14:55.928Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:14:55.929Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:14:55.929Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:14:55.931Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-07T17:14:55.931Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:14:55.931Z] [LOG] ================================================================================
[2025-10-07T17:14:55.932Z] [LOG] ================================================================================
[2025-10-07T17:14:55.932Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:14:55.932Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:14:55.933Z] [LOG]    Expected hours: 160h
[2025-10-07T17:14:55.933Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:14:55.933Z] [LOG] ================================================================================
[2025-10-07T17:14:56.045Z] [LOG] 🔄 Processing financial records for employee 014409a2-7105-11f0-a50f-98e743540430...
[2025-10-07T17:14:56.045Z] [LOG] 🔄 Processing financial records for employee 014409a2-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:14:56.161Z] [LOG] 📊 Found 0 active loans for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-07T17:14:56.280Z] [LOG] 📊 Found 0 active advances for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-07T17:14:56.397Z] [LOG] 📊 Found 0 approved bonuses for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-07T17:14:56.398Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:14:56.398Z] [LOG] 💰 GROSS CALCULATION for customer null:
[2025-10-07T17:14:56.399Z] [LOG]    Base Salary: 0
[2025-10-07T17:14:56.399Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:14:56.515Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:14:56.753Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:14:56.990Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:14:57.106Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:14:57.345Z] [LOG] Employee 014409a2-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:14:57.345Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:14:57.346Z] [LOG] ============================================================
[2025-10-07T17:14:57.346Z] [LOG] 👤 Employee ID: 014409a2-7105-11f0-a50f-98e743540430
[2025-10-07T17:14:57.347Z] [LOG] 💰 Base Salary: 0
[2025-10-07T17:14:57.347Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:14:57.348Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:14:57.348Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:14:57.349Z] [LOG] 💵 Per-Day Salary: 0.00
[2025-10-07T17:14:57.349Z] [LOG] ⏱️  Hourly Rate: 0.00
[2025-10-07T17:14:57.349Z] [LOG] 
[2025-10-07T17:14:57.350Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:14:57.350Z] [LOG]    Expected Hours: 160
[2025-10-07T17:14:57.350Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:14:57.350Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:14:57.351Z] [LOG]    Worked Hours: 0
[2025-10-07T17:14:57.351Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:14:57.351Z] [LOG]    💸 Shortfall Deduction: 160h × 0.00 = 0.00
[2025-10-07T17:14:57.351Z] [LOG] ============================================================
[2025-10-07T17:14:57.814Z] [LOG] 📅 Weekend absence check for employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-07T17:14:57.815Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:14:57.815Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:14:57.816Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:14:57.816Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:14:57.817Z] [LOG]    Gross Salary: 0
[2025-10-07T17:14:57.817Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:14:57.817Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:14:57.818Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:57.818Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:14:57.819Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:57.819Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:14:57.819Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:57.820Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:14:57.820Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:57.820Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:14:57.821Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:57.821Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:14:57.822Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:57.822Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:14:57.822Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:57.822Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:14:57.823Z] [LOG]    Fixed amount: 0
[2025-10-07T17:14:57.823Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:14:57.823Z] [LOG] Regular deductions for customer null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:14:57.824Z] [LOG] Combined deductions for customer null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 0,
      "details": "160 hours × 0.00"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 0,
      "details": "5 weekend days × 0.00"
    }
  ],
  "total": 0
}
[2025-10-07T17:14:57.934Z] [LOG] Creating components for record 0da2d6fb-3948-48f5-b545-2f7126fb9c80: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:14:57.935Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 0
}
[2025-10-07T17:14:58.052Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:14:58.170Z] [LOG] Created payroll_record_component: 03dfea89-fb05-4ce6-8f89-2148cdef09d2 for Working Hours Shortfall
[2025-10-07T17:14:58.171Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 0
}
[2025-10-07T17:14:58.280Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:14:58.388Z] [LOG] Created payroll_record_component: 09e1eea4-df91-4ff0-86f5-280dd6152b5d for Weekend Absent Days
[2025-10-07T17:14:58.712Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:14:58.713Z] [ERROR] ❌ Error updating financial balances for employee 014409a2-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:14:58.714Z] [LOG] ✅ customer null: Calculation completed successfully
[2025-10-07T17:14:58.714Z] [LOG] 📊 Progress: 2/34 (5.9%)
[2025-10-07T17:14:58.715Z] [LOG] 
🧮 Processing: Sumaiya null (EMP000016)
[2025-10-07T17:14:58.715Z] [LOG] 📋 Record ID: 12712748-11b5-4249-b7fa-09a67c18f0f3
[2025-10-07T17:14:59.148Z] [LOG] 🔍 Component filtering for employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-07T17:14:59.148Z] [LOG]    Total components: 8
[2025-10-07T17:14:59.149Z] [LOG]    Applicable components: 8
[2025-10-07T17:14:59.149Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-07T17:14:59.824Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:00.039Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:00.256Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:00.471Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:00.687Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:00.905Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:01.122Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:01.350Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:01.565Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:01.789Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:02.005Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:02.223Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:02.440Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:02.659Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:02.896Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:03.131Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:03.349Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:03.555Z] [LOG] 🔍 Fetched 25 attendance records for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:03.665Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:15:04.211Z] [LOG] Employee 0143b22f-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:04.212Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:15:04.212Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:15:04.213Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:15:04.214Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:04.215Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:15:04.215Z] [LOG] ================================================================================
[2025-10-07T17:15:04.215Z] [LOG] 📅 2025-08-01 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:04.216Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:04.216Z] [LOG] 📅 2025-08-02 (WEEKEND): 6h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:04.217Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:04.217Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.25h worked → 8.25h counted → OVERLAP 08:45-17:00 = 8.250h (attendance table)
[2025-10-07T17:15:04.218Z] [LOG]    ✅ Added to weekday total: 8.25h
[2025-10-07T17:15:04.218Z] [LOG] 📅 2025-08-05 (WEEKDAY): 10.11h worked → 7.523611111111111h counted → OVERLAP 09:28-17:00 = 7.524h (attendance table)
[2025-10-07T17:15:04.219Z] [LOG]    ✅ Added to weekday total: 7.523611111111111h
[2025-10-07T17:15:04.219Z] [LOG] 📅 2025-08-06 (WEEKDAY): 11.58h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:04.219Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:04.220Z] [LOG] 📅 2025-08-07 (WEEKDAY): 10.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:04.220Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:04.220Z] [LOG] 📅 2025-08-09 (WEEKEND): 8.68h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:04.221Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:04.221Z] [LOG] 📅 2025-08-11 (WEEKDAY): 9.83h worked → 8.333333333333334h counted → OVERLAP 08:40-17:00 = 8.333h (attendance table)
[2025-10-07T17:15:04.222Z] [LOG]    ✅ Added to weekday total: 8.333333333333334h
[2025-10-07T17:15:04.222Z] [LOG] 📅 2025-08-12 (WEEKDAY): 8h worked → 4.5h counted → OVERLAP 12:30-17:00 = 4.500h (attendance table)
[2025-10-07T17:15:04.222Z] [LOG]    ✅ Added to weekday total: 4.5h
[2025-10-07T17:15:04.223Z] [LOG] 📅 2025-08-13 (WEEKDAY): 12h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:04.223Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:04.224Z] [LOG] 📅 2025-08-14 (WEEKDAY): 10.45h worked → 8.45138888888889h counted → OVERLAP 08:32-17:00 = 8.451h (attendance table)
[2025-10-07T17:15:04.224Z] [LOG]    ✅ Added to weekday total: 8.45138888888889h
[2025-10-07T17:15:04.224Z] [LOG] 📅 2025-08-15 (WEEKDAY): 12.09h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:04.224Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:04.225Z] [LOG] 📅 2025-08-16 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:04.225Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:04.225Z] [LOG] 📅 2025-08-18 (WEEKDAY): 9.86h worked → 8.356111111111112h counted → OVERLAP 08:38-17:00 = 8.356h (attendance table)
[2025-10-07T17:15:04.226Z] [LOG]    ✅ Added to weekday total: 8.356111111111112h
[2025-10-07T17:15:04.226Z] [LOG] 📅 2025-08-19 (WEEKDAY): 10.43h worked → 7.833333333333333h counted → OVERLAP 09:10-17:00 = 7.833h (attendance table)
[2025-10-07T17:15:04.226Z] [LOG]    ✅ Added to weekday total: 7.833333333333333h
[2025-10-07T17:15:04.226Z] [LOG] 📅 2025-08-20 (WEEKDAY): 11h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:04.227Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:04.227Z] [LOG] 📅 2025-08-21 (WEEKDAY): 9.68h worked → 8.183333333333334h counted → OVERLAP 08:49-17:00 = 8.183h (attendance table)
[2025-10-07T17:15:04.227Z] [LOG]    ✅ Added to weekday total: 8.183333333333334h
[2025-10-07T17:15:04.227Z] [LOG] 📅 2025-08-22 (WEEKDAY): 9.73h worked → 8.231666666666667h counted → OVERLAP 08:46-17:00 = 8.232h (attendance table)
[2025-10-07T17:15:04.228Z] [LOG]    ✅ Added to weekday total: 8.231666666666667h
[2025-10-07T17:15:04.228Z] [LOG] 📅 2025-08-23 (WEEKEND): 6h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:04.228Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:04.228Z] [LOG] 📅 2025-08-25 (WEEKDAY): 7.65h worked → 7.649444444444445h counted → OVERLAP 08:30-16:08 = 7.649h (attendance table)
[2025-10-07T17:15:04.229Z] [LOG]    ✅ Added to weekday total: 7.649444444444445h
[2025-10-07T17:15:04.229Z] [LOG] 📅 2025-08-26 (WEEKDAY): 9.93h worked → 8.433055555555555h counted → OVERLAP 08:34-17:00 = 8.433h (attendance table)
[2025-10-07T17:15:04.229Z] [LOG]    ✅ Added to weekday total: 8.433055555555555h
[2025-10-07T17:15:04.229Z] [LOG] 📅 2025-08-27 (WEEKDAY): 10h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:04.230Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:04.230Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:04.230Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:04.230Z] [LOG] 📅 2025-08-29 (WEEKDAY): 10.42h worked → 8.416666666666666h counted → OVERLAP 08:35-17:00 = 8.417h (attendance table)
[2025-10-07T17:15:04.231Z] [LOG]    ✅ Added to weekday total: 8.416666666666666h
[2025-10-07T17:15:04.231Z] [LOG] 📅 2025-08-30 (WEEKEND): 5.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:04.231Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:04.231Z] [LOG] ================================================================================
[2025-10-07T17:15:04.231Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:15:04.232Z] [LOG]    Sum of all daily counted hours (rounded): 162.1619h
[2025-10-07T17:15:04.232Z] [LOG]    Expected hours: 170h
[2025-10-07T17:15:04.232Z] [LOG]    Shortfall: 7.84h
[2025-10-07T17:15:04.232Z] [LOG] ================================================================================
[2025-10-07T17:15:04.341Z] [LOG] 🔄 Processing financial records for employee 0143b22f-7105-11f0-a50f-98e743540430...
[2025-10-07T17:15:04.342Z] [LOG] 🔄 Processing financial records for employee 0143b22f-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:15:04.450Z] [LOG] 📊 Found 0 active loans for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:04.558Z] [LOG] 📊 Found 0 active advances for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:04.667Z] [LOG] 📊 Found 0 approved bonuses for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:04.667Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:15:04.668Z] [LOG] 💰 GROSS CALCULATION for Sumaiya null:
[2025-10-07T17:15:04.668Z] [LOG]    Base Salary: 60000
[2025-10-07T17:15:04.669Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:15:04.785Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:15:05.021Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:15:05.244Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:15:05.354Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:15:05.465Z] [LOG] Employee 0143b22f-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:05.466Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:15:05.466Z] [LOG] ============================================================
[2025-10-07T17:15:05.466Z] [LOG] 👤 Employee ID: 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:05.467Z] [LOG] 💰 Base Salary: 60,000
[2025-10-07T17:15:05.467Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:15:05.468Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:15:05.468Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:15:05.468Z] [LOG] 💵 Per-Day Salary: 2400.00
[2025-10-07T17:15:05.468Z] [LOG] ⏱️  Hourly Rate: 282.35
[2025-10-07T17:15:05.469Z] [LOG] 
[2025-10-07T17:15:05.469Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:15:05.469Z] [LOG]    Expected Hours: 170
[2025-10-07T17:15:05.470Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:15:05.470Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:15:05.470Z] [LOG]    Worked Hours: 162.1619
[2025-10-07T17:15:05.471Z] [LOG]    ⚠️  Shortfall Hours: 7.838099999999997
[2025-10-07T17:15:05.471Z] [LOG]    💸 Shortfall Deduction: 7.838099999999997h × 282.35 = 2213.11
[2025-10-07T17:15:05.471Z] [LOG] ============================================================
[2025-10-07T17:15:05.689Z] [LOG] ✅ Weekend Day Met: 2025-08-02 (Saturday)
[2025-10-07T17:15:05.689Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:05.690Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:15:05.690Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:05.691Z] [LOG] ✅ Weekend Day Met: 2025-08-16 (Saturday)
[2025-10-07T17:15:05.691Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:05.691Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:15:05.692Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:05.692Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:15:05.692Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:05.909Z] [LOG] 📅 Weekend absence check for employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:05.910Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:15:05.910Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:15:05.911Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:15:05.911Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:15:05.911Z] [LOG]    Gross Salary: 60000
[2025-10-07T17:15:05.912Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:15:05.912Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:15:05.913Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:05.913Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:15:05.913Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:05.914Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:15:05.914Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:05.914Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:15:05.915Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:05.915Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:15:05.915Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:05.916Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:15:05.916Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:05.917Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:15:05.917Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:05.918Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:15:05.918Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:05.918Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:15:05.918Z] [LOG] Regular deductions for Sumaiya null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:15:05.919Z] [LOG] Combined deductions for Sumaiya null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2213.1105882352936,
      "details": "7.838099999999997 hours × 282.35"
    }
  ],
  "total": 2213.1105882352936
}
[2025-10-07T17:15:06.031Z] [LOG] Creating components for record 12712748-11b5-4249-b7fa-09a67c18f0f3: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-07T17:15:06.032Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2213.1105882352936
}
[2025-10-07T17:15:06.142Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:15:06.249Z] [LOG] Created payroll_record_component: 1c84ae08-79b7-419a-843a-c6c225c241e8 for Working Hours Shortfall
[2025-10-07T17:15:06.581Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:06.583Z] [ERROR] ❌ Error updating financial balances for employee 0143b22f-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:06.611Z] [LOG] ✅ Sumaiya null: Calculation completed successfully
[2025-10-07T17:15:06.611Z] [LOG] 📊 Progress: 3/34 (8.8%)
[2025-10-07T17:15:06.611Z] [LOG] 
🧮 Processing: Safna Nawas null (EMP000021)
[2025-10-07T17:15:06.612Z] [LOG] 📋 Record ID: 16154d75-b6f6-4214-a489-b009c91f0c8c
[2025-10-07T17:15:07.044Z] [LOG] 🔍 Component filtering for employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:07.045Z] [LOG]    Total components: 8
[2025-10-07T17:15:07.045Z] [LOG]    Applicable components: 8
[2025-10-07T17:15:07.046Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-07T17:15:07.760Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:07.985Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:08.209Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:08.446Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:08.685Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:08.925Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:09.145Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:09.361Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:09.579Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:09.794Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:10.013Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:10.231Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:10.455Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:10.691Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:10.927Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:11.045Z] [LOG] 🔍 Fetched 23 attendance records for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:11.163Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:15:11.756Z] [LOG] Employee 0143c977-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:11.756Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:15:11.756Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:15:11.757Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:15:11.757Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:11.757Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:15:11.757Z] [LOG] ================================================================================
[2025-10-07T17:15:11.757Z] [LOG] 📅 2025-08-01 (WEEKDAY): 9.95h worked → 7.495555555555556h counted → OVERLAP 09:30-17:00 = 7.496h (attendance table)
[2025-10-07T17:15:11.757Z] [LOG]    ✅ Added to weekday total: 7.495555555555556h
[2025-10-07T17:15:11.757Z] [LOG] 📅 2025-08-02 (WEEKEND): 4.12h worked → 2.265833333333333h counted → OVERLAP 10:44-13:00 = 2.266h (attendance table)
[2025-10-07T17:15:11.757Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 2.265833333333333h
[2025-10-07T17:15:11.758Z] [LOG] 📅 2025-08-04 (WEEKDAY): 9.1h worked → 8.166666666666666h counted → OVERLAP 08:50-17:00 = 8.167h (attendance table)
[2025-10-07T17:15:11.758Z] [LOG]    ✅ Added to weekday total: 8.166666666666666h
[2025-10-07T17:15:11.758Z] [LOG] 📅 2025-08-05 (WEEKDAY): 7.41h worked → 6.909166666666667h counted → OVERLAP 10:05-17:00 = 6.909h (attendance table)
[2025-10-07T17:15:11.758Z] [LOG]    ✅ Added to weekday total: 6.909166666666667h
[2025-10-07T17:15:11.758Z] [LOG] 📅 2025-08-06 (WEEKDAY): 11.23h worked → 8.142777777777777h counted → OVERLAP 08:51-17:00 = 8.143h (attendance table)
[2025-10-07T17:15:11.758Z] [LOG]    ✅ Added to weekday total: 8.142777777777777h
[2025-10-07T17:15:11.758Z] [LOG] 📅 2025-08-07 (WEEKDAY): 10.44h worked → 8.013333333333334h counted → OVERLAP 08:59-17:00 = 8.013h (attendance table)
[2025-10-07T17:15:11.758Z] [LOG]    ✅ Added to weekday total: 8.013333333333334h
[2025-10-07T17:15:11.758Z] [LOG] 📅 2025-08-09 (WEEKEND): 5.17h worked → 3.1666666666666665h counted → OVERLAP 09:50-13:00 = 3.167h (attendance table)
[2025-10-07T17:15:11.758Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.1666666666666665h
[2025-10-07T17:15:11.758Z] [LOG] 📅 2025-08-11 (WEEKDAY): 9.29h worked → 8.293888888888889h counted → OVERLAP 08:42-17:00 = 8.294h (attendance table)
[2025-10-07T17:15:11.758Z] [LOG]    ✅ Added to weekday total: 8.293888888888889h
[2025-10-07T17:15:11.759Z] [LOG] 📅 2025-08-12 (WEEKDAY): 9.75h worked → 6.25h counted → OVERLAP 10:45-17:00 = 6.250h (attendance table)
[2025-10-07T17:15:11.759Z] [LOG]    ✅ Added to weekday total: 6.25h
[2025-10-07T17:15:11.759Z] [LOG] 📅 2025-08-13 (WEEKDAY): 8.83h worked → 8.333333333333334h counted → OVERLAP 08:40-17:00 = 8.333h (attendance table)
[2025-10-07T17:15:11.759Z] [LOG]    ✅ Added to weekday total: 8.333333333333334h
[2025-10-07T17:15:11.759Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.21h worked → 8.205555555555556h counted → OVERLAP 08:47-17:00 = 8.206h (attendance table)
[2025-10-07T17:15:11.759Z] [LOG]    ✅ Added to weekday total: 8.205555555555556h
[2025-10-07T17:15:11.759Z] [LOG] 📅 2025-08-15 (WEEKDAY): 11.61h worked → 8.061388888888889h counted → OVERLAP 08:56-17:00 = 8.061h (attendance table)
[2025-10-07T17:15:11.759Z] [LOG]    ✅ Added to weekday total: 8.061388888888889h
[2025-10-07T17:15:11.759Z] [LOG] 📅 2025-08-16 (WEEKEND): 8.4h worked → 4.3975h counted → OVERLAP 08:36-13:00 = 4.397h (attendance table)
[2025-10-07T17:15:11.759Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.3975h
[2025-10-07T17:15:11.759Z] [LOG] 📅 2025-08-18 (WEEKDAY): 8.69h worked → 8.311944444444444h counted → OVERLAP 08:41-17:00 = 8.312h (attendance table)
[2025-10-07T17:15:11.759Z] [LOG]    ✅ Added to weekday total: 8.311944444444444h
[2025-10-07T17:15:11.759Z] [LOG] 📅 2025-08-19 (WEEKDAY): 10.32h worked → 7.75h counted → OVERLAP 09:15-17:00 = 7.750h (attendance table)
[2025-10-07T17:15:11.759Z] [LOG]    ✅ Added to weekday total: 7.75h
[2025-10-07T17:15:11.760Z] [LOG] 📅 2025-08-21 (WEEKDAY): 10.43h worked → 8.25h counted → OVERLAP 08:45-17:00 = 8.250h (attendance table)
[2025-10-07T17:15:11.760Z] [LOG]    ✅ Added to weekday total: 8.25h
[2025-10-07T17:15:11.760Z] [LOG] 📅 2025-08-22 (WEEKDAY): 9.18h worked → 8h counted → OVERLAP 09:00-17:00 = 8.000h (attendance table)
[2025-10-07T17:15:11.760Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:15:11.760Z] [LOG] 📅 2025-08-23 (WEEKEND): 6.24h worked → 4.125555555555556h counted → OVERLAP 08:52-13:00 = 4.126h (attendance table)
[2025-10-07T17:15:11.760Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.125555555555556h
[2025-10-07T17:15:11.760Z] [LOG] 📅 2025-08-25 (WEEKDAY): 9.5h worked → 8.395h counted → OVERLAP 08:36-17:00 = 8.395h (attendance table)
[2025-10-07T17:15:11.760Z] [LOG]    ✅ Added to weekday total: 8.395h
[2025-10-07T17:15:11.760Z] [LOG] 📅 2025-08-26 (WEEKDAY): 7.84h worked → 7.3375h counted → OVERLAP 09:39-17:00 = 7.338h (attendance table)
[2025-10-07T17:15:11.760Z] [LOG]    ✅ Added to weekday total: 7.3375h
[2025-10-07T17:15:11.760Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.35h worked → 6.847222222222222h counted → OVERLAP 10:09-17:00 = 6.847h (attendance table)
[2025-10-07T17:15:11.760Z] [LOG]    ✅ Added to weekday total: 6.847222222222222h
[2025-10-07T17:15:11.760Z] [LOG] 📅 2025-08-29 (WEEKDAY): 8.76h worked → 8.26388888888889h counted → OVERLAP 08:44-17:00 = 8.264h (attendance table)
[2025-10-07T17:15:11.760Z] [LOG]    ✅ Added to weekday total: 8.26388888888889h
[2025-10-07T17:15:11.760Z] [LOG] 📅 2025-08-30 (WEEKEND): 3.5h worked → 3.5h counted → OVERLAP 09:30-13:00 = 3.500h (attendance table)
[2025-10-07T17:15:11.761Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.5h
[2025-10-07T17:15:11.761Z] [LOG] ================================================================================
[2025-10-07T17:15:11.761Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:15:11.761Z] [LOG]    Sum of all daily counted hours (rounded): 141.0272h
[2025-10-07T17:15:11.761Z] [LOG]    Expected hours: 170h
[2025-10-07T17:15:11.761Z] [LOG]    Shortfall: 28.97h
[2025-10-07T17:15:11.761Z] [LOG] ================================================================================
[2025-10-07T17:15:11.872Z] [LOG] 🔄 Processing financial records for employee 0143c977-7105-11f0-a50f-98e743540430...
[2025-10-07T17:15:11.872Z] [LOG] 🔄 Processing financial records for employee 0143c977-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:15:12.026Z] [LOG] 📊 Found 0 active loans for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:12.135Z] [LOG] 📊 Found 0 active advances for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:12.244Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:12.244Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:15:12.245Z] [LOG] 💰 GROSS CALCULATION for Safna Nawas null:
[2025-10-07T17:15:12.245Z] [LOG]    Base Salary: 50000
[2025-10-07T17:15:12.245Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:15:12.356Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:15:12.583Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:15:12.810Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:15:12.923Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:15:13.031Z] [LOG] Employee 0143c977-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:13.031Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:15:13.031Z] [LOG] ============================================================
[2025-10-07T17:15:13.031Z] [LOG] 👤 Employee ID: 0143c977-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:13.031Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:15:13.032Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:15:13.032Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:15:13.032Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:15:13.032Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:15:13.032Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:15:13.032Z] [LOG] 
[2025-10-07T17:15:13.032Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:15:13.032Z] [LOG]    Expected Hours: 170
[2025-10-07T17:15:13.032Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:15:13.032Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:15:13.033Z] [LOG]    Worked Hours: 141.0272
[2025-10-07T17:15:13.033Z] [LOG]    ⚠️  Shortfall Hours: 28.972800000000007
[2025-10-07T17:15:13.033Z] [LOG]    💸 Shortfall Deduction: 28.972800000000007h × 235.29 = 6817.13
[2025-10-07T17:15:13.033Z] [LOG] ============================================================
[2025-10-07T17:15:13.250Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-02 (Saturday)
[2025-10-07T17:15:13.251Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:13.251Z] [LOG]    Actual: 10:44:03 - 14:51:25
[2025-10-07T17:15:13.251Z] [LOG]    Calculation: OVERLAP 10:44-13:00 = 2.266h
[2025-10-07T17:15:13.251Z] [LOG]    Payable Hours: 2.266h
[2025-10-07T17:15:13.251Z] [LOG]    Shortfall: 2.234h
[2025-10-07T17:15:13.251Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:15:13.252Z] [LOG]    Deduction: 992.96
[2025-10-07T17:15:13.252Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-09 (Saturday)
[2025-10-07T17:15:13.252Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:13.252Z] [LOG]    Actual: 09:50:00 - 15:00:00
[2025-10-07T17:15:13.253Z] [LOG]    Calculation: OVERLAP 09:50-13:00 = 3.167h
[2025-10-07T17:15:13.253Z] [LOG]    Payable Hours: 3.167h
[2025-10-07T17:15:13.253Z] [LOG]    Shortfall: 1.333h
[2025-10-07T17:15:13.253Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:15:13.253Z] [LOG]    Deduction: 592.59
[2025-10-07T17:15:13.253Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-16 (Saturday)
[2025-10-07T17:15:13.253Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:13.253Z] [LOG]    Actual: 08:36:09 - 17:00:00
[2025-10-07T17:15:13.254Z] [LOG]    Calculation: OVERLAP 08:36-13:00 = 4.397h
[2025-10-07T17:15:13.254Z] [LOG]    Payable Hours: 4.397h
[2025-10-07T17:15:13.254Z] [LOG]    Shortfall: 0.103h
[2025-10-07T17:15:13.254Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:15:13.254Z] [LOG]    Deduction: 45.56
[2025-10-07T17:15:13.254Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-23 (Saturday)
[2025-10-07T17:15:13.254Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:13.254Z] [LOG]    Actual: 08:52:28 - 15:07:00
[2025-10-07T17:15:13.255Z] [LOG]    Calculation: OVERLAP 08:52-13:00 = 4.126h
[2025-10-07T17:15:13.255Z] [LOG]    Payable Hours: 4.126h
[2025-10-07T17:15:13.255Z] [LOG]    Shortfall: 0.374h
[2025-10-07T17:15:13.255Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:15:13.255Z] [LOG]    Deduction: 166.42
[2025-10-07T17:15:13.255Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-30 (Saturday)
[2025-10-07T17:15:13.256Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:13.256Z] [LOG]    Actual: 09:30:00 - 13:00:00
[2025-10-07T17:15:13.256Z] [LOG]    Calculation: OVERLAP 09:30-13:00 = 3.500h
[2025-10-07T17:15:13.256Z] [LOG]    Payable Hours: 3.500h
[2025-10-07T17:15:13.256Z] [LOG]    Shortfall: 1.000h
[2025-10-07T17:15:13.257Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:15:13.257Z] [LOG]    Deduction: 444.44
[2025-10-07T17:15:13.473Z] [LOG] 📅 Weekend absence check for employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:13.473Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:15:13.473Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:15:13.473Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:15:13.473Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:15:13.474Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:15:13.474Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:15:13.474Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:15:13.474Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:13.474Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:15:13.474Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:13.474Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:15:13.474Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:13.474Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:15:13.475Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:13.475Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:15:13.475Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:13.475Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:15:13.475Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:13.475Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:15:13.475Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:13.475Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:15:13.475Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:13.475Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:15:13.475Z] [LOG] Regular deductions for Safna Nawas null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:15:13.476Z] [LOG] Combined deductions for Safna Nawas null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 2241.9753086419755,
      "details": "Total 5.04h shortfall - 2025-08-02 (Saturday): 2.23h, 2025-08-09 (Saturday): 1.33h, 2025-08-16 (Saturday): 0.10h, 2025-08-23 (Saturday): 0.37h, 2025-08-30 (Saturday): 1.00h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 6817.129411764707,
      "details": "28.972800000000007 hours × 235.29"
    }
  ],
  "total": 9059.104720406682
}
[2025-10-07T17:15:13.585Z] [LOG] Creating components for record 16154d75-b6f6-4214-a489-b009c91f0c8c: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:15:13.585Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 2241.9753086419755
}
[2025-10-07T17:15:13.694Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:15:13.804Z] [LOG] Created payroll_record_component: 877929cc-2019-4e93-8c9e-f2fa7cb8223a for Weekend Shortfall Deduction
[2025-10-07T17:15:13.805Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 6817.129411764707
}
[2025-10-07T17:15:13.912Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:15:14.020Z] [LOG] Created payroll_record_component: f3053ec8-e11a-4fa7-a605-e5401be7f9a0 for Working Hours Shortfall
[2025-10-07T17:15:14.352Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:14.354Z] [ERROR] ❌ Error updating financial balances for employee 0143c977-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:14.354Z] [LOG] ✅ Safna Nawas null: Calculation completed successfully
[2025-10-07T17:15:14.355Z] [LOG] 📊 Progress: 4/34 (11.8%)
[2025-10-07T17:15:14.355Z] [LOG] 
🧮 Processing: Waruni null (EMP000024)
[2025-10-07T17:15:14.355Z] [LOG] 📋 Record ID: 1a866497-5363-4091-b429-c28e10b827bc
[2025-10-07T17:15:14.829Z] [LOG] 🔍 Component filtering for employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:14.830Z] [LOG]    Total components: 8
[2025-10-07T17:15:14.830Z] [LOG]    Applicable components: 8
[2025-10-07T17:15:14.830Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-07T17:15:15.534Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:15.770Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:16.006Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:16.244Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:16.478Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:16.714Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:16.941Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:17.157Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:17.375Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:17.591Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:17.805Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:18.022Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:18.253Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:18.487Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:18.702Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:18.924Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:19.138Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:19.246Z] [LOG] 🔍 Fetched 25 attendance records for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:19.353Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:15:19.905Z] [LOG] Employee 0143e40c-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:19.905Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:15:19.906Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:15:19.906Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:15:19.906Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:19.907Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:15:19.907Z] [LOG] ================================================================================
[2025-10-07T17:15:19.907Z] [LOG] 📅 2025-08-01 (WEEKDAY): 9.4h worked → 8.481111111111112h counted → OVERLAP 08:31-17:00 = 8.481h (attendance table)
[2025-10-07T17:15:19.907Z] [LOG]    ✅ Added to weekday total: 8.481111111111112h
[2025-10-07T17:15:19.907Z] [LOG] 📅 2025-08-02 (WEEKEND): 4.83h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:19.907Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:19.908Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.45h worked → 8.38888888888889h counted → OVERLAP 08:36-17:00 = 8.389h (attendance table)
[2025-10-07T17:15:19.908Z] [LOG]    ✅ Added to weekday total: 8.38888888888889h
[2025-10-07T17:15:19.908Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.68h worked → 8.463333333333333h counted → OVERLAP 08:32-17:00 = 8.463h (attendance table)
[2025-10-07T17:15:19.908Z] [LOG]    ✅ Added to weekday total: 8.463333333333333h
[2025-10-07T17:15:19.908Z] [LOG] 📅 2025-08-06 (WEEKDAY): 11.58h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:19.908Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:19.908Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.47h worked → 8.473055555555556h counted → OVERLAP 08:31-17:00 = 8.473h (attendance table)
[2025-10-07T17:15:19.908Z] [LOG]    ✅ Added to weekday total: 8.473055555555556h
[2025-10-07T17:15:19.908Z] [LOG] 📅 2025-08-09 (WEEKEND): 5.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:19.908Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:19.908Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8.49h worked → 8.488333333333333h counted → OVERLAP 08:30-16:59 = 8.488h (attendance table)
[2025-10-07T17:15:19.908Z] [LOG]    ✅ Added to weekday total: 8.488333333333333h
[2025-10-07T17:15:19.908Z] [LOG] 📅 2025-08-12 (WEEKDAY): 9h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:19.909Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:19.909Z] [LOG] 📅 2025-08-13 (WEEKDAY): 8.57h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:19.909Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:19.909Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.51h worked → 8.494444444444444h counted → OVERLAP 08:30-17:00 = 8.494h (attendance table)
[2025-10-07T17:15:19.909Z] [LOG]    ✅ Added to weekday total: 8.494444444444444h
[2025-10-07T17:15:19.909Z] [LOG] 📅 2025-08-15 (WEEKDAY): 11.89h worked → 8.470555555555556h counted → OVERLAP 08:31-17:00 = 8.471h (attendance table)
[2025-10-07T17:15:19.910Z] [LOG]    ✅ Added to weekday total: 8.470555555555556h
[2025-10-07T17:15:19.910Z] [LOG] 📅 2025-08-16 (WEEKEND): 5.4h worked → 4.395555555555555h counted → OVERLAP 08:36-13:00 = 4.396h (attendance table)
[2025-10-07T17:15:19.911Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.395555555555555h
[2025-10-07T17:15:19.911Z] [LOG] 📅 2025-08-18 (WEEKDAY): 8.59h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:19.911Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:19.911Z] [LOG] 📅 2025-08-19 (WEEKDAY): 9.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:19.911Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:19.911Z] [LOG] 📅 2025-08-20 (WEEKDAY): 8.51h worked → 8.435277777777777h counted → OVERLAP 08:33-17:00 = 8.435h (attendance table)
[2025-10-07T17:15:19.911Z] [LOG]    ✅ Added to weekday total: 8.435277777777777h
[2025-10-07T17:15:19.911Z] [LOG] 📅 2025-08-21 (WEEKDAY): 8.41h worked → 8.411388888888888h counted → OVERLAP 08:35-17:00 = 8.411h (attendance table)
[2025-10-07T17:15:19.911Z] [LOG]    ✅ Added to weekday total: 8.411388888888888h
[2025-10-07T17:15:19.912Z] [LOG] 📅 2025-08-22 (WEEKDAY): 8.5h worked → 8.447222222222223h counted → OVERLAP 08:33-17:00 = 8.447h (attendance table)
[2025-10-07T17:15:19.912Z] [LOG]    ✅ Added to weekday total: 8.447222222222223h
[2025-10-07T17:15:19.912Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.79h worked → 4.4863888888888885h counted → OVERLAP 08:30-13:00 = 4.486h (attendance table)
[2025-10-07T17:15:19.912Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.4863888888888885h
[2025-10-07T17:15:19.912Z] [LOG] 📅 2025-08-25 (WEEKDAY): 9.41h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:19.912Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:19.912Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.58h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:19.912Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:19.912Z] [LOG] 📅 2025-08-27 (WEEKDAY): 8.53h worked → 8.470277777777778h counted → OVERLAP 08:31-17:00 = 8.470h (attendance table)
[2025-10-07T17:15:19.912Z] [LOG]    ✅ Added to weekday total: 8.470277777777778h
[2025-10-07T17:15:19.912Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.82h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:19.912Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:19.912Z] [LOG] 📅 2025-08-29 (WEEKDAY): 8.8h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:19.912Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:19.912Z] [LOG] 📅 2025-08-30 (WEEKEND): 4.97h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:19.912Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:19.912Z] [LOG] ================================================================================
[2025-10-07T17:15:19.912Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:15:19.913Z] [LOG]    Sum of all daily counted hours (rounded): 169.5239h
[2025-10-07T17:15:19.913Z] [LOG]    Expected hours: 170h
[2025-10-07T17:15:19.913Z] [LOG]    Shortfall: 0.48h
[2025-10-07T17:15:19.913Z] [LOG] ================================================================================
[2025-10-07T17:15:20.023Z] [LOG] 🔄 Processing financial records for employee 0143e40c-7105-11f0-a50f-98e743540430...
[2025-10-07T17:15:20.023Z] [LOG] 🔄 Processing financial records for employee 0143e40c-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:15:20.141Z] [LOG] 📊 Found 0 active loans for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:20.260Z] [LOG] 📊 Found 0 active advances for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:20.378Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:20.378Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:15:20.379Z] [LOG] 💰 GROSS CALCULATION for Waruni null:
[2025-10-07T17:15:20.379Z] [LOG]    Base Salary: 50000
[2025-10-07T17:15:20.379Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:15:20.490Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:15:20.707Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:15:20.923Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:15:21.031Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:15:21.141Z] [LOG] Employee 0143e40c-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:21.142Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:15:21.142Z] [LOG] ============================================================
[2025-10-07T17:15:21.142Z] [LOG] 👤 Employee ID: 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:21.143Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:15:21.143Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:15:21.143Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:15:21.143Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:15:21.143Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:15:21.143Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:15:21.143Z] [LOG] 
[2025-10-07T17:15:21.144Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:15:21.144Z] [LOG]    Expected Hours: 170
[2025-10-07T17:15:21.144Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:15:21.144Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:15:21.144Z] [LOG]    Worked Hours: 169.5239
[2025-10-07T17:15:21.145Z] [LOG]    ⚠️  Shortfall Hours: 0.4761000000000024
[2025-10-07T17:15:21.145Z] [LOG]    💸 Shortfall Deduction: 0.4761000000000024h × 235.29 = 112.02
[2025-10-07T17:15:21.145Z] [LOG] ============================================================
[2025-10-07T17:15:21.362Z] [LOG] ✅ Weekend Day Met: 2025-08-02 (Saturday)
[2025-10-07T17:15:21.363Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:21.363Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:15:21.363Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:21.364Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-16 (Saturday)
[2025-10-07T17:15:21.364Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:21.364Z] [LOG]    Actual: 08:36:16 - 14:00:00
[2025-10-07T17:15:21.365Z] [LOG]    Calculation: OVERLAP 08:36-13:00 = 4.396h
[2025-10-07T17:15:21.365Z] [LOG]    Payable Hours: 4.396h
[2025-10-07T17:15:21.365Z] [LOG]    Shortfall: 0.104h
[2025-10-07T17:15:21.366Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:15:21.366Z] [LOG]    Deduction: 46.42
[2025-10-07T17:15:21.367Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-23 (Saturday)
[2025-10-07T17:15:21.367Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:21.367Z] [LOG]    Actual: 08:30:49 - 13:18:03
[2025-10-07T17:15:21.367Z] [LOG]    Calculation: OVERLAP 08:30-13:00 = 4.486h
[2025-10-07T17:15:21.368Z] [LOG]    Payable Hours: 4.486h
[2025-10-07T17:15:21.368Z] [LOG]    Shortfall: 0.014h
[2025-10-07T17:15:21.368Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:15:21.368Z] [LOG]    Deduction: 6.05
[2025-10-07T17:15:21.369Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:15:21.369Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:21.587Z] [LOG] 📅 Weekend absence check for employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:21.588Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:15:21.588Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:15:21.589Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:15:21.589Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:15:21.589Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:15:21.590Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:15:21.590Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:15:21.590Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:21.591Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:15:21.591Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:21.591Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:15:21.591Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:21.592Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:15:21.592Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:21.592Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:15:21.592Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:21.592Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:15:21.593Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:21.593Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:15:21.593Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:21.593Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:15:21.593Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:21.594Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:15:21.594Z] [LOG] Regular deductions for Waruni null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:15:21.594Z] [LOG] Combined deductions for Waruni null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 52.46913580246944,
      "details": "Total 0.12h shortfall - 2025-08-16 (Saturday): 0.10h, 2025-08-23 (Saturday): 0.01h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 112.02352941176527,
      "details": "0.4761000000000024 hours × 235.29"
    }
  ],
  "total": 164.4926652142347
}
[2025-10-07T17:15:21.703Z] [LOG] Creating components for record 1a866497-5363-4091-b429-c28e10b827bc: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:15:21.704Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 52.46913580246944
}
[2025-10-07T17:15:21.812Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:15:21.919Z] [LOG] Created payroll_record_component: 5b7d2f3f-0d21-43d2-bfe5-5bec630404af for Weekend Shortfall Deduction
[2025-10-07T17:15:21.920Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 112.02352941176527
}
[2025-10-07T17:15:22.030Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:15:22.148Z] [LOG] Created payroll_record_component: 334540b1-f655-46ca-b9f2-bd8ae5264a99 for Working Hours Shortfall
[2025-10-07T17:15:22.507Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:22.508Z] [ERROR] ❌ Error updating financial balances for employee 0143e40c-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:22.508Z] [LOG] ✅ Waruni null: Calculation completed successfully
[2025-10-07T17:15:22.508Z] [LOG] 📊 Progress: 5/34 (14.7%)
[2025-10-07T17:15:22.508Z] [LOG] 
🧮 Processing: Chemil null (EMP000040)
[2025-10-07T17:15:22.508Z] [LOG] 📋 Record ID: 20aaca53-b96b-4278-ac0b-9a30010f5a7f
[2025-10-07T17:15:22.977Z] [LOG] 🔍 Component filtering for employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:22.977Z] [LOG]    Total components: 8
[2025-10-07T17:15:22.978Z] [LOG]    Applicable components: 8
[2025-10-07T17:15:22.978Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-07T17:15:23.686Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:23.925Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:24.158Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:24.409Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:24.631Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:24.868Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:25.090Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:25.306Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:25.522Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:25.633Z] [LOG] 🔍 Fetched 21 attendance records for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:25.742Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:15:26.286Z] [LOG] Employee 01442599-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:26.287Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:15:26.287Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:15:26.288Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:15:26.288Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:26.289Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:15:26.289Z] [LOG] ================================================================================
[2025-10-07T17:15:26.289Z] [LOG] 📅 2025-08-01 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.289Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.290Z] [LOG] 📅 2025-08-02 (WEEKEND): 0h worked → 0h counted → NO OVERLAP with scheduled time (attendance table)
[2025-10-07T17:15:26.290Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 0h
[2025-10-07T17:15:26.290Z] [LOG] 📅 2025-08-04 (WEEKDAY): 6.6h worked → 6.603611111111111h counted → OVERLAP 10:23-17:00 = 6.604h (attendance table)
[2025-10-07T17:15:26.290Z] [LOG]    ✅ Added to weekday total: 6.603611111111111h
[2025-10-07T17:15:26.291Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.291Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.291Z] [LOG] 📅 2025-08-06 (WEEKDAY): 9.7h worked → 8.492222222222223h counted → OVERLAP 08:30-17:00 = 8.492h (attendance table)
[2025-10-07T17:15:26.291Z] [LOG]    ✅ Added to weekday total: 8.492222222222223h
[2025-10-07T17:15:26.291Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.291Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.291Z] [LOG] 📅 2025-08-11 (WEEKDAY): 10.52h worked → 7.222777777777778h counted → OVERLAP 09:46-17:00 = 7.223h (attendance table)
[2025-10-07T17:15:26.292Z] [LOG]    ✅ Added to weekday total: 7.222777777777778h
[2025-10-07T17:15:26.292Z] [LOG] 📅 2025-08-12 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.292Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.292Z] [LOG] 📅 2025-08-15 (WEEKDAY): 7.12h worked → 7.118888888888889h counted → OVERLAP 09:52-17:00 = 7.119h (attendance table)
[2025-10-07T17:15:26.292Z] [LOG]    ✅ Added to weekday total: 7.118888888888889h
[2025-10-07T17:15:26.292Z] [LOG] 📅 2025-08-16 (WEEKEND): 4.5h worked → 4.496666666666667h counted → OVERLAP 08:30-13:00 = 4.497h (attendance table)
[2025-10-07T17:15:26.292Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.496666666666667h
[2025-10-07T17:15:26.292Z] [LOG] 📅 2025-08-18 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.292Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.292Z] [LOG] 📅 2025-08-19 (WEEKDAY): 8.43h worked → 8.432222222222222h counted → OVERLAP 08:34-17:00 = 8.432h (attendance table)
[2025-10-07T17:15:26.292Z] [LOG]    ✅ Added to weekday total: 8.432222222222222h
[2025-10-07T17:15:26.292Z] [LOG] 📅 2025-08-20 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.292Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.292Z] [LOG] 📅 2025-08-21 (WEEKDAY): 10.01h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.292Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.292Z] [LOG] 📅 2025-08-22 (WEEKDAY): 9.88h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.292Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.292Z] [LOG] 📅 2025-08-25 (WEEKDAY): 10.63h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.292Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.292Z] [LOG] 📅 2025-08-26 (WEEKDAY): 10.31h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.293Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.293Z] [LOG] 📅 2025-08-27 (WEEKDAY): 9.74h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.293Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.293Z] [LOG] 📅 2025-08-28 (WEEKDAY): 10.39h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:26.293Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:26.293Z] [LOG] 📅 2025-08-29 (WEEKDAY): 11.83h worked → 8.492777777777778h counted → OVERLAP 08:30-17:00 = 8.493h (attendance table)
[2025-10-07T17:15:26.293Z] [LOG]    ✅ Added to weekday total: 8.492777777777778h
[2025-10-07T17:15:26.293Z] [LOG] 📅 2025-08-30 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:26.293Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:26.293Z] [LOG] ================================================================================
[2025-10-07T17:15:26.293Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:15:26.293Z] [LOG]    Sum of all daily counted hours (rounded): 148.3625h
[2025-10-07T17:15:26.293Z] [LOG]    Expected hours: 170h
[2025-10-07T17:15:26.293Z] [LOG]    Shortfall: 21.64h
[2025-10-07T17:15:26.293Z] [LOG] ================================================================================
[2025-10-07T17:15:26.403Z] [LOG] 🔄 Processing financial records for employee 01442599-7105-11f0-a50f-98e743540430...
[2025-10-07T17:15:26.403Z] [LOG] 🔄 Processing financial records for employee 01442599-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:15:26.521Z] [LOG] 📊 Found 0 active loans for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:26.638Z] [LOG] 📊 Found 0 active advances for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:26.756Z] [LOG] 📊 Found 0 approved bonuses for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:26.756Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:15:26.757Z] [LOG] 💰 GROSS CALCULATION for Chemil null:
[2025-10-07T17:15:26.757Z] [LOG]    Base Salary: 250000
[2025-10-07T17:15:26.757Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:15:26.873Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:15:27.110Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:15:27.339Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:15:27.447Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:15:27.555Z] [LOG] Employee 01442599-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:27.556Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:15:27.556Z] [LOG] ============================================================
[2025-10-07T17:15:27.557Z] [LOG] 👤 Employee ID: 01442599-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:27.557Z] [LOG] 💰 Base Salary: 250,000
[2025-10-07T17:15:27.557Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:15:27.557Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:15:27.558Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:15:27.558Z] [LOG] 💵 Per-Day Salary: 10000.00
[2025-10-07T17:15:27.558Z] [LOG] ⏱️  Hourly Rate: 1176.47
[2025-10-07T17:15:27.559Z] [LOG] 
[2025-10-07T17:15:27.559Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:15:27.559Z] [LOG]    Expected Hours: 170
[2025-10-07T17:15:27.560Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:15:27.560Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:15:27.560Z] [LOG]    Worked Hours: 148.3625
[2025-10-07T17:15:27.561Z] [LOG]    ⚠️  Shortfall Hours: 21.63749999999999
[2025-10-07T17:15:27.561Z] [LOG]    💸 Shortfall Deduction: 21.63749999999999h × 1176.47 = 25455.88
[2025-10-07T17:15:27.561Z] [LOG] ============================================================
[2025-10-07T17:15:27.780Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-02 (Saturday)
[2025-10-07T17:15:27.781Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:27.781Z] [LOG]    Actual: 08:30:00 - 00:00:00
[2025-10-07T17:15:27.781Z] [LOG]    Calculation: NO OVERLAP with scheduled time
[2025-10-07T17:15:27.781Z] [LOG]    Payable Hours: 0.000h
[2025-10-07T17:15:27.782Z] [LOG]    Shortfall: 4.500h
[2025-10-07T17:15:27.782Z] [LOG]    Hourly Rate: 2222.22 (Day Salary 10000 ÷ 4.5h)
[2025-10-07T17:15:27.782Z] [LOG]    Deduction: 10000.00
[2025-10-07T17:15:27.783Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-16 (Saturday)
[2025-10-07T17:15:27.783Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:27.783Z] [LOG]    Actual: 08:30:12 - 13:00:00
[2025-10-07T17:15:27.783Z] [LOG]    Calculation: OVERLAP 08:30-13:00 = 4.497h
[2025-10-07T17:15:27.784Z] [LOG]    Payable Hours: 4.497h
[2025-10-07T17:15:27.784Z] [LOG]    Shortfall: 0.003h
[2025-10-07T17:15:27.784Z] [LOG]    Hourly Rate: 2222.22 (Day Salary 10000 ÷ 4.5h)
[2025-10-07T17:15:27.784Z] [LOG]    Deduction: 7.41
[2025-10-07T17:15:27.784Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:15:27.784Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:27.999Z] [LOG] 📅 Weekend absence check for employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:28.000Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:15:28.000Z] [LOG]    Attended weekend dates: 3 days
[2025-10-07T17:15:28.000Z] [LOG]    Absent weekend dates: 2 days
[2025-10-07T17:15:28.001Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:15:28.001Z] [LOG]    Gross Salary: 250000
[2025-10-07T17:15:28.001Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:15:28.002Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:15:28.002Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:28.002Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:15:28.003Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:28.003Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:15:28.004Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:28.004Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:15:28.004Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:28.004Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:15:28.005Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:28.005Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:15:28.005Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:28.006Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:15:28.006Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:28.006Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:15:28.007Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:28.007Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:15:28.007Z] [LOG] Regular deductions for Chemil null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:15:28.008Z] [LOG] Combined deductions for Chemil null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 10007.407407407407,
      "details": "Total 4.50h shortfall - 2025-08-02 (Saturday): 4.50h, 2025-08-16 (Saturday): 0.00h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 25455.882352941164,
      "details": "21.63749999999999 hours × 1176.47"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 20000,
      "details": "2 weekend days × 10000.00"
    }
  ],
  "total": 55463.28976034857
}
[2025-10-07T17:15:28.119Z] [LOG] Creating components for record 20aaca53-b96b-4278-ac0b-9a30010f5a7f: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 3,
  "taxComponentsCount": 1
}
[2025-10-07T17:15:28.120Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 10007.407407407407
}
[2025-10-07T17:15:28.228Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:15:28.336Z] [LOG] Created payroll_record_component: 7bb7f1a2-87fa-4797-a612-cde615fcebf8 for Weekend Shortfall Deduction
[2025-10-07T17:15:28.336Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 25455.882352941164
}
[2025-10-07T17:15:28.445Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:15:28.554Z] [LOG] Created payroll_record_component: b5546873-6272-4457-83f6-c4fd1b11ea5a for Working Hours Shortfall
[2025-10-07T17:15:28.555Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 20000
}
[2025-10-07T17:15:28.664Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:15:28.773Z] [LOG] Created payroll_record_component: 6b140a90-b1fd-46e7-a95e-ac461377b95f for Weekend Absent Days
[2025-10-07T17:15:28.774Z] [LOG] Processing component: {
  "name": "Income Tax",
  "type": "tax",
  "amount": 12000
}
[2025-10-07T17:15:28.884Z] [LOG] Using existing component ID: 72f98b53-4bd5-4713-98d0-e3a641ad8d0f
[2025-10-07T17:15:29.000Z] [LOG] Created payroll_record_component: 177777da-f112-4dc5-8835-f5404579fd15 for Income Tax
[2025-10-07T17:15:29.335Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:29.337Z] [ERROR] ❌ Error updating financial balances for employee 01442599-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:29.338Z] [LOG] ✅ Chemil null: Calculation completed successfully
[2025-10-07T17:15:29.339Z] [LOG] 📊 Progress: 6/34 (17.6%)
[2025-10-07T17:15:29.339Z] [LOG] 
🧮 Processing: R. D.A Kaushalya null (EMP000044)
[2025-10-07T17:15:29.339Z] [LOG] 📋 Record ID: 2607bbdd-6ae2-41ac-9aba-1ef6f6a27ec3
[2025-10-07T17:15:29.769Z] [LOG] 🔍 Component filtering for employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:29.770Z] [LOG]    Total components: 8
[2025-10-07T17:15:29.770Z] [LOG]    Applicable components: 8
[2025-10-07T17:15:29.770Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-07T17:15:30.425Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:30.816Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:31.034Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:31.252Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:31.481Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:31.697Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:31.913Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:32.132Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:32.349Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:32.566Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:32.791Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:33.016Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:33.254Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:33.489Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:33.725Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:33.844Z] [LOG] 🔍 Fetched 25 attendance records for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:33.955Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:15:34.503Z] [LOG] Employee 01443963-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:34.504Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:15:34.504Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:15:34.504Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:15:34.505Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:34.506Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:15:34.506Z] [LOG] ================================================================================
[2025-10-07T17:15:34.506Z] [LOG] 📅 2025-08-01 (WEEKDAY): 8.93h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:34.507Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:34.507Z] [LOG] 📅 2025-08-02 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:34.507Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:34.508Z] [LOG] 📅 2025-08-04 (WEEKDAY): 9.1h worked → 8.416666666666666h counted → OVERLAP 08:35-17:00 = 8.417h (attendance table)
[2025-10-07T17:15:34.508Z] [LOG]    ✅ Added to weekday total: 8.416666666666666h
[2025-10-07T17:15:34.508Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.89h worked → 8.487777777777778h counted → OVERLAP 08:30-17:00 = 8.488h (attendance table)
[2025-10-07T17:15:34.508Z] [LOG]    ✅ Added to weekday total: 8.487777777777778h
[2025-10-07T17:15:34.509Z] [LOG] 📅 2025-08-06 (WEEKDAY): 8.19h worked → 7.957777777777777h counted → OVERLAP 09:02-17:00 = 7.958h (attendance table)
[2025-10-07T17:15:34.509Z] [LOG]    ✅ Added to weekday total: 7.957777777777777h
[2025-10-07T17:15:34.509Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.51h worked → 8.200833333333334h counted → OVERLAP 08:47-17:00 = 8.201h (attendance table)
[2025-10-07T17:15:34.510Z] [LOG]    ✅ Added to weekday total: 8.200833333333334h
[2025-10-07T17:15:34.510Z] [LOG] 📅 2025-08-09 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:34.510Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:34.510Z] [LOG] 📅 2025-08-11 (WEEKDAY): 9.05h worked → 8h counted → OVERLAP 09:00-17:00 = 8.000h (attendance table)
[2025-10-07T17:15:34.510Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:15:34.511Z] [LOG] 📅 2025-08-12 (WEEKDAY): 9h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:34.511Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:34.511Z] [LOG] 📅 2025-08-13 (WEEKDAY): 8.97h worked → 8.202777777777778h counted → OVERLAP 08:47-17:00 = 8.203h (attendance table)
[2025-10-07T17:15:34.511Z] [LOG]    ✅ Added to weekday total: 8.202777777777778h
[2025-10-07T17:15:34.512Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.42h worked → 8.060555555555556h counted → OVERLAP 08:56-17:00 = 8.061h (attendance table)
[2025-10-07T17:15:34.512Z] [LOG]    ✅ Added to weekday total: 8.060555555555556h
[2025-10-07T17:15:34.512Z] [LOG] 📅 2025-08-15 (WEEKDAY): 8.85h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:34.512Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:34.513Z] [LOG] 📅 2025-08-16 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:34.513Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:34.513Z] [LOG] 📅 2025-08-18 (WEEKDAY): 9.69h worked → 8.17361111111111h counted → OVERLAP 08:49-17:00 = 8.174h (attendance table)
[2025-10-07T17:15:34.513Z] [LOG]    ✅ Added to weekday total: 8.17361111111111h
[2025-10-07T17:15:34.513Z] [LOG] 📅 2025-08-19 (WEEKDAY): 5.72h worked → 5.058611111111111h counted → OVERLAP 11:56-17:00 = 5.059h (attendance table)
[2025-10-07T17:15:34.514Z] [LOG]    ✅ Added to weekday total: 5.058611111111111h
[2025-10-07T17:15:34.514Z] [LOG] 📅 2025-08-20 (WEEKDAY): 9.03h worked → 8.3825h counted → OVERLAP 08:37-17:00 = 8.383h (attendance table)
[2025-10-07T17:15:34.514Z] [LOG]    ✅ Added to weekday total: 8.3825h
[2025-10-07T17:15:34.514Z] [LOG] 📅 2025-08-21 (WEEKDAY): 8.48h worked → 8.334722222222222h counted → OVERLAP 08:39-17:00 = 8.335h (attendance table)
[2025-10-07T17:15:34.514Z] [LOG]    ✅ Added to weekday total: 8.334722222222222h
[2025-10-07T17:15:34.514Z] [LOG] 📅 2025-08-22 (WEEKDAY): 8.13h worked → 7.506111111111111h counted → OVERLAP 09:29-17:00 = 7.506h (attendance table)
[2025-10-07T17:15:34.514Z] [LOG]    ✅ Added to weekday total: 7.506111111111111h
[2025-10-07T17:15:34.514Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:34.514Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:34.514Z] [LOG] 📅 2025-08-25 (WEEKDAY): 11.38h worked → 8.133888888888889h counted → OVERLAP 08:51-17:00 = 8.134h (attendance table)
[2025-10-07T17:15:34.514Z] [LOG]    ✅ Added to weekday total: 8.133888888888889h
[2025-10-07T17:15:34.514Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.84h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:34.514Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:34.514Z] [LOG] 📅 2025-08-27 (WEEKDAY): 8.77h worked → 8.440555555555555h counted → OVERLAP 08:33-17:00 = 8.441h (attendance table)
[2025-10-07T17:15:34.514Z] [LOG]    ✅ Added to weekday total: 8.440555555555555h
[2025-10-07T17:15:34.514Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.59h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:34.514Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:34.514Z] [LOG] 📅 2025-08-29 (WEEKDAY): 9.41h worked → 8.343333333333334h counted → OVERLAP 08:39-17:00 = 8.343h (attendance table)
[2025-10-07T17:15:34.514Z] [LOG]    ✅ Added to weekday total: 8.343333333333334h
[2025-10-07T17:15:34.515Z] [LOG] 📅 2025-08-30 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:34.515Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:34.515Z] [LOG] ================================================================================
[2025-10-07T17:15:34.515Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:15:34.515Z] [LOG]    Sum of all daily counted hours (rounded): 162.1997h
[2025-10-07T17:15:34.515Z] [LOG]    Expected hours: 170h
[2025-10-07T17:15:34.515Z] [LOG]    Shortfall: 7.80h
[2025-10-07T17:15:34.515Z] [LOG] ================================================================================
[2025-10-07T17:15:34.627Z] [LOG] 🔄 Processing financial records for employee 01443963-7105-11f0-a50f-98e743540430...
[2025-10-07T17:15:34.627Z] [LOG] 🔄 Processing financial records for employee 01443963-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:15:34.736Z] [LOG] 📊 Found 0 active loans for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:34.843Z] [LOG] 📊 Found 0 active advances for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:34.951Z] [LOG] 📊 Found 0 approved bonuses for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:34.952Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:15:34.953Z] [LOG] 💰 GROSS CALCULATION for R. D.A Kaushalya null:
[2025-10-07T17:15:34.953Z] [LOG]    Base Salary: 50000
[2025-10-07T17:15:34.953Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:15:35.063Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:15:35.280Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:15:35.497Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:15:35.605Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:15:35.713Z] [LOG] Employee 01443963-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:35.713Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:15:35.713Z] [LOG] ============================================================
[2025-10-07T17:15:35.714Z] [LOG] 👤 Employee ID: 01443963-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:35.714Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:15:35.714Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:15:35.715Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:15:35.715Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:15:35.715Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:15:35.716Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:15:35.716Z] [LOG] 
[2025-10-07T17:15:35.716Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:15:35.716Z] [LOG]    Expected Hours: 170
[2025-10-07T17:15:35.717Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:15:35.717Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:15:35.717Z] [LOG]    Worked Hours: 162.1997
[2025-10-07T17:15:35.717Z] [LOG]    ⚠️  Shortfall Hours: 7.800299999999993
[2025-10-07T17:15:35.717Z] [LOG]    💸 Shortfall Deduction: 7.800299999999993h × 235.29 = 1835.36
[2025-10-07T17:15:35.717Z] [LOG] ============================================================
[2025-10-07T17:15:35.934Z] [LOG] ✅ Weekend Day Met: 2025-08-02 (Saturday)
[2025-10-07T17:15:35.934Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:35.935Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:15:35.935Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:35.935Z] [LOG] ✅ Weekend Day Met: 2025-08-16 (Saturday)
[2025-10-07T17:15:35.936Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:35.936Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:15:35.936Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:35.937Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:15:35.937Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:36.154Z] [LOG] 📅 Weekend absence check for employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:36.155Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:15:36.155Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:15:36.156Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:15:36.156Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:15:36.156Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:15:36.157Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:15:36.157Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:15:36.157Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:36.158Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:15:36.158Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:36.159Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:15:36.159Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:36.159Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:15:36.160Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:36.160Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:15:36.160Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:36.161Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:15:36.161Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:36.161Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:15:36.162Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:36.162Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:15:36.162Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:36.163Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:15:36.163Z] [LOG] Regular deductions for R. D.A Kaushalya null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:15:36.163Z] [LOG] Combined deductions for R. D.A Kaushalya null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 1835.3647058823512,
      "details": "7.800299999999993 hours × 235.29"
    }
  ],
  "total": 1835.3647058823512
}
[2025-10-07T17:15:36.272Z] [LOG] Creating components for record 2607bbdd-6ae2-41ac-9aba-1ef6f6a27ec3: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-07T17:15:36.273Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 1835.3647058823512
}
[2025-10-07T17:15:36.382Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:15:36.501Z] [LOG] Created payroll_record_component: 07c6133c-a53f-45f7-abd2-a3890d9cbc8f for Working Hours Shortfall
[2025-10-07T17:15:36.823Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:36.824Z] [ERROR] ❌ Error updating financial balances for employee 01443963-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:36.825Z] [LOG] ✅ R. D.A Kaushalya null: Calculation completed successfully
[2025-10-07T17:15:36.825Z] [LOG] 📊 Progress: 7/34 (20.6%)
[2025-10-07T17:15:36.825Z] [LOG] 
🧮 Processing: Uthpala null (EMP000006)
[2025-10-07T17:15:36.825Z] [LOG] 📋 Record ID: 268d8a7d-c87c-4603-89ba-559f60172ee6
[2025-10-07T17:15:37.270Z] [LOG] 🔍 Component filtering for employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:37.271Z] [LOG]    Total components: 8
[2025-10-07T17:15:37.271Z] [LOG]    Applicable components: 8
[2025-10-07T17:15:37.271Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-07T17:15:37.928Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:38.145Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:38.361Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:38.589Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:38.806Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:39.026Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:39.241Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:39.456Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:39.671Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:39.888Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:40.104Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:40.341Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:40.576Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:40.815Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:41.049Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:41.285Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:41.521Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:41.630Z] [LOG] 🔍 Fetched 23 attendance records for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:41.744Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:15:42.295Z] [LOG] Employee 0143a539-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 09:30:00 - 17:30:00 = 8 hours
[2025-10-07T17:15:42.295Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:15:42.295Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:15:42.296Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:15:42.297Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:42.297Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:15:42.297Z] [LOG] ================================================================================
[2025-10-07T17:15:42.298Z] [LOG] 📅 2025-08-01 (WEEKDAY): 9.67h worked → 7.564166666666667h counted → OVERLAP 09:56-17:30 = 7.564h (attendance table)
[2025-10-07T17:15:42.298Z] [LOG]    ✅ Added to weekday total: 7.564166666666667h
[2025-10-07T17:15:42.299Z] [LOG] 📅 2025-08-02 (WEEKEND): 5.34h worked → 3.341666666666667h counted → OVERLAP 09:39-13:00 = 3.342h (attendance table)
[2025-10-07T17:15:42.299Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.341666666666667h
[2025-10-07T17:15:42.299Z] [LOG] 📅 2025-08-04 (WEEKDAY): 10.35h worked → 8h counted → OVERLAP 09:30-17:30 = 8.000h (attendance table)
[2025-10-07T17:15:42.299Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:15:42.299Z] [LOG] 📅 2025-08-05 (WEEKDAY): 9.2h worked → 7.704444444444444h counted → OVERLAP 09:47-17:30 = 7.704h (attendance table)
[2025-10-07T17:15:42.300Z] [LOG]    ✅ Added to weekday total: 7.704444444444444h
[2025-10-07T17:15:42.300Z] [LOG] 📅 2025-08-06 (WEEKDAY): 9.45h worked → 6.865555555555556h counted → OVERLAP 10:38-17:30 = 6.866h (attendance table)
[2025-10-07T17:15:42.300Z] [LOG]    ✅ Added to weekday total: 6.865555555555556h
[2025-10-07T17:15:42.300Z] [LOG] 📅 2025-08-07 (WEEKDAY): 10.33h worked → 8h counted → OVERLAP 09:30-17:30 = 8.000h (attendance table)
[2025-10-07T17:15:42.300Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:15:42.300Z] [LOG] 📅 2025-08-09 (WEEKEND): 7.25h worked → 3.25h counted → OVERLAP 09:45-13:00 = 3.250h (attendance table)
[2025-10-07T17:15:42.300Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.25h
[2025-10-07T17:15:42.301Z] [LOG] 📅 2025-08-11 (WEEKDAY): 10h worked → 7.5h counted → OVERLAP 10:00-17:30 = 7.500h (attendance table)
[2025-10-07T17:15:42.301Z] [LOG]    ✅ Added to weekday total: 7.5h
[2025-10-07T17:15:42.301Z] [LOG] 📅 2025-08-12 (WEEKDAY): 11.75h worked → 8h counted → OVERLAP 09:30-17:30 = 8.000h (attendance table)
[2025-10-07T17:15:42.301Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:15:42.301Z] [LOG] 📅 2025-08-13 (WEEKDAY): 11.34h worked → 8h counted → OVERLAP 09:30-17:30 = 8.000h (attendance table)
[2025-10-07T17:15:42.301Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:15:42.301Z] [LOG] 📅 2025-08-16 (WEEKEND): 8.73h worked → 2.7280555555555557h counted → OVERLAP 10:16-13:00 = 2.728h (attendance table)
[2025-10-07T17:15:42.301Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 2.7280555555555557h
[2025-10-07T17:15:42.301Z] [LOG] 📅 2025-08-18 (WEEKDAY): 8.15h worked → 7.646944444444444h counted → OVERLAP 09:51-17:30 = 7.647h (attendance table)
[2025-10-07T17:15:42.301Z] [LOG]    ✅ Added to weekday total: 7.646944444444444h
[2025-10-07T17:15:42.302Z] [LOG] 📅 2025-08-19 (WEEKDAY): 8h worked → 7.5h counted → OVERLAP 10:00-17:30 = 7.500h (attendance table)
[2025-10-07T17:15:42.302Z] [LOG]    ✅ Added to weekday total: 7.5h
[2025-10-07T17:15:42.302Z] [LOG] 📅 2025-08-20 (WEEKDAY): 9.04h worked → 7.788055555555555h counted → OVERLAP 09:42-17:30 = 7.788h (attendance table)
[2025-10-07T17:15:42.302Z] [LOG]    ✅ Added to weekday total: 7.788055555555555h
[2025-10-07T17:15:42.317Z] [LOG] 📅 2025-08-21 (WEEKDAY): 7.75h worked → 6.7525h counted → OVERLAP 10:44-17:30 = 6.753h (attendance table)
[2025-10-07T17:15:42.318Z] [LOG]    ✅ Added to weekday total: 6.7525h
[2025-10-07T17:15:42.318Z] [LOG] 📅 2025-08-22 (WEEKDAY): 9.5h worked → 8h counted → OVERLAP 09:30-17:30 = 8.000h (attendance table)
[2025-10-07T17:15:42.318Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:15:42.319Z] [LOG] 📅 2025-08-23 (WEEKEND): 5h worked → 3h counted → OVERLAP 10:00-13:00 = 3.000h (attendance table)
[2025-10-07T17:15:42.319Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3h
[2025-10-07T17:15:42.319Z] [LOG] 📅 2025-08-25 (WEEKDAY): 8.03h worked → 7.5h counted → OVERLAP 09:30-17:00 = 7.500h (attendance table)
[2025-10-07T17:15:42.319Z] [LOG]    ✅ Added to weekday total: 7.5h
[2025-10-07T17:15:42.319Z] [LOG] 📅 2025-08-26 (WEEKDAY): 7.48h worked → 6.982777777777778h counted → OVERLAP 10:31-17:30 = 6.983h (attendance table)
[2025-10-07T17:15:42.320Z] [LOG]    ✅ Added to weekday total: 6.982777777777778h
[2025-10-07T17:15:42.320Z] [LOG] 📅 2025-08-27 (WEEKDAY): 8.27h worked → 7.77h counted → OVERLAP 09:43-17:30 = 7.770h (attendance table)
[2025-10-07T17:15:42.320Z] [LOG]    ✅ Added to weekday total: 7.77h
[2025-10-07T17:15:42.320Z] [LOG] 📅 2025-08-28 (WEEKDAY): 6.42h worked → 6.416666666666667h counted → OVERLAP 10:35-17:00 = 6.417h (attendance table)
[2025-10-07T17:15:42.321Z] [LOG]    ✅ Added to weekday total: 6.416666666666667h
[2025-10-07T17:15:42.321Z] [LOG] 📅 2025-08-29 (WEEKDAY): 9.23h worked → 7.730555555555555h counted → OVERLAP 09:46-17:30 = 7.731h (attendance table)
[2025-10-07T17:15:42.321Z] [LOG]    ✅ Added to weekday total: 7.730555555555555h
[2025-10-07T17:15:42.321Z] [LOG] 📅 2025-08-30 (WEEKEND): 5.5h worked → 3.5h counted → OVERLAP 09:30-13:00 = 3.500h (attendance table)
[2025-10-07T17:15:42.321Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.5h
[2025-10-07T17:15:42.321Z] [LOG] ================================================================================
[2025-10-07T17:15:42.321Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:15:42.322Z] [LOG]    Sum of all daily counted hours (rounded): 135.7217h
[2025-10-07T17:15:42.322Z] [LOG]    Expected hours: 160h
[2025-10-07T17:15:42.322Z] [LOG]    Shortfall: 24.28h
[2025-10-07T17:15:42.322Z] [LOG] ================================================================================
[2025-10-07T17:15:42.430Z] [LOG] 🔄 Processing financial records for employee 0143a539-7105-11f0-a50f-98e743540430...
[2025-10-07T17:15:42.430Z] [LOG] 🔄 Processing financial records for employee 0143a539-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:15:42.538Z] [LOG] 📊 Found 0 active loans for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:42.649Z] [LOG] 📊 Found 0 active advances for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:42.759Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:42.759Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:15:42.759Z] [LOG] 💰 GROSS CALCULATION for Uthpala null:
[2025-10-07T17:15:42.760Z] [LOG]    Base Salary: 100000
[2025-10-07T17:15:42.760Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:15:42.869Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:15:43.086Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:15:43.302Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:15:43.410Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:15:43.531Z] [LOG] Employee 0143a539-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 09:30:00 - 17:30:00 = 8 hours
[2025-10-07T17:15:43.532Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:15:43.533Z] [LOG] ============================================================
[2025-10-07T17:15:43.533Z] [LOG] 👤 Employee ID: 0143a539-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:43.534Z] [LOG] 💰 Base Salary: 100,000
[2025-10-07T17:15:43.534Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:15:43.534Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:15:43.535Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:15:43.535Z] [LOG] 💵 Per-Day Salary: 4000.00
[2025-10-07T17:15:43.535Z] [LOG] ⏱️  Hourly Rate: 500.00
[2025-10-07T17:15:43.536Z] [LOG] 
[2025-10-07T17:15:43.536Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:15:43.536Z] [LOG]    Expected Hours: 160
[2025-10-07T17:15:43.537Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:15:43.537Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:15:43.537Z] [LOG]    Worked Hours: 135.7217
[2025-10-07T17:15:43.538Z] [LOG]    ⚠️  Shortfall Hours: 24.2783
[2025-10-07T17:15:43.538Z] [LOG]    💸 Shortfall Deduction: 24.2783h × 500.00 = 12139.15
[2025-10-07T17:15:43.538Z] [LOG] ============================================================
[2025-10-07T17:15:43.768Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-02 (Saturday)
[2025-10-07T17:15:43.768Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:43.769Z] [LOG]    Actual: 09:39:30 - 15:00:00
[2025-10-07T17:15:43.769Z] [LOG]    Calculation: OVERLAP 09:39-13:00 = 3.342h
[2025-10-07T17:15:43.769Z] [LOG]    Payable Hours: 3.342h
[2025-10-07T17:15:43.770Z] [LOG]    Shortfall: 1.158h
[2025-10-07T17:15:43.770Z] [LOG]    Hourly Rate: 888.89 (Day Salary 4000 ÷ 4.5h)
[2025-10-07T17:15:43.770Z] [LOG]    Deduction: 1029.63
[2025-10-07T17:15:43.771Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-09 (Saturday)
[2025-10-07T17:15:43.771Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:43.771Z] [LOG]    Actual: 09:45:00 - 17:00:00
[2025-10-07T17:15:43.772Z] [LOG]    Calculation: OVERLAP 09:45-13:00 = 3.250h
[2025-10-07T17:15:43.772Z] [LOG]    Payable Hours: 3.250h
[2025-10-07T17:15:43.772Z] [LOG]    Shortfall: 1.250h
[2025-10-07T17:15:43.772Z] [LOG]    Hourly Rate: 888.89 (Day Salary 4000 ÷ 4.5h)
[2025-10-07T17:15:43.773Z] [LOG]    Deduction: 1111.11
[2025-10-07T17:15:43.773Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-16 (Saturday)
[2025-10-07T17:15:43.773Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:43.773Z] [LOG]    Actual: 10:16:19 - 19:00:00
[2025-10-07T17:15:43.774Z] [LOG]    Calculation: OVERLAP 10:16-13:00 = 2.728h
[2025-10-07T17:15:43.774Z] [LOG]    Payable Hours: 2.728h
[2025-10-07T17:15:43.774Z] [LOG]    Shortfall: 1.772h
[2025-10-07T17:15:43.774Z] [LOG]    Hourly Rate: 888.89 (Day Salary 4000 ÷ 4.5h)
[2025-10-07T17:15:43.774Z] [LOG]    Deduction: 1575.06
[2025-10-07T17:15:43.775Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-23 (Saturday)
[2025-10-07T17:15:43.775Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:43.775Z] [LOG]    Actual: 10:00:00 - 15:00:00
[2025-10-07T17:15:43.775Z] [LOG]    Calculation: OVERLAP 10:00-13:00 = 3.000h
[2025-10-07T17:15:43.776Z] [LOG]    Payable Hours: 3.000h
[2025-10-07T17:15:43.776Z] [LOG]    Shortfall: 1.500h
[2025-10-07T17:15:43.776Z] [LOG]    Hourly Rate: 888.89 (Day Salary 4000 ÷ 4.5h)
[2025-10-07T17:15:43.776Z] [LOG]    Deduction: 1333.33
[2025-10-07T17:15:43.776Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-30 (Saturday)
[2025-10-07T17:15:43.777Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:43.777Z] [LOG]    Actual: 09:30:00 - 15:00:00
[2025-10-07T17:15:43.777Z] [LOG]    Calculation: OVERLAP 09:30-13:00 = 3.500h
[2025-10-07T17:15:43.777Z] [LOG]    Payable Hours: 3.500h
[2025-10-07T17:15:43.777Z] [LOG]    Shortfall: 1.000h
[2025-10-07T17:15:43.777Z] [LOG]    Hourly Rate: 888.89 (Day Salary 4000 ÷ 4.5h)
[2025-10-07T17:15:43.777Z] [LOG]    Deduction: 888.89
[2025-10-07T17:15:44.002Z] [LOG] 📅 Weekend absence check for employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:44.003Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:15:44.003Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:15:44.003Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:15:44.003Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:15:44.004Z] [LOG]    Gross Salary: 100000
[2025-10-07T17:15:44.004Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:15:44.004Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:15:44.004Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:44.005Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:15:44.005Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:44.005Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:15:44.005Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:44.006Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:15:44.006Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:44.006Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:15:44.006Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:44.007Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:15:44.007Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:44.007Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:15:44.007Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:44.008Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:15:44.008Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:44.008Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:15:44.008Z] [LOG] Regular deductions for Uthpala null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:15:44.008Z] [LOG] Combined deductions for Uthpala null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 5938.024691358025,
      "details": "Total 6.68h shortfall - 2025-08-02 (Saturday): 1.16h, 2025-08-09 (Saturday): 1.25h, 2025-08-16 (Saturday): 1.77h, 2025-08-23 (Saturday): 1.50h, 2025-08-30 (Saturday): 1.00h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 12139.150000000001,
      "details": "24.2783 hours × 500.00"
    }
  ],
  "total": 18077.17469135803
}
[2025-10-07T17:15:44.122Z] [LOG] Creating components for record 268d8a7d-c87c-4603-89ba-559f60172ee6: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:15:44.123Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 5938.024691358025
}
[2025-10-07T17:15:44.239Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:15:44.356Z] [LOG] Created payroll_record_component: 75aed003-54fd-4b0e-8594-b7fff5da2fee for Weekend Shortfall Deduction
[2025-10-07T17:15:44.356Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 12139.150000000001
}
[2025-10-07T17:15:44.476Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:15:44.592Z] [LOG] Created payroll_record_component: 2874dd3d-8a08-4990-bec0-d0d3cf9f70db for Working Hours Shortfall
[2025-10-07T17:15:44.927Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:44.928Z] [ERROR] ❌ Error updating financial balances for employee 0143a539-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:44.929Z] [LOG] ✅ Uthpala null: Calculation completed successfully
[2025-10-07T17:15:44.929Z] [LOG] 📊 Progress: 8/34 (23.5%)
[2025-10-07T17:15:44.929Z] [LOG] 
🧮 Processing: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-07T17:15:44.929Z] [LOG] 📋 Record ID: 2f27af2a-a935-4b26-aed3-29dbd9ed2f5d
[2025-10-07T17:15:45.359Z] [LOG] 🔍 Component filtering for employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:45.360Z] [LOG]    Total components: 8
[2025-10-07T17:15:45.360Z] [LOG]    Applicable components: 8
[2025-10-07T17:15:45.361Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-07T17:15:45.906Z] [LOG] 🔍 Fetched 0 attendance records for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:45.907Z] [LOG] ⚠️  ATTENTION: Employee 0144315c-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:15:46.015Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:15:46.701Z] [LOG] Employee 0144315c-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:15:46.701Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:15:46.702Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:15:46.702Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:15:46.703Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:46.703Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:15:46.703Z] [LOG] ================================================================================
[2025-10-07T17:15:46.703Z] [LOG] ================================================================================
[2025-10-07T17:15:46.704Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:15:46.704Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:15:46.704Z] [LOG]    Expected hours: 160h
[2025-10-07T17:15:46.704Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:15:46.705Z] [LOG] ================================================================================
[2025-10-07T17:15:46.813Z] [LOG] 🔄 Processing financial records for employee 0144315c-7105-11f0-a50f-98e743540430...
[2025-10-07T17:15:46.813Z] [LOG] 🔄 Processing financial records for employee 0144315c-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:15:46.921Z] [LOG] 📊 Found 0 active loans for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:47.029Z] [LOG] 📊 Found 0 active advances for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:47.137Z] [LOG] 📊 Found 0 approved bonuses for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:47.137Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:15:47.138Z] [LOG] 💰 GROSS CALCULATION for G.M Supathala Sadaru Madhushan null:
[2025-10-07T17:15:47.138Z] [LOG]    Base Salary: 50000
[2025-10-07T17:15:47.138Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:15:47.247Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:15:47.462Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:15:47.678Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:15:47.786Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:15:48.011Z] [LOG] Employee 0144315c-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:15:48.011Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:15:48.012Z] [LOG] ============================================================
[2025-10-07T17:15:48.012Z] [LOG] 👤 Employee ID: 0144315c-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:48.012Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:15:48.013Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:15:48.013Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:15:48.014Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:15:48.014Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:15:48.014Z] [LOG] ⏱️  Hourly Rate: 250.00
[2025-10-07T17:15:48.015Z] [LOG] 
[2025-10-07T17:15:48.015Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:15:48.015Z] [LOG]    Expected Hours: 160
[2025-10-07T17:15:48.015Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:15:48.016Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:15:48.016Z] [LOG]    Worked Hours: 0
[2025-10-07T17:15:48.017Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:15:48.018Z] [LOG]    💸 Shortfall Deduction: 160h × 250.00 = 40000.00
[2025-10-07T17:15:48.018Z] [LOG] ============================================================
[2025-10-07T17:15:48.467Z] [LOG] 📅 Weekend absence check for employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:48.467Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:15:48.468Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:15:48.468Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:15:48.468Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:15:48.468Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:15:48.468Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:15:48.468Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:15:48.469Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:48.469Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:15:48.469Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:48.469Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:15:48.469Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:48.470Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:15:48.470Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:48.470Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:15:48.470Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:48.470Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:15:48.470Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:48.470Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:15:48.471Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:48.471Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:15:48.471Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:48.471Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:15:48.471Z] [LOG] Regular deductions for G.M Supathala Sadaru Madhushan null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:15:48.472Z] [LOG] Combined deductions for G.M Supathala Sadaru Madhushan null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 40000,
      "details": "160 hours × 250.00"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 10000,
      "details": "5 weekend days × 2000.00"
    }
  ],
  "total": 50000
}
[2025-10-07T17:15:48.581Z] [LOG] Creating components for record 2f27af2a-a935-4b26-aed3-29dbd9ed2f5d: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:15:48.582Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 40000
}
[2025-10-07T17:15:48.690Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:15:48.799Z] [LOG] Created payroll_record_component: aa802e6b-ebc7-460d-aa2b-16e583d7dece for Working Hours Shortfall
[2025-10-07T17:15:48.800Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 10000
}
[2025-10-07T17:15:48.908Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:15:49.017Z] [LOG] Created payroll_record_component: beaee2c3-3ccb-4f7f-a502-8cc1cfa226a8 for Weekend Absent Days
[2025-10-07T17:15:49.342Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:49.343Z] [ERROR] ❌ Error updating financial balances for employee 0144315c-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:49.346Z] [LOG] ✅ G.M Supathala Sadaru Madhushan null: Calculation completed successfully
[2025-10-07T17:15:49.346Z] [LOG] 📊 Progress: 9/34 (26.5%)
[2025-10-07T17:15:49.347Z] [LOG] 
🧮 Processing: Saru null (EMP000022)
[2025-10-07T17:15:49.347Z] [LOG] 📋 Record ID: 3094cf9d-9f12-4946-b6d6-43692fc8189a
[2025-10-07T17:15:49.790Z] [LOG] 🔍 Component filtering for employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:49.791Z] [LOG]    Total components: 8
[2025-10-07T17:15:49.791Z] [LOG]    Applicable components: 8
[2025-10-07T17:15:49.792Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-07T17:15:50.490Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:50.600Z] [LOG] 🔍 Fetched 24 attendance records for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:50.709Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:15:51.248Z] [LOG] Employee 0143cc7e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:51.249Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:15:51.249Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:15:51.250Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:15:51.251Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:51.251Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:15:51.252Z] [LOG] ================================================================================
[2025-10-07T17:15:51.252Z] [LOG] 📅 2025-08-01 (WEEKDAY): 15.11h worked → 8.453611111111112h counted → OVERLAP 08:32-17:00 = 8.454h (attendance table)
[2025-10-07T17:15:51.252Z] [LOG]    ✅ Added to weekday total: 8.453611111111112h
[2025-10-07T17:15:51.252Z] [LOG] 📅 2025-08-02 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:51.253Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:51.253Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.254Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.254Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.254Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.255Z] [LOG] 📅 2025-08-06 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.255Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.255Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.256Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.256Z] [LOG] 📅 2025-08-09 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:51.256Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:51.257Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.257Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.257Z] [LOG] 📅 2025-08-12 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.257Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.258Z] [LOG] 📅 2025-08-13 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.258Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.258Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.258Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.259Z] [LOG] 📅 2025-08-15 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.259Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.259Z] [LOG] 📅 2025-08-16 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:51.259Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:51.260Z] [LOG] 📅 2025-08-19 (WEEKDAY): 8.42h worked → 8.416666666666666h counted → OVERLAP 08:35-17:00 = 8.417h (attendance table)
[2025-10-07T17:15:51.260Z] [LOG]    ✅ Added to weekday total: 8.416666666666666h
[2025-10-07T17:15:51.260Z] [LOG] 📅 2025-08-20 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.260Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.261Z] [LOG] 📅 2025-08-21 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.261Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.261Z] [LOG] 📅 2025-08-22 (WEEKDAY): 8h worked → 8h counted → OVERLAP 09:00-17:00 = 8.000h (attendance table)
[2025-10-07T17:15:51.261Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:15:51.261Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:51.261Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:51.261Z] [LOG] 📅 2025-08-25 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.261Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.262Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.262Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.262Z] [LOG] 📅 2025-08-27 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.262Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.262Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.262Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.262Z] [LOG] 📅 2025-08-29 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:51.262Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:51.263Z] [LOG] 📅 2025-08-30 (WEEKEND): 3.25h worked → 3.2533333333333334h counted → OVERLAP 09:44-13:00 = 3.253h (attendance table)
[2025-10-07T17:15:51.263Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.2533333333333334h
[2025-10-07T17:15:51.263Z] [LOG] ================================================================================
[2025-10-07T17:15:51.263Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:15:51.263Z] [LOG]    Sum of all daily counted hours (rounded): 160.8703h
[2025-10-07T17:15:51.263Z] [LOG]    Expected hours: 170h
[2025-10-07T17:15:51.263Z] [LOG]    Shortfall: 9.13h
[2025-10-07T17:15:51.263Z] [LOG] ================================================================================
[2025-10-07T17:15:51.371Z] [LOG] 🔄 Processing financial records for employee 0143cc7e-7105-11f0-a50f-98e743540430...
[2025-10-07T17:15:51.372Z] [LOG] 🔄 Processing financial records for employee 0143cc7e-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:15:51.480Z] [LOG] 📊 Found 0 active loans for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:51.591Z] [LOG] 📊 Found 0 active advances for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:51.699Z] [LOG] 📊 Found 0 approved bonuses for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:51.700Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:15:51.701Z] [LOG] 💰 GROSS CALCULATION for Saru null:
[2025-10-07T17:15:51.701Z] [LOG]    Base Salary: 50000
[2025-10-07T17:15:51.701Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:15:51.809Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:15:52.037Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:15:52.275Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:15:52.388Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:15:52.497Z] [LOG] Employee 0143cc7e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:52.498Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:15:52.498Z] [LOG] ============================================================
[2025-10-07T17:15:52.498Z] [LOG] 👤 Employee ID: 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:52.499Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:15:52.499Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:15:52.500Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:15:52.500Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:15:52.500Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:15:52.501Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:15:52.501Z] [LOG] 
[2025-10-07T17:15:52.501Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:15:52.502Z] [LOG]    Expected Hours: 170
[2025-10-07T17:15:52.504Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:15:52.505Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:15:52.505Z] [LOG]    Worked Hours: 160.8703
[2025-10-07T17:15:52.506Z] [LOG]    ⚠️  Shortfall Hours: 9.129700000000014
[2025-10-07T17:15:52.506Z] [LOG]    💸 Shortfall Deduction: 9.129700000000014h × 235.29 = 2148.16
[2025-10-07T17:15:52.506Z] [LOG] ============================================================
[2025-10-07T17:15:52.729Z] [LOG] ✅ Weekend Day Met: 2025-08-02 (Saturday)
[2025-10-07T17:15:52.729Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:52.730Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:15:52.730Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:52.731Z] [LOG] ✅ Weekend Day Met: 2025-08-16 (Saturday)
[2025-10-07T17:15:52.731Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:52.731Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:15:52.732Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:15:52.732Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-30 (Saturday)
[2025-10-07T17:15:52.733Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:15:52.733Z] [LOG]    Actual: 09:44:48 - 13:00:00
[2025-10-07T17:15:52.733Z] [LOG]    Calculation: OVERLAP 09:44-13:00 = 3.253h
[2025-10-07T17:15:52.734Z] [LOG]    Payable Hours: 3.253h
[2025-10-07T17:15:52.734Z] [LOG]    Shortfall: 1.247h
[2025-10-07T17:15:52.734Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:15:52.735Z] [LOG]    Deduction: 554.07
[2025-10-07T17:15:52.950Z] [LOG] 📅 Weekend absence check for employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:52.951Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:15:52.951Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:15:52.951Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:15:52.952Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:15:52.952Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:15:52.952Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:15:52.953Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:15:52.953Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:52.954Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:15:52.954Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:52.954Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:15:52.955Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:52.955Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:15:52.955Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:52.956Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:15:52.956Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:52.956Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:15:52.957Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:52.957Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:15:52.957Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:52.958Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:15:52.958Z] [LOG]    Fixed amount: 0
[2025-10-07T17:15:52.958Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:15:52.959Z] [LOG] Regular deductions for Saru null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:15:52.959Z] [LOG] Combined deductions for Saru null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 554.074074074074,
      "details": "Total 1.25h shortfall - 2025-08-30 (Saturday): 1.25h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2148.164705882356,
      "details": "9.129700000000014 hours × 235.29"
    }
  ],
  "total": 2702.23877995643
}
[2025-10-07T17:15:53.068Z] [LOG] Creating components for record 3094cf9d-9f12-4946-b6d6-43692fc8189a: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:15:53.068Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 554.074074074074
}
[2025-10-07T17:15:53.177Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:15:53.286Z] [LOG] Created payroll_record_component: bce7cb84-3e86-4f42-b7ae-7394ad229b50 for Weekend Shortfall Deduction
[2025-10-07T17:15:53.286Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2148.164705882356
}
[2025-10-07T17:15:53.395Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:15:53.503Z] [LOG] Created payroll_record_component: c426050a-a002-49fc-a883-adf7a4ae9c5b for Working Hours Shortfall
[2025-10-07T17:15:53.830Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:53.832Z] [ERROR] ❌ Error updating financial balances for employee 0143cc7e-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:15:53.834Z] [LOG] ✅ Saru null: Calculation completed successfully
[2025-10-07T17:15:53.834Z] [LOG] 📊 Progress: 10/34 (29.4%)
[2025-10-07T17:15:53.834Z] [LOG] 
🧮 Processing: Nimdiya Ranasinghe null (EMP000045)
[2025-10-07T17:15:53.835Z] [LOG] 📋 Record ID: 425aa4e7-7723-4e72-adb8-6f029f7b0176
[2025-10-07T17:15:54.286Z] [LOG] 🔍 Component filtering for employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:54.287Z] [LOG]    Total components: 8
[2025-10-07T17:15:54.287Z] [LOG]    Applicable components: 8
[2025-10-07T17:15:54.287Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-07T17:15:54.960Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:55.178Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:55.426Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:55.652Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:55.867Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:56.084Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:56.301Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:56.553Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:56.770Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:56.985Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:57.201Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:57.417Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:57.635Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:57.853Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:15:57.961Z] [LOG] 🔍 Fetched 23 attendance records for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:58.069Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:15:58.614Z] [LOG] Employee 01444074-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:58.615Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:15:58.615Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:15:58.616Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:15:58.617Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-07T17:15:58.617Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:15:58.618Z] [LOG] ================================================================================
[2025-10-07T17:15:58.618Z] [LOG] 📅 2025-08-01 (WEEKDAY): 9.23h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.619Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.619Z] [LOG] 📅 2025-08-02 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:58.619Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:58.620Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.53h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.620Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.621Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.66h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.621Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.622Z] [LOG] 📅 2025-08-06 (WEEKDAY): 8.66h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.622Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.622Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.69h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.623Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.623Z] [LOG] 📅 2025-08-09 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:58.623Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:58.624Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8.54h worked → 8.413055555555555h counted → OVERLAP 08:35-17:00 = 8.413h (attendance table)
[2025-10-07T17:15:58.624Z] [LOG]    ✅ Added to weekday total: 8.413055555555555h
[2025-10-07T17:15:58.624Z] [LOG] 📅 2025-08-12 (WEEKDAY): 8.56h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.624Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.624Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.69h worked → 8.49611111111111h counted → OVERLAP 08:30-17:00 = 8.496h (attendance table)
[2025-10-07T17:15:58.625Z] [LOG]    ✅ Added to weekday total: 8.49611111111111h
[2025-10-07T17:15:58.625Z] [LOG] 📅 2025-08-15 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.625Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.626Z] [LOG] 📅 2025-08-16 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:58.626Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:58.626Z] [LOG] 📅 2025-08-18 (WEEKDAY): 8.41h worked → 8.414444444444445h counted → OVERLAP 08:30-16:54 = 8.414h (attendance table)
[2025-10-07T17:15:58.626Z] [LOG]    ✅ Added to weekday total: 8.414444444444445h
[2025-10-07T17:15:58.626Z] [LOG] 📅 2025-08-19 (WEEKDAY): 8.68h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.627Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.627Z] [LOG] 📅 2025-08-20 (WEEKDAY): 8.85h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.627Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.627Z] [LOG] 📅 2025-08-21 (WEEKDAY): 3.5h worked → 3.5h counted → OVERLAP 08:30-12:00 = 3.500h (attendance table)
[2025-10-07T17:15:58.627Z] [LOG]    ✅ Added to weekday total: 3.5h
[2025-10-07T17:15:58.627Z] [LOG] 📅 2025-08-22 (WEEKDAY): 9.53h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.627Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.627Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:58.627Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:58.627Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.6h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.627Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.628Z] [LOG] 📅 2025-08-27 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.628Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.628Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.6h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.628Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.628Z] [LOG] 📅 2025-08-29 (WEEKDAY): 9.57h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:15:58.628Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:15:58.628Z] [LOG] 📅 2025-08-30 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:15:58.628Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:15:58.629Z] [LOG] ================================================================================
[2025-10-07T17:15:58.629Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:15:58.629Z] [LOG]    Sum of all daily counted hours (rounded): 147.8236h
[2025-10-07T17:15:58.629Z] [LOG]    Expected hours: 170h
[2025-10-07T17:15:58.630Z] [LOG]    Shortfall: 22.18h
[2025-10-07T17:15:58.630Z] [LOG] ================================================================================
[2025-10-07T17:15:58.738Z] [LOG] 🔄 Processing financial records for employee 01444074-7105-11f0-a50f-98e743540430...
[2025-10-07T17:15:58.738Z] [LOG] 🔄 Processing financial records for employee 01444074-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:15:58.847Z] [LOG] 📊 Found 0 active loans for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:58.955Z] [LOG] 📊 Found 0 active advances for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:59.066Z] [LOG] 📊 Found 0 approved bonuses for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:59.067Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:15:59.067Z] [LOG] 💰 GROSS CALCULATION for Nimdiya Ranasinghe null:
[2025-10-07T17:15:59.068Z] [LOG]    Base Salary: 35000
[2025-10-07T17:15:59.068Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:15:59.175Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:15:59.391Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:15:59.608Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:15:59.716Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:15:59.836Z] [LOG] Employee 01444074-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:15:59.836Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:15:59.836Z] [LOG] ============================================================
[2025-10-07T17:15:59.837Z] [LOG] 👤 Employee ID: 01444074-7105-11f0-a50f-98e743540430
[2025-10-07T17:15:59.837Z] [LOG] 💰 Base Salary: 35,000
[2025-10-07T17:15:59.837Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:15:59.837Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:15:59.838Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:15:59.838Z] [LOG] 💵 Per-Day Salary: 1400.00
[2025-10-07T17:15:59.838Z] [LOG] ⏱️  Hourly Rate: 164.71
[2025-10-07T17:15:59.838Z] [LOG] 
[2025-10-07T17:15:59.839Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:15:59.839Z] [LOG]    Expected Hours: 170
[2025-10-07T17:15:59.839Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:15:59.840Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:15:59.840Z] [LOG]    Worked Hours: 147.8236
[2025-10-07T17:15:59.840Z] [LOG]    ⚠️  Shortfall Hours: 22.1764
[2025-10-07T17:15:59.840Z] [LOG]    💸 Shortfall Deduction: 22.1764h × 164.71 = 3652.58
[2025-10-07T17:15:59.840Z] [LOG] ============================================================
[2025-10-07T17:16:00.071Z] [LOG] ✅ Weekend Day Met: 2025-08-02 (Saturday)
[2025-10-07T17:16:00.071Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:00.072Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:16:00.072Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:00.072Z] [LOG] ✅ Weekend Day Met: 2025-08-16 (Saturday)
[2025-10-07T17:16:00.072Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:00.072Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:16:00.073Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:00.073Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:16:00.073Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:00.290Z] [LOG] 📅 Weekend absence check for employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:00.290Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:00.291Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:16:00.291Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:16:00.291Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:00.291Z] [LOG]    Gross Salary: 35000
[2025-10-07T17:16:00.291Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:00.292Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:00.292Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:00.292Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:00.292Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:00.292Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:00.292Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:00.293Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:00.293Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:00.293Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:00.293Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:00.293Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:00.294Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:00.295Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:00.295Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:00.295Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:00.296Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:00.296Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:00.297Z] [LOG] Regular deductions for Nimdiya Ranasinghe null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:00.297Z] [LOG] Combined deductions for Nimdiya Ranasinghe null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 3652.583529411765,
      "details": "22.1764 hours × 164.71"
    }
  ],
  "total": 3652.583529411765
}
[2025-10-07T17:16:00.406Z] [LOG] Creating components for record 425aa4e7-7723-4e72-adb8-6f029f7b0176: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-07T17:16:00.407Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 3652.583529411765
}
[2025-10-07T17:16:00.515Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:00.623Z] [LOG] Created payroll_record_component: 933340b8-2986-48bf-afc8-55caba6c51d0 for Working Hours Shortfall
[2025-10-07T17:16:00.947Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:00.948Z] [ERROR] ❌ Error updating financial balances for employee 01444074-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:00.949Z] [LOG] ✅ Nimdiya Ranasinghe null: Calculation completed successfully
[2025-10-07T17:16:00.949Z] [LOG] 📊 Progress: 11/34 (32.4%)
[2025-10-07T17:16:00.950Z] [LOG] 
🧮 Processing: Ratheeshanan null (EMP000047)
[2025-10-07T17:16:00.950Z] [LOG] 📋 Record ID: 430d596d-eddd-46bb-9c9a-2f1d3a8b0eff
[2025-10-07T17:16:01.379Z] [LOG] 🔍 Component filtering for employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:01.380Z] [LOG]    Total components: 8
[2025-10-07T17:16:01.380Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:01.380Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-07T17:16:02.056Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:02.282Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:02.502Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:02.718Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:02.940Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:03.157Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:03.270Z] [LOG] 🔍 Fetched 22 attendance records for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:03.411Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:16:03.967Z] [LOG] Employee 01444966-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:16:03.967Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:16:03.968Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:16:03.968Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:16:03.970Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:03.970Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:16:03.970Z] [LOG] ================================================================================
[2025-10-07T17:16:03.971Z] [LOG] 📅 2025-08-01 (WEEKDAY): 8.28h worked → 8.216666666666667h counted → OVERLAP 08:47-17:00 = 8.217h (attendance table)
[2025-10-07T17:16:03.971Z] [LOG]    ✅ Added to weekday total: 8.216666666666667h
[2025-10-07T17:16:03.971Z] [LOG] 📅 2025-08-02 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:16:03.972Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:16:03.972Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.46h worked → 8.35h counted → OVERLAP 08:39-17:00 = 8.350h (attendance table)
[2025-10-07T17:16:03.972Z] [LOG]    ✅ Added to weekday total: 8.35h
[2025-10-07T17:16:03.973Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.29h worked → 8.226666666666667h counted → OVERLAP 08:46-17:00 = 8.227h (attendance table)
[2025-10-07T17:16:03.973Z] [LOG]    ✅ Added to weekday total: 8.226666666666667h
[2025-10-07T17:16:03.973Z] [LOG] 📅 2025-08-06 (WEEKDAY): 8.46h worked → 8.211944444444445h counted → OVERLAP 08:47-17:00 = 8.212h (attendance table)
[2025-10-07T17:16:03.973Z] [LOG]    ✅ Added to weekday total: 8.211944444444445h
[2025-10-07T17:16:03.974Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.32h worked → 8.183333333333334h counted → OVERLAP 08:49-17:00 = 8.183h (attendance table)
[2025-10-07T17:16:03.974Z] [LOG]    ✅ Added to weekday total: 8.183333333333334h
[2025-10-07T17:16:03.974Z] [LOG] 📅 2025-08-09 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:16:03.975Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:16:03.975Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8.33h worked → 8.191944444444445h counted → OVERLAP 08:48-17:00 = 8.192h (attendance table)
[2025-10-07T17:16:03.975Z] [LOG]    ✅ Added to weekday total: 8.191944444444445h
[2025-10-07T17:16:03.976Z] [LOG] 📅 2025-08-12 (WEEKDAY): 9.12h worked → 8.208055555555555h counted → OVERLAP 08:47-17:00 = 8.208h (attendance table)
[2025-10-07T17:16:03.976Z] [LOG]    ✅ Added to weekday total: 8.208055555555555h
[2025-10-07T17:16:03.976Z] [LOG] 📅 2025-08-13 (WEEKDAY): 8.52h worked → 8.416666666666666h counted → OVERLAP 08:35-17:00 = 8.417h (attendance table)
[2025-10-07T17:16:03.977Z] [LOG]    ✅ Added to weekday total: 8.416666666666666h
[2025-10-07T17:16:03.977Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.57h worked → 8.466666666666667h counted → OVERLAP 08:32-17:00 = 8.467h (attendance table)
[2025-10-07T17:16:03.977Z] [LOG]    ✅ Added to weekday total: 8.466666666666667h
[2025-10-07T17:16:03.978Z] [LOG] 📅 2025-08-16 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:16:03.978Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:16:03.978Z] [LOG] 📅 2025-08-18 (WEEKDAY): 8.25h worked → 8.16388888888889h counted → OVERLAP 08:50-17:00 = 8.164h (attendance table)
[2025-10-07T17:16:03.978Z] [LOG]    ✅ Added to weekday total: 8.16388888888889h
[2025-10-07T17:16:03.979Z] [LOG] 📅 2025-08-19 (WEEKDAY): 9.32h worked → 8.416666666666666h counted → OVERLAP 08:35-17:00 = 8.417h (attendance table)
[2025-10-07T17:16:03.979Z] [LOG]    ✅ Added to weekday total: 8.416666666666666h
[2025-10-07T17:16:03.979Z] [LOG] 📅 2025-08-20 (WEEKDAY): 8.4h worked → 8.383333333333333h counted → OVERLAP 08:37-17:00 = 8.383h (attendance table)
[2025-10-07T17:16:03.980Z] [LOG]    ✅ Added to weekday total: 8.383333333333333h
[2025-10-07T17:16:03.980Z] [LOG] 📅 2025-08-21 (WEEKDAY): 8.18h worked → 7.7780555555555555h counted → OVERLAP 09:13-17:00 = 7.778h (attendance table)
[2025-10-07T17:16:03.980Z] [LOG]    ✅ Added to weekday total: 7.7780555555555555h
[2025-10-07T17:16:03.980Z] [LOG] 📅 2025-08-22 (WEEKDAY): 8.62h worked → 8.416666666666666h counted → OVERLAP 08:35-17:00 = 8.417h (attendance table)
[2025-10-07T17:16:03.981Z] [LOG]    ✅ Added to weekday total: 8.416666666666666h
[2025-10-07T17:16:03.981Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:16:03.981Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:16:03.982Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.26h worked → 7.473333333333334h counted → OVERLAP 09:31-17:00 = 7.473h (attendance table)
[2025-10-07T17:16:03.982Z] [LOG]    ✅ Added to weekday total: 7.473333333333334h
[2025-10-07T17:16:03.984Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.28h worked → 8.25h counted → OVERLAP 08:45-17:00 = 8.250h (attendance table)
[2025-10-07T17:16:03.985Z] [LOG]    ✅ Added to weekday total: 8.25h
[2025-10-07T17:16:03.985Z] [LOG] 📅 2025-08-29 (WEEKDAY): 8.75h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:03.986Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:03.986Z] [LOG] 📅 2025-08-30 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:16:03.987Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:16:03.987Z] [LOG] ================================================================================
[2025-10-07T17:16:03.987Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:16:03.988Z] [LOG]    Sum of all daily counted hours (rounded): 139.8539h
[2025-10-07T17:16:03.988Z] [LOG]    Expected hours: 170h
[2025-10-07T17:16:03.989Z] [LOG]    Shortfall: 30.15h
[2025-10-07T17:16:03.989Z] [LOG] ================================================================================
[2025-10-07T17:16:04.101Z] [LOG] 🔄 Processing financial records for employee 01444966-7105-11f0-a50f-98e743540430...
[2025-10-07T17:16:04.101Z] [LOG] 🔄 Processing financial records for employee 01444966-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:16:04.211Z] [LOG] 📊 Found 0 active loans for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:04.321Z] [LOG] 📊 Found 0 active advances for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:04.440Z] [LOG] 📊 Found 0 approved bonuses for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:04.441Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:16:04.441Z] [LOG] 💰 GROSS CALCULATION for Ratheeshanan null:
[2025-10-07T17:16:04.441Z] [LOG]    Base Salary: 25000
[2025-10-07T17:16:04.442Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:16:04.556Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:16:04.773Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:16:04.992Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:16:05.100Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:16:05.210Z] [LOG] Employee 01444966-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:16:05.210Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:16:05.211Z] [LOG] ============================================================
[2025-10-07T17:16:05.211Z] [LOG] 👤 Employee ID: 01444966-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:05.211Z] [LOG] 💰 Base Salary: 25,000
[2025-10-07T17:16:05.212Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:16:05.212Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:16:05.212Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:16:05.212Z] [LOG] 💵 Per-Day Salary: 1000.00
[2025-10-07T17:16:05.212Z] [LOG] ⏱️  Hourly Rate: 117.65
[2025-10-07T17:16:05.213Z] [LOG] 
[2025-10-07T17:16:05.213Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:16:05.213Z] [LOG]    Expected Hours: 170
[2025-10-07T17:16:05.213Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:16:05.213Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:16:05.213Z] [LOG]    Worked Hours: 139.8539
[2025-10-07T17:16:05.213Z] [LOG]    ⚠️  Shortfall Hours: 30.14609999999999
[2025-10-07T17:16:05.213Z] [LOG]    💸 Shortfall Deduction: 30.14609999999999h × 117.65 = 3546.60
[2025-10-07T17:16:05.213Z] [LOG] ============================================================
[2025-10-07T17:16:05.428Z] [LOG] ✅ Weekend Day Met: 2025-08-02 (Saturday)
[2025-10-07T17:16:05.429Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:05.429Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:16:05.429Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:05.430Z] [LOG] ✅ Weekend Day Met: 2025-08-16 (Saturday)
[2025-10-07T17:16:05.430Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:05.430Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:16:05.431Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:05.431Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:16:05.431Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:05.649Z] [LOG] 📅 Weekend absence check for employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:05.650Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:05.650Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:16:05.651Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:16:05.651Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:05.652Z] [LOG]    Gross Salary: 25000
[2025-10-07T17:16:05.652Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:05.652Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:05.653Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:05.653Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:05.653Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:05.654Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:05.654Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:05.655Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:05.656Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:05.656Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:05.656Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:05.657Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:05.657Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:05.657Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:05.657Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:05.658Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:05.658Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:05.658Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:05.658Z] [LOG] Regular deductions for Ratheeshanan null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:05.659Z] [LOG] Combined deductions for Ratheeshanan null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 3546.5999999999985,
      "details": "30.14609999999999 hours × 117.65"
    }
  ],
  "total": 3546.5999999999985
}
[2025-10-07T17:16:05.769Z] [LOG] Creating components for record 430d596d-eddd-46bb-9c9a-2f1d3a8b0eff: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-07T17:16:05.770Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 3546.5999999999985
}
[2025-10-07T17:16:05.877Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:05.991Z] [LOG] Created payroll_record_component: 099b7c93-79bc-4742-b888-eb5b74e6bf40 for Working Hours Shortfall
[2025-10-07T17:16:06.328Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:06.330Z] [ERROR] ❌ Error updating financial balances for employee 01444966-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:06.331Z] [LOG] ✅ Ratheeshanan null: Calculation completed successfully
[2025-10-07T17:16:06.331Z] [LOG] 📊 Progress: 12/34 (35.3%)
[2025-10-07T17:16:06.332Z] [LOG] 
🧮 Processing: Faizan Faizan (EMP000003)
[2025-10-07T17:16:06.332Z] [LOG] 📋 Record ID: 51d4dbbc-b3c6-413b-bdd3-1add301e318f
[2025-10-07T17:16:06.767Z] [LOG] 🔍 Component filtering for employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:06.768Z] [LOG]    Total components: 8
[2025-10-07T17:16:06.768Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:06.768Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-07T17:16:07.310Z] [LOG] 🔍 Fetched 0 attendance records for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:07.310Z] [LOG] ⚠️  ATTENTION: Employee 0143a057-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:16:07.419Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:16:08.068Z] [LOG] Employee 0143a057-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:16:08.068Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:16:08.068Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:16:08.068Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:16:08.069Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:08.069Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:16:08.069Z] [LOG] ================================================================================
[2025-10-07T17:16:08.070Z] [LOG] ================================================================================
[2025-10-07T17:16:08.070Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:16:08.070Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:16:08.070Z] [LOG]    Expected hours: 160h
[2025-10-07T17:16:08.070Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:16:08.070Z] [LOG] ================================================================================
[2025-10-07T17:16:08.181Z] [LOG] 🔄 Processing financial records for employee 0143a057-7105-11f0-a50f-98e743540430...
[2025-10-07T17:16:08.182Z] [LOG] 🔄 Processing financial records for employee 0143a057-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:16:08.291Z] [LOG] 📊 Found 0 active loans for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:08.399Z] [LOG] 📊 Found 0 active advances for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:08.509Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:08.510Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:16:08.510Z] [LOG] 💰 GROSS CALCULATION for Faizan Faizan:
[2025-10-07T17:16:08.511Z] [LOG]    Base Salary: 50000
[2025-10-07T17:16:08.511Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:16:08.619Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:16:08.835Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:16:09.052Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:16:09.166Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:16:09.400Z] [LOG] Employee 0143a057-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:16:09.400Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:16:09.401Z] [LOG] ============================================================
[2025-10-07T17:16:09.401Z] [LOG] 👤 Employee ID: 0143a057-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:09.402Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:16:09.402Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:16:09.402Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:16:09.402Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:16:09.403Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:16:09.403Z] [LOG] ⏱️  Hourly Rate: 250.00
[2025-10-07T17:16:09.403Z] [LOG] 
[2025-10-07T17:16:09.404Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:16:09.404Z] [LOG]    Expected Hours: 160
[2025-10-07T17:16:09.404Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:16:09.404Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:16:09.405Z] [LOG]    Worked Hours: 0
[2025-10-07T17:16:09.405Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:16:09.405Z] [LOG]    💸 Shortfall Deduction: 160h × 250.00 = 40000.00
[2025-10-07T17:16:09.406Z] [LOG] ============================================================
[2025-10-07T17:16:09.850Z] [LOG] 📅 Weekend absence check for employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:09.852Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:09.853Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:16:09.853Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:16:09.854Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:09.854Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:16:09.854Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:09.854Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:09.854Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:09.855Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:09.855Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:09.855Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:09.855Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:09.855Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:09.856Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:09.856Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:09.856Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:09.857Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:09.857Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:09.857Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:09.857Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:09.857Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:09.857Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:09.857Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:09.858Z] [LOG] Regular deductions for Faizan Faizan: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:09.858Z] [LOG] Combined deductions for Faizan Faizan: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 40000,
      "details": "160 hours × 250.00"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 10000,
      "details": "5 weekend days × 2000.00"
    }
  ],
  "total": 50000
}
[2025-10-07T17:16:09.967Z] [LOG] Creating components for record 51d4dbbc-b3c6-413b-bdd3-1add301e318f: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:16:09.969Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 40000
}
[2025-10-07T17:16:10.078Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:10.187Z] [LOG] Created payroll_record_component: ccb7e9a3-acef-47ec-a51e-b508b4f1ec72 for Working Hours Shortfall
[2025-10-07T17:16:10.187Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 10000
}
[2025-10-07T17:16:10.295Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:16:10.404Z] [LOG] Created payroll_record_component: cccc31f4-ae74-40c8-a8f2-791c8ca85b82 for Weekend Absent Days
[2025-10-07T17:16:10.725Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:10.727Z] [ERROR] ❌ Error updating financial balances for employee 0143a057-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:10.728Z] [LOG] ✅ Faizan Faizan: Calculation completed successfully
[2025-10-07T17:16:10.729Z] [LOG] 📊 Progress: 13/34 (38.2%)
[2025-10-07T17:16:10.729Z] [LOG] 
🧮 Processing: Rasanga null (EMP000028)
[2025-10-07T17:16:10.729Z] [LOG] 📋 Record ID: 5596be79-472f-4e09-bf3b-18b62b38cb10
[2025-10-07T17:16:11.175Z] [LOG] 🔍 Component filtering for employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:11.175Z] [LOG]    Total components: 8
[2025-10-07T17:16:11.175Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:11.176Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-07T17:16:11.717Z] [LOG] 🔍 Fetched 0 attendance records for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:11.718Z] [LOG] ⚠️  ATTENTION: Employee 0143eaec-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:16:11.826Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:16:12.487Z] [LOG] Employee 0143eaec-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:16:12.496Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:16:12.497Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:16:12.498Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:16:12.505Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:12.506Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:16:12.507Z] [LOG] ================================================================================
[2025-10-07T17:16:12.508Z] [LOG] ================================================================================
[2025-10-07T17:16:12.508Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:16:12.509Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:16:12.509Z] [LOG]    Expected hours: 160h
[2025-10-07T17:16:12.509Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:16:12.509Z] [LOG] ================================================================================
[2025-10-07T17:16:12.618Z] [LOG] 🔄 Processing financial records for employee 0143eaec-7105-11f0-a50f-98e743540430...
[2025-10-07T17:16:12.618Z] [LOG] 🔄 Processing financial records for employee 0143eaec-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:16:12.726Z] [LOG] 📊 Found 0 active loans for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:12.835Z] [LOG] 📊 Found 0 active advances for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:12.943Z] [LOG] 📊 Found 0 approved bonuses for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:12.943Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:16:12.943Z] [LOG] 💰 GROSS CALCULATION for Rasanga null:
[2025-10-07T17:16:12.944Z] [LOG]    Base Salary: 50000
[2025-10-07T17:16:12.944Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:16:13.063Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:16:13.299Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:16:13.579Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:16:13.687Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:16:13.905Z] [LOG] Employee 0143eaec-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:16:13.905Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:16:13.906Z] [LOG] ============================================================
[2025-10-07T17:16:13.906Z] [LOG] 👤 Employee ID: 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:13.907Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:16:13.907Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:16:13.907Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:16:13.908Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:16:13.908Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:16:13.908Z] [LOG] ⏱️  Hourly Rate: 250.00
[2025-10-07T17:16:13.909Z] [LOG] 
[2025-10-07T17:16:13.909Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:16:13.909Z] [LOG]    Expected Hours: 160
[2025-10-07T17:16:13.909Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:16:13.910Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:16:13.910Z] [LOG]    Worked Hours: 0
[2025-10-07T17:16:13.911Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:16:13.911Z] [LOG]    💸 Shortfall Deduction: 160h × 250.00 = 40000.00
[2025-10-07T17:16:13.912Z] [LOG] ============================================================
[2025-10-07T17:16:14.389Z] [LOG] 📅 Weekend absence check for employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:14.390Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:14.390Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:16:14.390Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:16:14.390Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:14.391Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:16:14.391Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:14.391Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:14.392Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:14.392Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:14.393Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:14.393Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:14.393Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:14.393Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:14.394Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:14.394Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:14.394Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:14.394Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:14.395Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:14.395Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:14.395Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:14.396Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:14.396Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:14.396Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:14.397Z] [LOG] Regular deductions for Rasanga null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:14.397Z] [LOG] Combined deductions for Rasanga null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 40000,
      "details": "160 hours × 250.00"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 10000,
      "details": "5 weekend days × 2000.00"
    }
  ],
  "total": 50000
}
[2025-10-07T17:16:14.506Z] [LOG] Creating components for record 5596be79-472f-4e09-bf3b-18b62b38cb10: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:16:14.507Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 40000
}
[2025-10-07T17:16:14.637Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:14.744Z] [LOG] Created payroll_record_component: a01ce185-3ad1-483c-8de1-0e5128aca3b0 for Working Hours Shortfall
[2025-10-07T17:16:14.745Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 10000
}
[2025-10-07T17:16:14.853Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:16:14.964Z] [LOG] Created payroll_record_component: 47d52ea2-5f84-4e7a-85d0-b928736ab44a for Weekend Absent Days
[2025-10-07T17:16:15.306Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:15.308Z] [ERROR] ❌ Error updating financial balances for employee 0143eaec-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:15.309Z] [LOG] ✅ Rasanga null: Calculation completed successfully
[2025-10-07T17:16:15.309Z] [LOG] 📊 Progress: 14/34 (41.2%)
[2025-10-07T17:16:15.310Z] [LOG] 
🧮 Processing: Jessie null (EMP000013)
[2025-10-07T17:16:15.310Z] [LOG] 📋 Record ID: 5dade4d0-6147-4933-a98f-0301b347ee60
[2025-10-07T17:16:15.751Z] [LOG] 🔍 Component filtering for employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:15.752Z] [LOG]    Total components: 8
[2025-10-07T17:16:15.752Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:15.753Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-07T17:16:16.400Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:16.617Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:16.831Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:17.045Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:17.260Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:17.477Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:17.694Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:17.910Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:18.140Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:18.366Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:18.591Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:18.805Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:19.019Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:19.234Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:19.448Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:19.677Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:19.899Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:20.008Z] [LOG] 🔍 Fetched 18 attendance records for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:20.114Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:16:20.651Z] [LOG] Employee 0143ae6e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:16:20.651Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:16:20.652Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:16:20.652Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:16:20.653Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:20.653Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:16:20.653Z] [LOG] ================================================================================
[2025-10-07T17:16:20.653Z] [LOG] 📅 2025-08-01 (WEEKDAY): 10.21h worked → 7.5925h counted → OVERLAP 09:24-17:00 = 7.593h (attendance table)
[2025-10-07T17:16:20.653Z] [LOG]    ✅ Added to weekday total: 7.5925h
[2025-10-07T17:16:20.653Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.95h worked → 7.666666666666667h counted → OVERLAP 09:20-17:00 = 7.667h (attendance table)
[2025-10-07T17:16:20.653Z] [LOG]    ✅ Added to weekday total: 7.666666666666667h
[2025-10-07T17:16:20.654Z] [LOG] 📅 2025-08-05 (WEEKDAY): 10.37h worked → 7.562222222222222h counted → OVERLAP 09:26-17:00 = 7.562h (attendance table)
[2025-10-07T17:16:20.654Z] [LOG]    ✅ Added to weekday total: 7.562222222222222h
[2025-10-07T17:16:20.654Z] [LOG] 📅 2025-08-06 (WEEKDAY): 9.6h worked → 7.601388888888889h counted → OVERLAP 09:23-17:00 = 7.601h (attendance table)
[2025-10-07T17:16:20.654Z] [LOG]    ✅ Added to weekday total: 7.601388888888889h
[2025-10-07T17:16:20.654Z] [LOG] 📅 2025-08-07 (WEEKDAY): 9.63h worked → 7.629722222222222h counted → OVERLAP 09:22-17:00 = 7.630h (attendance table)
[2025-10-07T17:16:20.655Z] [LOG]    ✅ Added to weekday total: 7.629722222222222h
[2025-10-07T17:16:20.655Z] [LOG] 📅 2025-08-11 (WEEKDAY): 9.85h worked → 7.916666666666667h counted → OVERLAP 09:05-17:00 = 7.917h (attendance table)
[2025-10-07T17:16:20.655Z] [LOG]    ✅ Added to weekday total: 7.916666666666667h
[2025-10-07T17:16:20.655Z] [LOG] 📅 2025-08-12 (WEEKDAY): 10.89h worked → 7.333333333333333h counted → OVERLAP 09:40-17:00 = 7.333h (attendance table)
[2025-10-07T17:16:20.655Z] [LOG]    ✅ Added to weekday total: 7.333333333333333h
[2025-10-07T17:16:20.656Z] [LOG] 📅 2025-08-13 (WEEKDAY): 11.21h worked → 7.714166666666666h counted → OVERLAP 09:17-17:00 = 7.714h (attendance table)
[2025-10-07T17:16:20.656Z] [LOG]    ✅ Added to weekday total: 7.714166666666666h
[2025-10-07T17:16:20.656Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.57h worked → 6.542777777777777h counted → OVERLAP 10:27-17:00 = 6.543h (attendance table)
[2025-10-07T17:16:20.656Z] [LOG]    ✅ Added to weekday total: 6.542777777777777h
[2025-10-07T17:16:20.656Z] [LOG] 📅 2025-08-15 (WEEKDAY): 9.52h worked → 7.523611111111111h counted → OVERLAP 09:28-17:00 = 7.524h (attendance table)
[2025-10-07T17:16:20.656Z] [LOG]    ✅ Added to weekday total: 7.523611111111111h
[2025-10-07T17:16:20.656Z] [LOG] 📅 2025-08-19 (WEEKDAY): 9.66h worked → 7.663055555555555h counted → OVERLAP 09:20-17:00 = 7.663h (attendance table)
[2025-10-07T17:16:20.656Z] [LOG]    ✅ Added to weekday total: 7.663055555555555h
[2025-10-07T17:16:20.656Z] [LOG] 📅 2025-08-20 (WEEKDAY): 10.19h worked → 7.708055555555555h counted → OVERLAP 09:17-17:00 = 7.708h (attendance table)
[2025-10-07T17:16:20.657Z] [LOG]    ✅ Added to weekday total: 7.708055555555555h
[2025-10-07T17:16:20.657Z] [LOG] 📅 2025-08-21 (WEEKDAY): 8.98h worked → 7.477777777777778h counted → OVERLAP 09:31-17:00 = 7.478h (attendance table)
[2025-10-07T17:16:20.657Z] [LOG]    ✅ Added to weekday total: 7.477777777777778h
[2025-10-07T17:16:20.657Z] [LOG] 📅 2025-08-22 (WEEKDAY): 9.06h worked → 7.563055555555556h counted → OVERLAP 09:26-17:00 = 7.563h (attendance table)
[2025-10-07T17:16:20.657Z] [LOG]    ✅ Added to weekday total: 7.563055555555556h
[2025-10-07T17:16:20.657Z] [LOG] 📅 2025-08-25 (WEEKDAY): 8.07h worked → 8.065833333333334h counted → OVERLAP 08:56-17:00 = 8.066h (attendance table)
[2025-10-07T17:16:20.657Z] [LOG]    ✅ Added to weekday total: 8.065833333333334h
[2025-10-07T17:16:20.658Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.57h worked → 7.5713888888888885h counted → OVERLAP 09:25-17:00 = 7.571h (attendance table)
[2025-10-07T17:16:20.658Z] [LOG]    ✅ Added to weekday total: 7.5713888888888885h
[2025-10-07T17:16:20.658Z] [LOG] 📅 2025-08-28 (WEEKDAY): 9h worked → 7.5h counted → OVERLAP 09:30-17:00 = 7.500h (attendance table)
[2025-10-07T17:16:20.658Z] [LOG]    ✅ Added to weekday total: 7.5h
[2025-10-07T17:16:20.658Z] [LOG] 📅 2025-08-29 (WEEKDAY): 11.06h worked → 7.562777777777778h counted → OVERLAP 09:26-17:00 = 7.563h (attendance table)
[2025-10-07T17:16:20.658Z] [LOG]    ✅ Added to weekday total: 7.562777777777778h
[2025-10-07T17:16:20.658Z] [LOG] ================================================================================
[2025-10-07T17:16:20.658Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:16:20.658Z] [LOG]    Sum of all daily counted hours (rounded): 136.195h
[2025-10-07T17:16:20.658Z] [LOG]    Expected hours: 170h
[2025-10-07T17:16:20.659Z] [LOG]    Shortfall: 33.81h
[2025-10-07T17:16:20.659Z] [LOG] ================================================================================
[2025-10-07T17:16:20.766Z] [LOG] 🔄 Processing financial records for employee 0143ae6e-7105-11f0-a50f-98e743540430...
[2025-10-07T17:16:20.766Z] [LOG] 🔄 Processing financial records for employee 0143ae6e-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:16:20.902Z] [LOG] 📊 Found 1 active loans for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:21.010Z] [LOG] 📊 Found 1 active advances for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:21.117Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:21.118Z] [LOG] 💰 Loan 2625eeef-b509-439f-9fbe-f80c1065c6fe: Deducting LKR 10000 (Remaining: LKR 10000)
[2025-10-07T17:16:21.118Z] [LOG] 💸 Advance d1db4f71-1c1e-4611-a1c5-6cec09c476d8: Deducting LKR 17000 (Remaining: LKR 17000)
[2025-10-07T17:16:21.118Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 10000,
  "advances": 17000,
  "bonuses": 0,
  "netAdjustment": -27000
}
[2025-10-07T17:16:21.119Z] [LOG] 💰 GROSS CALCULATION for Jessie null:
[2025-10-07T17:16:21.119Z] [LOG]    Base Salary: 60000
[2025-10-07T17:16:21.119Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:16:21.226Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:16:21.444Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:16:21.659Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:16:21.767Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:16:21.875Z] [LOG] Employee 0143ae6e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:16:21.875Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:16:21.875Z] [LOG] ============================================================
[2025-10-07T17:16:21.875Z] [LOG] 👤 Employee ID: 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:21.876Z] [LOG] 💰 Base Salary: 60,000
[2025-10-07T17:16:21.876Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:16:21.876Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:16:21.876Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:16:21.876Z] [LOG] 💵 Per-Day Salary: 2400.00
[2025-10-07T17:16:21.876Z] [LOG] ⏱️  Hourly Rate: 282.35
[2025-10-07T17:16:21.876Z] [LOG] 
[2025-10-07T17:16:21.876Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:16:21.876Z] [LOG]    Expected Hours: 170
[2025-10-07T17:16:21.876Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:16:21.876Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:16:21.876Z] [LOG]    Worked Hours: 136.195
[2025-10-07T17:16:21.877Z] [LOG]    ⚠️  Shortfall Hours: 33.80500000000001
[2025-10-07T17:16:21.877Z] [LOG]    💸 Shortfall Deduction: 33.80500000000001h × 282.35 = 9544.94
[2025-10-07T17:16:21.877Z] [LOG] ============================================================
[2025-10-07T17:16:22.308Z] [LOG] 📅 Weekend absence check for employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:22.308Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:22.309Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:16:22.309Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:16:22.309Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:22.309Z] [LOG]    Gross Salary: 60000
[2025-10-07T17:16:22.309Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:22.309Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:22.309Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:22.309Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:22.309Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:22.309Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:22.309Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:22.309Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:22.309Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:22.310Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:22.310Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:22.310Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:22.310Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:22.310Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:22.310Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:22.310Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:22.310Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:22.310Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:22.310Z] [LOG] Regular deductions for Jessie null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:22.310Z] [LOG] Combined deductions for Jessie null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 9544.941176470591,
      "details": "33.80500000000001 hours × 282.35"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 12000,
      "details": "5 weekend days × 2400.00"
    },
    {
      "code": "LOAN_DED",
      "name": "Loan Deductions",
      "type": "deduction",
      "category": "loan",
      "amount": 10000,
      "details": "1 loan(s)"
    },
    {
      "code": "ADVANCE_DED",
      "name": "Advance Deductions",
      "type": "deduction",
      "category": "other",
      "amount": 17000,
      "details": "1 advance(s)"
    }
  ],
  "total": 48544.94117647059
}
[2025-10-07T17:16:22.418Z] [LOG] Creating components for record 5dade4d0-6147-4933-a98f-0301b347ee60: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 4,
  "taxComponentsCount": 0
}
[2025-10-07T17:16:22.418Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 9544.941176470591
}
[2025-10-07T17:16:22.526Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:22.633Z] [LOG] Created payroll_record_component: 90f6d091-2535-48f9-8b31-274c23fcccef for Working Hours Shortfall
[2025-10-07T17:16:22.634Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 12000
}
[2025-10-07T17:16:22.748Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:16:22.866Z] [LOG] Created payroll_record_component: d44309fd-b20b-4ff5-b059-7b248e1cec76 for Weekend Absent Days
[2025-10-07T17:16:22.867Z] [LOG] Processing component: {
  "name": "Loan Deductions",
  "type": "deduction",
  "amount": 10000
}
[2025-10-07T17:16:22.984Z] [LOG] Using existing component ID: 64a0d7d8-8fdb-4968-a7a2-057590b481c7
[2025-10-07T17:16:23.101Z] [LOG] Created payroll_record_component: 2901d6a3-7ff1-4480-bfd8-0c6dcce583e3 for Loan Deductions
[2025-10-07T17:16:23.101Z] [LOG] Processing component: {
  "name": "Advance Deductions",
  "type": "deduction",
  "amount": 17000
}
[2025-10-07T17:16:23.211Z] [LOG] Using existing component ID: 212471aa-dc59-47a4-9969-235f68be2fa4
[2025-10-07T17:16:23.319Z] [LOG] Created payroll_record_component: 7d161873-d360-4987-9d93-d8fe8a1d6fcc for Advance Deductions
[2025-10-07T17:16:23.642Z] [LOG] ✅ Updated loan 2625eeef-b509-439f-9fbe-f80c1065c6fe: Remaining LKR 0, Status: completed
[2025-10-07T17:16:23.860Z] [LOG] ✅ Updated advance d1db4f71-1c1e-4611-a1c5-6cec09c476d8: Remaining LKR 0, Status: completed
[2025-10-07T17:16:24.075Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:24.076Z] [ERROR] ❌ Error updating financial balances for employee 0143ae6e-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:24.077Z] [LOG] ✅ Jessie null: Calculation completed successfully
[2025-10-07T17:16:24.077Z] [LOG] 📊 Progress: 15/34 (44.1%)
[2025-10-07T17:16:24.078Z] [LOG] 
🧮 Processing: P.D.P Dilini Madushani null (EMP000043)
[2025-10-07T17:16:24.078Z] [LOG] 📋 Record ID: 6266930e-45a5-4abd-a9c2-58a7df5024f7
[2025-10-07T17:16:24.507Z] [LOG] 🔍 Component filtering for employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:24.508Z] [LOG]    Total components: 8
[2025-10-07T17:16:24.508Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:24.508Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-07T17:16:25.043Z] [LOG] 🔍 Fetched 0 attendance records for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:25.044Z] [LOG] ⚠️  ATTENTION: Employee 014435dc-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:16:25.151Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:16:25.818Z] [LOG] Employee 014435dc-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:16:25.819Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:16:25.819Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:16:25.819Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:16:25.819Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:25.820Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:16:25.820Z] [LOG] ================================================================================
[2025-10-07T17:16:25.820Z] [LOG] ================================================================================
[2025-10-07T17:16:25.820Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:16:25.820Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:16:25.820Z] [LOG]    Expected hours: 160h
[2025-10-07T17:16:25.820Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:16:25.820Z] [LOG] ================================================================================
[2025-10-07T17:16:25.935Z] [LOG] 🔄 Processing financial records for employee 014435dc-7105-11f0-a50f-98e743540430...
[2025-10-07T17:16:25.936Z] [LOG] 🔄 Processing financial records for employee 014435dc-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:16:26.043Z] [LOG] 📊 Found 0 active loans for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:26.151Z] [LOG] 📊 Found 0 active advances for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:26.258Z] [LOG] 📊 Found 0 approved bonuses for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:26.258Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:16:26.259Z] [LOG] 💰 GROSS CALCULATION for P.D.P Dilini Madushani null:
[2025-10-07T17:16:26.259Z] [LOG]    Base Salary: 50000
[2025-10-07T17:16:26.259Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:16:26.367Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:16:26.582Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:16:26.797Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:16:26.905Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:16:27.123Z] [LOG] Employee 014435dc-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:16:27.124Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:16:27.124Z] [LOG] ============================================================
[2025-10-07T17:16:27.124Z] [LOG] 👤 Employee ID: 014435dc-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:27.124Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:16:27.124Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:16:27.125Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:16:27.125Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:16:27.125Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:16:27.125Z] [LOG] ⏱️  Hourly Rate: 250.00
[2025-10-07T17:16:27.125Z] [LOG] 
[2025-10-07T17:16:27.125Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:16:27.125Z] [LOG]    Expected Hours: 160
[2025-10-07T17:16:27.125Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:16:27.125Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:16:27.126Z] [LOG]    Worked Hours: 0
[2025-10-07T17:16:27.126Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:16:27.126Z] [LOG]    💸 Shortfall Deduction: 160h × 250.00 = 40000.00
[2025-10-07T17:16:27.126Z] [LOG] ============================================================
[2025-10-07T17:16:27.560Z] [LOG] 📅 Weekend absence check for employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:27.560Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:27.561Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:16:27.561Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:16:27.561Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:27.561Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:16:27.561Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:27.562Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:27.562Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:27.562Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:27.562Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:27.562Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:27.562Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:27.563Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:27.563Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:27.563Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:27.563Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:27.563Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:27.563Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:27.564Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:27.564Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:27.564Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:27.564Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:27.564Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:27.564Z] [LOG] Regular deductions for P.D.P Dilini Madushani null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:27.564Z] [LOG] Combined deductions for P.D.P Dilini Madushani null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 40000,
      "details": "160 hours × 250.00"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 10000,
      "details": "5 weekend days × 2000.00"
    }
  ],
  "total": 50000
}
[2025-10-07T17:16:27.673Z] [LOG] Creating components for record 6266930e-45a5-4abd-a9c2-58a7df5024f7: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:16:27.674Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 40000
}
[2025-10-07T17:16:27.782Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:27.891Z] [LOG] Created payroll_record_component: ab7a9f89-3850-4237-9a45-e9df008e8f27 for Working Hours Shortfall
[2025-10-07T17:16:27.891Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 10000
}
[2025-10-07T17:16:27.999Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:16:28.108Z] [LOG] Created payroll_record_component: d8f8c033-3a0e-444d-9415-f9e68276f3b7 for Weekend Absent Days
[2025-10-07T17:16:28.429Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:28.429Z] [ERROR] ❌ Error updating financial balances for employee 014435dc-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:28.430Z] [LOG] ✅ P.D.P Dilini Madushani null: Calculation completed successfully
[2025-10-07T17:16:28.430Z] [LOG] 📊 Progress: 16/34 (47.1%)
[2025-10-07T17:16:28.430Z] [LOG] 
🧮 Processing: Kaushal Thambi (EMP465256103)
[2025-10-07T17:16:28.430Z] [LOG] 📋 Record ID: 660d14b3-bff7-4645-9841-36ab26e4a899
[2025-10-07T17:16:28.877Z] [LOG] 🔍 Component filtering for employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-07T17:16:28.878Z] [LOG]    Total components: 8
[2025-10-07T17:16:28.878Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:28.878Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-07T17:16:29.415Z] [LOG] 🔍 Fetched 0 attendance records for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-07T17:16:29.416Z] [LOG] ⚠️  ATTENTION: Employee 9e8125c4-ce58-411a-b617-9f75d481c613 has NO attendance records in this payroll period!
[2025-10-07T17:16:29.524Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:16:30.185Z] [LOG] Employee 9e8125c4-ce58-411a-b617-9f75d481c613 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:16:30.186Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:16:30.186Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:16:30.186Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:16:30.187Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-07T17:16:30.187Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:16:30.187Z] [LOG] ================================================================================
[2025-10-07T17:16:30.187Z] [LOG] ================================================================================
[2025-10-07T17:16:30.187Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:16:30.187Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:16:30.187Z] [LOG]    Expected hours: 160h
[2025-10-07T17:16:30.188Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:16:30.188Z] [LOG] ================================================================================
[2025-10-07T17:16:30.296Z] [LOG] 🔄 Processing financial records for employee 9e8125c4-ce58-411a-b617-9f75d481c613...
[2025-10-07T17:16:30.296Z] [LOG] 🔄 Processing financial records for employee 9e8125c4-ce58-411a-b617-9f75d481c613 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:16:30.404Z] [LOG] 📊 Found 0 active loans for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-07T17:16:30.511Z] [LOG] 📊 Found 0 active advances for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-07T17:16:30.620Z] [LOG] 📊 Found 0 approved bonuses for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-07T17:16:30.620Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:16:30.621Z] [LOG] 💰 GROSS CALCULATION for Kaushal Thambi:
[2025-10-07T17:16:30.621Z] [LOG]    Base Salary: 50000
[2025-10-07T17:16:30.621Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:16:30.728Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:16:30.951Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:16:31.167Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:16:31.275Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:16:31.490Z] [LOG] Employee 9e8125c4-ce58-411a-b617-9f75d481c613 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:16:31.490Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:16:31.490Z] [LOG] ============================================================
[2025-10-07T17:16:31.491Z] [LOG] 👤 Employee ID: 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-07T17:16:31.491Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:16:31.491Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:16:31.491Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:16:31.491Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:16:31.492Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:16:31.492Z] [LOG] ⏱️  Hourly Rate: 250.00
[2025-10-07T17:16:31.492Z] [LOG] 
[2025-10-07T17:16:31.492Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:16:31.493Z] [LOG]    Expected Hours: 160
[2025-10-07T17:16:31.493Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:16:31.493Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:16:31.493Z] [LOG]    Worked Hours: 0
[2025-10-07T17:16:31.494Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:16:31.494Z] [LOG]    💸 Shortfall Deduction: 160h × 250.00 = 40000.00
[2025-10-07T17:16:31.494Z] [LOG] ============================================================
[2025-10-07T17:16:31.927Z] [LOG] 📅 Weekend absence check for employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-07T17:16:31.927Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:31.928Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:16:31.928Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:16:31.928Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:31.928Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:16:31.928Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:31.928Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:31.928Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:31.928Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:31.929Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:31.929Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:31.929Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:31.929Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:31.929Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:31.929Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:31.929Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:31.930Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:31.930Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:31.930Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:31.930Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:31.930Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:31.931Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:31.931Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:31.931Z] [LOG] Regular deductions for Kaushal Thambi: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:31.931Z] [LOG] Combined deductions for Kaushal Thambi: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 40000,
      "details": "160 hours × 250.00"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 10000,
      "details": "5 weekend days × 2000.00"
    }
  ],
  "total": 50000
}
[2025-10-07T17:16:32.039Z] [LOG] Creating components for record 660d14b3-bff7-4645-9841-36ab26e4a899: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:16:32.040Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 40000
}
[2025-10-07T17:16:32.147Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:32.255Z] [LOG] Created payroll_record_component: d9ffae96-1d9e-4159-8883-09370efc658f for Working Hours Shortfall
[2025-10-07T17:16:32.255Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 10000
}
[2025-10-07T17:16:32.363Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:16:32.470Z] [LOG] Created payroll_record_component: f1e45dc8-1e45-4d0c-987f-e120c4c51f12 for Weekend Absent Days
[2025-10-07T17:16:32.795Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:32.796Z] [ERROR] ❌ Error updating financial balances for employee 9e8125c4-ce58-411a-b617-9f75d481c613: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:32.797Z] [LOG] ✅ Kaushal Thambi: Calculation completed successfully
[2025-10-07T17:16:32.798Z] [LOG] 📊 Progress: 17/34 (50.0%)
[2025-10-07T17:16:32.798Z] [LOG] 
🧮 Processing: Chamodi null (EMP000032)
[2025-10-07T17:16:32.798Z] [LOG] 📋 Record ID: 662b9801-4a2b-46ea-aa0c-cda28d708bc2
[2025-10-07T17:16:33.261Z] [LOG] 🔍 Component filtering for employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:33.261Z] [LOG]    Total components: 8
[2025-10-07T17:16:33.261Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:33.262Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-07T17:16:33.929Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:34.150Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:34.368Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:34.585Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:34.804Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:35.029Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:35.250Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:35.470Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:35.699Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:35.922Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:36.148Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:36.261Z] [LOG] 🔍 Fetched 24 attendance records for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:36.371Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:16:36.926Z] [LOG] Employee 0143f302-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:16:36.927Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:16:36.927Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:16:36.927Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:16:36.928Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:36.928Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:16:36.928Z] [LOG] ================================================================================
[2025-10-07T17:16:36.928Z] [LOG] 📅 2025-08-01 (WEEKDAY): 8.18h worked → 7.4366666666666665h counted → OVERLAP 09:33-17:00 = 7.437h (attendance table)
[2025-10-07T17:16:36.928Z] [LOG]    ✅ Added to weekday total: 7.4366666666666665h
[2025-10-07T17:16:36.929Z] [LOG] 📅 2025-08-02 (WEEKEND): 5.82h worked → 3.8194444444444446h counted → OVERLAP 09:10-13:00 = 3.819h (attendance table)
[2025-10-07T17:16:36.929Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.8194444444444446h
[2025-10-07T17:16:36.929Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.71h worked → 8.402777777777779h counted → OVERLAP 08:35-17:00 = 8.403h (attendance table)
[2025-10-07T17:16:36.929Z] [LOG]    ✅ Added to weekday total: 8.402777777777779h
[2025-10-07T17:16:36.930Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.64h worked → 8.365277777777777h counted → OVERLAP 08:38-17:00 = 8.365h (attendance table)
[2025-10-07T17:16:36.930Z] [LOG]    ✅ Added to weekday total: 8.365277777777777h
[2025-10-07T17:16:36.930Z] [LOG] 📅 2025-08-06 (WEEKDAY): 10.53h worked → 7.636111111111111h counted → OVERLAP 09:21-17:00 = 7.636h (attendance table)
[2025-10-07T17:16:36.930Z] [LOG]    ✅ Added to weekday total: 7.636111111111111h
[2025-10-07T17:16:36.930Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.67h worked → 8.16611111111111h counted → OVERLAP 08:50-17:00 = 8.166h (attendance table)
[2025-10-07T17:16:36.930Z] [LOG]    ✅ Added to weekday total: 8.16611111111111h
[2025-10-07T17:16:36.930Z] [LOG] 📅 2025-08-09 (WEEKEND): 4.83h worked → 3.433611111111111h counted → OVERLAP 09:33-13:00 = 3.434h (attendance table)
[2025-10-07T17:16:36.930Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.433611111111111h
[2025-10-07T17:16:36.931Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8h worked → 8h counted → OVERLAP 09:00-17:00 = 8.000h (attendance table)
[2025-10-07T17:16:36.931Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:16:36.931Z] [LOG] 📅 2025-08-12 (WEEKDAY): 8.8h worked → 7.175833333333333h counted → OVERLAP 09:49-17:00 = 7.176h (attendance table)
[2025-10-07T17:16:36.931Z] [LOG]    ✅ Added to weekday total: 7.175833333333333h
[2025-10-07T17:16:36.931Z] [LOG] 📅 2025-08-13 (WEEKDAY): 8.37h worked → 7.7908333333333335h counted → OVERLAP 09:12-17:00 = 7.791h (attendance table)
[2025-10-07T17:16:36.931Z] [LOG]    ✅ Added to weekday total: 7.7908333333333335h
[2025-10-07T17:16:36.931Z] [LOG] 📅 2025-08-14 (WEEKDAY): 7.53h worked → 7.523333333333333h counted → OVERLAP 09:28-17:00 = 7.523h (attendance table)
[2025-10-07T17:16:36.931Z] [LOG]    ✅ Added to weekday total: 7.523333333333333h
[2025-10-07T17:16:36.932Z] [LOG] 📅 2025-08-15 (WEEKDAY): 8.19h worked → 8.076666666666666h counted → OVERLAP 08:55-17:00 = 8.077h (attendance table)
[2025-10-07T17:16:36.932Z] [LOG]    ✅ Added to weekday total: 8.076666666666666h
[2025-10-07T17:16:36.932Z] [LOG] 📅 2025-08-16 (WEEKEND): 3.89h worked → 3.3933333333333335h counted → OVERLAP 09:36-13:00 = 3.393h (attendance table)
[2025-10-07T17:16:36.932Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.3933333333333335h
[2025-10-07T17:16:36.932Z] [LOG] 📅 2025-08-18 (WEEKDAY): 7.87h worked → 7.778333333333333h counted → OVERLAP 09:13-17:00 = 7.778h (attendance table)
[2025-10-07T17:16:36.932Z] [LOG]    ✅ Added to weekday total: 7.778333333333333h
[2025-10-07T17:16:36.933Z] [LOG] 📅 2025-08-19 (WEEKDAY): 10.33h worked → 7.833333333333333h counted → OVERLAP 09:10-17:00 = 7.833h (attendance table)
[2025-10-07T17:16:36.934Z] [LOG]    ✅ Added to weekday total: 7.833333333333333h
[2025-10-07T17:16:36.934Z] [LOG] 📅 2025-08-20 (WEEKDAY): 8.42h worked → 8.345277777777778h counted → OVERLAP 08:39-17:00 = 8.345h (attendance table)
[2025-10-07T17:16:36.934Z] [LOG]    ✅ Added to weekday total: 8.345277777777778h
[2025-10-07T17:16:36.934Z] [LOG] 📅 2025-08-22 (WEEKDAY): 7.41h worked → 7.243055555555555h counted → OVERLAP 09:45-17:00 = 7.243h (attendance table)
[2025-10-07T17:16:36.934Z] [LOG]    ✅ Added to weekday total: 7.243055555555555h
[2025-10-07T17:16:36.934Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.31h worked → 3.9466666666666668h counted → OVERLAP 09:03-13:00 = 3.947h (attendance table)
[2025-10-07T17:16:36.934Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.9466666666666668h
[2025-10-07T17:16:36.935Z] [LOG] 📅 2025-08-25 (WEEKDAY): 9.1h worked → 8.103055555555555h counted → OVERLAP 08:53-17:00 = 8.103h (attendance table)
[2025-10-07T17:16:36.935Z] [LOG]    ✅ Added to weekday total: 8.103055555555555h
[2025-10-07T17:16:36.935Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.11h worked → 7.995555555555556h counted → OVERLAP 09:00-17:00 = 7.996h (attendance table)
[2025-10-07T17:16:36.935Z] [LOG]    ✅ Added to weekday total: 7.995555555555556h
[2025-10-07T17:16:36.935Z] [LOG] 📅 2025-08-27 (WEEKDAY): 9.4h worked → 8.18361111111111h counted → OVERLAP 08:48-17:00 = 8.184h (attendance table)
[2025-10-07T17:16:36.935Z] [LOG]    ✅ Added to weekday total: 8.18361111111111h
[2025-10-07T17:16:36.935Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.19h worked → 8.159722222222221h counted → OVERLAP 08:50-17:00 = 8.160h (attendance table)
[2025-10-07T17:16:36.935Z] [LOG]    ✅ Added to weekday total: 8.159722222222221h
[2025-10-07T17:16:36.935Z] [LOG] 📅 2025-08-29 (WEEKDAY): 8.8h worked → 7.876666666666667h counted → OVERLAP 09:07-17:00 = 7.877h (attendance table)
[2025-10-07T17:16:36.936Z] [LOG]    ✅ Added to weekday total: 7.876666666666667h
[2025-10-07T17:16:36.936Z] [LOG] 📅 2025-08-30 (WEEKEND): 5.04h worked → 3.5008333333333335h counted → OVERLAP 09:29-13:00 = 3.501h (attendance table)
[2025-10-07T17:16:36.936Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.5008333333333335h
[2025-10-07T17:16:36.936Z] [LOG] ================================================================================
[2025-10-07T17:16:36.936Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:16:36.936Z] [LOG]    Sum of all daily counted hours (rounded): 150.0922h
[2025-10-07T17:16:36.936Z] [LOG]    Expected hours: 170h
[2025-10-07T17:16:36.936Z] [LOG]    Shortfall: 19.91h
[2025-10-07T17:16:36.936Z] [LOG] ================================================================================
[2025-10-07T17:16:37.046Z] [LOG] 🔄 Processing financial records for employee 0143f302-7105-11f0-a50f-98e743540430...
[2025-10-07T17:16:37.046Z] [LOG] 🔄 Processing financial records for employee 0143f302-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:16:37.160Z] [LOG] 📊 Found 0 active loans for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:37.278Z] [LOG] 📊 Found 0 active advances for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:37.400Z] [LOG] 📊 Found 0 approved bonuses for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:37.400Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:16:37.401Z] [LOG] 💰 GROSS CALCULATION for Chamodi null:
[2025-10-07T17:16:37.401Z] [LOG]    Base Salary: 50000
[2025-10-07T17:16:37.401Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:16:37.514Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:16:37.749Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:16:37.985Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:16:38.105Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:16:38.221Z] [LOG] Employee 0143f302-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:16:38.222Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:16:38.222Z] [LOG] ============================================================
[2025-10-07T17:16:38.223Z] [LOG] 👤 Employee ID: 0143f302-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:38.223Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:16:38.223Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:16:38.223Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:16:38.223Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:16:38.223Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:16:38.223Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:16:38.224Z] [LOG] 
[2025-10-07T17:16:38.224Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:16:38.224Z] [LOG]    Expected Hours: 170
[2025-10-07T17:16:38.224Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:16:38.224Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:16:38.224Z] [LOG]    Worked Hours: 150.0922
[2025-10-07T17:16:38.224Z] [LOG]    ⚠️  Shortfall Hours: 19.90780000000001
[2025-10-07T17:16:38.225Z] [LOG]    💸 Shortfall Deduction: 19.90780000000001h × 235.29 = 4684.19
[2025-10-07T17:16:38.225Z] [LOG] ============================================================
[2025-10-07T17:16:38.449Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-02 (Saturday)
[2025-10-07T17:16:38.449Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:16:38.449Z] [LOG]    Actual: 09:10:50 - 15:00:00
[2025-10-07T17:16:38.450Z] [LOG]    Calculation: OVERLAP 09:10-13:00 = 3.819h
[2025-10-07T17:16:38.450Z] [LOG]    Payable Hours: 3.819h
[2025-10-07T17:16:38.450Z] [LOG]    Shortfall: 0.681h
[2025-10-07T17:16:38.450Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:16:38.450Z] [LOG]    Deduction: 302.47
[2025-10-07T17:16:38.451Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-09 (Saturday)
[2025-10-07T17:16:38.452Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:16:38.452Z] [LOG]    Actual: 09:33:59 - 14:23:29
[2025-10-07T17:16:38.452Z] [LOG]    Calculation: OVERLAP 09:33-13:00 = 3.434h
[2025-10-07T17:16:38.452Z] [LOG]    Payable Hours: 3.434h
[2025-10-07T17:16:38.452Z] [LOG]    Shortfall: 1.066h
[2025-10-07T17:16:38.452Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:16:38.453Z] [LOG]    Deduction: 473.95
[2025-10-07T17:16:38.453Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-16 (Saturday)
[2025-10-07T17:16:38.453Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:16:38.453Z] [LOG]    Actual: 09:36:24 - 13:30:00
[2025-10-07T17:16:38.453Z] [LOG]    Calculation: OVERLAP 09:36-13:00 = 3.393h
[2025-10-07T17:16:38.454Z] [LOG]    Payable Hours: 3.393h
[2025-10-07T17:16:38.454Z] [LOG]    Shortfall: 1.107h
[2025-10-07T17:16:38.454Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:16:38.454Z] [LOG]    Deduction: 491.85
[2025-10-07T17:16:38.454Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-23 (Saturday)
[2025-10-07T17:16:38.454Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:16:38.454Z] [LOG]    Actual: 09:03:12 - 13:21:33
[2025-10-07T17:16:38.454Z] [LOG]    Calculation: OVERLAP 09:03-13:00 = 3.947h
[2025-10-07T17:16:38.455Z] [LOG]    Payable Hours: 3.947h
[2025-10-07T17:16:38.455Z] [LOG]    Shortfall: 0.553h
[2025-10-07T17:16:38.455Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:16:38.455Z] [LOG]    Deduction: 245.93
[2025-10-07T17:16:38.455Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-30 (Saturday)
[2025-10-07T17:16:38.455Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:16:38.455Z] [LOG]    Actual: 09:29:57 - 14:32:03
[2025-10-07T17:16:38.456Z] [LOG]    Calculation: OVERLAP 09:29-13:00 = 3.501h
[2025-10-07T17:16:38.456Z] [LOG]    Payable Hours: 3.501h
[2025-10-07T17:16:38.456Z] [LOG]    Shortfall: 0.999h
[2025-10-07T17:16:38.456Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:16:38.456Z] [LOG]    Deduction: 444.07
[2025-10-07T17:16:38.726Z] [LOG] 📅 Weekend absence check for employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:38.726Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:38.726Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:16:38.727Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:16:38.727Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:38.727Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:16:38.727Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:38.727Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:38.727Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:38.727Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:38.728Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:38.728Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:38.728Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:38.728Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:38.728Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:38.728Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:38.728Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:38.729Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:38.729Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:38.729Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:38.729Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:38.729Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:38.729Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:38.729Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:38.729Z] [LOG] Regular deductions for Chamodi null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:38.729Z] [LOG] Combined deductions for Chamodi null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 1958.2716049382716,
      "details": "Total 4.41h shortfall - 2025-08-02 (Saturday): 0.68h, 2025-08-09 (Saturday): 1.07h, 2025-08-16 (Saturday): 1.11h, 2025-08-23 (Saturday): 0.55h, 2025-08-30 (Saturday): 1.00h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 4684.188235294119,
      "details": "19.90780000000001 hours × 235.29"
    }
  ],
  "total": 6642.459840232391
}
[2025-10-07T17:16:38.837Z] [LOG] Creating components for record 662b9801-4a2b-46ea-aa0c-cda28d708bc2: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:16:38.837Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 1958.2716049382716
}
[2025-10-07T17:16:38.945Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:16:39.053Z] [LOG] Created payroll_record_component: 90317b16-6430-4835-aafe-6ae0bc610d17 for Weekend Shortfall Deduction
[2025-10-07T17:16:39.053Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 4684.188235294119
}
[2025-10-07T17:16:39.166Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:39.287Z] [LOG] Created payroll_record_component: cb14b688-3508-47f8-827b-0297766fbdc4 for Working Hours Shortfall
[2025-10-07T17:16:39.617Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:39.618Z] [ERROR] ❌ Error updating financial balances for employee 0143f302-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:39.619Z] [LOG] ✅ Chamodi null: Calculation completed successfully
[2025-10-07T17:16:39.619Z] [LOG] 📊 Progress: 18/34 (52.9%)
[2025-10-07T17:16:39.619Z] [LOG] 
🧮 Processing: Prasanthan null (EMP000001)
[2025-10-07T17:16:39.620Z] [LOG] 📋 Record ID: 66e549f6-f6a1-43ef-a6f2-54c244490198
[2025-10-07T17:16:40.050Z] [LOG] 🔍 Component filtering for employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:40.051Z] [LOG]    Total components: 8
[2025-10-07T17:16:40.051Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:40.051Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-07T17:16:40.591Z] [LOG] 🔍 Fetched 0 attendance records for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:40.591Z] [LOG] ⚠️  ATTENTION: Employee 014397c7-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:16:40.702Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:16:41.368Z] [LOG] Employee 014397c7-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:16:41.368Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:16:41.368Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:16:41.369Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:16:41.369Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:41.369Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:16:41.369Z] [LOG] ================================================================================
[2025-10-07T17:16:41.369Z] [LOG] ================================================================================
[2025-10-07T17:16:41.369Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:16:41.369Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:16:41.369Z] [LOG]    Expected hours: 160h
[2025-10-07T17:16:41.369Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:16:41.369Z] [LOG] ================================================================================
[2025-10-07T17:16:41.477Z] [LOG] 🔄 Processing financial records for employee 014397c7-7105-11f0-a50f-98e743540430...
[2025-10-07T17:16:41.477Z] [LOG] 🔄 Processing financial records for employee 014397c7-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:16:41.584Z] [LOG] 📊 Found 0 active loans for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:41.691Z] [LOG] 📊 Found 0 active advances for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:41.799Z] [LOG] 📊 Found 0 approved bonuses for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:41.800Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:16:41.800Z] [LOG] 💰 GROSS CALCULATION for Prasanthan null:
[2025-10-07T17:16:41.801Z] [LOG]    Base Salary: 150000
[2025-10-07T17:16:41.801Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:16:41.908Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:16:42.126Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:16:42.341Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:16:42.449Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:16:42.665Z] [LOG] Employee 014397c7-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:16:42.665Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:16:42.665Z] [LOG] ============================================================
[2025-10-07T17:16:42.665Z] [LOG] 👤 Employee ID: 014397c7-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:42.665Z] [LOG] 💰 Base Salary: 150,000
[2025-10-07T17:16:42.665Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:16:42.666Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:16:42.666Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:16:42.666Z] [LOG] 💵 Per-Day Salary: 6000.00
[2025-10-07T17:16:42.666Z] [LOG] ⏱️  Hourly Rate: 750.00
[2025-10-07T17:16:42.666Z] [LOG] 
[2025-10-07T17:16:42.666Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:16:42.667Z] [LOG]    Expected Hours: 160
[2025-10-07T17:16:42.667Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:16:42.667Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:16:42.667Z] [LOG]    Worked Hours: 0
[2025-10-07T17:16:42.667Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:16:42.667Z] [LOG]    💸 Shortfall Deduction: 160h × 750.00 = 120000.00
[2025-10-07T17:16:42.667Z] [LOG] ============================================================
[2025-10-07T17:16:43.099Z] [LOG] 📅 Weekend absence check for employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:43.099Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:43.100Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:16:43.100Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:16:43.101Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:43.101Z] [LOG]    Gross Salary: 150000
[2025-10-07T17:16:43.101Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:43.102Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:43.102Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:43.102Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:43.103Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:43.103Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:43.104Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:43.104Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:43.104Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:43.105Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:43.105Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:43.105Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:43.106Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:43.106Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:43.106Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:43.107Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:43.107Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:43.107Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:43.108Z] [LOG] Regular deductions for Prasanthan null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:43.108Z] [LOG] Combined deductions for Prasanthan null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 120000,
      "details": "160 hours × 750.00"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 30000,
      "details": "5 weekend days × 6000.00"
    }
  ],
  "total": 150000
}
[2025-10-07T17:16:43.217Z] [LOG] Creating components for record 66e549f6-f6a1-43ef-a6f2-54c244490198: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 1
}
[2025-10-07T17:16:43.218Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 120000
}
[2025-10-07T17:16:43.326Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:43.434Z] [LOG] Created payroll_record_component: e82117be-a98c-4107-a085-47127de2941c for Working Hours Shortfall
[2025-10-07T17:16:43.435Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 30000
}
[2025-10-07T17:16:43.543Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:16:43.651Z] [LOG] Created payroll_record_component: 6a1efc5f-8636-46b3-ab2d-eafaee04a0e5 for Weekend Absent Days
[2025-10-07T17:16:43.651Z] [LOG] Processing component: {
  "name": "Income Tax",
  "type": "tax",
  "amount": 3000
}
[2025-10-07T17:16:43.759Z] [LOG] Using existing component ID: 72f98b53-4bd5-4713-98d0-e3a641ad8d0f
[2025-10-07T17:16:43.868Z] [LOG] Created payroll_record_component: 8b606cf8-a69b-424c-ab91-b80080c931e4 for Income Tax
[2025-10-07T17:16:44.191Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:44.192Z] [ERROR] ❌ Error updating financial balances for employee 014397c7-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:44.192Z] [LOG] ✅ Prasanthan null: Calculation completed successfully
[2025-10-07T17:16:44.193Z] [LOG] 📊 Progress: 19/34 (55.9%)
[2025-10-07T17:16:44.193Z] [LOG] 
🧮 Processing: Sithira null (EMP000039)
[2025-10-07T17:16:44.193Z] [LOG] 📋 Record ID: 7848c2cc-032c-49c7-abdb-5b23a9f2184f
[2025-10-07T17:16:44.623Z] [LOG] 🔍 Component filtering for employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:44.623Z] [LOG]    Total components: 8
[2025-10-07T17:16:44.624Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:44.624Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-07T17:16:45.309Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:45.546Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:45.783Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:46.018Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:46.235Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:46.450Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:46.666Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:46.885Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:47.102Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:47.318Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:47.436Z] [LOG] 🔍 Fetched 21 attendance records for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:47.544Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:16:48.084Z] [LOG] Employee 01441e19-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:16:48.085Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:16:48.085Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:16:48.086Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:16:48.087Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:48.087Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:16:48.087Z] [LOG] ================================================================================
[2025-10-07T17:16:48.088Z] [LOG] 📅 2025-08-01 (WEEKDAY): 8.54h worked → 8.376388888888888h counted → OVERLAP 08:37-17:00 = 8.376h (attendance table)
[2025-10-07T17:16:48.088Z] [LOG]    ✅ Added to weekday total: 8.376388888888888h
[2025-10-07T17:16:48.089Z] [LOG] 📅 2025-08-02 (WEEKEND): 5.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:16:48.089Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:16:48.089Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.54h worked → 8.489166666666666h counted → OVERLAP 08:30-17:00 = 8.489h (attendance table)
[2025-10-07T17:16:48.090Z] [LOG]    ✅ Added to weekday total: 8.489166666666666h
[2025-10-07T17:16:48.090Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.49h worked → 7.819166666666667h counted → OVERLAP 09:10-17:00 = 7.819h (attendance table)
[2025-10-07T17:16:48.090Z] [LOG]    ✅ Added to weekday total: 7.819166666666667h
[2025-10-07T17:16:48.091Z] [LOG] 📅 2025-08-06 (WEEKDAY): 7.95h worked → 6.6786111111111115h counted → OVERLAP 10:19-17:00 = 6.679h (attendance table)
[2025-10-07T17:16:48.091Z] [LOG]    ✅ Added to weekday total: 6.6786111111111115h
[2025-10-07T17:16:48.091Z] [LOG] 📅 2025-08-07 (WEEKDAY): 9.31h worked → 8.30888888888889h counted → OVERLAP 08:41-17:00 = 8.309h (attendance table)
[2025-10-07T17:16:48.091Z] [LOG]    ✅ Added to weekday total: 8.30888888888889h
[2025-10-07T17:16:48.092Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8.08h worked → 7.833333333333333h counted → OVERLAP 09:10-17:00 = 7.833h (attendance table)
[2025-10-07T17:16:48.092Z] [LOG]    ✅ Added to weekday total: 7.833333333333333h
[2025-10-07T17:16:48.092Z] [LOG] 📅 2025-08-12 (WEEKDAY): 9.65h worked → 8.151388888888889h counted → OVERLAP 08:50-17:00 = 8.151h (attendance table)
[2025-10-07T17:16:48.092Z] [LOG]    ✅ Added to weekday total: 8.151388888888889h
[2025-10-07T17:16:48.092Z] [LOG] 📅 2025-08-13 (WEEKDAY): 8.22h worked → 7.716666666666667h counted → OVERLAP 09:17-17:00 = 7.717h (attendance table)
[2025-10-07T17:16:48.092Z] [LOG]    ✅ Added to weekday total: 7.716666666666667h
[2025-10-07T17:16:48.093Z] [LOG] 📅 2025-08-14 (WEEKDAY): 9.05h worked → 8.489166666666666h counted → OVERLAP 08:30-17:00 = 8.489h (attendance table)
[2025-10-07T17:16:48.093Z] [LOG]    ✅ Added to weekday total: 8.489166666666666h
[2025-10-07T17:16:48.093Z] [LOG] 📅 2025-08-18 (WEEKDAY): 8.82h worked → 8.316944444444445h counted → OVERLAP 08:40-17:00 = 8.317h (attendance table)
[2025-10-07T17:16:48.093Z] [LOG]    ✅ Added to weekday total: 8.316944444444445h
[2025-10-07T17:16:48.093Z] [LOG] 📅 2025-08-19 (WEEKDAY): 8.4h worked → 8.150555555555556h counted → OVERLAP 08:50-17:00 = 8.151h (attendance table)
[2025-10-07T17:16:48.093Z] [LOG]    ✅ Added to weekday total: 8.150555555555556h
[2025-10-07T17:16:48.094Z] [LOG] 📅 2025-08-20 (WEEKDAY): 8.54h worked → 8.25h counted → OVERLAP 08:45-17:00 = 8.250h (attendance table)
[2025-10-07T17:16:48.094Z] [LOG]    ✅ Added to weekday total: 8.25h
[2025-10-07T17:16:48.094Z] [LOG] 📅 2025-08-21 (WEEKDAY): 8.17h worked → 8.104444444444445h counted → OVERLAP 08:53-17:00 = 8.104h (attendance table)
[2025-10-07T17:16:48.094Z] [LOG]    ✅ Added to weekday total: 8.104444444444445h
[2025-10-07T17:16:48.094Z] [LOG] 📅 2025-08-22 (WEEKDAY): 8.54h worked → 8.25h counted → OVERLAP 08:45-17:00 = 8.250h (attendance table)
[2025-10-07T17:16:48.094Z] [LOG]    ✅ Added to weekday total: 8.25h
[2025-10-07T17:16:48.095Z] [LOG] 📅 2025-08-25 (WEEKDAY): 8.27h worked → 8.265833333333333h counted → OVERLAP 08:44-17:00 = 8.266h (attendance table)
[2025-10-07T17:16:48.095Z] [LOG]    ✅ Added to weekday total: 8.265833333333333h
[2025-10-07T17:16:48.095Z] [LOG] 📅 2025-08-26 (WEEKDAY): 7.86h worked → 7.858055555555556h counted → OVERLAP 09:08-17:00 = 7.858h (attendance table)
[2025-10-07T17:16:48.096Z] [LOG]    ✅ Added to weekday total: 7.858055555555556h
[2025-10-07T17:16:48.097Z] [LOG] 📅 2025-08-27 (WEEKDAY): 8.44h worked → 8.133611111111112h counted → OVERLAP 08:51-17:00 = 8.134h (attendance table)
[2025-10-07T17:16:48.097Z] [LOG]    ✅ Added to weekday total: 8.133611111111112h
[2025-10-07T17:16:48.097Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.2h worked → 8.1475h counted → OVERLAP 08:51-17:00 = 8.148h (attendance table)
[2025-10-07T17:16:48.097Z] [LOG]    ✅ Added to weekday total: 8.1475h
[2025-10-07T17:16:48.098Z] [LOG] 📅 2025-08-29 (WEEKDAY): 9.2h worked → 8.364444444444445h counted → OVERLAP 08:38-17:00 = 8.364h (attendance table)
[2025-10-07T17:16:48.098Z] [LOG]    ✅ Added to weekday total: 8.364444444444445h
[2025-10-07T17:16:48.098Z] [LOG] 📅 2025-08-30 (WEEKEND): 6.03h worked → 4.0311111111111115h counted → OVERLAP 08:58-13:00 = 4.031h (attendance table)
[2025-10-07T17:16:48.098Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.0311111111111115h
[2025-10-07T17:16:48.098Z] [LOG] ================================================================================
[2025-10-07T17:16:48.098Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:16:48.098Z] [LOG]    Sum of all daily counted hours (rounded): 153.7042h
[2025-10-07T17:16:48.099Z] [LOG]    Expected hours: 170h
[2025-10-07T17:16:48.099Z] [LOG]    Shortfall: 16.30h
[2025-10-07T17:16:48.099Z] [LOG] ================================================================================
[2025-10-07T17:16:48.207Z] [LOG] 🔄 Processing financial records for employee 01441e19-7105-11f0-a50f-98e743540430...
[2025-10-07T17:16:48.208Z] [LOG] 🔄 Processing financial records for employee 01441e19-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:16:48.316Z] [LOG] 📊 Found 0 active loans for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:48.425Z] [LOG] 📊 Found 0 active advances for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:48.533Z] [LOG] 📊 Found 0 approved bonuses for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:48.534Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:16:48.535Z] [LOG] 💰 GROSS CALCULATION for Sithira null:
[2025-10-07T17:16:48.535Z] [LOG]    Base Salary: 40000
[2025-10-07T17:16:48.535Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:16:48.643Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:16:48.863Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:16:49.079Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:16:49.187Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:16:49.294Z] [LOG] Employee 01441e19-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:16:49.294Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:16:49.294Z] [LOG] ============================================================
[2025-10-07T17:16:49.295Z] [LOG] 👤 Employee ID: 01441e19-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:49.295Z] [LOG] 💰 Base Salary: 40,000
[2025-10-07T17:16:49.295Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:16:49.295Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:16:49.295Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:16:49.295Z] [LOG] 💵 Per-Day Salary: 1600.00
[2025-10-07T17:16:49.295Z] [LOG] ⏱️  Hourly Rate: 188.24
[2025-10-07T17:16:49.295Z] [LOG] 
[2025-10-07T17:16:49.295Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:16:49.295Z] [LOG]    Expected Hours: 170
[2025-10-07T17:16:49.295Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:16:49.295Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:16:49.295Z] [LOG]    Worked Hours: 153.7042
[2025-10-07T17:16:49.296Z] [LOG]    ⚠️  Shortfall Hours: 16.295800000000014
[2025-10-07T17:16:49.296Z] [LOG]    💸 Shortfall Deduction: 16.295800000000014h × 188.24 = 3067.44
[2025-10-07T17:16:49.296Z] [LOG] ============================================================
[2025-10-07T17:16:49.511Z] [LOG] ✅ Weekend Day Met: 2025-08-02 (Saturday)
[2025-10-07T17:16:49.512Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:49.512Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-30 (Saturday)
[2025-10-07T17:16:49.512Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:16:49.512Z] [LOG]    Actual: 08:58:08 - 15:00:00
[2025-10-07T17:16:49.513Z] [LOG]    Calculation: OVERLAP 08:58-13:00 = 4.031h
[2025-10-07T17:16:49.513Z] [LOG]    Payable Hours: 4.031h
[2025-10-07T17:16:49.513Z] [LOG]    Shortfall: 0.469h
[2025-10-07T17:16:49.514Z] [LOG]    Hourly Rate: 355.56 (Day Salary 1600 ÷ 4.5h)
[2025-10-07T17:16:49.514Z] [LOG]    Deduction: 166.72
[2025-10-07T17:16:49.729Z] [LOG] 📅 Weekend absence check for employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:49.729Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:49.730Z] [LOG]    Attended weekend dates: 2 days
[2025-10-07T17:16:49.730Z] [LOG]    Absent weekend dates: 3 days
[2025-10-07T17:16:49.730Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:49.730Z] [LOG]    Gross Salary: 40000
[2025-10-07T17:16:49.731Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:49.731Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:49.731Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:49.732Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:49.732Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:49.732Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:49.732Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:49.733Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:49.733Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:49.733Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:49.734Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:49.734Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:49.734Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:49.734Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:49.734Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:49.734Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:49.735Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:49.735Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:49.735Z] [LOG] Regular deductions for Sithira null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:49.735Z] [LOG] Combined deductions for Sithira null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 166.71604938271588,
      "details": "Total 0.47h shortfall - 2025-08-30 (Saturday): 0.47h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 3067.4447058823557,
      "details": "16.295800000000014 hours × 188.24"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 4800,
      "details": "3 weekend days × 1600.00"
    }
  ],
  "total": 8034.160755265071
}
[2025-10-07T17:16:49.845Z] [LOG] Creating components for record 7848c2cc-032c-49c7-abdb-5b23a9f2184f: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 3,
  "taxComponentsCount": 0
}
[2025-10-07T17:16:49.846Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 166.71604938271588
}
[2025-10-07T17:16:49.954Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:16:50.063Z] [LOG] Created payroll_record_component: d7f82884-05d5-47c4-9cf6-7bd53052f86d for Weekend Shortfall Deduction
[2025-10-07T17:16:50.063Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 3067.4447058823557
}
[2025-10-07T17:16:50.171Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:50.278Z] [LOG] Created payroll_record_component: a518745a-6859-442e-bb2e-3a4f096607ad for Working Hours Shortfall
[2025-10-07T17:16:50.278Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 4800
}
[2025-10-07T17:16:50.389Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:16:50.507Z] [LOG] Created payroll_record_component: 0d166d45-a012-45c0-b259-027568f600f1 for Weekend Absent Days
[2025-10-07T17:16:50.863Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:50.864Z] [ERROR] ❌ Error updating financial balances for employee 01441e19-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:50.865Z] [LOG] ✅ Sithira null: Calculation completed successfully
[2025-10-07T17:16:50.866Z] [LOG] 📊 Progress: 20/34 (58.8%)
[2025-10-07T17:16:50.866Z] [LOG] 
🧮 Processing: Viruna Damsiha Cooray null (EMP000038)
[2025-10-07T17:16:50.867Z] [LOG] 📋 Record ID: 7bbf6b8d-eb38-48ba-b40c-06e4e453e998
[2025-10-07T17:16:51.336Z] [LOG] 🔍 Component filtering for employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:51.336Z] [LOG]    Total components: 8
[2025-10-07T17:16:51.336Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:51.336Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-07T17:16:52.011Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:52.231Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:52.446Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:52.662Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:52.881Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:53.107Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:53.331Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:53.551Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:53.768Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:53.984Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:54.201Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:54.417Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:54.643Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:54.865Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:55.083Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:55.301Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:55.518Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:55.734Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:55.951Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:56.177Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:16:56.298Z] [LOG] 🔍 Fetched 25 attendance records for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:56.415Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:16:56.979Z] [LOG] Employee 01441633-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:16:56.980Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:16:56.980Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:16:56.981Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:16:56.982Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:56.982Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:16:56.982Z] [LOG] ================================================================================
[2025-10-07T17:16:56.983Z] [LOG] 📅 2025-08-01 (WEEKDAY): 8.87h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.983Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.984Z] [LOG] 📅 2025-08-02 (WEEKEND): 4.92h worked → 4.25h counted → OVERLAP 08:45-13:00 = 4.250h (attendance table)
[2025-10-07T17:16:56.984Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.25h
[2025-10-07T17:16:56.985Z] [LOG] 📅 2025-08-04 (WEEKDAY): 10.98h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.985Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.985Z] [LOG] 📅 2025-08-05 (WEEKDAY): 9.25h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.986Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.986Z] [LOG] 📅 2025-08-06 (WEEKDAY): 10.31h worked → 8.401666666666667h counted → OVERLAP 08:35-17:00 = 8.402h (attendance table)
[2025-10-07T17:16:56.987Z] [LOG]    ✅ Added to weekday total: 8.401666666666667h
[2025-10-07T17:16:56.987Z] [LOG] 📅 2025-08-07 (WEEKDAY): 9h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.987Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.988Z] [LOG] 📅 2025-08-09 (WEEKEND): 7.28h worked → 3.9252777777777776h counted → OVERLAP 09:04-13:00 = 3.925h (attendance table)
[2025-10-07T17:16:56.988Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.9252777777777776h
[2025-10-07T17:16:56.988Z] [LOG] 📅 2025-08-11 (WEEKDAY): 10.54h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.988Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.989Z] [LOG] 📅 2025-08-12 (WEEKDAY): 10.98h worked → 8.364444444444445h counted → OVERLAP 08:38-17:00 = 8.364h (attendance table)
[2025-10-07T17:16:56.989Z] [LOG]    ✅ Added to weekday total: 8.364444444444445h
[2025-10-07T17:16:56.989Z] [LOG] 📅 2025-08-13 (WEEKDAY): 9.08h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.989Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.990Z] [LOG] 📅 2025-08-14 (WEEKDAY): 10.56h worked → 8.4925h counted → OVERLAP 08:30-17:00 = 8.492h (attendance table)
[2025-10-07T17:16:56.990Z] [LOG]    ✅ Added to weekday total: 8.4925h
[2025-10-07T17:16:56.990Z] [LOG] 📅 2025-08-15 (WEEKDAY): 11.08h worked → 8.22888888888889h counted → OVERLAP 08:46-17:00 = 8.229h (attendance table)
[2025-10-07T17:16:56.990Z] [LOG]    ✅ Added to weekday total: 8.22888888888889h
[2025-10-07T17:16:56.991Z] [LOG] 📅 2025-08-16 (WEEKEND): 6.92h worked → 4.394166666666667h counted → OVERLAP 08:36-13:00 = 4.394h (attendance table)
[2025-10-07T17:16:56.991Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.394166666666667h
[2025-10-07T17:16:56.992Z] [LOG] 📅 2025-08-18 (WEEKDAY): 10.85h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.992Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.992Z] [LOG] 📅 2025-08-19 (WEEKDAY): 11.01h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.992Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.992Z] [LOG] 📅 2025-08-20 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.993Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.993Z] [LOG] 📅 2025-08-21 (WEEKDAY): 10.01h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.993Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.993Z] [LOG] 📅 2025-08-22 (WEEKDAY): 9.75h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.994Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.994Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:16:56.994Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:16:56.994Z] [LOG] 📅 2025-08-25 (WEEKDAY): 9.27h worked → 8.393333333333333h counted → OVERLAP 08:36-17:00 = 8.393h (attendance table)
[2025-10-07T17:16:56.994Z] [LOG]    ✅ Added to weekday total: 8.393333333333333h
[2025-10-07T17:16:56.994Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.72h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:16:56.995Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:16:56.995Z] [LOG] 📅 2025-08-27 (WEEKDAY): 6.66h worked → 5.5075h counted → OVERLAP 11:29-17:00 = 5.508h (attendance table)
[2025-10-07T17:16:56.995Z] [LOG]    ✅ Added to weekday total: 5.5075h
[2025-10-07T17:16:56.995Z] [LOG] 📅 2025-08-28 (WEEKDAY): 9.56h worked → 7.801944444444445h counted → OVERLAP 09:11-17:00 = 7.802h (attendance table)
[2025-10-07T17:16:56.995Z] [LOG]    ✅ Added to weekday total: 7.801944444444445h
[2025-10-07T17:16:56.996Z] [LOG] 📅 2025-08-29 (WEEKDAY): 10.91h worked → 8.240277777777777h counted → OVERLAP 08:45-17:00 = 8.240h (attendance table)
[2025-10-07T17:16:56.996Z] [LOG]    ✅ Added to weekday total: 8.240277777777777h
[2025-10-07T17:16:56.996Z] [LOG] 📅 2025-08-30 (WEEKEND): 5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:16:56.996Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:16:56.996Z] [LOG] ================================================================================
[2025-10-07T17:16:56.996Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:16:56.996Z] [LOG]    Sum of all daily counted hours (rounded): 165.4306h
[2025-10-07T17:16:56.997Z] [LOG]    Expected hours: 170h
[2025-10-07T17:16:56.997Z] [LOG]    Shortfall: 4.57h
[2025-10-07T17:16:56.997Z] [LOG] ================================================================================
[2025-10-07T17:16:57.107Z] [LOG] 🔄 Processing financial records for employee 01441633-7105-11f0-a50f-98e743540430...
[2025-10-07T17:16:57.107Z] [LOG] 🔄 Processing financial records for employee 01441633-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:16:57.218Z] [LOG] 📊 Found 0 active loans for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:57.326Z] [LOG] 📊 Found 0 active advances for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:57.435Z] [LOG] 📊 Found 0 approved bonuses for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:57.436Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:16:57.436Z] [LOG] 💰 GROSS CALCULATION for Viruna Damsiha Cooray null:
[2025-10-07T17:16:57.437Z] [LOG]    Base Salary: 50000
[2025-10-07T17:16:57.437Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:16:57.545Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:16:57.761Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:16:57.979Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:16:58.087Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:16:58.195Z] [LOG] Employee 01441633-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:16:58.196Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:16:58.196Z] [LOG] ============================================================
[2025-10-07T17:16:58.197Z] [LOG] 👤 Employee ID: 01441633-7105-11f0-a50f-98e743540430
[2025-10-07T17:16:58.197Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:16:58.197Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:16:58.198Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:16:58.198Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:16:58.198Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:16:58.198Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:16:58.199Z] [LOG] 
[2025-10-07T17:16:58.199Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:16:58.200Z] [LOG]    Expected Hours: 170
[2025-10-07T17:16:58.200Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:16:58.201Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:16:58.201Z] [LOG]    Worked Hours: 165.4306
[2025-10-07T17:16:58.201Z] [LOG]    ⚠️  Shortfall Hours: 4.569400000000002
[2025-10-07T17:16:58.201Z] [LOG]    💸 Shortfall Deduction: 4.569400000000002h × 235.29 = 1075.15
[2025-10-07T17:16:58.202Z] [LOG] ============================================================
[2025-10-07T17:16:58.422Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-02 (Saturday)
[2025-10-07T17:16:58.422Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:16:58.422Z] [LOG]    Actual: 08:45:00 - 13:40:00
[2025-10-07T17:16:58.422Z] [LOG]    Calculation: OVERLAP 08:45-13:00 = 4.250h
[2025-10-07T17:16:58.423Z] [LOG]    Payable Hours: 4.250h
[2025-10-07T17:16:58.423Z] [LOG]    Shortfall: 0.250h
[2025-10-07T17:16:58.423Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:16:58.423Z] [LOG]    Deduction: 111.11
[2025-10-07T17:16:58.423Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-09 (Saturday)
[2025-10-07T17:16:58.423Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:16:58.424Z] [LOG]    Actual: 09:04:29 - 16:21:17
[2025-10-07T17:16:58.424Z] [LOG]    Calculation: OVERLAP 09:04-13:00 = 3.925h
[2025-10-07T17:16:58.424Z] [LOG]    Payable Hours: 3.925h
[2025-10-07T17:16:58.424Z] [LOG]    Shortfall: 0.575h
[2025-10-07T17:16:58.424Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:16:58.425Z] [LOG]    Deduction: 255.43
[2025-10-07T17:16:58.425Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-16 (Saturday)
[2025-10-07T17:16:58.425Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:16:58.425Z] [LOG]    Actual: 08:36:21 - 15:31:21
[2025-10-07T17:16:58.425Z] [LOG]    Calculation: OVERLAP 08:36-13:00 = 4.394h
[2025-10-07T17:16:58.425Z] [LOG]    Payable Hours: 4.394h
[2025-10-07T17:16:58.426Z] [LOG]    Shortfall: 0.106h
[2025-10-07T17:16:58.426Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:16:58.426Z] [LOG]    Deduction: 47.04
[2025-10-07T17:16:58.426Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:16:58.426Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:58.426Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:16:58.427Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:16:58.646Z] [LOG] 📅 Weekend absence check for employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:58.646Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:16:58.647Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:16:58.647Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:16:58.648Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:16:58.648Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:16:58.648Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:16:58.648Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:16:58.648Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:58.648Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:16:58.649Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:58.649Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:16:58.649Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:58.649Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:16:58.649Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:58.650Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:16:58.650Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:58.650Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:16:58.650Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:58.651Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:16:58.651Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:58.651Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:16:58.651Z] [LOG]    Fixed amount: 0
[2025-10-07T17:16:58.651Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:16:58.651Z] [LOG] Regular deductions for Viruna Damsiha Cooray null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:16:58.652Z] [LOG] Combined deductions for Viruna Damsiha Cooray null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 413.5802469135802,
      "details": "Total 0.93h shortfall - 2025-08-02 (Saturday): 0.25h, 2025-08-09 (Saturday): 0.57h, 2025-08-16 (Saturday): 0.11h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 1075.152941176471,
      "details": "4.569400000000002 hours × 235.29"
    }
  ],
  "total": 1488.733188090051
}
[2025-10-07T17:16:58.760Z] [LOG] Creating components for record 7bbf6b8d-eb38-48ba-b40c-06e4e453e998: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:16:58.760Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 413.5802469135802
}
[2025-10-07T17:16:58.869Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:16:58.977Z] [LOG] Created payroll_record_component: 07d602b8-7c7b-4fd1-b5b2-9464b9b2936c for Weekend Shortfall Deduction
[2025-10-07T17:16:58.977Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 1075.152941176471
}
[2025-10-07T17:16:59.085Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:16:59.193Z] [LOG] Created payroll_record_component: c3643069-092a-4f16-8907-f703b142a16e for Working Hours Shortfall
[2025-10-07T17:16:59.517Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:59.519Z] [ERROR] ❌ Error updating financial balances for employee 01441633-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:16:59.519Z] [LOG] ✅ Viruna Damsiha Cooray null: Calculation completed successfully
[2025-10-07T17:16:59.519Z] [LOG] 📊 Progress: 21/34 (61.8%)
[2025-10-07T17:16:59.520Z] [LOG] 
🧮 Processing: Ruvindu Hewabandu null (EMP000027)
[2025-10-07T17:16:59.520Z] [LOG] 📋 Record ID: 81d1a02a-cae5-41f0-813d-3e9e1ae6e737
[2025-10-07T17:16:59.961Z] [LOG] 🔍 Component filtering for employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-07T17:16:59.961Z] [LOG]    Total components: 8
[2025-10-07T17:16:59.961Z] [LOG]    Applicable components: 8
[2025-10-07T17:16:59.962Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-07T17:17:00.539Z] [LOG] 🔍 Fetched 0 attendance records for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:00.540Z] [LOG] ⚠️  ATTENTION: Employee 0143e915-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:17:00.648Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:01.296Z] [LOG] Employee 0143e915-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:17:01.297Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:17:01.297Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:01.298Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:01.299Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:01.300Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:01.300Z] [LOG] ================================================================================
[2025-10-07T17:17:01.301Z] [LOG] ================================================================================
[2025-10-07T17:17:01.301Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:01.302Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:17:01.302Z] [LOG]    Expected hours: 160h
[2025-10-07T17:17:01.302Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:17:01.302Z] [LOG] ================================================================================
[2025-10-07T17:17:01.411Z] [LOG] 🔄 Processing financial records for employee 0143e915-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:01.412Z] [LOG] 🔄 Processing financial records for employee 0143e915-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:01.520Z] [LOG] 📊 Found 0 active loans for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:01.636Z] [LOG] 📊 Found 0 active advances for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:01.745Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:01.746Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:01.746Z] [LOG] 💰 GROSS CALCULATION for Ruvindu Hewabandu null:
[2025-10-07T17:17:01.747Z] [LOG]    Base Salary: 0
[2025-10-07T17:17:01.747Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:01.857Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:02.076Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:02.293Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:02.402Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:02.618Z] [LOG] Employee 0143e915-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:17:02.619Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:02.619Z] [LOG] ============================================================
[2025-10-07T17:17:02.619Z] [LOG] 👤 Employee ID: 0143e915-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:02.619Z] [LOG] 💰 Base Salary: 0
[2025-10-07T17:17:02.620Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:02.620Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:02.620Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:17:02.620Z] [LOG] 💵 Per-Day Salary: 0.00
[2025-10-07T17:17:02.620Z] [LOG] ⏱️  Hourly Rate: 0.00
[2025-10-07T17:17:02.621Z] [LOG] 
[2025-10-07T17:17:02.621Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:02.621Z] [LOG]    Expected Hours: 160
[2025-10-07T17:17:02.621Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:17:02.621Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:02.622Z] [LOG]    Worked Hours: 0
[2025-10-07T17:17:02.622Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:17:02.622Z] [LOG]    💸 Shortfall Deduction: 160h × 0.00 = 0.00
[2025-10-07T17:17:02.622Z] [LOG] ============================================================
[2025-10-07T17:17:03.057Z] [LOG] 📅 Weekend absence check for employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:03.058Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:03.058Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:17:03.059Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:17:03.059Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:03.059Z] [LOG]    Gross Salary: 0
[2025-10-07T17:17:03.060Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:03.060Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:03.060Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:03.061Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:03.061Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:03.062Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:03.062Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:03.062Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:03.063Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:03.063Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:03.063Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:03.064Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:03.064Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:03.064Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:03.064Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:03.065Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:03.065Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:03.065Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:03.065Z] [LOG] Regular deductions for Ruvindu Hewabandu null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:03.066Z] [LOG] Combined deductions for Ruvindu Hewabandu null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 0,
      "details": "160 hours × 0.00"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 0,
      "details": "5 weekend days × 0.00"
    }
  ],
  "total": 0
}
[2025-10-07T17:17:03.175Z] [LOG] Creating components for record 81d1a02a-cae5-41f0-813d-3e9e1ae6e737: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:03.176Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 0
}
[2025-10-07T17:17:03.285Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:17:03.393Z] [LOG] Created payroll_record_component: 7cb607ce-54ff-48a0-b59b-413889d7196a for Working Hours Shortfall
[2025-10-07T17:17:03.393Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 0
}
[2025-10-07T17:17:03.500Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:17:03.619Z] [LOG] Created payroll_record_component: 94780d3b-69cc-4977-98a1-af56df867bfc for Weekend Absent Days
[2025-10-07T17:17:03.942Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:03.943Z] [ERROR] ❌ Error updating financial balances for employee 0143e915-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:03.944Z] [LOG] ✅ Ruvindu Hewabandu null: Calculation completed successfully
[2025-10-07T17:17:03.944Z] [LOG] 📊 Progress: 22/34 (64.7%)
[2025-10-07T17:17:03.945Z] [LOG] 
🧮 Processing: Office Team null (EMP000041)
[2025-10-07T17:17:03.945Z] [LOG] 📋 Record ID: 8c6ad298-7e2a-43bb-b248-3d8ec5abbd38
[2025-10-07T17:17:04.378Z] [LOG] 🔍 Component filtering for employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:04.378Z] [LOG]    Total components: 8
[2025-10-07T17:17:04.378Z] [LOG]    Applicable components: 8
[2025-10-07T17:17:04.379Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-07T17:17:04.930Z] [LOG] 🔍 Fetched 0 attendance records for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:04.931Z] [LOG] ⚠️  ATTENTION: Employee 01442b21-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:17:05.040Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:05.696Z] [LOG] Employee 01442b21-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:17:05.696Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:17:05.697Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:05.697Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:05.698Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:05.699Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:05.699Z] [LOG] ================================================================================
[2025-10-07T17:17:05.700Z] [LOG] ================================================================================
[2025-10-07T17:17:05.700Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:05.701Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:17:05.701Z] [LOG]    Expected hours: 160h
[2025-10-07T17:17:05.702Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:17:05.702Z] [LOG] ================================================================================
[2025-10-07T17:17:05.811Z] [LOG] 🔄 Processing financial records for employee 01442b21-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:05.811Z] [LOG] 🔄 Processing financial records for employee 01442b21-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:05.920Z] [LOG] 📊 Found 0 active loans for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:06.028Z] [LOG] 📊 Found 0 active advances for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:06.138Z] [LOG] 📊 Found 0 approved bonuses for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:06.138Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:06.139Z] [LOG] 💰 GROSS CALCULATION for Office Team null:
[2025-10-07T17:17:06.139Z] [LOG]    Base Salary: 1
[2025-10-07T17:17:06.139Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:06.248Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:06.463Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:06.693Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:06.809Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:07.045Z] [LOG] Employee 01442b21-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:17:07.045Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:07.046Z] [LOG] ============================================================
[2025-10-07T17:17:07.046Z] [LOG] 👤 Employee ID: 01442b21-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:07.046Z] [LOG] 💰 Base Salary: 1
[2025-10-07T17:17:07.047Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:07.047Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:07.047Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:17:07.048Z] [LOG] 💵 Per-Day Salary: 0.04
[2025-10-07T17:17:07.048Z] [LOG] ⏱️  Hourly Rate: 0.01
[2025-10-07T17:17:07.048Z] [LOG] 
[2025-10-07T17:17:07.049Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:07.049Z] [LOG]    Expected Hours: 160
[2025-10-07T17:17:07.049Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:17:07.050Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:07.050Z] [LOG]    Worked Hours: 0
[2025-10-07T17:17:07.051Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:17:07.051Z] [LOG]    💸 Shortfall Deduction: 160h × 0.01 = 0.80
[2025-10-07T17:17:07.051Z] [LOG] ============================================================
[2025-10-07T17:17:07.498Z] [LOG] 📅 Weekend absence check for employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:07.499Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:07.499Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:17:07.500Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:17:07.501Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:07.501Z] [LOG]    Gross Salary: 1
[2025-10-07T17:17:07.502Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:07.502Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:07.503Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:07.503Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:07.503Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:07.503Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:07.504Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:07.504Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:07.504Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:07.504Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:07.505Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:07.505Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:07.505Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:07.506Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:07.506Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:07.506Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:07.506Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:07.506Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:07.506Z] [LOG] Regular deductions for Office Team null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:07.507Z] [LOG] Combined deductions for Office Team null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 0.8,
      "details": "160 hours × 0.01"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 0.2,
      "details": "5 weekend days × 0.04"
    }
  ],
  "total": 1
}
[2025-10-07T17:17:07.615Z] [LOG] Creating components for record 8c6ad298-7e2a-43bb-b248-3d8ec5abbd38: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:07.616Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 0.8
}
[2025-10-07T17:17:07.724Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:17:07.831Z] [LOG] Created payroll_record_component: 6f2cf414-5e31-4481-84ac-299c955d6455 for Working Hours Shortfall
[2025-10-07T17:17:07.831Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 0.2
}
[2025-10-07T17:17:07.939Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:17:08.047Z] [LOG] Created payroll_record_component: 7c54aa68-0f68-4036-be56-c02e8d7e229e for Weekend Absent Days
[2025-10-07T17:17:08.370Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:08.371Z] [ERROR] ❌ Error updating financial balances for employee 01442b21-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:08.372Z] [LOG] ✅ Office Team null: Calculation completed successfully
[2025-10-07T17:17:08.373Z] [LOG] 📊 Progress: 23/34 (67.6%)
[2025-10-07T17:17:08.373Z] [LOG] 
🧮 Processing: Shandeep null (EMP000034)
[2025-10-07T17:17:08.374Z] [LOG] 📋 Record ID: 97ae0ea2-886e-44e2-b9ce-2a2c6a0067ae
[2025-10-07T17:17:08.823Z] [LOG] 🔍 Component filtering for employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:08.823Z] [LOG]    Total components: 8
[2025-10-07T17:17:08.823Z] [LOG]    Applicable components: 8
[2025-10-07T17:17:08.823Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-07T17:17:09.472Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:09.687Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:09.904Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:10.120Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:10.352Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:10.579Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:10.797Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:11.013Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:11.229Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:11.455Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:11.678Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:11.901Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:12.010Z] [LOG] 🔍 Fetched 23 attendance records for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:12.127Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:12.702Z] [LOG] Employee 0143fc5a-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:12.703Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:17:12.703Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:12.704Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:12.705Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:12.705Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:12.705Z] [LOG] ================================================================================
[2025-10-07T17:17:12.706Z] [LOG] 📅 2025-08-01 (WEEKDAY): 8.53h worked → 7.9319444444444445h counted → OVERLAP 09:04-17:00 = 7.932h (attendance table)
[2025-10-07T17:17:12.706Z] [LOG]    ✅ Added to weekday total: 7.9319444444444445h
[2025-10-07T17:17:12.706Z] [LOG] 📅 2025-08-02 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:12.706Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:12.707Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.73h worked → 8h counted → OVERLAP 09:00-17:00 = 8.000h (attendance table)
[2025-10-07T17:17:12.707Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:17:12.707Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.07h worked → 7.886388888888889h counted → OVERLAP 09:06-17:00 = 7.886h (attendance table)
[2025-10-07T17:17:12.707Z] [LOG]    ✅ Added to weekday total: 7.886388888888889h
[2025-10-07T17:17:12.708Z] [LOG] 📅 2025-08-06 (WEEKDAY): 8.75h worked → 8.083333333333334h counted → OVERLAP 08:55-17:00 = 8.083h (attendance table)
[2025-10-07T17:17:12.708Z] [LOG]    ✅ Added to weekday total: 8.083333333333334h
[2025-10-07T17:17:12.708Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.82h worked → 8.166666666666666h counted → OVERLAP 08:50-17:00 = 8.167h (attendance table)
[2025-10-07T17:17:12.708Z] [LOG]    ✅ Added to weekday total: 8.166666666666666h
[2025-10-07T17:17:12.709Z] [LOG] 📅 2025-08-09 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:12.709Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:12.709Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8.92h worked → 7.916666666666667h counted → OVERLAP 09:05-17:00 = 7.917h (attendance table)
[2025-10-07T17:17:12.709Z] [LOG]    ✅ Added to weekday total: 7.916666666666667h
[2025-10-07T17:17:12.710Z] [LOG] 📅 2025-08-12 (WEEKDAY): 9.33h worked → 8.333333333333334h counted → OVERLAP 08:40-17:00 = 8.333h (attendance table)
[2025-10-07T17:17:12.710Z] [LOG]    ✅ Added to weekday total: 8.333333333333334h
[2025-10-07T17:17:12.710Z] [LOG] 📅 2025-08-13 (WEEKDAY): 8.75h worked → 8.25h counted → OVERLAP 08:45-17:00 = 8.250h (attendance table)
[2025-10-07T17:17:12.710Z] [LOG]    ✅ Added to weekday total: 8.25h
[2025-10-07T17:17:12.710Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.71h worked → 8.212222222222222h counted → OVERLAP 08:47-17:00 = 8.212h (attendance table)
[2025-10-07T17:17:12.711Z] [LOG]    ✅ Added to weekday total: 8.212222222222222h
[2025-10-07T17:17:12.711Z] [LOG] 📅 2025-08-15 (WEEKDAY): 8.67h worked → 8.166666666666666h counted → OVERLAP 08:50-17:00 = 8.167h (attendance table)
[2025-10-07T17:17:12.711Z] [LOG]    ✅ Added to weekday total: 8.166666666666666h
[2025-10-07T17:17:12.711Z] [LOG] 📅 2025-08-16 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:12.711Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:12.712Z] [LOG] 📅 2025-08-18 (WEEKDAY): 8.67h worked → 8.166666666666666h counted → OVERLAP 08:50-17:00 = 8.167h (attendance table)
[2025-10-07T17:17:12.712Z] [LOG]    ✅ Added to weekday total: 8.166666666666666h
[2025-10-07T17:17:12.712Z] [LOG] 📅 2025-08-19 (WEEKDAY): 8.68h worked → 8.166666666666666h counted → OVERLAP 08:50-17:00 = 8.167h (attendance table)
[2025-10-07T17:17:12.712Z] [LOG]    ✅ Added to weekday total: 8.166666666666666h
[2025-10-07T17:17:12.712Z] [LOG] 📅 2025-08-20 (WEEKDAY): 7.89h worked → 7.525h counted → OVERLAP 09:28-17:00 = 7.525h (attendance table)
[2025-10-07T17:17:12.712Z] [LOG]    ✅ Added to weekday total: 7.525h
[2025-10-07T17:17:12.713Z] [LOG] 📅 2025-08-22 (WEEKDAY): 7.95h worked → 7.451388888888889h counted → OVERLAP 09:32-17:00 = 7.451h (attendance table)
[2025-10-07T17:17:12.713Z] [LOG]    ✅ Added to weekday total: 7.451388888888889h
[2025-10-07T17:17:12.713Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:12.713Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:12.713Z] [LOG] 📅 2025-08-25 (WEEKDAY): 8h worked → 8h counted → OVERLAP 09:00-17:00 = 8.000h (attendance table)
[2025-10-07T17:17:12.713Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:17:12.714Z] [LOG] 📅 2025-08-26 (WEEKDAY): 4h worked → 3.5h counted → OVERLAP 13:30-17:00 = 3.500h (attendance table)
[2025-10-07T17:17:12.714Z] [LOG]    ✅ Added to weekday total: 3.5h
[2025-10-07T17:17:12.714Z] [LOG] 📅 2025-08-27 (WEEKDAY): 8.67h worked → 8.083333333333334h counted → OVERLAP 08:55-17:00 = 8.083h (attendance table)
[2025-10-07T17:17:12.714Z] [LOG]    ✅ Added to weekday total: 8.083333333333334h
[2025-10-07T17:17:12.715Z] [LOG] 📅 2025-08-28 (WEEKDAY): 7.5h worked → 7.5h counted → OVERLAP 09:30-17:00 = 7.500h (attendance table)
[2025-10-07T17:17:12.715Z] [LOG]    ✅ Added to weekday total: 7.5h
[2025-10-07T17:17:12.715Z] [LOG] 📅 2025-08-30 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:12.715Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:12.715Z] [LOG] ================================================================================
[2025-10-07T17:17:12.715Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:12.715Z] [LOG]    Sum of all daily counted hours (rounded): 139.3403h
[2025-10-07T17:17:12.715Z] [LOG]    Expected hours: 170h
[2025-10-07T17:17:12.715Z] [LOG]    Shortfall: 30.66h
[2025-10-07T17:17:12.715Z] [LOG] ================================================================================
[2025-10-07T17:17:12.842Z] [LOG] 🔄 Processing financial records for employee 0143fc5a-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:12.843Z] [LOG] 🔄 Processing financial records for employee 0143fc5a-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:12.951Z] [LOG] 📊 Found 0 active loans for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:13.072Z] [LOG] 📊 Found 0 active advances for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:13.187Z] [LOG] 📊 Found 0 approved bonuses for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:13.187Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:13.188Z] [LOG] 💰 GROSS CALCULATION for Shandeep null:
[2025-10-07T17:17:13.188Z] [LOG]    Base Salary: 80000
[2025-10-07T17:17:13.188Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:13.306Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:13.543Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:13.768Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:13.875Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:13.983Z] [LOG] Employee 0143fc5a-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:13.983Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:13.983Z] [LOG] ============================================================
[2025-10-07T17:17:13.984Z] [LOG] 👤 Employee ID: 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:13.984Z] [LOG] 💰 Base Salary: 80,000
[2025-10-07T17:17:13.984Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:13.984Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:13.984Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:17:13.984Z] [LOG] 💵 Per-Day Salary: 3200.00
[2025-10-07T17:17:13.984Z] [LOG] ⏱️  Hourly Rate: 376.47
[2025-10-07T17:17:13.985Z] [LOG] 
[2025-10-07T17:17:13.985Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:13.985Z] [LOG]    Expected Hours: 170
[2025-10-07T17:17:13.985Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:17:13.985Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:13.985Z] [LOG]    Worked Hours: 139.3403
[2025-10-07T17:17:13.985Z] [LOG]    ⚠️  Shortfall Hours: 30.659699999999987
[2025-10-07T17:17:13.985Z] [LOG]    💸 Shortfall Deduction: 30.659699999999987h × 376.47 = 11542.48
[2025-10-07T17:17:13.986Z] [LOG] ============================================================
[2025-10-07T17:17:14.201Z] [LOG] ✅ Weekend Day Met: 2025-08-02 (Saturday)
[2025-10-07T17:17:14.201Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:14.202Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:17:14.202Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:14.203Z] [LOG] ✅ Weekend Day Met: 2025-08-16 (Saturday)
[2025-10-07T17:17:14.203Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:14.203Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:17:14.204Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:14.204Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:17:14.205Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:14.421Z] [LOG] 📅 Weekend absence check for employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:14.422Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:14.422Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:17:14.422Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:17:14.423Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:14.423Z] [LOG]    Gross Salary: 80000
[2025-10-07T17:17:14.423Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:14.424Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:14.424Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:14.424Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:14.425Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:14.425Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:14.425Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:14.426Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:14.426Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:14.426Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:14.427Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:14.427Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:14.427Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:14.428Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:14.428Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:14.428Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:14.428Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:14.429Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:14.429Z] [LOG] Regular deductions for Shandeep null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:14.429Z] [LOG] Combined deductions for Shandeep null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 11542.475294117643,
      "details": "30.659699999999987 hours × 376.47"
    }
  ],
  "total": 11542.475294117643
}
[2025-10-07T17:17:14.537Z] [LOG] Creating components for record 97ae0ea2-886e-44e2-b9ce-2a2c6a0067ae: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:14.538Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 11542.475294117643
}
[2025-10-07T17:17:14.647Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:17:14.755Z] [LOG] Created payroll_record_component: d77d47b2-fe1c-40bf-97fc-95f505d6f21a for Working Hours Shortfall
[2025-10-07T17:17:15.081Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:15.082Z] [ERROR] ❌ Error updating financial balances for employee 0143fc5a-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:15.083Z] [LOG] ✅ Shandeep null: Calculation completed successfully
[2025-10-07T17:17:15.083Z] [LOG] 📊 Progress: 24/34 (70.6%)
[2025-10-07T17:17:15.084Z] [LOG] 
🧮 Processing: Sujevan Selvaratnam null (EMP000026)
[2025-10-07T17:17:15.084Z] [LOG] 📋 Record ID: 9b73c8e7-c674-431b-846a-8896cda7e0f8
[2025-10-07T17:17:15.550Z] [LOG] 🔍 Component filtering for employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:15.550Z] [LOG]    Total components: 8
[2025-10-07T17:17:15.550Z] [LOG]    Applicable components: 8
[2025-10-07T17:17:15.551Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-07T17:17:16.127Z] [LOG] 🔍 Fetched 0 attendance records for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:16.127Z] [LOG] ⚠️  ATTENTION: Employee 0143e6c3-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:17:16.237Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:16.885Z] [LOG] Employee 0143e6c3-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:17:16.886Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:17:16.886Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:16.887Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:16.888Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:16.888Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:16.889Z] [LOG] ================================================================================
[2025-10-07T17:17:16.889Z] [LOG] ================================================================================
[2025-10-07T17:17:16.889Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:16.890Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:17:16.890Z] [LOG]    Expected hours: 160h
[2025-10-07T17:17:16.890Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:17:16.890Z] [LOG] ================================================================================
[2025-10-07T17:17:16.998Z] [LOG] 🔄 Processing financial records for employee 0143e6c3-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:16.998Z] [LOG] 🔄 Processing financial records for employee 0143e6c3-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:17.106Z] [LOG] 📊 Found 0 active loans for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:17.214Z] [LOG] 📊 Found 0 active advances for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:17.323Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:17.324Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:17.325Z] [LOG] 💰 GROSS CALCULATION for Sujevan Selvaratnam null:
[2025-10-07T17:17:17.325Z] [LOG]    Base Salary: 1
[2025-10-07T17:17:17.325Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:17.439Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:17.653Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:17.872Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:17.980Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:18.195Z] [LOG] Employee 0143e6c3-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:17:18.196Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:18.196Z] [LOG] ============================================================
[2025-10-07T17:17:18.197Z] [LOG] 👤 Employee ID: 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:18.197Z] [LOG] 💰 Base Salary: 1
[2025-10-07T17:17:18.197Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:18.198Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:18.198Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:17:18.198Z] [LOG] 💵 Per-Day Salary: 0.04
[2025-10-07T17:17:18.199Z] [LOG] ⏱️  Hourly Rate: 0.01
[2025-10-07T17:17:18.199Z] [LOG] 
[2025-10-07T17:17:18.199Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:18.199Z] [LOG]    Expected Hours: 160
[2025-10-07T17:17:18.200Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:17:18.200Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:18.200Z] [LOG]    Worked Hours: 0
[2025-10-07T17:17:18.200Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:17:18.201Z] [LOG]    💸 Shortfall Deduction: 160h × 0.01 = 0.80
[2025-10-07T17:17:18.201Z] [LOG] ============================================================
[2025-10-07T17:17:18.634Z] [LOG] 📅 Weekend absence check for employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:18.635Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:18.635Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:17:18.635Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:17:18.635Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:18.635Z] [LOG]    Gross Salary: 1
[2025-10-07T17:17:18.635Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:18.635Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:18.636Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:18.636Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:18.636Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:18.636Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:18.636Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:18.636Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:18.637Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:18.637Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:18.637Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:18.637Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:18.637Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:18.637Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:18.637Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:18.638Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:18.638Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:18.638Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:18.638Z] [LOG] Regular deductions for Sujevan Selvaratnam null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:18.638Z] [LOG] Combined deductions for Sujevan Selvaratnam null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 0.8,
      "details": "160 hours × 0.01"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 0.2,
      "details": "5 weekend days × 0.04"
    }
  ],
  "total": 1
}
[2025-10-07T17:17:18.747Z] [LOG] Creating components for record 9b73c8e7-c674-431b-846a-8896cda7e0f8: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:18.748Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 0.8
}
[2025-10-07T17:17:18.858Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:17:18.976Z] [LOG] Created payroll_record_component: 3ab1b0ca-7214-495f-95a9-a40bc53cdbed for Working Hours Shortfall
[2025-10-07T17:17:18.976Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 0.2
}
[2025-10-07T17:17:19.094Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:17:19.213Z] [LOG] Created payroll_record_component: 9a518814-6a45-4a8b-8730-733361e30509 for Weekend Absent Days
[2025-10-07T17:17:19.566Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:19.568Z] [ERROR] ❌ Error updating financial balances for employee 0143e6c3-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:19.569Z] [LOG] ✅ Sujevan Selvaratnam null: Calculation completed successfully
[2025-10-07T17:17:19.569Z] [LOG] 📊 Progress: 25/34 (73.5%)
[2025-10-07T17:17:19.569Z] [LOG] 
🧮 Processing: Saruban null (EMP000007)
[2025-10-07T17:17:19.570Z] [LOG] 📋 Record ID: adbe99cc-32d3-4359-9c9e-adaa19bcf62a
[2025-10-07T17:17:20.003Z] [LOG] 🔍 Component filtering for employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:20.004Z] [LOG]    Total components: 8
[2025-10-07T17:17:20.004Z] [LOG]    Applicable components: 8
[2025-10-07T17:17:20.004Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-07T17:17:20.544Z] [LOG] 🔍 Fetched 0 attendance records for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:20.544Z] [LOG] ⚠️  ATTENTION: Employee 0143a6e3-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:17:20.653Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:21.339Z] [LOG] Employee 0143a6e3-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:17:21.339Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:17:21.340Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:21.340Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:21.341Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:21.342Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:21.342Z] [LOG] ================================================================================
[2025-10-07T17:17:21.342Z] [LOG] ================================================================================
[2025-10-07T17:17:21.343Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:21.343Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:17:21.343Z] [LOG]    Expected hours: 160h
[2025-10-07T17:17:21.344Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:17:21.344Z] [LOG] ================================================================================
[2025-10-07T17:17:21.452Z] [LOG] 🔄 Processing financial records for employee 0143a6e3-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:21.453Z] [LOG] 🔄 Processing financial records for employee 0143a6e3-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:21.562Z] [LOG] 📊 Found 0 active loans for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:21.670Z] [LOG] 📊 Found 0 active advances for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:21.778Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:21.779Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:21.780Z] [LOG] 💰 GROSS CALCULATION for Saruban null:
[2025-10-07T17:17:21.780Z] [LOG]    Base Salary: 0
[2025-10-07T17:17:21.780Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:21.888Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:22.102Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:22.323Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:22.432Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:22.648Z] [LOG] Employee 0143a6e3-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:17:22.649Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:22.649Z] [LOG] ============================================================
[2025-10-07T17:17:22.649Z] [LOG] 👤 Employee ID: 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:22.650Z] [LOG] 💰 Base Salary: 0
[2025-10-07T17:17:22.650Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:22.650Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:22.651Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:17:22.651Z] [LOG] 💵 Per-Day Salary: 0.00
[2025-10-07T17:17:22.651Z] [LOG] ⏱️  Hourly Rate: 0.00
[2025-10-07T17:17:22.652Z] [LOG] 
[2025-10-07T17:17:22.652Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:22.652Z] [LOG]    Expected Hours: 160
[2025-10-07T17:17:22.653Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:17:22.653Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:22.653Z] [LOG]    Worked Hours: 0
[2025-10-07T17:17:22.653Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:17:22.654Z] [LOG]    💸 Shortfall Deduction: 160h × 0.00 = 0.00
[2025-10-07T17:17:22.654Z] [LOG] ============================================================
[2025-10-07T17:17:23.109Z] [LOG] 📅 Weekend absence check for employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:23.110Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:23.110Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:17:23.111Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:17:23.111Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:23.111Z] [LOG]    Gross Salary: 0
[2025-10-07T17:17:23.112Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:23.112Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:23.112Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:23.113Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:23.113Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:23.113Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:23.114Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:23.114Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:23.114Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:23.115Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:23.115Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:23.115Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:23.116Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:23.116Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:23.116Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:23.116Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:23.117Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:23.117Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:23.117Z] [LOG] Regular deductions for Saruban null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:23.117Z] [LOG] Combined deductions for Saruban null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 0,
      "details": "160 hours × 0.00"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 0,
      "details": "5 weekend days × 0.00"
    }
  ],
  "total": 0
}
[2025-10-07T17:17:23.229Z] [LOG] Creating components for record adbe99cc-32d3-4359-9c9e-adaa19bcf62a: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:23.230Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 0
}
[2025-10-07T17:17:23.346Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:17:23.465Z] [LOG] Created payroll_record_component: 42884788-c77e-4dda-8147-b149d82e38a0 for Working Hours Shortfall
[2025-10-07T17:17:23.466Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 0
}
[2025-10-07T17:17:23.584Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:17:23.702Z] [LOG] Created payroll_record_component: 6823d082-4957-4500-9dc9-87f98b1296fc for Weekend Absent Days
[2025-10-07T17:17:24.045Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:24.047Z] [ERROR] ❌ Error updating financial balances for employee 0143a6e3-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:24.047Z] [LOG] ✅ Saruban null: Calculation completed successfully
[2025-10-07T17:17:24.048Z] [LOG] 📊 Progress: 26/34 (76.5%)
[2025-10-07T17:17:24.048Z] [LOG] 
🧮 Processing: Dharshika null (EMP000009)
[2025-10-07T17:17:24.048Z] [LOG] 📋 Record ID: b336dc13-2ea0-41be-b140-e5307fe03d17
[2025-10-07T17:17:24.484Z] [LOG] 🔍 Component filtering for employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:24.484Z] [LOG]    Total components: 8
[2025-10-07T17:17:24.485Z] [LOG]    Applicable components: 8
[2025-10-07T17:17:24.485Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-07T17:17:25.135Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:25.355Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:25.572Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:25.787Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:26.004Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:26.220Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:26.438Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:26.662Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:26.884Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:27.099Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:27.316Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:27.531Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:27.746Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:27.972Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:28.191Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:28.301Z] [LOG] 🔍 Fetched 22 attendance records for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:28.410Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:28.950Z] [LOG] Employee 0143a994-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:28.950Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:17:28.951Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:28.951Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:28.952Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:28.953Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:28.953Z] [LOG] ================================================================================
[2025-10-07T17:17:28.953Z] [LOG] 📅 2025-08-01 (WEEKDAY): 10.37h worked → 7.753611111111111h counted → OVERLAP 09:14-17:00 = 7.754h (attendance table)
[2025-10-07T17:17:28.953Z] [LOG]    ✅ Added to weekday total: 7.753611111111111h
[2025-10-07T17:17:28.954Z] [LOG] 📅 2025-08-04 (WEEKDAY): 9.71h worked → 8.166666666666666h counted → OVERLAP 08:50-17:00 = 8.167h (attendance table)
[2025-10-07T17:17:28.954Z] [LOG]    ✅ Added to weekday total: 8.166666666666666h
[2025-10-07T17:17:28.954Z] [LOG] 📅 2025-08-06 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:28.955Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:28.955Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:28.955Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:28.955Z] [LOG] 📅 2025-08-09 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:28.956Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:28.956Z] [LOG] 📅 2025-08-11 (WEEKDAY): 10.46h worked → 8.091388888888888h counted → OVERLAP 08:54-17:00 = 8.091h (attendance table)
[2025-10-07T17:17:28.956Z] [LOG]    ✅ Added to weekday total: 8.091388888888888h
[2025-10-07T17:17:28.956Z] [LOG] 📅 2025-08-12 (WEEKDAY): 10.99h worked → 7.433333333333334h counted → OVERLAP 09:34-17:00 = 7.433h (attendance table)
[2025-10-07T17:17:28.956Z] [LOG]    ✅ Added to weekday total: 7.433333333333334h
[2025-10-07T17:17:28.956Z] [LOG] 📅 2025-08-13 (WEEKDAY): 7.82h worked → 4.755833333333333h counted → OVERLAP 12:14-17:00 = 4.756h (attendance table)
[2025-10-07T17:17:28.957Z] [LOG]    ✅ Added to weekday total: 4.755833333333333h
[2025-10-07T17:17:28.957Z] [LOG] 📅 2025-08-14 (WEEKDAY): 10.18h worked → 7.688888888888889h counted → OVERLAP 09:18-17:00 = 7.689h (attendance table)
[2025-10-07T17:17:28.957Z] [LOG]    ✅ Added to weekday total: 7.688888888888889h
[2025-10-07T17:17:28.957Z] [LOG] 📅 2025-08-15 (WEEKDAY): 10.69h worked → 7.098333333333334h counted → OVERLAP 09:54-17:00 = 7.098h (attendance table)
[2025-10-07T17:17:28.957Z] [LOG]    ✅ Added to weekday total: 7.098333333333334h
[2025-10-07T17:17:28.957Z] [LOG] 📅 2025-08-16 (WEEKEND): 7.28h worked → 3.3433333333333333h counted → OVERLAP 09:39-13:00 = 3.343h (attendance table)
[2025-10-07T17:17:28.958Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.3433333333333333h
[2025-10-07T17:17:28.958Z] [LOG] 📅 2025-08-18 (WEEKDAY): 9.03h worked → 7.332777777777777h counted → OVERLAP 09:40-17:00 = 7.333h (attendance table)
[2025-10-07T17:17:28.958Z] [LOG]    ✅ Added to weekday total: 7.332777777777777h
[2025-10-07T17:17:28.958Z] [LOG] 📅 2025-08-19 (WEEKDAY): 10.18h worked → 7.5h counted → OVERLAP 09:30-17:00 = 7.500h (attendance table)
[2025-10-07T17:17:28.958Z] [LOG]    ✅ Added to weekday total: 7.5h
[2025-10-07T17:17:28.958Z] [LOG] 📅 2025-08-20 (WEEKDAY): 9.81h worked → 7.285555555555556h counted → OVERLAP 09:42-17:00 = 7.286h (attendance table)
[2025-10-07T17:17:28.958Z] [LOG]    ✅ Added to weekday total: 7.285555555555556h
[2025-10-07T17:17:28.959Z] [LOG] 📅 2025-08-21 (WEEKDAY): 9.19h worked → 6.996944444444445h counted → OVERLAP 10:00-17:00 = 6.997h (attendance table)
[2025-10-07T17:17:28.959Z] [LOG]    ✅ Added to weekday total: 6.996944444444445h
[2025-10-07T17:17:28.959Z] [LOG] 📅 2025-08-22 (WEEKDAY): 8.61h worked → 7.426666666666667h counted → OVERLAP 09:34-17:00 = 7.427h (attendance table)
[2025-10-07T17:17:28.959Z] [LOG]    ✅ Added to weekday total: 7.426666666666667h
[2025-10-07T17:17:28.959Z] [LOG] 📅 2025-08-25 (WEEKDAY): 10.71h worked → 8.068333333333333h counted → OVERLAP 08:55-17:00 = 8.068h (attendance table)
[2025-10-07T17:17:28.959Z] [LOG]    ✅ Added to weekday total: 8.068333333333333h
[2025-10-07T17:17:28.959Z] [LOG] 📅 2025-08-26 (WEEKDAY): 9.08h worked → 7.339166666666666h counted → OVERLAP 09:39-17:00 = 7.339h (attendance table)
[2025-10-07T17:17:28.959Z] [LOG]    ✅ Added to weekday total: 7.339166666666666h
[2025-10-07T17:17:28.959Z] [LOG] 📅 2025-08-27 (WEEKDAY): 8.5h worked → 5h counted → OVERLAP 12:00-17:00 = 5.000h (attendance table)
[2025-10-07T17:17:28.959Z] [LOG]    ✅ Added to weekday total: 5h
[2025-10-07T17:17:28.959Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.57h worked → 6.769166666666667h counted → OVERLAP 10:13-17:00 = 6.769h (attendance table)
[2025-10-07T17:17:28.959Z] [LOG]    ✅ Added to weekday total: 6.769166666666667h
[2025-10-07T17:17:28.959Z] [LOG] 📅 2025-08-29 (WEEKDAY): 10.83h worked → 7.010833333333333h counted → OVERLAP 09:59-17:00 = 7.011h (attendance table)
[2025-10-07T17:17:28.959Z] [LOG]    ✅ Added to weekday total: 7.010833333333333h
[2025-10-07T17:17:28.960Z] [LOG] 📅 2025-08-30 (WEEKEND): 7.49h worked → 3.2225h counted → OVERLAP 09:46-13:00 = 3.223h (attendance table)
[2025-10-07T17:17:28.960Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.2225h
[2025-10-07T17:17:28.960Z] [LOG] ================================================================================
[2025-10-07T17:17:28.960Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:28.960Z] [LOG]    Sum of all daily counted hours (rounded): 138.7175h
[2025-10-07T17:17:28.960Z] [LOG]    Expected hours: 170h
[2025-10-07T17:17:28.960Z] [LOG]    Shortfall: 31.28h
[2025-10-07T17:17:28.960Z] [LOG] ================================================================================
[2025-10-07T17:17:29.067Z] [LOG] 🔄 Processing financial records for employee 0143a994-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:29.068Z] [LOG] 🔄 Processing financial records for employee 0143a994-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:29.178Z] [LOG] 📊 Found 0 active loans for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:29.287Z] [LOG] 📊 Found 0 active advances for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:29.396Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:29.397Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:29.397Z] [LOG] 💰 GROSS CALCULATION for Dharshika null:
[2025-10-07T17:17:29.398Z] [LOG]    Base Salary: 100000
[2025-10-07T17:17:29.398Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:29.507Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:29.725Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:29.962Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:30.077Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:30.185Z] [LOG] Employee 0143a994-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:30.185Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:30.186Z] [LOG] ============================================================
[2025-10-07T17:17:30.186Z] [LOG] 👤 Employee ID: 0143a994-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:30.186Z] [LOG] 💰 Base Salary: 100,000
[2025-10-07T17:17:30.186Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:30.187Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:30.187Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:17:30.187Z] [LOG] 💵 Per-Day Salary: 4000.00
[2025-10-07T17:17:30.187Z] [LOG] ⏱️  Hourly Rate: 470.59
[2025-10-07T17:17:30.188Z] [LOG] 
[2025-10-07T17:17:30.188Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:30.188Z] [LOG]    Expected Hours: 170
[2025-10-07T17:17:30.188Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:17:30.188Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:30.189Z] [LOG]    Worked Hours: 138.7175
[2025-10-07T17:17:30.189Z] [LOG]    ⚠️  Shortfall Hours: 31.2825
[2025-10-07T17:17:30.189Z] [LOG]    💸 Shortfall Deduction: 31.2825h × 470.59 = 14721.18
[2025-10-07T17:17:30.189Z] [LOG] ============================================================
[2025-10-07T17:17:30.407Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:17:30.408Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:30.408Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-16 (Saturday)
[2025-10-07T17:17:30.409Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:30.409Z] [LOG]    Actual: 09:39:24 - 16:56:23
[2025-10-07T17:17:30.409Z] [LOG]    Calculation: OVERLAP 09:39-13:00 = 3.343h
[2025-10-07T17:17:30.410Z] [LOG]    Payable Hours: 3.343h
[2025-10-07T17:17:30.410Z] [LOG]    Shortfall: 1.157h
[2025-10-07T17:17:30.410Z] [LOG]    Hourly Rate: 888.89 (Day Salary 4000 ÷ 4.5h)
[2025-10-07T17:17:30.411Z] [LOG]    Deduction: 1028.15
[2025-10-07T17:17:30.411Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-30 (Saturday)
[2025-10-07T17:17:30.412Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:30.412Z] [LOG]    Actual: 09:46:39 - 17:16:00
[2025-10-07T17:17:30.412Z] [LOG]    Calculation: OVERLAP 09:46-13:00 = 3.223h
[2025-10-07T17:17:30.412Z] [LOG]    Payable Hours: 3.223h
[2025-10-07T17:17:30.413Z] [LOG]    Shortfall: 1.277h
[2025-10-07T17:17:30.413Z] [LOG]    Hourly Rate: 888.89 (Day Salary 4000 ÷ 4.5h)
[2025-10-07T17:17:30.413Z] [LOG]    Deduction: 1135.56
[2025-10-07T17:17:30.628Z] [LOG] 📅 Weekend absence check for employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:30.629Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:30.629Z] [LOG]    Attended weekend dates: 3 days
[2025-10-07T17:17:30.630Z] [LOG]    Absent weekend dates: 2 days
[2025-10-07T17:17:30.630Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:30.630Z] [LOG]    Gross Salary: 100000
[2025-10-07T17:17:30.630Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:30.631Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:30.631Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:30.631Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:30.632Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:30.632Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:30.632Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:30.633Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:30.633Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:30.633Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:30.634Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:30.634Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:30.634Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:30.635Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:30.635Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:30.635Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:30.636Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:30.636Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:30.636Z] [LOG] Regular deductions for Dharshika null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:30.637Z] [LOG] Combined deductions for Dharshika null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 2163.7037037037035,
      "details": "Total 2.43h shortfall - 2025-08-16 (Saturday): 1.16h, 2025-08-30 (Saturday): 1.28h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 14721.176470588234,
      "details": "31.2825 hours × 470.59"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 8000,
      "details": "2 weekend days × 4000.00"
    }
  ],
  "total": 24884.88017429194
}
[2025-10-07T17:17:30.746Z] [LOG] Creating components for record b336dc13-2ea0-41be-b140-e5307fe03d17: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 3,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:30.746Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 2163.7037037037035
}
[2025-10-07T17:17:30.858Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:17:30.966Z] [LOG] Created payroll_record_component: 4f386028-9e7e-4c40-99b7-d43ea4cd491a for Weekend Shortfall Deduction
[2025-10-07T17:17:30.967Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 14721.176470588234
}
[2025-10-07T17:17:31.075Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:17:31.184Z] [LOG] Created payroll_record_component: 2f4d31e2-d298-4a43-b233-90aa6447038a for Working Hours Shortfall
[2025-10-07T17:17:31.184Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 8000
}
[2025-10-07T17:17:31.293Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:17:31.401Z] [LOG] Created payroll_record_component: 4dd815d3-46d7-460d-8cc0-727f40c3a0a2 for Weekend Absent Days
[2025-10-07T17:17:31.734Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:31.736Z] [ERROR] ❌ Error updating financial balances for employee 0143a994-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:31.737Z] [LOG] ✅ Dharshika null: Calculation completed successfully
[2025-10-07T17:17:31.737Z] [LOG] 📊 Progress: 27/34 (79.4%)
[2025-10-07T17:17:31.738Z] [LOG] 
🧮 Processing: Hari null (EMP000017)
[2025-10-07T17:17:31.738Z] [LOG] 📋 Record ID: bab4b4ce-f389-4e94-a821-d1806c0ade0a
[2025-10-07T17:17:32.190Z] [LOG] 🔍 Component filtering for employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:32.190Z] [LOG]    Total components: 8
[2025-10-07T17:17:32.191Z] [LOG]    Applicable components: 8
[2025-10-07T17:17:32.191Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-07T17:17:32.841Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:33.059Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:33.279Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:33.496Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:33.710Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:33.925Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:34.142Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:34.252Z] [LOG] 🔍 Fetched 20 attendance records for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:34.359Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:34.927Z] [LOG] Employee 0143bc58-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:34.927Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:17:34.928Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:34.929Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:34.930Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:34.930Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:34.930Z] [LOG] ================================================================================
[2025-10-07T17:17:34.931Z] [LOG] 📅 2025-08-01 (WEEKDAY): 9.69h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:34.931Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:34.931Z] [LOG] 📅 2025-08-02 (WEEKEND): 10.26h worked → 4.013055555555556h counted → OVERLAP 08:59-13:00 = 4.013h (attendance table)
[2025-10-07T17:17:34.932Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.013055555555556h
[2025-10-07T17:17:34.932Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.17h worked → 8.166666666666666h counted → OVERLAP 08:50-17:00 = 8.167h (attendance table)
[2025-10-07T17:17:34.932Z] [LOG]    ✅ Added to weekday total: 8.166666666666666h
[2025-10-07T17:17:34.933Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.38h worked → 7.384166666666666h counted → OVERLAP 09:36-17:00 = 7.384h (attendance table)
[2025-10-07T17:17:34.933Z] [LOG]    ✅ Added to weekday total: 7.384166666666666h
[2025-10-07T17:17:34.933Z] [LOG] 📅 2025-08-06 (WEEKDAY): 7.22h worked → 7.225h counted → OVERLAP 09:46-17:00 = 7.225h (attendance table)
[2025-10-07T17:17:34.933Z] [LOG]    ✅ Added to weekday total: 7.225h
[2025-10-07T17:17:34.934Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8h worked → 7.5h counted → OVERLAP 09:30-17:00 = 7.500h (attendance table)
[2025-10-07T17:17:34.934Z] [LOG]    ✅ Added to weekday total: 7.5h
[2025-10-07T17:17:34.935Z] [LOG] 📅 2025-08-09 (WEEKEND): 5.83h worked → 3.8333333333333335h counted → OVERLAP 09:10-13:00 = 3.833h (attendance table)
[2025-10-07T17:17:34.935Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.8333333333333335h
[2025-10-07T17:17:34.935Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8.17h worked → 8.166666666666666h counted → OVERLAP 08:50-17:00 = 8.167h (attendance table)
[2025-10-07T17:17:34.935Z] [LOG]    ✅ Added to weekday total: 8.166666666666666h
[2025-10-07T17:17:34.936Z] [LOG] 📅 2025-08-15 (WEEKDAY): 8.66h worked → 8.159166666666666h counted → OVERLAP 08:50-17:00 = 8.159h (attendance table)
[2025-10-07T17:17:34.936Z] [LOG]    ✅ Added to weekday total: 8.159166666666666h
[2025-10-07T17:17:34.936Z] [LOG] 📅 2025-08-19 (WEEKDAY): 8.83h worked → 7.833333333333333h counted → OVERLAP 09:10-17:00 = 7.833h (attendance table)
[2025-10-07T17:17:34.937Z] [LOG]    ✅ Added to weekday total: 7.833333333333333h
[2025-10-07T17:17:34.937Z] [LOG] 📅 2025-08-20 (WEEKDAY): 6.94h worked → 6.935833333333333h counted → OVERLAP 10:03-17:00 = 6.936h (attendance table)
[2025-10-07T17:17:34.937Z] [LOG]    ✅ Added to weekday total: 6.935833333333333h
[2025-10-07T17:17:34.937Z] [LOG] 📅 2025-08-21 (WEEKDAY): 7h worked → 7h counted → OVERLAP 10:00-17:00 = 7.000h (attendance table)
[2025-10-07T17:17:34.937Z] [LOG]    ✅ Added to weekday total: 7h
[2025-10-07T17:17:34.938Z] [LOG] 📅 2025-08-22 (WEEKDAY): 4.5h worked → 4h counted → OVERLAP 13:00-17:00 = 4.000h (attendance table)
[2025-10-07T17:17:34.938Z] [LOG]    ✅ Added to weekday total: 4h
[2025-10-07T17:17:34.938Z] [LOG] 📅 2025-08-23 (WEEKEND): 7h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:34.938Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:34.938Z] [LOG] 📅 2025-08-25 (WEEKDAY): 8.03h worked → 8.033333333333333h counted → OVERLAP 08:58-17:00 = 8.033h (attendance table)
[2025-10-07T17:17:34.938Z] [LOG]    ✅ Added to weekday total: 8.033333333333333h
[2025-10-07T17:17:34.938Z] [LOG] 📅 2025-08-26 (WEEKDAY): 9.22h worked → 6.64h counted → OVERLAP 10:21-17:00 = 6.640h (attendance table)
[2025-10-07T17:17:34.938Z] [LOG]    ✅ Added to weekday total: 6.64h
[2025-10-07T17:17:34.938Z] [LOG] 📅 2025-08-27 (WEEKDAY): 7.05h worked → 6.552777777777778h counted → OVERLAP 10:26-17:00 = 6.553h (attendance table)
[2025-10-07T17:17:34.938Z] [LOG]    ✅ Added to weekday total: 6.552777777777778h
[2025-10-07T17:17:34.938Z] [LOG] 📅 2025-08-28 (WEEKDAY): 7.75h worked → 7.75h counted → OVERLAP 09:15-17:00 = 7.750h (attendance table)
[2025-10-07T17:17:34.939Z] [LOG]    ✅ Added to weekday total: 7.75h
[2025-10-07T17:17:34.939Z] [LOG] 📅 2025-08-29 (WEEKDAY): 5h worked → 5h counted → OVERLAP 12:00-17:00 = 5.000h (attendance table)
[2025-10-07T17:17:34.939Z] [LOG]    ✅ Added to weekday total: 5h
[2025-10-07T17:17:34.939Z] [LOG] 📅 2025-08-30 (WEEKEND): 14.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:34.939Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:34.939Z] [LOG] ================================================================================
[2025-10-07T17:17:34.939Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:34.939Z] [LOG]    Sum of all daily counted hours (rounded): 114.8469h
[2025-10-07T17:17:34.939Z] [LOG]    Expected hours: 170h
[2025-10-07T17:17:34.939Z] [LOG]    Shortfall: 55.15h
[2025-10-07T17:17:34.939Z] [LOG] ================================================================================
[2025-10-07T17:17:35.047Z] [LOG] 🔄 Processing financial records for employee 0143bc58-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:35.047Z] [LOG] 🔄 Processing financial records for employee 0143bc58-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:35.159Z] [LOG] 📊 Found 0 active loans for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:35.280Z] [LOG] 📊 Found 0 active advances for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:35.389Z] [LOG] 📊 Found 0 approved bonuses for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:35.389Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:35.390Z] [LOG] 💰 GROSS CALCULATION for Hari null:
[2025-10-07T17:17:35.390Z] [LOG]    Base Salary: 50000
[2025-10-07T17:17:35.391Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:35.500Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:35.717Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:35.934Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:36.044Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:36.154Z] [LOG] Employee 0143bc58-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:36.154Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:36.155Z] [LOG] ============================================================
[2025-10-07T17:17:36.155Z] [LOG] 👤 Employee ID: 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:36.155Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:17:36.155Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:36.156Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:36.156Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:17:36.156Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:17:36.157Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:17:36.157Z] [LOG] 
[2025-10-07T17:17:36.157Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:36.158Z] [LOG]    Expected Hours: 170
[2025-10-07T17:17:36.158Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:17:36.158Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:36.159Z] [LOG]    Worked Hours: 114.8469
[2025-10-07T17:17:36.159Z] [LOG]    ⚠️  Shortfall Hours: 55.153099999999995
[2025-10-07T17:17:36.159Z] [LOG]    💸 Shortfall Deduction: 55.153099999999995h × 235.29 = 12977.20
[2025-10-07T17:17:36.160Z] [LOG] ============================================================
[2025-10-07T17:17:36.377Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-02 (Saturday)
[2025-10-07T17:17:36.378Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:36.378Z] [LOG]    Actual: 08:59:13 - 19:15:00
[2025-10-07T17:17:36.378Z] [LOG]    Calculation: OVERLAP 08:59-13:00 = 4.013h
[2025-10-07T17:17:36.379Z] [LOG]    Payable Hours: 4.013h
[2025-10-07T17:17:36.379Z] [LOG]    Shortfall: 0.487h
[2025-10-07T17:17:36.379Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:17:36.380Z] [LOG]    Deduction: 216.42
[2025-10-07T17:17:36.380Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-09 (Saturday)
[2025-10-07T17:17:36.380Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:36.381Z] [LOG]    Actual: 09:10:00 - 15:00:00
[2025-10-07T17:17:36.381Z] [LOG]    Calculation: OVERLAP 09:10-13:00 = 3.833h
[2025-10-07T17:17:36.381Z] [LOG]    Payable Hours: 3.833h
[2025-10-07T17:17:36.382Z] [LOG]    Shortfall: 0.667h
[2025-10-07T17:17:36.382Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:17:36.382Z] [LOG]    Deduction: 296.30
[2025-10-07T17:17:36.383Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:17:36.383Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:36.384Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:17:36.384Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:36.600Z] [LOG] 📅 Weekend absence check for employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:36.601Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:36.601Z] [LOG]    Attended weekend dates: 4 days
[2025-10-07T17:17:36.602Z] [LOG]    Absent weekend dates: 1 days
[2025-10-07T17:17:36.602Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:36.602Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:17:36.602Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:36.603Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:36.603Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:36.603Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:36.604Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:36.604Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:36.605Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:36.605Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:36.605Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:36.606Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:36.606Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:36.606Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:36.607Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:36.607Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:36.607Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:36.608Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:36.608Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:36.608Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:36.609Z] [LOG] Regular deductions for Hari null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:36.609Z] [LOG] Combined deductions for Hari null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 512.7160493827159,
      "details": "Total 1.15h shortfall - 2025-08-02 (Saturday): 0.49h, 2025-08-09 (Saturday): 0.67h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 12977.199999999999,
      "details": "55.153099999999995 hours × 235.29"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "1 weekend days × 2000.00"
    }
  ],
  "total": 15489.916049382715
}
[2025-10-07T17:17:36.718Z] [LOG] Creating components for record bab4b4ce-f389-4e94-a821-d1806c0ade0a: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 3,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:36.719Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 512.7160493827159
}
[2025-10-07T17:17:36.828Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:17:36.941Z] [LOG] Created payroll_record_component: ee3998a6-da97-40e9-a860-eec898a255c1 for Weekend Shortfall Deduction
[2025-10-07T17:17:36.942Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 12977.199999999999
}
[2025-10-07T17:17:37.053Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:17:37.189Z] [LOG] Created payroll_record_component: f33de9e1-05a0-41c7-9818-a7c524a2598b for Working Hours Shortfall
[2025-10-07T17:17:37.189Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 2000
}
[2025-10-07T17:17:37.297Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:17:37.404Z] [LOG] Created payroll_record_component: 6fba3c3c-52ab-45a0-9fe3-2a206447b774 for Weekend Absent Days
[2025-10-07T17:17:37.740Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:37.741Z] [ERROR] ❌ Error updating financial balances for employee 0143bc58-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:37.743Z] [LOG] ✅ Hari null: Calculation completed successfully
[2025-10-07T17:17:37.743Z] [LOG] 📊 Progress: 28/34 (82.4%)
[2025-10-07T17:17:37.743Z] [LOG] 
🧮 Processing: Franklin null (EMP000018)
[2025-10-07T17:17:37.743Z] [LOG] 📋 Record ID: c61f7286-f259-44f0-8280-3afb63162c29
[2025-10-07T17:17:38.176Z] [LOG] 🔍 Component filtering for employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:38.177Z] [LOG]    Total components: 8
[2025-10-07T17:17:38.177Z] [LOG]    Applicable components: 8
[2025-10-07T17:17:38.177Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-07T17:17:38.828Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:39.044Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:39.260Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:39.478Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:39.693Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:39.909Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:40.125Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:40.357Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:40.592Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:40.718Z] [LOG] 🔍 Fetched 23 attendance records for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:40.828Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:41.401Z] [LOG] Employee 0143c037-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:41.401Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:17:41.401Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:41.402Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:41.403Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:41.403Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:41.403Z] [LOG] ================================================================================
[2025-10-07T17:17:41.403Z] [LOG] 📅 2025-08-01 (WEEKDAY): 9.8h worked → 7.523611111111111h counted → OVERLAP 09:28-17:00 = 7.524h (attendance table)
[2025-10-07T17:17:41.404Z] [LOG]    ✅ Added to weekday total: 7.523611111111111h
[2025-10-07T17:17:41.404Z] [LOG] 📅 2025-08-02 (WEEKEND): 4.14h worked → 2.5052777777777777h counted → OVERLAP 10:29-13:00 = 2.505h (attendance table)
[2025-10-07T17:17:41.404Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 2.5052777777777777h
[2025-10-07T17:17:41.405Z] [LOG] 📅 2025-08-04 (WEEKDAY): 7.43h worked → 6.398888888888889h counted → OVERLAP 10:36-17:00 = 6.399h (attendance table)
[2025-10-07T17:17:41.405Z] [LOG]    ✅ Added to weekday total: 6.398888888888889h
[2025-10-07T17:17:41.405Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.26h worked → 6.606111111111111h counted → OVERLAP 10:23-17:00 = 6.606h (attendance table)
[2025-10-07T17:17:41.405Z] [LOG]    ✅ Added to weekday total: 6.606111111111111h
[2025-10-07T17:17:41.405Z] [LOG] 📅 2025-08-06 (WEEKDAY): 7.57h worked → 7.573333333333333h counted → OVERLAP 09:18-16:52 = 7.573h (attendance table)
[2025-10-07T17:17:41.405Z] [LOG]    ✅ Added to weekday total: 7.573333333333333h
[2025-10-07T17:17:41.406Z] [LOG] 📅 2025-08-07 (WEEKDAY): 9.1h worked → 6.680833333333333h counted → OVERLAP 10:19-17:00 = 6.681h (attendance table)
[2025-10-07T17:17:41.406Z] [LOG]    ✅ Added to weekday total: 6.680833333333333h
[2025-10-07T17:17:41.406Z] [LOG] 📅 2025-08-09 (WEEKEND): 4.18h worked → 0.8844444444444445h counted → OVERLAP 12:06-13:00 = 0.884h (attendance table)
[2025-10-07T17:17:41.406Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 0.8844444444444445h
[2025-10-07T17:17:41.407Z] [LOG] 📅 2025-08-11 (WEEKDAY): 10.02h worked → 7.506944444444445h counted → OVERLAP 09:29-17:00 = 7.507h (attendance table)
[2025-10-07T17:17:41.407Z] [LOG]    ✅ Added to weekday total: 7.506944444444445h
[2025-10-07T17:17:41.407Z] [LOG] 📅 2025-08-12 (WEEKDAY): 10.92h worked → 7.374722222222222h counted → OVERLAP 09:37-17:00 = 7.375h (attendance table)
[2025-10-07T17:17:41.407Z] [LOG]    ✅ Added to weekday total: 7.374722222222222h
[2025-10-07T17:17:41.407Z] [LOG] 📅 2025-08-13 (WEEKDAY): 6.18h worked → 5.593055555555556h counted → OVERLAP 11:24-17:00 = 5.593h (attendance table)
[2025-10-07T17:17:41.407Z] [LOG]    ✅ Added to weekday total: 5.593055555555556h
[2025-10-07T17:17:41.408Z] [LOG] 📅 2025-08-14 (WEEKDAY): 7.9h worked → 6.578333333333333h counted → OVERLAP 10:25-17:00 = 6.578h (attendance table)
[2025-10-07T17:17:41.408Z] [LOG]    ✅ Added to weekday total: 6.578333333333333h
[2025-10-07T17:17:41.408Z] [LOG] 📅 2025-08-15 (WEEKDAY): 9.41h worked → 7.051388888888889h counted → OVERLAP 09:56-17:00 = 7.051h (attendance table)
[2025-10-07T17:17:41.408Z] [LOG]    ✅ Added to weekday total: 7.051388888888889h
[2025-10-07T17:17:41.408Z] [LOG] 📅 2025-08-16 (WEEKEND): 9h worked → 3h counted → OVERLAP 10:00-13:00 = 3.000h (attendance table)
[2025-10-07T17:17:41.409Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3h
[2025-10-07T17:17:41.409Z] [LOG] 📅 2025-08-19 (WEEKDAY): 9.28h worked → 6.714166666666666h counted → OVERLAP 10:17-17:00 = 6.714h (attendance table)
[2025-10-07T17:17:41.409Z] [LOG]    ✅ Added to weekday total: 6.714166666666666h
[2025-10-07T17:17:41.410Z] [LOG] 📅 2025-08-20 (WEEKDAY): 7.8h worked → 6.644722222222223h counted → OVERLAP 10:21-17:00 = 6.645h (attendance table)
[2025-10-07T17:17:41.410Z] [LOG]    ✅ Added to weekday total: 6.644722222222223h
[2025-10-07T17:17:41.410Z] [LOG] 📅 2025-08-21 (WEEKDAY): 6.8h worked → 6.469444444444444h counted → OVERLAP 10:31-17:00 = 6.469h (attendance table)
[2025-10-07T17:17:41.410Z] [LOG]    ✅ Added to weekday total: 6.469444444444444h
[2025-10-07T17:17:41.410Z] [LOG] 📅 2025-08-22 (WEEKDAY): 6.66h worked → 5.995833333333334h counted → OVERLAP 11:00-17:00 = 5.996h (attendance table)
[2025-10-07T17:17:41.410Z] [LOG]    ✅ Added to weekday total: 5.995833333333334h
[2025-10-07T17:17:41.411Z] [LOG] 📅 2025-08-23 (WEEKEND): 3.72h worked → 3.062777777777778h counted → OVERLAP 09:56-13:00 = 3.063h (attendance table)
[2025-10-07T17:17:41.411Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.062777777777778h
[2025-10-07T17:17:41.411Z] [LOG] 📅 2025-08-25 (WEEKDAY): 6.64h worked → 6.6369444444444445h counted → OVERLAP 10:21-17:00 = 6.637h (attendance table)
[2025-10-07T17:17:41.411Z] [LOG]    ✅ Added to weekday total: 6.6369444444444445h
[2025-10-07T17:17:41.411Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.94h worked → 7.152222222222222h counted → OVERLAP 09:50-17:00 = 7.152h (attendance table)
[2025-10-07T17:17:41.412Z] [LOG]    ✅ Added to weekday total: 7.152222222222222h
[2025-10-07T17:17:41.412Z] [LOG] 📅 2025-08-28 (WEEKDAY): 7.82h worked → 6.613333333333333h counted → OVERLAP 10:23-17:00 = 6.613h (attendance table)
[2025-10-07T17:17:41.412Z] [LOG]    ✅ Added to weekday total: 6.613333333333333h
[2025-10-07T17:17:41.412Z] [LOG] 📅 2025-08-29 (WEEKDAY): 8.96h worked → 6.652777777777778h counted → OVERLAP 10:20-17:00 = 6.653h (attendance table)
[2025-10-07T17:17:41.412Z] [LOG]    ✅ Added to weekday total: 6.652777777777778h
[2025-10-07T17:17:41.412Z] [LOG] 📅 2025-08-30 (WEEKEND): 4.16h worked → 2.155h counted → OVERLAP 10:50-13:00 = 2.155h (attendance table)
[2025-10-07T17:17:41.412Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 2.155h
[2025-10-07T17:17:41.412Z] [LOG] ================================================================================
[2025-10-07T17:17:41.412Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:41.412Z] [LOG]    Sum of all daily counted hours (rounded): 121.7667h
[2025-10-07T17:17:41.412Z] [LOG]    Expected hours: 170h
[2025-10-07T17:17:41.412Z] [LOG]    Shortfall: 48.23h
[2025-10-07T17:17:41.412Z] [LOG] ================================================================================
[2025-10-07T17:17:41.520Z] [LOG] 🔄 Processing financial records for employee 0143c037-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:41.521Z] [LOG] 🔄 Processing financial records for employee 0143c037-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:41.629Z] [LOG] 📊 Found 0 active loans for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:41.738Z] [LOG] 📊 Found 0 active advances for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:41.846Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:41.847Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:41.847Z] [LOG] 💰 GROSS CALCULATION for Franklin null:
[2025-10-07T17:17:41.848Z] [LOG]    Base Salary: 50000
[2025-10-07T17:17:41.848Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:41.957Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:42.172Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:42.388Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:42.504Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:42.612Z] [LOG] Employee 0143c037-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:42.613Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:42.613Z] [LOG] ============================================================
[2025-10-07T17:17:42.613Z] [LOG] 👤 Employee ID: 0143c037-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:42.614Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:17:42.614Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:42.614Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:42.615Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:17:42.615Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:17:42.615Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:17:42.615Z] [LOG] 
[2025-10-07T17:17:42.616Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:42.616Z] [LOG]    Expected Hours: 170
[2025-10-07T17:17:42.616Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:17:42.616Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:42.616Z] [LOG]    Worked Hours: 121.7667
[2025-10-07T17:17:42.617Z] [LOG]    ⚠️  Shortfall Hours: 48.2333
[2025-10-07T17:17:42.617Z] [LOG]    💸 Shortfall Deduction: 48.2333h × 235.29 = 11349.01
[2025-10-07T17:17:42.617Z] [LOG] ============================================================
[2025-10-07T17:17:42.840Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-02 (Saturday)
[2025-10-07T17:17:42.840Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:42.841Z] [LOG]    Actual: 10:29:41 - 14:38:17
[2025-10-07T17:17:42.841Z] [LOG]    Calculation: OVERLAP 10:29-13:00 = 2.505h
[2025-10-07T17:17:42.841Z] [LOG]    Payable Hours: 2.505h
[2025-10-07T17:17:42.842Z] [LOG]    Shortfall: 1.995h
[2025-10-07T17:17:42.842Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:17:42.843Z] [LOG]    Deduction: 886.54
[2025-10-07T17:17:42.843Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-09 (Saturday)
[2025-10-07T17:17:42.843Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:42.844Z] [LOG]    Actual: 12:06:56 - 16:18:00
[2025-10-07T17:17:42.844Z] [LOG]    Calculation: OVERLAP 12:06-13:00 = 0.884h
[2025-10-07T17:17:42.844Z] [LOG]    Payable Hours: 0.884h
[2025-10-07T17:17:42.845Z] [LOG]    Shortfall: 3.616h
[2025-10-07T17:17:42.845Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:17:42.845Z] [LOG]    Deduction: 1606.91
[2025-10-07T17:17:42.846Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-16 (Saturday)
[2025-10-07T17:17:42.846Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:42.846Z] [LOG]    Actual: 10:00:00 - 19:00:00
[2025-10-07T17:17:42.847Z] [LOG]    Calculation: OVERLAP 10:00-13:00 = 3.000h
[2025-10-07T17:17:42.847Z] [LOG]    Payable Hours: 3.000h
[2025-10-07T17:17:42.847Z] [LOG]    Shortfall: 1.500h
[2025-10-07T17:17:42.848Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:17:42.848Z] [LOG]    Deduction: 666.67
[2025-10-07T17:17:42.848Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-23 (Saturday)
[2025-10-07T17:17:42.849Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:42.849Z] [LOG]    Actual: 09:56:14 - 13:39:10
[2025-10-07T17:17:42.849Z] [LOG]    Calculation: OVERLAP 09:56-13:00 = 3.063h
[2025-10-07T17:17:42.850Z] [LOG]    Payable Hours: 3.063h
[2025-10-07T17:17:42.850Z] [LOG]    Shortfall: 1.437h
[2025-10-07T17:17:42.850Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:17:42.850Z] [LOG]    Deduction: 638.77
[2025-10-07T17:17:42.851Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-30 (Saturday)
[2025-10-07T17:17:42.851Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:42.851Z] [LOG]    Actual: 10:50:42 - 15:00:00
[2025-10-07T17:17:42.851Z] [LOG]    Calculation: OVERLAP 10:50-13:00 = 2.155h
[2025-10-07T17:17:42.852Z] [LOG]    Payable Hours: 2.155h
[2025-10-07T17:17:42.852Z] [LOG]    Shortfall: 2.345h
[2025-10-07T17:17:42.852Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:17:42.852Z] [LOG]    Deduction: 1042.22
[2025-10-07T17:17:43.075Z] [LOG] 📅 Weekend absence check for employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:43.076Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:43.076Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:17:43.077Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:17:43.077Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:43.077Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:17:43.078Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:43.078Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:43.078Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:43.079Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:43.079Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:43.079Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:43.080Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:43.080Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:43.080Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:43.081Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:43.081Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:43.081Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:43.082Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:43.082Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:43.083Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:43.083Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:43.083Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:43.084Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:43.084Z] [LOG] Regular deductions for Franklin null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:43.084Z] [LOG] Combined deductions for Franklin null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 4841.111111111111,
      "details": "Total 10.89h shortfall - 2025-08-02 (Saturday): 1.99h, 2025-08-09 (Saturday): 3.62h, 2025-08-16 (Saturday): 1.50h, 2025-08-23 (Saturday): 1.44h, 2025-08-30 (Saturday): 2.35h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 11349.011764705881,
      "details": "48.2333 hours × 235.29"
    }
  ],
  "total": 16190.122875816993
}
[2025-10-07T17:17:43.194Z] [LOG] Creating components for record c61f7286-f259-44f0-8280-3afb63162c29: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:43.194Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 4841.111111111111
}
[2025-10-07T17:17:43.312Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:17:43.428Z] [LOG] Created payroll_record_component: 63bbaa3d-317e-4314-9881-093afe9fac99 for Weekend Shortfall Deduction
[2025-10-07T17:17:43.429Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 11349.011764705881
}
[2025-10-07T17:17:43.547Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:17:43.657Z] [LOG] Created payroll_record_component: 4a41c3f6-7ac7-49ff-913c-2109e0f2bbcc for Working Hours Shortfall
[2025-10-07T17:17:43.981Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:43.982Z] [ERROR] ❌ Error updating financial balances for employee 0143c037-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:43.983Z] [LOG] ✅ Franklin null: Calculation completed successfully
[2025-10-07T17:17:43.984Z] [LOG] 📊 Progress: 29/34 (85.3%)
[2025-10-07T17:17:43.984Z] [LOG] 
🧮 Processing: Anoj null (EMP000014)
[2025-10-07T17:17:43.984Z] [LOG] 📋 Record ID: ca0cec15-4c4f-4ff7-a372-ede09266ae5f
[2025-10-07T17:17:44.415Z] [LOG] 🔍 Component filtering for employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:44.415Z] [LOG]    Total components: 8
[2025-10-07T17:17:44.416Z] [LOG]    Applicable components: 8
[2025-10-07T17:17:44.416Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-07T17:17:45.082Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:45.318Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:45.546Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:45.763Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:45.981Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:46.196Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:46.412Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:46.628Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:46.855Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:47.091Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:47.328Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:47.556Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:47.783Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:47.999Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:48.219Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:48.330Z] [LOG] 🔍 Fetched 17 attendance records for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:48.440Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:48.982Z] [LOG] Employee 0143afc6-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:48.982Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:17:48.982Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:48.983Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:48.984Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:48.984Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:48.984Z] [LOG] ================================================================================
[2025-10-07T17:17:48.984Z] [LOG] 📅 2025-08-01 (WEEKDAY): 15.16h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:48.984Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:48.985Z] [LOG] 📅 2025-08-02 (WEEKEND): 6.07h worked → 4.473888888888889h counted → OVERLAP 08:31-13:00 = 4.474h (attendance table)
[2025-10-07T17:17:48.985Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.473888888888889h
[2025-10-07T17:17:48.985Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.64h worked → 8h counted → OVERLAP 09:00-17:00 = 8.000h (attendance table)
[2025-10-07T17:17:48.985Z] [LOG]    ✅ Added to weekday total: 8h
[2025-10-07T17:17:48.986Z] [LOG] 📅 2025-08-05 (WEEKDAY): 9.17h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:48.986Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:48.986Z] [LOG] 📅 2025-08-06 (WEEKDAY): 11.58h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:48.986Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:48.986Z] [LOG] 📅 2025-08-13 (WEEKDAY): 11h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:48.986Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:48.986Z] [LOG] 📅 2025-08-14 (WEEKDAY): 10.58h worked → 7.982777777777778h counted → OVERLAP 09:01-17:00 = 7.983h (attendance table)
[2025-10-07T17:17:48.987Z] [LOG]    ✅ Added to weekday total: 7.982777777777778h
[2025-10-07T17:17:48.987Z] [LOG] 📅 2025-08-15 (WEEKDAY): 10.48h worked → 8.475277777777778h counted → OVERLAP 08:31-17:00 = 8.475h (attendance table)
[2025-10-07T17:17:48.987Z] [LOG]    ✅ Added to weekday total: 8.475277777777778h
[2025-10-07T17:17:48.987Z] [LOG] 📅 2025-08-16 (WEEKEND): 10.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:48.987Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:48.987Z] [LOG] 📅 2025-08-18 (WEEKDAY): 9.07h worked → 8.071111111111112h counted → OVERLAP 08:55-17:00 = 8.071h (attendance table)
[2025-10-07T17:17:48.987Z] [LOG]    ✅ Added to weekday total: 8.071111111111112h
[2025-10-07T17:17:48.987Z] [LOG] 📅 2025-08-19 (WEEKDAY): 9.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:48.987Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:48.987Z] [LOG] 📅 2025-08-20 (WEEKDAY): 12h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:48.987Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:48.988Z] [LOG] 📅 2025-08-21 (WEEKDAY): 9.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:48.988Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:48.988Z] [LOG] 📅 2025-08-22 (WEEKDAY): 9.25h worked → 8.25h counted → OVERLAP 08:45-17:00 = 8.250h (attendance table)
[2025-10-07T17:17:48.988Z] [LOG]    ✅ Added to weekday total: 8.25h
[2025-10-07T17:17:48.988Z] [LOG] 📅 2025-08-23 (WEEKEND): 7.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:48.988Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:48.988Z] [LOG] 📅 2025-08-29 (WEEKDAY): 9.25h worked → 8.25h counted → OVERLAP 08:45-17:00 = 8.250h (attendance table)
[2025-10-07T17:17:48.988Z] [LOG]    ✅ Added to weekday total: 8.25h
[2025-10-07T17:17:48.988Z] [LOG] 📅 2025-08-30 (WEEKEND): 6.25h worked → 3.2508333333333335h counted → OVERLAP 09:44-13:00 = 3.251h (attendance table)
[2025-10-07T17:17:48.988Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.2508333333333335h
[2025-10-07T17:17:48.988Z] [LOG] ================================================================================
[2025-10-07T17:17:48.988Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:48.989Z] [LOG]    Sum of all daily counted hours (rounded): 108.5292h
[2025-10-07T17:17:48.989Z] [LOG]    Expected hours: 170h
[2025-10-07T17:17:48.989Z] [LOG]    Shortfall: 61.47h
[2025-10-07T17:17:48.989Z] [LOG] ================================================================================
[2025-10-07T17:17:49.101Z] [LOG] 🔄 Processing financial records for employee 0143afc6-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:49.101Z] [LOG] 🔄 Processing financial records for employee 0143afc6-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:49.217Z] [LOG] 📊 Found 0 active loans for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:49.334Z] [LOG] 📊 Found 0 active advances for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:49.455Z] [LOG] 📊 Found 0 approved bonuses for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:49.456Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:49.456Z] [LOG] 💰 GROSS CALCULATION for Anoj null:
[2025-10-07T17:17:49.456Z] [LOG]    Base Salary: 50000
[2025-10-07T17:17:49.456Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:49.571Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:49.806Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:50.032Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:50.140Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:50.248Z] [LOG] Employee 0143afc6-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:50.248Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:50.248Z] [LOG] ============================================================
[2025-10-07T17:17:50.249Z] [LOG] 👤 Employee ID: 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:50.249Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:17:50.249Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:50.249Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:50.249Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:17:50.249Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:17:50.249Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:17:50.249Z] [LOG] 
[2025-10-07T17:17:50.249Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:50.249Z] [LOG]    Expected Hours: 170
[2025-10-07T17:17:50.249Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:17:50.249Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:50.250Z] [LOG]    Worked Hours: 108.5292
[2025-10-07T17:17:50.250Z] [LOG]    ⚠️  Shortfall Hours: 61.4708
[2025-10-07T17:17:50.250Z] [LOG]    💸 Shortfall Deduction: 61.4708h × 235.29 = 14463.72
[2025-10-07T17:17:50.250Z] [LOG] ============================================================
[2025-10-07T17:17:50.464Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-02 (Saturday)
[2025-10-07T17:17:50.465Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:50.465Z] [LOG]    Actual: 08:31:34 - 14:36:00
[2025-10-07T17:17:50.465Z] [LOG]    Calculation: OVERLAP 08:31-13:00 = 4.474h
[2025-10-07T17:17:50.465Z] [LOG]    Payable Hours: 4.474h
[2025-10-07T17:17:50.466Z] [LOG]    Shortfall: 0.026h
[2025-10-07T17:17:50.466Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:17:50.466Z] [LOG]    Deduction: 11.60
[2025-10-07T17:17:50.466Z] [LOG] ✅ Weekend Day Met: 2025-08-16 (Saturday)
[2025-10-07T17:17:50.466Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:50.466Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:17:50.466Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:50.466Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-30 (Saturday)
[2025-10-07T17:17:50.467Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:50.467Z] [LOG]    Actual: 09:44:57 - 16:00:00
[2025-10-07T17:17:50.467Z] [LOG]    Calculation: OVERLAP 09:44-13:00 = 3.251h
[2025-10-07T17:17:50.467Z] [LOG]    Payable Hours: 3.251h
[2025-10-07T17:17:50.467Z] [LOG]    Shortfall: 1.249h
[2025-10-07T17:17:50.467Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:17:50.467Z] [LOG]    Deduction: 555.19
[2025-10-07T17:17:50.684Z] [LOG] 📅 Weekend absence check for employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:50.684Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:50.684Z] [LOG]    Attended weekend dates: 4 days
[2025-10-07T17:17:50.685Z] [LOG]    Absent weekend dates: 1 days
[2025-10-07T17:17:50.685Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:50.685Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:17:50.685Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:50.685Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:50.685Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:50.685Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:50.685Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:50.685Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:50.686Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:50.686Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:50.686Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:50.686Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:50.686Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:50.686Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:50.686Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:50.686Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:50.687Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:50.687Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:50.687Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:50.687Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:50.687Z] [LOG] Regular deductions for Anoj null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:50.687Z] [LOG] Combined deductions for Anoj null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 566.7901234567898,
      "details": "Total 1.28h shortfall - 2025-08-02 (Saturday): 0.03h, 2025-08-30 (Saturday): 1.25h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 14463.717647058822,
      "details": "61.4708 hours × 235.29"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "1 weekend days × 2000.00"
    }
  ],
  "total": 17030.50777051561
}
[2025-10-07T17:17:50.795Z] [LOG] Creating components for record ca0cec15-4c4f-4ff7-a372-ede09266ae5f: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 3,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:50.796Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 566.7901234567898
}
[2025-10-07T17:17:50.904Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:17:51.014Z] [LOG] Created payroll_record_component: c1ab91d1-92a6-4c00-a8c9-9b8f29f64db0 for Weekend Shortfall Deduction
[2025-10-07T17:17:51.014Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 14463.717647058822
}
[2025-10-07T17:17:51.122Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:17:51.243Z] [LOG] Created payroll_record_component: 34444e5f-50ab-4317-b27b-7b4e0193cb15 for Working Hours Shortfall
[2025-10-07T17:17:51.243Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 2000
}
[2025-10-07T17:17:51.351Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:17:51.460Z] [LOG] Created payroll_record_component: d5dd4bc3-7b05-44f7-acaa-04f1e1a2fce0 for Weekend Absent Days
[2025-10-07T17:17:51.794Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:51.795Z] [ERROR] ❌ Error updating financial balances for employee 0143afc6-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:51.795Z] [LOG] ✅ Anoj null: Calculation completed successfully
[2025-10-07T17:17:51.795Z] [LOG] 📊 Progress: 30/34 (88.2%)
[2025-10-07T17:17:51.796Z] [LOG] 
🧮 Processing: Ishara null (EMP000011)
[2025-10-07T17:17:51.796Z] [LOG] 📋 Record ID: d9904d91-8612-4220-8ddb-82f488343b7a
[2025-10-07T17:17:52.228Z] [LOG] 🔍 Component filtering for employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:52.228Z] [LOG]    Total components: 8
[2025-10-07T17:17:52.228Z] [LOG]    Applicable components: 8
[2025-10-07T17:17:52.229Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-07T17:17:52.766Z] [LOG] 🔍 Fetched 0 attendance records for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:52.767Z] [LOG] ⚠️  ATTENTION: Employee 0143ac0c-7105-11f0-a50f-98e743540430 has NO attendance records in this payroll period!
[2025-10-07T17:17:52.879Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:53.533Z] [LOG] Employee 0143ac0c-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:17:53.533Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8h = 160h
[2025-10-07T17:17:53.534Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:53.534Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:53.535Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:53.535Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:53.535Z] [LOG] ================================================================================
[2025-10-07T17:17:53.535Z] [LOG] ================================================================================
[2025-10-07T17:17:53.536Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:53.536Z] [LOG]    Sum of all daily counted hours (rounded): 0h
[2025-10-07T17:17:53.536Z] [LOG]    Expected hours: 160h
[2025-10-07T17:17:53.536Z] [LOG]    Shortfall: 160.00h
[2025-10-07T17:17:53.536Z] [LOG] ================================================================================
[2025-10-07T17:17:53.644Z] [LOG] 🔄 Processing financial records for employee 0143ac0c-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:53.644Z] [LOG] 🔄 Processing financial records for employee 0143ac0c-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:53.751Z] [LOG] 📊 Found 0 active loans for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:53.861Z] [LOG] 📊 Found 0 active advances for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:53.969Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:53.969Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:53.970Z] [LOG] 💰 GROSS CALCULATION for Ishara null:
[2025-10-07T17:17:53.970Z] [LOG]    Base Salary: 50000
[2025-10-07T17:17:53.970Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:54.078Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:54.295Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:54.531Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:54.653Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:54.872Z] [LOG] Employee 0143ac0c-7105-11f0-a50f-98e743540430 has no attendance records with scheduled times for period 2025-08-01 to 2025-08-31, using default: 8h
[2025-10-07T17:17:54.872Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:54.872Z] [LOG] ============================================================
[2025-10-07T17:17:54.873Z] [LOG] 👤 Employee ID: 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:54.873Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:17:54.873Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:54.873Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:54.873Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-07T17:17:54.873Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:17:54.873Z] [LOG] ⏱️  Hourly Rate: 250.00
[2025-10-07T17:17:54.873Z] [LOG] 
[2025-10-07T17:17:54.874Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:54.874Z] [LOG]    Expected Hours: 160
[2025-10-07T17:17:54.874Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8h = 200.00h
[2025-10-07T17:17:54.874Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:54.874Z] [LOG]    Worked Hours: 0
[2025-10-07T17:17:54.874Z] [LOG]    ⚠️  Shortfall Hours: 160
[2025-10-07T17:17:54.875Z] [LOG]    💸 Shortfall Deduction: 160h × 250.00 = 40000.00
[2025-10-07T17:17:54.875Z] [LOG] ============================================================
[2025-10-07T17:17:55.307Z] [LOG] 📅 Weekend absence check for employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:55.307Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:55.308Z] [LOG]    Attended weekend dates: 0 days
[2025-10-07T17:17:55.308Z] [LOG]    Absent weekend dates: 5 days
[2025-10-07T17:17:55.308Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:55.308Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:17:55.308Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:55.308Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:55.308Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:55.309Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:55.309Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:55.309Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:55.309Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:55.309Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:55.309Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:55.309Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:55.309Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:55.310Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:55.310Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:55.310Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:55.310Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:55.310Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:55.310Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:55.310Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:55.311Z] [LOG] Regular deductions for Ishara null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:55.311Z] [LOG] Combined deductions for Ishara null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 40000,
      "details": "160 hours × 250.00"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 10000,
      "details": "5 weekend days × 2000.00"
    }
  ],
  "total": 50000
}
[2025-10-07T17:17:55.418Z] [LOG] Creating components for record d9904d91-8612-4220-8ddb-82f488343b7a: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:55.419Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 40000
}
[2025-10-07T17:17:55.528Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:17:55.635Z] [LOG] Created payroll_record_component: 82fed8b2-6bab-4b53-8dcc-66d5cc25553c for Working Hours Shortfall
[2025-10-07T17:17:55.636Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 10000
}
[2025-10-07T17:17:55.743Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:17:55.851Z] [LOG] Created payroll_record_component: 95a285bf-4f77-4fe3-980e-cb8a6dbb5989 for Weekend Absent Days
[2025-10-07T17:17:56.175Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:56.176Z] [ERROR] ❌ Error updating financial balances for employee 0143ac0c-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:17:56.176Z] [LOG] ✅ Ishara null: Calculation completed successfully
[2025-10-07T17:17:56.176Z] [LOG] 📊 Progress: 31/34 (91.2%)
[2025-10-07T17:17:56.176Z] [LOG] 
🧮 Processing: Piyumi null (EMP000025)
[2025-10-07T17:17:56.177Z] [LOG] 📋 Record ID: e0079539-8ed7-4934-a55c-fda3ba48668b
[2025-10-07T17:17:56.605Z] [LOG] 🔍 Component filtering for employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:56.605Z] [LOG]    Total components: 8
[2025-10-07T17:17:56.605Z] [LOG]    Applicable components: 8
[2025-10-07T17:17:56.605Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-07T17:17:57.251Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:17:57.369Z] [LOG] 🔍 Fetched 21 attendance records for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:57.487Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:17:58.023Z] [LOG] Employee 0143e565-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:58.023Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:17:58.023Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:17:58.024Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:17:58.024Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:58.025Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:17:58.025Z] [LOG] ================================================================================
[2025-10-07T17:17:58.025Z] [LOG] 📅 2025-08-02 (WEEKEND): 3.61h worked → 2.6102777777777777h counted → OVERLAP 10:23-13:00 = 2.610h (attendance table)
[2025-10-07T17:17:58.025Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 2.6102777777777777h
[2025-10-07T17:17:58.026Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.026Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.026Z] [LOG] 📅 2025-08-05 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.026Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.026Z] [LOG] 📅 2025-08-06 (WEEKDAY): 11.58h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.027Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.027Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.027Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.027Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.028Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.028Z] [LOG] 📅 2025-08-12 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.028Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.028Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.49h worked → 8.4875h counted → OVERLAP 08:30-17:00 = 8.488h (attendance table)
[2025-10-07T17:17:58.028Z] [LOG]    ✅ Added to weekday total: 8.4875h
[2025-10-07T17:17:58.028Z] [LOG] 📅 2025-08-15 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.029Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.029Z] [LOG] 📅 2025-08-16 (WEEKEND): 5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:58.029Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:58.029Z] [LOG] 📅 2025-08-18 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.029Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.029Z] [LOG] 📅 2025-08-19 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.029Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.030Z] [LOG] 📅 2025-08-20 (WEEKDAY): 3.96h worked → 3.965h counted → OVERLAP 13:02-17:00 = 3.965h (attendance table)
[2025-10-07T17:17:58.030Z] [LOG]    ✅ Added to weekday total: 3.965h
[2025-10-07T17:17:58.030Z] [LOG] 📅 2025-08-21 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.030Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.030Z] [LOG] 📅 2025-08-22 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.030Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.030Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:58.031Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:58.031Z] [LOG] 📅 2025-08-26 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.031Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.031Z] [LOG] 📅 2025-08-27 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.031Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.031Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.031Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.031Z] [LOG] 📅 2025-08-29 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:17:58.031Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:17:58.031Z] [LOG] 📅 2025-08-30 (WEEKEND): 5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:17:58.032Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:17:58.032Z] [LOG] ================================================================================
[2025-10-07T17:17:58.032Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:17:58.032Z] [LOG]    Sum of all daily counted hours (rounded): 139.9525h
[2025-10-07T17:17:58.032Z] [LOG]    Expected hours: 170h
[2025-10-07T17:17:58.032Z] [LOG]    Shortfall: 30.05h
[2025-10-07T17:17:58.032Z] [LOG] ================================================================================
[2025-10-07T17:17:58.139Z] [LOG] 🔄 Processing financial records for employee 0143e565-7105-11f0-a50f-98e743540430...
[2025-10-07T17:17:58.140Z] [LOG] 🔄 Processing financial records for employee 0143e565-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:17:58.247Z] [LOG] 📊 Found 0 active loans for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:58.355Z] [LOG] 📊 Found 0 active advances for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:58.465Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:58.465Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:17:58.465Z] [LOG] 💰 GROSS CALCULATION for Piyumi null:
[2025-10-07T17:17:58.466Z] [LOG]    Base Salary: 50000
[2025-10-07T17:17:58.466Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:17:58.583Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:17:58.797Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:17:59.025Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:17:59.139Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:17:59.257Z] [LOG] Employee 0143e565-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:17:59.257Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:17:59.258Z] [LOG] ============================================================
[2025-10-07T17:17:59.258Z] [LOG] 👤 Employee ID: 0143e565-7105-11f0-a50f-98e743540430
[2025-10-07T17:17:59.258Z] [LOG] 💰 Base Salary: 50,000
[2025-10-07T17:17:59.258Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:17:59.258Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:17:59.258Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:17:59.259Z] [LOG] 💵 Per-Day Salary: 2000.00
[2025-10-07T17:17:59.259Z] [LOG] ⏱️  Hourly Rate: 235.29
[2025-10-07T17:17:59.259Z] [LOG] 
[2025-10-07T17:17:59.259Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:17:59.259Z] [LOG]    Expected Hours: 170
[2025-10-07T17:17:59.259Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:17:59.259Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:17:59.260Z] [LOG]    Worked Hours: 139.9525
[2025-10-07T17:17:59.260Z] [LOG]    ⚠️  Shortfall Hours: 30.047500000000014
[2025-10-07T17:17:59.260Z] [LOG]    💸 Shortfall Deduction: 30.047500000000014h × 235.29 = 7070.00
[2025-10-07T17:17:59.260Z] [LOG] ============================================================
[2025-10-07T17:17:59.493Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-02 (Saturday)
[2025-10-07T17:17:59.493Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:17:59.494Z] [LOG]    Actual: 10:23:23 - 14:00:00
[2025-10-07T17:17:59.494Z] [LOG]    Calculation: OVERLAP 10:23-13:00 = 2.610h
[2025-10-07T17:17:59.494Z] [LOG]    Payable Hours: 2.610h
[2025-10-07T17:17:59.494Z] [LOG]    Shortfall: 1.890h
[2025-10-07T17:17:59.495Z] [LOG]    Hourly Rate: 444.44 (Day Salary 2000 ÷ 4.5h)
[2025-10-07T17:17:59.495Z] [LOG]    Deduction: 839.88
[2025-10-07T17:17:59.495Z] [LOG] ✅ Weekend Day Met: 2025-08-16 (Saturday)
[2025-10-07T17:17:59.496Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:59.496Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:17:59.496Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:59.497Z] [LOG] ✅ Weekend Day Met: 2025-08-30 (Saturday)
[2025-10-07T17:17:59.497Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:17:59.729Z] [LOG] 📅 Weekend absence check for employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-07T17:17:59.729Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:17:59.729Z] [LOG]    Attended weekend dates: 4 days
[2025-10-07T17:17:59.729Z] [LOG]    Absent weekend dates: 1 days
[2025-10-07T17:17:59.729Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:17:59.729Z] [LOG]    Gross Salary: 50000
[2025-10-07T17:17:59.730Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:17:59.730Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:17:59.730Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:59.730Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:17:59.730Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:59.730Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:17:59.730Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:59.730Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:17:59.730Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:59.731Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:17:59.731Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:59.731Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:17:59.731Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:59.731Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:17:59.731Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:59.731Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:17:59.731Z] [LOG]    Fixed amount: 0
[2025-10-07T17:17:59.731Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:17:59.731Z] [LOG] Regular deductions for Piyumi null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:17:59.732Z] [LOG] Combined deductions for Piyumi null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 839.8765432098766,
      "details": "Total 1.89h shortfall - 2025-08-02 (Saturday): 1.89h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 7070.000000000003,
      "details": "30.047500000000014 hours × 235.29"
    },
    {
      "code": "WEEKEND_ABSENT_DED",
      "name": "Weekend Absent Days",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "1 weekend days × 2000.00"
    }
  ],
  "total": 9909.876543209879
}
[2025-10-07T17:17:59.849Z] [LOG] Creating components for record e0079539-8ed7-4934-a55c-fda3ba48668b: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 3,
  "taxComponentsCount": 0
}
[2025-10-07T17:17:59.849Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 839.8765432098766
}
[2025-10-07T17:17:59.966Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:18:00.084Z] [LOG] Created payroll_record_component: bfee6787-5788-4e08-bb5b-f4a7b0697175 for Weekend Shortfall Deduction
[2025-10-07T17:18:00.084Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 7070.000000000003
}
[2025-10-07T17:18:00.201Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:18:00.321Z] [LOG] Created payroll_record_component: 6767bdaf-691d-4b63-8649-d6440d1e0e90 for Working Hours Shortfall
[2025-10-07T17:18:00.321Z] [LOG] Processing component: {
  "name": "Weekend Absent Days",
  "type": "deduction",
  "amount": 2000
}
[2025-10-07T17:18:00.441Z] [LOG] Using existing component ID: a33d49be-0c47-41d4-bddb-fb73f66cca58
[2025-10-07T17:18:00.556Z] [LOG] Created payroll_record_component: ab0a0948-25d6-4521-beaa-40a4050e3d1f for Weekend Absent Days
[2025-10-07T17:18:00.888Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:18:00.889Z] [ERROR] ❌ Error updating financial balances for employee 0143e565-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:18:00.890Z] [LOG] ✅ Piyumi null: Calculation completed successfully
[2025-10-07T17:18:00.890Z] [LOG] 📊 Progress: 32/34 (94.1%)
[2025-10-07T17:18:00.891Z] [LOG] 
🧮 Processing: Ammaar Ilham (EMP000023)
[2025-10-07T17:18:00.891Z] [LOG] 📋 Record ID: efcc5c76-98a5-4366-9863-201f7f9cd87e
[2025-10-07T17:18:01.325Z] [LOG] 🔍 Component filtering for employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-07T17:18:01.326Z] [LOG]    Total components: 8
[2025-10-07T17:18:01.326Z] [LOG]    Applicable components: 8
[2025-10-07T17:18:01.326Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-07T17:18:01.978Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:02.210Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:02.448Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:02.682Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:02.913Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:03.128Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:03.342Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:03.556Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:03.771Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:03.986Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:04.218Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:04.439Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:04.653Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:04.867Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:04.984Z] [LOG] 🔍 Fetched 25 attendance records for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-07T17:18:05.092Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:18:05.627Z] [LOG] Employee 0143de00-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:18:05.628Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:18:05.628Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:18:05.628Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:18:05.629Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-07T17:18:05.629Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:18:05.629Z] [LOG] ================================================================================
[2025-10-07T17:18:05.629Z] [LOG] 📅 2025-08-01 (WEEKDAY): 8.51h worked → 8.177777777777777h counted → OVERLAP 08:49-17:00 = 8.178h (attendance table)
[2025-10-07T17:18:05.630Z] [LOG]    ✅ Added to weekday total: 8.177777777777777h
[2025-10-07T17:18:05.630Z] [LOG] 📅 2025-08-02 (WEEKEND): 5.93h worked → 3.6008333333333336h counted → OVERLAP 09:23-13:00 = 3.601h (attendance table)
[2025-10-07T17:18:05.630Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.6008333333333336h
[2025-10-07T17:18:05.630Z] [LOG] 📅 2025-08-04 (WEEKDAY): 9.25h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:18:05.630Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:18:05.630Z] [LOG] 📅 2025-08-05 (WEEKDAY): 7.64h worked → 7.103055555555556h counted → OVERLAP 09:53-17:00 = 7.103h (attendance table)
[2025-10-07T17:18:05.630Z] [LOG]    ✅ Added to weekday total: 7.103055555555556h
[2025-10-07T17:18:05.631Z] [LOG] 📅 2025-08-06 (WEEKDAY): 8.1h worked → 7.372777777777777h counted → OVERLAP 09:37-17:00 = 7.373h (attendance table)
[2025-10-07T17:18:05.631Z] [LOG]    ✅ Added to weekday total: 7.372777777777777h
[2025-10-07T17:18:05.631Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:18:05.631Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:18:05.631Z] [LOG] 📅 2025-08-09 (WEEKEND): 4.89h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:18:05.631Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:18:05.631Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8.69h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:18:05.631Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:18:05.632Z] [LOG] 📅 2025-08-12 (WEEKDAY): 8.11h worked → 8.083333333333334h counted → OVERLAP 08:55-17:00 = 8.083h (attendance table)
[2025-10-07T17:18:05.632Z] [LOG]    ✅ Added to weekday total: 8.083333333333334h
[2025-10-07T17:18:05.632Z] [LOG] 📅 2025-08-13 (WEEKDAY): 7.64h worked → 7.1113888888888885h counted → OVERLAP 09:53-17:00 = 7.111h (attendance table)
[2025-10-07T17:18:05.632Z] [LOG]    ✅ Added to weekday total: 7.1113888888888885h
[2025-10-07T17:18:05.632Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.08h worked → 7.684722222222222h counted → OVERLAP 09:18-17:00 = 7.685h (attendance table)
[2025-10-07T17:18:05.632Z] [LOG]    ✅ Added to weekday total: 7.684722222222222h
[2025-10-07T17:18:05.632Z] [LOG] 📅 2025-08-15 (WEEKDAY): 7.36h worked → 6.544444444444444h counted → OVERLAP 10:27-17:00 = 6.544h (attendance table)
[2025-10-07T17:18:05.632Z] [LOG]    ✅ Added to weekday total: 6.544444444444444h
[2025-10-07T17:18:05.632Z] [LOG] 📅 2025-08-16 (WEEKEND): 5.04h worked → 4.403888888888889h counted → OVERLAP 08:35-13:00 = 4.404h (attendance table)
[2025-10-07T17:18:05.632Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.403888888888889h
[2025-10-07T17:18:05.632Z] [LOG] 📅 2025-08-18 (WEEKDAY): 9.58h worked → 8.25h counted → OVERLAP 08:45-17:00 = 8.250h (attendance table)
[2025-10-07T17:18:05.632Z] [LOG]    ✅ Added to weekday total: 8.25h
[2025-10-07T17:18:05.633Z] [LOG] 📅 2025-08-19 (WEEKDAY): 8.79h worked → 8.231666666666667h counted → OVERLAP 08:46-17:00 = 8.232h (attendance table)
[2025-10-07T17:18:05.633Z] [LOG]    ✅ Added to weekday total: 8.231666666666667h
[2025-10-07T17:18:05.633Z] [LOG] 📅 2025-08-20 (WEEKDAY): 8.93h worked → 8.25h counted → OVERLAP 08:45-17:00 = 8.250h (attendance table)
[2025-10-07T17:18:05.633Z] [LOG]    ✅ Added to weekday total: 8.25h
[2025-10-07T17:18:05.633Z] [LOG] 📅 2025-08-21 (WEEKDAY): 4.65h worked → 4.646111111111111h counted → OVERLAP 08:40-13:18 = 4.646h (attendance table)
[2025-10-07T17:18:05.633Z] [LOG]    ✅ Added to weekday total: 4.646111111111111h
[2025-10-07T17:18:05.634Z] [LOG] 📅 2025-08-22 (WEEKDAY): 9.4h worked → 8.441944444444445h counted → OVERLAP 08:33-17:00 = 8.442h (attendance table)
[2025-10-07T17:18:05.634Z] [LOG]    ✅ Added to weekday total: 8.441944444444445h
[2025-10-07T17:18:05.634Z] [LOG] 📅 2025-08-23 (WEEKEND): 5.49h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:18:05.634Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:18:05.634Z] [LOG] 📅 2025-08-25 (WEEKDAY): 9.09h worked → 8.335555555555555h counted → OVERLAP 08:39-17:00 = 8.336h (attendance table)
[2025-10-07T17:18:05.634Z] [LOG]    ✅ Added to weekday total: 8.335555555555555h
[2025-10-07T17:18:05.635Z] [LOG] 📅 2025-08-26 (WEEKDAY): 10.24h worked → 8.422777777777778h counted → OVERLAP 08:34-17:00 = 8.423h (attendance table)
[2025-10-07T17:18:05.635Z] [LOG]    ✅ Added to weekday total: 8.422777777777778h
[2025-10-07T17:18:05.635Z] [LOG] 📅 2025-08-27 (WEEKDAY): 9.68h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:18:05.635Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:18:05.635Z] [LOG] 📅 2025-08-28 (WEEKDAY): 9.39h worked → 8.072777777777778h counted → OVERLAP 08:55-17:00 = 8.073h (attendance table)
[2025-10-07T17:18:05.635Z] [LOG]    ✅ Added to weekday total: 8.072777777777778h
[2025-10-07T17:18:05.635Z] [LOG] 📅 2025-08-29 (WEEKDAY): 8.97h worked → 8.474444444444444h counted → OVERLAP 08:31-17:00 = 8.474h (attendance table)
[2025-10-07T17:18:05.635Z] [LOG]    ✅ Added to weekday total: 8.474444444444444h
[2025-10-07T17:18:05.635Z] [LOG] 📅 2025-08-30 (WEEKEND): 8.28h worked → 4.333333333333333h counted → OVERLAP 08:40-13:00 = 4.333h (attendance table)
[2025-10-07T17:18:05.636Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.333333333333333h
[2025-10-07T17:18:05.636Z] [LOG] ================================================================================
[2025-10-07T17:18:05.636Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:18:05.636Z] [LOG]    Sum of all daily counted hours (rounded): 157.2028h
[2025-10-07T17:18:05.636Z] [LOG]    Expected hours: 170h
[2025-10-07T17:18:05.636Z] [LOG]    Shortfall: 12.80h
[2025-10-07T17:18:05.636Z] [LOG] ================================================================================
[2025-10-07T17:18:05.755Z] [LOG] 🔄 Processing financial records for employee 0143de00-7105-11f0-a50f-98e743540430...
[2025-10-07T17:18:05.755Z] [LOG] 🔄 Processing financial records for employee 0143de00-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:18:05.872Z] [LOG] 📊 Found 0 active loans for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-07T17:18:05.991Z] [LOG] 📊 Found 0 active advances for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-07T17:18:06.108Z] [LOG] 📊 Found 0 approved bonuses for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-07T17:18:06.108Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:18:06.108Z] [LOG] 💰 GROSS CALCULATION for Ammaar Ilham:
[2025-10-07T17:18:06.108Z] [LOG]    Base Salary: 70000
[2025-10-07T17:18:06.108Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:18:06.227Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:18:06.452Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:18:06.667Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:18:06.775Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:18:06.882Z] [LOG] Employee 0143de00-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:18:06.882Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:18:06.882Z] [LOG] ============================================================
[2025-10-07T17:18:06.882Z] [LOG] 👤 Employee ID: 0143de00-7105-11f0-a50f-98e743540430
[2025-10-07T17:18:06.883Z] [LOG] 💰 Base Salary: 70,000
[2025-10-07T17:18:06.883Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:18:06.883Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:18:06.883Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:18:06.883Z] [LOG] 💵 Per-Day Salary: 2800.00
[2025-10-07T17:18:06.883Z] [LOG] ⏱️  Hourly Rate: 329.41
[2025-10-07T17:18:06.884Z] [LOG] 
[2025-10-07T17:18:06.884Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:18:06.884Z] [LOG]    Expected Hours: 170
[2025-10-07T17:18:06.885Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:18:06.885Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:18:06.885Z] [LOG]    Worked Hours: 157.2028
[2025-10-07T17:18:06.885Z] [LOG]    ⚠️  Shortfall Hours: 12.797200000000004
[2025-10-07T17:18:06.885Z] [LOG]    💸 Shortfall Deduction: 12.797200000000004h × 329.41 = 4215.55
[2025-10-07T17:18:06.885Z] [LOG] ============================================================
[2025-10-07T17:18:07.099Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-02 (Saturday)
[2025-10-07T17:18:07.100Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:18:07.100Z] [LOG]    Actual: 09:23:57 - 15:19:51
[2025-10-07T17:18:07.100Z] [LOG]    Calculation: OVERLAP 09:23-13:00 = 3.601h
[2025-10-07T17:18:07.101Z] [LOG]    Payable Hours: 3.601h
[2025-10-07T17:18:07.101Z] [LOG]    Shortfall: 0.899h
[2025-10-07T17:18:07.101Z] [LOG]    Hourly Rate: 622.22 (Day Salary 2800 ÷ 4.5h)
[2025-10-07T17:18:07.101Z] [LOG]    Deduction: 559.48
[2025-10-07T17:18:07.101Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:18:07.101Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:18:07.102Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-16 (Saturday)
[2025-10-07T17:18:07.102Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:18:07.102Z] [LOG]    Actual: 08:35:46 - 13:38:10
[2025-10-07T17:18:07.102Z] [LOG]    Calculation: OVERLAP 08:35-13:00 = 4.404h
[2025-10-07T17:18:07.102Z] [LOG]    Payable Hours: 4.404h
[2025-10-07T17:18:07.103Z] [LOG]    Shortfall: 0.096h
[2025-10-07T17:18:07.103Z] [LOG]    Hourly Rate: 622.22 (Day Salary 2800 ÷ 4.5h)
[2025-10-07T17:18:07.103Z] [LOG]    Deduction: 59.80
[2025-10-07T17:18:07.103Z] [LOG] ✅ Weekend Day Met: 2025-08-23 (Saturday)
[2025-10-07T17:18:07.103Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:18:07.103Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-30 (Saturday)
[2025-10-07T17:18:07.103Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:18:07.104Z] [LOG]    Actual: 08:40:00 - 16:57:00
[2025-10-07T17:18:07.104Z] [LOG]    Calculation: OVERLAP 08:40-13:00 = 4.333h
[2025-10-07T17:18:07.104Z] [LOG]    Payable Hours: 4.333h
[2025-10-07T17:18:07.104Z] [LOG]    Shortfall: 0.167h
[2025-10-07T17:18:07.104Z] [LOG]    Hourly Rate: 622.22 (Day Salary 2800 ÷ 4.5h)
[2025-10-07T17:18:07.105Z] [LOG]    Deduction: 103.70
[2025-10-07T17:18:07.319Z] [LOG] 📅 Weekend absence check for employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-07T17:18:07.320Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:18:07.320Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:18:07.320Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:18:07.320Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:18:07.320Z] [LOG]    Gross Salary: 70000
[2025-10-07T17:18:07.320Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:18:07.321Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:18:07.321Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:07.321Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:18:07.321Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:07.321Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:18:07.321Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:07.321Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:18:07.322Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:07.322Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:18:07.322Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:07.322Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:18:07.322Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:07.323Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:18:07.323Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:07.323Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:18:07.323Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:07.323Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:18:07.323Z] [LOG] Regular deductions for Ammaar Ilham: {
  "components": [],
  "total": 0
}
[2025-10-07T17:18:07.323Z] [LOG] Combined deductions for Ammaar Ilham: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 722.9876543209876,
      "details": "Total 1.16h shortfall - 2025-08-02 (Saturday): 0.90h, 2025-08-16 (Saturday): 0.10h, 2025-08-30 (Saturday): 0.17h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 4215.548235294119,
      "details": "12.797200000000004 hours × 329.41"
    }
  ],
  "total": 4938.5358896151065
}
[2025-10-07T17:18:07.432Z] [LOG] Creating components for record efcc5c76-98a5-4366-9863-201f7f9cd87e: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:18:07.432Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 722.9876543209876
}
[2025-10-07T17:18:07.543Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:18:07.650Z] [LOG] Created payroll_record_component: 673ed021-87f8-49e2-9c07-bde66b234963 for Weekend Shortfall Deduction
[2025-10-07T17:18:07.650Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 4215.548235294119
}
[2025-10-07T17:18:07.764Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:18:07.880Z] [LOG] Created payroll_record_component: 2cf85373-200e-407e-9384-6a3e6efffe66 for Working Hours Shortfall
[2025-10-07T17:18:08.211Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:18:08.212Z] [ERROR] ❌ Error updating financial balances for employee 0143de00-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:18:08.212Z] [LOG] ✅ Ammaar Ilham: Calculation completed successfully
[2025-10-07T17:18:08.212Z] [LOG] 📊 Progress: 33/34 (97.1%)
[2025-10-07T17:18:08.212Z] [LOG] 
🧮 Processing: Maryam null (EMP000035)
[2025-10-07T17:18:08.212Z] [LOG] 📋 Record ID: f14ddb8c-d893-4050-b3b6-24aafd14d459
[2025-10-07T17:18:08.669Z] [LOG] 🔍 Component filtering for employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-07T17:18:08.669Z] [LOG]    Total components: 8
[2025-10-07T17:18:08.669Z] [LOG]    Applicable components: 8
[2025-10-07T17:18:08.669Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-07T17:18:09.314Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:09.569Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:09.782Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:10.001Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:10.215Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:10.430Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:10.644Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:10.862Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:11.077Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:11.298Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:11.513Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:11.730Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:11.946Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:12.161Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:12.375Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-07T17:18:12.486Z] [LOG] 🔍 Fetched 23 attendance records for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-07T17:18:12.603Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-07T17:18:13.139Z] [LOG] Employee 01440221-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:18:13.140Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 20 weekday days × 8.5h = 170h
[2025-10-07T17:18:13.140Z] [LOG]    📊 Working days breakdown: Total=25, Weekdays=20, Weekend=5
[2025-10-07T17:18:13.140Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-07T17:18:13.141Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-07T17:18:13.142Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-07T17:18:13.142Z] [LOG] ================================================================================
[2025-10-07T17:18:13.142Z] [LOG] 📅 2025-08-01 (WEEKDAY): 7.94h worked → 7.7716666666666665h counted → OVERLAP 09:13-17:00 = 7.772h (attendance table)
[2025-10-07T17:18:13.142Z] [LOG]    ✅ Added to weekday total: 7.7716666666666665h
[2025-10-07T17:18:13.142Z] [LOG] 📅 2025-08-02 (WEEKEND): 4.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:18:13.143Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:18:13.143Z] [LOG] 📅 2025-08-04 (WEEKDAY): 8.2h worked → 8.2h counted → OVERLAP 08:48-17:00 = 8.200h (attendance table)
[2025-10-07T17:18:13.143Z] [LOG]    ✅ Added to weekday total: 8.2h
[2025-10-07T17:18:13.143Z] [LOG] 📅 2025-08-06 (WEEKDAY): 8.75h worked → 8.481666666666667h counted → OVERLAP 08:31-17:00 = 8.482h (attendance table)
[2025-10-07T17:18:13.143Z] [LOG]    ✅ Added to weekday total: 8.481666666666667h
[2025-10-07T17:18:13.143Z] [LOG] 📅 2025-08-07 (WEEKDAY): 8.55h worked → 8.318888888888889h counted → OVERLAP 08:40-17:00 = 8.319h (attendance table)
[2025-10-07T17:18:13.144Z] [LOG]    ✅ Added to weekday total: 8.318888888888889h
[2025-10-07T17:18:13.144Z] [LOG] 📅 2025-08-09 (WEEKEND): 6h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-07T17:18:13.144Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-07T17:18:13.144Z] [LOG] 📅 2025-08-11 (WEEKDAY): 8.89h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:18:13.144Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:18:13.145Z] [LOG] 📅 2025-08-12 (WEEKDAY): 8.65h worked → 8.31861111111111h counted → OVERLAP 08:40-17:00 = 8.319h (attendance table)
[2025-10-07T17:18:13.145Z] [LOG]    ✅ Added to weekday total: 8.31861111111111h
[2025-10-07T17:18:13.145Z] [LOG] 📅 2025-08-13 (WEEKDAY): 8.9h worked → 8.440833333333334h counted → OVERLAP 08:33-17:00 = 8.441h (attendance table)
[2025-10-07T17:18:13.145Z] [LOG]    ✅ Added to weekday total: 8.440833333333334h
[2025-10-07T17:18:13.146Z] [LOG] 📅 2025-08-14 (WEEKDAY): 8.95h worked → 8.490833333333333h counted → OVERLAP 08:30-17:00 = 8.491h (attendance table)
[2025-10-07T17:18:13.146Z] [LOG]    ✅ Added to weekday total: 8.490833333333333h
[2025-10-07T17:18:13.146Z] [LOG] 📅 2025-08-15 (WEEKDAY): 8.97h worked → 8.333333333333334h counted → OVERLAP 08:40-17:00 = 8.333h (attendance table)
[2025-10-07T17:18:13.146Z] [LOG]    ✅ Added to weekday total: 8.333333333333334h
[2025-10-07T17:18:13.146Z] [LOG] 📅 2025-08-16 (WEEKEND): 5.12h worked → 4.370555555555556h counted → OVERLAP 08:37-13:00 = 4.371h (attendance table)
[2025-10-07T17:18:13.146Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.370555555555556h
[2025-10-07T17:18:13.146Z] [LOG] 📅 2025-08-18 (WEEKDAY): 8.76h worked → 8.42388888888889h counted → OVERLAP 08:34-17:00 = 8.424h (attendance table)
[2025-10-07T17:18:13.146Z] [LOG]    ✅ Added to weekday total: 8.42388888888889h
[2025-10-07T17:18:13.147Z] [LOG] 📅 2025-08-19 (WEEKDAY): 8.55h worked → 8.332777777777778h counted → OVERLAP 08:40-17:00 = 8.333h (attendance table)
[2025-10-07T17:18:13.147Z] [LOG]    ✅ Added to weekday total: 8.332777777777778h
[2025-10-07T17:18:13.147Z] [LOG] 📅 2025-08-20 (WEEKDAY): 8.82h worked → 8.383333333333333h counted → OVERLAP 08:37-17:00 = 8.383h (attendance table)
[2025-10-07T17:18:13.147Z] [LOG]    ✅ Added to weekday total: 8.383333333333333h
[2025-10-07T17:18:13.147Z] [LOG] 📅 2025-08-21 (WEEKDAY): 8.59h worked → 8.421111111111111h counted → OVERLAP 08:34-17:00 = 8.421h (attendance table)
[2025-10-07T17:18:13.147Z] [LOG]    ✅ Added to weekday total: 8.421111111111111h
[2025-10-07T17:18:13.148Z] [LOG] 📅 2025-08-22 (WEEKDAY): 8.29h worked → 8.0275h counted → OVERLAP 08:58-17:00 = 8.027h (attendance table)
[2025-10-07T17:18:13.148Z] [LOG]    ✅ Added to weekday total: 8.0275h
[2025-10-07T17:18:13.148Z] [LOG] 📅 2025-08-23 (WEEKEND): 4.48h worked → 3.961388888888889h counted → OVERLAP 09:02-13:00 = 3.961h (attendance table)
[2025-10-07T17:18:13.148Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 3.961388888888889h
[2025-10-07T17:18:13.148Z] [LOG] 📅 2025-08-25 (WEEKDAY): 8.68h worked → 8.224722222222223h counted → OVERLAP 08:46-17:00 = 8.225h (attendance table)
[2025-10-07T17:18:13.148Z] [LOG]    ✅ Added to weekday total: 8.224722222222223h
[2025-10-07T17:18:13.148Z] [LOG] 📅 2025-08-27 (WEEKDAY): 8.84h worked → 8.266388888888889h counted → OVERLAP 08:44-17:00 = 8.266h (attendance table)
[2025-10-07T17:18:13.149Z] [LOG]    ✅ Added to weekday total: 8.266388888888889h
[2025-10-07T17:18:13.149Z] [LOG] 📅 2025-08-28 (WEEKDAY): 8.87h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-07T17:18:13.149Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-07T17:18:13.149Z] [LOG] 📅 2025-08-29 (WEEKDAY): 6.98h worked → 6.6433333333333335h counted → OVERLAP 10:21-17:00 = 6.643h (attendance table)
[2025-10-07T17:18:13.149Z] [LOG]    ✅ Added to weekday total: 6.6433333333333335h
[2025-10-07T17:18:13.149Z] [LOG] 📅 2025-08-30 (WEEKEND): 4.98h worked → 4.416666666666667h counted → OVERLAP 08:35-13:00 = 4.417h (attendance table)
[2025-10-07T17:18:13.150Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.416666666666667h
[2025-10-07T17:18:13.150Z] [LOG] ================================================================================
[2025-10-07T17:18:13.150Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-07T17:18:13.150Z] [LOG]    Sum of all daily counted hours (rounded): 148.0789h
[2025-10-07T17:18:13.150Z] [LOG]    Expected hours: 170h
[2025-10-07T17:18:13.150Z] [LOG]    Shortfall: 21.92h
[2025-10-07T17:18:13.150Z] [LOG] ================================================================================
[2025-10-07T17:18:13.258Z] [LOG] 🔄 Processing financial records for employee 01440221-7105-11f0-a50f-98e743540430...
[2025-10-07T17:18:13.259Z] [LOG] 🔄 Processing financial records for employee 01440221-7105-11f0-a50f-98e743540430 in period 2025-08-01 to 2025-08-31
[2025-10-07T17:18:13.367Z] [LOG] 📊 Found 0 active loans for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-07T17:18:13.475Z] [LOG] 📊 Found 0 active advances for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-07T17:18:13.584Z] [LOG] 📊 Found 0 approved bonuses for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-07T17:18:13.584Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-07T17:18:13.584Z] [LOG] 💰 GROSS CALCULATION for Maryam null:
[2025-10-07T17:18:13.584Z] [LOG]    Base Salary: 40000
[2025-10-07T17:18:13.584Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-07T17:18:13.691Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-07T17:18:13.907Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-08-01 to 2025-08-31
[2025-10-07T17:18:14.142Z] [LOG] 📊 CALCULATED WORKING DAYS: 25 days (excluding weekends & holidays)
[2025-10-07T17:18:14.259Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN: {
  "standard_working_days": 20,
  "weekend_working_days": 5,
  "weekend_full_day_weight": 5,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-07T17:18:14.376Z] [LOG] Employee 01440221-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-08-01 to 2025-08-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-07T17:18:14.377Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-07T17:18:14.377Z] [LOG] ============================================================
[2025-10-07T17:18:14.377Z] [LOG] 👤 Employee ID: 01440221-7105-11f0-a50f-98e743540430
[2025-10-07T17:18:14.378Z] [LOG] 💰 Base Salary: 40,000
[2025-10-07T17:18:14.378Z] [LOG] 📅 Working Days: 25 (Raw: 25)
[2025-10-07T17:18:14.378Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-07T17:18:14.378Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-07T17:18:14.379Z] [LOG] 💵 Per-Day Salary: 1600.00
[2025-10-07T17:18:14.379Z] [LOG] ⏱️  Hourly Rate: 188.24
[2025-10-07T17:18:14.379Z] [LOG] 
[2025-10-07T17:18:14.380Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-07T17:18:14.380Z] [LOG]    Expected Hours: 170
[2025-10-07T17:18:14.380Z] [LOG]    📋 CALCULATION CHECK: 25 days × 8.5h = 212.50h
[2025-10-07T17:18:14.380Z] [LOG]    ❗ DISCREPANCY: YES - Values don't match!
[2025-10-07T17:18:14.381Z] [LOG]    Worked Hours: 148.0789
[2025-10-07T17:18:14.381Z] [LOG]    ⚠️  Shortfall Hours: 21.921099999999996
[2025-10-07T17:18:14.381Z] [LOG]    💸 Shortfall Deduction: 21.921099999999996h × 188.24 = 4126.32
[2025-10-07T17:18:14.381Z] [LOG] ============================================================
[2025-10-07T17:18:14.614Z] [LOG] ✅ Weekend Day Met: 2025-08-02 (Saturday)
[2025-10-07T17:18:14.614Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:18:14.614Z] [LOG] ✅ Weekend Day Met: 2025-08-09 (Saturday)
[2025-10-07T17:18:14.615Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-07T17:18:14.615Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-16 (Saturday)
[2025-10-07T17:18:14.615Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:18:14.616Z] [LOG]    Actual: 08:37:46 - 13:45:00
[2025-10-07T17:18:14.616Z] [LOG]    Calculation: OVERLAP 08:37-13:00 = 4.371h
[2025-10-07T17:18:14.616Z] [LOG]    Payable Hours: 4.371h
[2025-10-07T17:18:14.617Z] [LOG]    Shortfall: 0.129h
[2025-10-07T17:18:14.617Z] [LOG]    Hourly Rate: 355.56 (Day Salary 1600 ÷ 4.5h)
[2025-10-07T17:18:14.617Z] [LOG]    Deduction: 46.02
[2025-10-07T17:18:14.617Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-23 (Saturday)
[2025-10-07T17:18:14.618Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:18:14.618Z] [LOG]    Actual: 09:02:19 - 13:31:22
[2025-10-07T17:18:14.618Z] [LOG]    Calculation: OVERLAP 09:02-13:00 = 3.961h
[2025-10-07T17:18:14.618Z] [LOG]    Payable Hours: 3.961h
[2025-10-07T17:18:14.618Z] [LOG]    Shortfall: 0.539h
[2025-10-07T17:18:14.619Z] [LOG]    Hourly Rate: 355.56 (Day Salary 1600 ÷ 4.5h)
[2025-10-07T17:18:14.619Z] [LOG]    Deduction: 191.51
[2025-10-07T17:18:14.619Z] [LOG] 🏗️  Weekend Shortfall: 2025-08-30 (Saturday)
[2025-10-07T17:18:14.620Z] [LOG]    Scheduled: 08:30 - 13:00 = 4.5h
[2025-10-07T17:18:14.620Z] [LOG]    Actual: 08:35:00 - 13:34:00
[2025-10-07T17:18:14.620Z] [LOG]    Calculation: OVERLAP 08:35-13:00 = 4.417h
[2025-10-07T17:18:14.620Z] [LOG]    Payable Hours: 4.417h
[2025-10-07T17:18:14.621Z] [LOG]    Shortfall: 0.083h
[2025-10-07T17:18:14.621Z] [LOG]    Hourly Rate: 355.56 (Day Salary 1600 ÷ 4.5h)
[2025-10-07T17:18:14.621Z] [LOG]    Deduction: 29.63
[2025-10-07T17:18:14.852Z] [LOG] 📅 Weekend absence check for employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-07T17:18:14.852Z] [LOG]    Scheduled weekend dates: 5 days
[2025-10-07T17:18:14.853Z] [LOG]    Attended weekend dates: 5 days
[2025-10-07T17:18:14.853Z] [LOG]    Absent weekend dates: 0 days
[2025-10-07T17:18:14.853Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-07T17:18:14.853Z] [LOG]    Gross Salary: 40000
[2025-10-07T17:18:14.854Z] [LOG]    📋 Processing 8 configured deduction components
[2025-10-07T17:18:14.854Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-07T17:18:14.854Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:14.854Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-07T17:18:14.855Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:14.855Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-07T17:18:14.855Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:14.855Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-07T17:18:14.855Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:14.855Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-07T17:18:14.856Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:14.856Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-07T17:18:14.856Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:14.856Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-07T17:18:14.856Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:14.856Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-07T17:18:14.856Z] [LOG]    Fixed amount: 0
[2025-10-07T17:18:14.857Z] [LOG]    📊 Total Deductions: 0
[2025-10-07T17:18:14.857Z] [LOG] Regular deductions for Maryam null: {
  "components": [],
  "total": 0
}
[2025-10-07T17:18:14.857Z] [LOG] Combined deductions for Maryam null: {
  "components": [
    {
      "code": "WEEKEND_SHORTFALL",
      "name": "Weekend Shortfall Deduction",
      "type": "deduction",
      "category": "other",
      "amount": 267.1604938271602,
      "details": "Total 0.75h shortfall - 2025-08-16 (Saturday): 0.13h, 2025-08-23 (Saturday): 0.54h, 2025-08-30 (Saturday): 0.08h"
    },
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 4126.324705882353,
      "details": "21.921099999999996 hours × 188.24"
    }
  ],
  "total": 4393.485199709513
}
[2025-10-07T17:18:14.968Z] [LOG] Creating components for record f14ddb8c-d893-4050-b3b6-24aafd14d459: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 2,
  "taxComponentsCount": 0
}
[2025-10-07T17:18:14.969Z] [LOG] Processing component: {
  "name": "Weekend Shortfall Deduction",
  "type": "deduction",
  "amount": 267.1604938271602
}
[2025-10-07T17:18:15.077Z] [LOG] Using existing component ID: 106fdfbf-ee30-432b-8a98-9c8f6cef1ae1
[2025-10-07T17:18:15.185Z] [LOG] Created payroll_record_component: e76f4556-c266-41d5-9e91-2067821ce8c1 for Weekend Shortfall Deduction
[2025-10-07T17:18:15.186Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 4126.324705882353
}
[2025-10-07T17:18:15.294Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-07T17:18:15.402Z] [LOG] Created payroll_record_component: f7f2d8e5-9228-4f6b-8594-f9cd85d605fa for Working Hours Shortfall
[2025-10-07T17:18:15.727Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:18:15.728Z] [ERROR] ❌ Error updating financial balances for employee 01440221-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-07T17:18:15.729Z] [LOG] ✅ Maryam null: Calculation completed successfully
[2025-10-07T17:18:15.729Z] [LOG] 📊 Progress: 34/34 (100.0%)
[2025-10-07T17:18:15.729Z] [LOG] 
============================================================
[2025-10-07T17:18:15.729Z] [LOG] 📈 Processing Summary: 34 successful, 0 failed
[2025-10-07T17:18:16.816Z] [LOG] 🎉 Payroll calculation completed successfully!
[2025-10-07T17:18:16.817Z] [LOG] 📊 Final Summary: 34 processed, 0 errors
[2025-10-07T17:18:16.818Z] [INFO] ================================================================================
[2025-10-07T17:18:16.818Z] [INFO] ⏰ Completed at: 2025-10-07T17:18:16.818Z
[2025-10-07T17:18:16.818Z] [INFO] 📊 Total log entries: 4815