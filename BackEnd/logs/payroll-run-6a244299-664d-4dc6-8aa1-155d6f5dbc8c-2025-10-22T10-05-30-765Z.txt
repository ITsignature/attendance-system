[2025-10-22T10:05:30.766Z] [INFO] 🚀 Payroll calculation logging started for run: 6a244299-664d-4dc6-8aa1-155d6f5dbc8c
[2025-10-22T10:05:30.766Z] [INFO] 📁 Log file: D:\attendance-system\BackEnd\logs\payroll-run-6a244299-664d-4dc6-8aa1-155d6f5dbc8c-2025-10-22T10-05-30-765Z.txt
[2025-10-22T10:05:30.766Z] [INFO] ⏰ Started at: 2025-10-22T10:05:30.766Z
[2025-10-22T10:05:30.766Z] [INFO] ================================================================================
[2025-10-22T10:05:30.766Z] [LOG] 🚀 Starting payroll calculation for run: 6a244299-664d-4dc6-8aa1-155d6f5dbc8c
[2025-10-22T10:05:30.767Z] [LOG] 👤 Client ID: it-signature, User ID: 059304ea-24a5-4d78-a290-cf09b9e53c4c
[2025-10-22T10:05:31.310Z] [LOG] ✅ Payroll run verified: October (MONTHLY_2025_10_REGULAR)
[2025-10-22T10:05:31.677Z] [LOG] 📊 Status updated to 'calculating'
[2025-10-22T10:05:32.255Z] [LOG] 👥 Processing 34 employee records:
[2025-10-22T10:05:32.256Z] [LOG] ============================================================
[2025-10-22T10:05:32.257Z] [LOG] 
🧮 Processing: Dharshika null (EMP000009)
[2025-10-22T10:05:32.257Z] [LOG] 📋 Record ID: 0668d3f5-c29f-4f7f-9e6d-1e775582398f
[2025-10-22T10:05:32.259Z] [LOG] 
======================================================================
[2025-10-22T10:05:32.260Z] [LOG] 🧮 CALCULATING PAYROLL: Dharshika null (EMP000009)
[2025-10-22T10:05:32.261Z] [LOG] ======================================================================
[2025-10-22T10:05:33.879Z] [LOG] 🔍 Component filtering for employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-22T10:05:33.880Z] [LOG]    Total components: 10
[2025-10-22T10:05:33.880Z] [LOG]    Applicable components: 10
[2025-10-22T10:05:33.881Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-22T10:05:36.540Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:05:36.541Z] [LOG] 🔄 Processing financial records for employee 0143a994-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:05:37.124Z] [LOG] 📊 Found 0 active loans for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:37.584Z] [LOG] 📊 Found 0 active advances for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:38.991Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:38.993Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:05:38.994Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:05:38.996Z] [LOG] 💰 GROSS CALCULATION for Dharshika null:
[2025-10-22T10:05:38.997Z] [LOG]    Base Salary: 100000
[2025-10-22T10:05:38.998Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:05:38.999Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:05:39.000Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:39.427Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:05:39.795Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:05:39.795Z] [LOG]    Employee ID: 0143a994-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:39.795Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:05:39.796Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:05:39.796Z] [LOG]    Base Salary (Full Month): Rs.100000.00
[2025-10-22T10:05:40.352Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:05:40.352Z] [LOG]       Daily Salary: Rs.4000.00
[2025-10-22T10:05:40.353Z] [LOG]       Weekday Hourly Rate: Rs.470.59
[2025-10-22T10:05:40.354Z] [LOG]       Saturday Hourly Rate: Rs.888.89
[2025-10-22T10:05:40.354Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:05:40.356Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:05:40.357Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:05:41.492Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:05:41.493Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:05:41.850Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:05:41.851Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:05:41.851Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:05:41.852Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:42.246Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:05:42.247Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:05:42.247Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:05:42.249Z] [LOG]       Current Time: 15:35:42
[2025-10-22T10:05:42.249Z] [LOG]       Expected Hours (scheduled → now): 7.10h
[2025-10-22T10:05:42.250Z] [LOG]       Actual Hours (check-in → now): 7.10h
[2025-10-22T10:05:42.251Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:05:42.251Z] [LOG]       Weekday: 117.60h
[2025-10-22T10:05:42.252Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:05:42.253Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:42.254Z] [LOG]       Total Expected: 131.10h
[2025-10-22T10:05:42.254Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:05:42.257Z] [LOG]       Weekday: 24.10h (includes 7.10h live)
[2025-10-22T10:05:42.259Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:05:42.261Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:42.261Z] [LOG]       Total Actual: 28.60h
[2025-10-22T10:05:42.262Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:05:42.263Z] [LOG]       Weekday: 117.60h × Rs.470.59 = Rs.55339.06
[2025-10-22T10:05:42.264Z] [LOG]       Saturday: 13.50h × Rs.888.89 = Rs.12000.01
[2025-10-22T10:05:42.264Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:05:42.265Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:42.266Z] [LOG]       Total Expected Earned: Rs.67339.08
[2025-10-22T10:05:42.266Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:05:42.267Z] [LOG]       Weekday: 24.10h × Rs.470.59 = Rs.11338.90
[2025-10-22T10:05:42.268Z] [LOG]       Saturday: 4.50h × Rs.888.89 = Rs.4000.01
[2025-10-22T10:05:42.268Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:05:42.269Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:42.270Z] [LOG]       Total Actual Earned: Rs.15338.90
[2025-10-22T10:05:42.271Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:05:42.274Z] [LOG]       Calculated At: Oct 22, 2025, 15:35:42
[2025-10-22T10:05:42.275Z] [LOG]       Expected Earned (until NOW): Rs.67339.08
[2025-10-22T10:05:42.275Z] [LOG]       Actual Earned (until NOW): Rs.15338.90
[2025-10-22T10:05:42.276Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:42.276Z] [LOG]       Attendance Deduction: Rs.52000.18
[2025-10-22T10:05:42.277Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:05:42.277Z] [LOG]       📉 Shortfall: 102.50 hours (77.22% of expected)
[2025-10-22T10:05:42.278Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:05:42.278Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:05:42.280Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:05:42.280Z] [LOG]    Gross Salary: 100000
[2025-10-22T10:05:42.280Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:05:42.281Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:05:42.281Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:42.282Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:05:42.282Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:42.282Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:05:42.283Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:42.283Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:05:42.284Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:42.284Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:05:42.284Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:42.285Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:05:42.285Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:42.286Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:05:42.286Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:42.287Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:05:42.287Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:42.288Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:05:42.292Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:42.293Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:05:42.294Z] [LOG] Regular deductions for Dharshika null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:05:42.294Z] [LOG] Combined deductions for Dharshika null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 52000.175,
      "details": "Shortfall: 102.50h of 131.10h expected (calculated at Oct 22, 2025, 15:35:42)"
    }
  ],
  "total": 52000.175
}
[2025-10-22T10:05:42.768Z] [LOG] Creating components for record 0668d3f5-c29f-4f7f-9e6d-1e775582398f: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:05:42.770Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 52000.175
}
[2025-10-22T10:05:43.122Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:05:43.482Z] [LOG] Created payroll_record_component: 29a70b49-1c76-4272-a8a8-c9780273f5fc for Attendance Deduction
[2025-10-22T10:05:43.837Z] [LOG] ✅ Financial balances updated successfully for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:43.838Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:05:43.839Z] [LOG] 
======================================================================
[2025-10-22T10:05:43.840Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Dharshika null
[2025-10-22T10:05:43.841Z] [LOG] ======================================================================
[2025-10-22T10:05:43.841Z] [LOG]    Gross Salary: Rs.100000.00
[2025-10-22T10:05:43.842Z] [LOG]    Total Deductions: Rs.52000.18
[2025-10-22T10:05:43.843Z] [LOG]       - Attendance Deduction: Rs.52000.18
[2025-10-22T10:05:43.843Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:05:43.844Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:05:43.845Z] [LOG]    NET SALARY: Rs.47999.82
[2025-10-22T10:05:43.845Z] [LOG] ======================================================================

[2025-10-22T10:05:43.846Z] [LOG] ✅ Dharshika null: Calculation completed successfully
[2025-10-22T10:05:43.847Z] [LOG] 📊 Progress: 1/34 (2.9%)
[2025-10-22T10:05:43.847Z] [LOG] 
🧮 Processing: R. D.A Kaushalya null (EMP000044)
[2025-10-22T10:05:43.849Z] [LOG] 📋 Record ID: 34c97a70-e3be-4b23-b12a-db2cb57cf5a9
[2025-10-22T10:05:43.850Z] [LOG] 
======================================================================
[2025-10-22T10:05:43.850Z] [LOG] 🧮 CALCULATING PAYROLL: R. D.A Kaushalya null (EMP000044)
[2025-10-22T10:05:43.851Z] [LOG] ======================================================================
[2025-10-22T10:05:44.590Z] [LOG] 🔍 Component filtering for employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-22T10:05:44.591Z] [LOG]    Total components: 10
[2025-10-22T10:05:44.591Z] [LOG]    Applicable components: 10
[2025-10-22T10:05:44.592Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-22T10:05:45.666Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:05:45.667Z] [LOG] 🔄 Processing financial records for employee 01443963-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:05:45.844Z] [LOG] 📊 Found 0 active loans for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:46.021Z] [LOG] 📊 Found 0 active advances for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:46.199Z] [LOG] 📊 Found 0 approved bonuses for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:46.200Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:05:46.202Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:05:46.203Z] [LOG] 💰 GROSS CALCULATION for R. D.A Kaushalya null:
[2025-10-22T10:05:46.203Z] [LOG]    Base Salary: 50000
[2025-10-22T10:05:46.204Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:05:46.205Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:05:46.207Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:46.385Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:05:46.564Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:05:46.565Z] [LOG]    Employee ID: 01443963-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:46.566Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:05:46.566Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:05:46.567Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:05:46.750Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:05:46.751Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:05:46.751Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:05:46.752Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:05:46.753Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:05:46.753Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:05:46.754Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:05:47.296Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:05:47.297Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:05:47.478Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:05:47.479Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:05:47.479Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:05:47.480Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:47.658Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:05:47.659Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:05:47.659Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:05:47.660Z] [LOG]       Current Time: 15:35:47
[2025-10-22T10:05:47.660Z] [LOG]       Expected Hours (scheduled → now): 7.10h
[2025-10-22T10:05:47.661Z] [LOG]       Actual Hours (check-in → now): 7.10h
[2025-10-22T10:05:47.661Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:05:47.661Z] [LOG]       Weekday: 117.60h
[2025-10-22T10:05:47.662Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:05:47.662Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:47.662Z] [LOG]       Total Expected: 131.10h
[2025-10-22T10:05:47.663Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:05:47.663Z] [LOG]       Weekday: 24.10h (includes 7.10h live)
[2025-10-22T10:05:47.663Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:05:47.664Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:47.664Z] [LOG]       Total Actual: 28.60h
[2025-10-22T10:05:47.664Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:05:47.665Z] [LOG]       Weekday: 117.60h × Rs.235.29 = Rs.27669.30
[2025-10-22T10:05:47.665Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:05:47.666Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:05:47.666Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:47.666Z] [LOG]       Total Expected Earned: Rs.33669.24
[2025-10-22T10:05:47.667Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:05:47.667Z] [LOG]       Weekday: 24.10h × Rs.235.29 = Rs.5669.68
[2025-10-22T10:05:47.668Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:05:47.668Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:05:47.668Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:47.668Z] [LOG]       Total Actual Earned: Rs.7669.66
[2025-10-22T10:05:47.669Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:05:47.670Z] [LOG]       Calculated At: Oct 22, 2025, 15:35:47
[2025-10-22T10:05:47.670Z] [LOG]       Expected Earned (until NOW): Rs.33669.24
[2025-10-22T10:05:47.670Z] [LOG]       Actual Earned (until NOW): Rs.7669.66
[2025-10-22T10:05:47.670Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:47.671Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-22T10:05:47.671Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:05:47.673Z] [LOG]       📉 Shortfall: 102.50 hours (77.22% of expected)
[2025-10-22T10:05:47.674Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:05:47.675Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:05:47.676Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:05:47.676Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:05:47.677Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:05:47.677Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:05:47.677Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:47.678Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:05:47.678Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:47.678Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:05:47.679Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:47.679Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:05:47.679Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:47.680Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:05:47.681Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:47.681Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:05:47.681Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:47.682Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:05:47.682Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:47.683Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:05:47.683Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:47.683Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:05:47.684Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:47.684Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:05:47.684Z] [LOG] Regular deductions for R. D.A Kaushalya null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:05:47.685Z] [LOG] Combined deductions for R. D.A Kaushalya null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.574999999997,
      "details": "Shortfall: 102.50h of 131.10h expected (calculated at Oct 22, 2025, 15:35:47)"
    }
  ],
  "total": 25999.574999999997
}
[2025-10-22T10:05:47.865Z] [LOG] Creating components for record 34c97a70-e3be-4b23-b12a-db2cb57cf5a9: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:05:47.867Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-22T10:05:48.051Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:05:48.232Z] [LOG] Created payroll_record_component: b52b054f-c3b5-4f4d-89a6-779812b3ace1 for Attendance Deduction
[2025-10-22T10:05:48.584Z] [LOG] ✅ Financial balances updated successfully for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:48.584Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:05:48.585Z] [LOG] 
======================================================================
[2025-10-22T10:05:48.586Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: R. D.A Kaushalya null
[2025-10-22T10:05:48.586Z] [LOG] ======================================================================
[2025-10-22T10:05:48.587Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:05:48.588Z] [LOG]    Total Deductions: Rs.25999.57
[2025-10-22T10:05:48.589Z] [LOG]       - Attendance Deduction: Rs.25999.57
[2025-10-22T10:05:48.590Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:05:48.590Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:05:48.591Z] [LOG]    NET SALARY: Rs.24000.43
[2025-10-22T10:05:48.592Z] [LOG] ======================================================================

[2025-10-22T10:05:48.593Z] [LOG] ✅ R. D.A Kaushalya null: Calculation completed successfully
[2025-10-22T10:05:48.593Z] [LOG] 📊 Progress: 2/34 (5.9%)
[2025-10-22T10:05:48.594Z] [LOG] 
🧮 Processing: Jessie null (EMP000013)
[2025-10-22T10:05:48.595Z] [LOG] 📋 Record ID: 37693c15-2274-4748-8ad2-ce9e1be9846e
[2025-10-22T10:05:48.596Z] [LOG] 
======================================================================
[2025-10-22T10:05:48.596Z] [LOG] 🧮 CALCULATING PAYROLL: Jessie null (EMP000013)
[2025-10-22T10:05:48.597Z] [LOG] ======================================================================
[2025-10-22T10:05:49.328Z] [LOG] 🔍 Component filtering for employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-22T10:05:49.328Z] [LOG]    Total components: 10
[2025-10-22T10:05:49.329Z] [LOG]    Applicable components: 10
[2025-10-22T10:05:49.329Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-22T10:05:50.402Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:05:50.403Z] [LOG] 🔄 Processing financial records for employee 0143ae6e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:05:50.579Z] [LOG] 📊 Found 0 active loans for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:50.758Z] [LOG] 📊 Found 0 active advances for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:50.937Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:50.937Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:05:50.942Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:05:50.943Z] [LOG] 💰 GROSS CALCULATION for Jessie null:
[2025-10-22T10:05:50.944Z] [LOG]    Base Salary: 60000
[2025-10-22T10:05:50.944Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:05:50.945Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:05:50.946Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:51.122Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:05:51.301Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:05:51.301Z] [LOG]    Employee ID: 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:51.302Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:05:51.303Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:05:51.303Z] [LOG]    Base Salary (Full Month): Rs.60000.00
[2025-10-22T10:05:51.484Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:05:51.485Z] [LOG]       Daily Salary: Rs.2400.00
[2025-10-22T10:05:51.485Z] [LOG]       Weekday Hourly Rate: Rs.282.35
[2025-10-22T10:05:51.486Z] [LOG]       Saturday Hourly Rate: Rs.533.33
[2025-10-22T10:05:51.487Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:05:51.487Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:05:51.488Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:05:52.041Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:05:52.042Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:05:52.222Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:05:52.223Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:05:52.224Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:05:52.224Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:52.403Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:05:52.403Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:05:52.404Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:05:52.406Z] [LOG]       Current Time: 15:35:52
[2025-10-22T10:05:52.406Z] [LOG]       Expected Hours (scheduled → now): 7.10h
[2025-10-22T10:05:52.407Z] [LOG]       Actual Hours (check-in → now): 7.10h
[2025-10-22T10:05:52.408Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:05:52.408Z] [LOG]       Weekday: 117.60h
[2025-10-22T10:05:52.409Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:05:52.410Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:52.411Z] [LOG]       Total Expected: 131.10h
[2025-10-22T10:05:52.411Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:05:52.412Z] [LOG]       Weekday: 24.10h (includes 7.10h live)
[2025-10-22T10:05:52.413Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:05:52.413Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:52.414Z] [LOG]       Total Actual: 28.60h
[2025-10-22T10:05:52.415Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:05:52.416Z] [LOG]       Weekday: 117.60h × Rs.282.35 = Rs.33203.76
[2025-10-22T10:05:52.416Z] [LOG]       Saturday: 13.50h × Rs.533.33 = Rs.7199.96
[2025-10-22T10:05:52.417Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:05:52.417Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:52.418Z] [LOG]       Total Expected Earned: Rs.40403.72
[2025-10-22T10:05:52.419Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:05:52.420Z] [LOG]       Weekday: 24.10h × Rs.282.35 = Rs.6804.04
[2025-10-22T10:05:52.421Z] [LOG]       Saturday: 4.50h × Rs.533.33 = Rs.2399.99
[2025-10-22T10:05:52.423Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:05:52.424Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:52.427Z] [LOG]       Total Actual Earned: Rs.9204.02
[2025-10-22T10:05:52.428Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:05:52.429Z] [LOG]       Calculated At: Oct 22, 2025, 15:35:52
[2025-10-22T10:05:52.430Z] [LOG]       Expected Earned (until NOW): Rs.40403.72
[2025-10-22T10:05:52.430Z] [LOG]       Actual Earned (until NOW): Rs.9204.02
[2025-10-22T10:05:52.431Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:52.432Z] [LOG]       Attendance Deduction: Rs.31199.70
[2025-10-22T10:05:52.432Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:05:52.433Z] [LOG]       📉 Shortfall: 102.50 hours (77.22% of expected)
[2025-10-22T10:05:52.433Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:05:52.434Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:05:52.435Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:05:52.436Z] [LOG]    Gross Salary: 60000
[2025-10-22T10:05:52.437Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:05:52.438Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:05:52.440Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:52.441Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:05:52.441Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:52.442Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:05:52.442Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:52.442Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:05:52.443Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:52.443Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:05:52.443Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:52.443Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:05:52.444Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:52.444Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:05:52.444Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:52.444Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:05:52.445Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:52.445Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:05:52.446Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:52.446Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:05:52.446Z] [LOG] Regular deductions for Jessie null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:05:52.447Z] [LOG] Combined deductions for Jessie null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 31199.695000000007,
      "details": "Shortfall: 102.50h of 131.10h expected (calculated at Oct 22, 2025, 15:35:52)"
    }
  ],
  "total": 31199.695000000007
}
[2025-10-22T10:05:52.628Z] [LOG] Creating components for record 37693c15-2274-4748-8ad2-ce9e1be9846e: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:05:52.630Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 31199.695000000007
}
[2025-10-22T10:05:52.811Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:05:52.996Z] [LOG] Created payroll_record_component: b945e974-4e04-427d-85e0-a8a5833ad7a7 for Attendance Deduction
[2025-10-22T10:05:53.375Z] [LOG] ✅ Financial balances updated successfully for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:53.376Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:05:53.376Z] [LOG] 
======================================================================
[2025-10-22T10:05:53.377Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Jessie null
[2025-10-22T10:05:53.378Z] [LOG] ======================================================================
[2025-10-22T10:05:53.378Z] [LOG]    Gross Salary: Rs.60000.00
[2025-10-22T10:05:53.379Z] [LOG]    Total Deductions: Rs.31199.70
[2025-10-22T10:05:53.380Z] [LOG]       - Attendance Deduction: Rs.31199.70
[2025-10-22T10:05:53.380Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:05:53.381Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:05:53.382Z] [LOG]    NET SALARY: Rs.28800.30
[2025-10-22T10:05:53.383Z] [LOG] ======================================================================

[2025-10-22T10:05:53.383Z] [LOG] ✅ Jessie null: Calculation completed successfully
[2025-10-22T10:05:53.384Z] [LOG] 📊 Progress: 3/34 (8.8%)
[2025-10-22T10:05:53.385Z] [LOG] 
🧮 Processing: Uthpala null (EMP000006)
[2025-10-22T10:05:53.385Z] [LOG] 📋 Record ID: 3927dd26-aa97-4fee-bc3f-5813f8a6a85c
[2025-10-22T10:05:53.386Z] [LOG] 
======================================================================
[2025-10-22T10:05:53.387Z] [LOG] 🧮 CALCULATING PAYROLL: Uthpala null (EMP000006)
[2025-10-22T10:05:53.388Z] [LOG] ======================================================================
[2025-10-22T10:05:54.114Z] [LOG] 🔍 Component filtering for employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-22T10:05:54.114Z] [LOG]    Total components: 10
[2025-10-22T10:05:54.115Z] [LOG]    Applicable components: 10
[2025-10-22T10:05:54.115Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-22T10:05:55.894Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:05:55.895Z] [LOG] 🔄 Processing financial records for employee 0143a539-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:05:56.077Z] [LOG] 📊 Found 0 active loans for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:56.260Z] [LOG] 📊 Found 0 active advances for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:56.443Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:56.444Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:05:56.445Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:05:56.446Z] [LOG] 💰 GROSS CALCULATION for Uthpala null:
[2025-10-22T10:05:56.446Z] [LOG]    Base Salary: 100000
[2025-10-22T10:05:56.447Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:05:56.447Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:05:56.448Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:56.626Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:05:56.804Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:05:56.805Z] [LOG]    Employee ID: 0143a539-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:56.806Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:05:56.807Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:05:56.808Z] [LOG]    Base Salary (Full Month): Rs.100000.00
[2025-10-22T10:05:56.990Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:05:56.991Z] [LOG]       Daily Salary: Rs.4000.00
[2025-10-22T10:05:56.991Z] [LOG]       Weekday Hourly Rate: Rs.500.00
[2025-10-22T10:05:56.992Z] [LOG]       Saturday Hourly Rate: Rs.888.89
[2025-10-22T10:05:56.993Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:05:56.993Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:05:56.994Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:05:57.533Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:05:57.533Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:05:57.715Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:05:57.716Z] [LOG]       Weekday: 15.00h
[2025-10-22T10:05:57.716Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:05:57.717Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:57.896Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:05:57.897Z] [LOG]       Scheduled Start: 09:30:00
[2025-10-22T10:05:57.898Z] [LOG]       Check-in Time: 09:30:00
[2025-10-22T10:05:57.899Z] [LOG]       Current Time: 15:35:57
[2025-10-22T10:05:57.899Z] [LOG]       Expected Hours (scheduled → now): 6.10h
[2025-10-22T10:05:57.900Z] [LOG]       Actual Hours (check-in → now): 6.10h
[2025-10-22T10:05:57.900Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:05:57.901Z] [LOG]       Weekday: 110.10h
[2025-10-22T10:05:57.902Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:05:57.902Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:57.903Z] [LOG]       Total Expected: 123.60h
[2025-10-22T10:05:57.904Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:05:57.905Z] [LOG]       Weekday: 21.10h (includes 6.10h live)
[2025-10-22T10:05:57.907Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:05:57.908Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:05:57.908Z] [LOG]       Total Actual: 25.60h
[2025-10-22T10:05:57.909Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:05:57.910Z] [LOG]       Weekday: 110.10h × Rs.500.00 = Rs.55049.71
[2025-10-22T10:05:57.910Z] [LOG]       Saturday: 13.50h × Rs.888.89 = Rs.12000.01
[2025-10-22T10:05:57.911Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:05:57.911Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:57.912Z] [LOG]       Total Expected Earned: Rs.67049.72
[2025-10-22T10:05:57.913Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:05:57.914Z] [LOG]       Weekday: 21.10h × Rs.500.00 = Rs.10549.71
[2025-10-22T10:05:57.914Z] [LOG]       Saturday: 4.50h × Rs.888.89 = Rs.4000.01
[2025-10-22T10:05:57.915Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:05:57.916Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:57.917Z] [LOG]       Total Actual Earned: Rs.14549.71
[2025-10-22T10:05:57.919Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:05:57.920Z] [LOG]       Calculated At: Oct 22, 2025, 15:35:57
[2025-10-22T10:05:57.921Z] [LOG]       Expected Earned (until NOW): Rs.67049.72
[2025-10-22T10:05:57.923Z] [LOG]       Actual Earned (until NOW): Rs.14549.71
[2025-10-22T10:05:57.924Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:05:57.924Z] [LOG]       Attendance Deduction: Rs.52500.01
[2025-10-22T10:05:57.925Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:05:57.926Z] [LOG]       📉 Shortfall: 98.00 hours (78.30% of expected)
[2025-10-22T10:05:57.926Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:05:57.927Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:05:57.927Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:05:57.927Z] [LOG]    Gross Salary: 100000
[2025-10-22T10:05:57.928Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:05:57.928Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:05:57.928Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:57.928Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:05:57.929Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:57.929Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:05:57.930Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:57.930Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:05:57.931Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:57.931Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:05:57.931Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:57.931Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:05:57.932Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:57.933Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:05:57.933Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:57.933Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:05:57.933Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:57.934Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:05:57.934Z] [LOG]    Fixed amount: 0
[2025-10-22T10:05:57.934Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:05:57.935Z] [LOG] Regular deductions for Uthpala null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:05:57.935Z] [LOG] Combined deductions for Uthpala null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 52500.009999999995,
      "details": "Shortfall: 98.00h of 123.60h expected (calculated at Oct 22, 2025, 15:35:57)"
    }
  ],
  "total": 52500.009999999995
}
[2025-10-22T10:05:58.121Z] [LOG] Creating components for record 3927dd26-aa97-4fee-bc3f-5813f8a6a85c: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:05:58.124Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 52500.009999999995
}
[2025-10-22T10:05:58.306Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:05:58.486Z] [LOG] Created payroll_record_component: 804d7679-1f69-4dc7-9970-e27addbadcaa for Attendance Deduction
[2025-10-22T10:05:58.846Z] [LOG] ✅ Financial balances updated successfully for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-22T10:05:58.847Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:05:58.848Z] [LOG] 
======================================================================
[2025-10-22T10:05:58.848Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Uthpala null
[2025-10-22T10:05:58.849Z] [LOG] ======================================================================
[2025-10-22T10:05:58.850Z] [LOG]    Gross Salary: Rs.100000.00
[2025-10-22T10:05:58.850Z] [LOG]    Total Deductions: Rs.52500.01
[2025-10-22T10:05:58.851Z] [LOG]       - Attendance Deduction: Rs.52500.01
[2025-10-22T10:05:58.851Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:05:58.852Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:05:58.853Z] [LOG]    NET SALARY: Rs.47499.99
[2025-10-22T10:05:58.854Z] [LOG] ======================================================================

[2025-10-22T10:05:58.854Z] [LOG] ✅ Uthpala null: Calculation completed successfully
[2025-10-22T10:05:58.857Z] [LOG] 📊 Progress: 4/34 (11.8%)
[2025-10-22T10:05:58.858Z] [LOG] 
🧮 Processing: Safna Nawas null (EMP000021)
[2025-10-22T10:05:58.858Z] [LOG] 📋 Record ID: 41b71425-0980-4533-bd2b-58ed498648ec
[2025-10-22T10:05:58.859Z] [LOG] 
======================================================================
[2025-10-22T10:05:58.860Z] [LOG] 🧮 CALCULATING PAYROLL: Safna Nawas null (EMP000021)
[2025-10-22T10:05:58.860Z] [LOG] ======================================================================
[2025-10-22T10:05:59.578Z] [LOG] 🔍 Component filtering for employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-22T10:05:59.578Z] [LOG]    Total components: 10
[2025-10-22T10:05:59.579Z] [LOG]    Applicable components: 10
[2025-10-22T10:05:59.580Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-22T10:06:00.663Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:00.663Z] [LOG] 🔄 Processing financial records for employee 0143c977-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:00.841Z] [LOG] 📊 Found 0 active loans for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:01.020Z] [LOG] 📊 Found 0 active advances for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:01.202Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:01.203Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:01.205Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:01.206Z] [LOG] 💰 GROSS CALCULATION for Safna Nawas null:
[2025-10-22T10:06:01.207Z] [LOG]    Base Salary: 50000
[2025-10-22T10:06:01.207Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:01.208Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:01.209Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:01.386Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:01.565Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:01.566Z] [LOG]    Employee ID: 0143c977-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:01.567Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:01.567Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:01.568Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:06:01.747Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:01.748Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:06:01.748Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:06:01.749Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:06:01.749Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:01.750Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:01.751Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:02.290Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:02.291Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:02.474Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:02.475Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:02.475Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:02.476Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:02.652Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:02.653Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:02.654Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:02.655Z] [LOG]       Current Time: 15:36:02
[2025-10-22T10:06:02.656Z] [LOG]       Expected Hours (scheduled → now): 7.10h
[2025-10-22T10:06:02.657Z] [LOG]       Actual Hours (check-in → now): 7.10h
[2025-10-22T10:06:02.657Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:02.658Z] [LOG]       Weekday: 117.60h
[2025-10-22T10:06:02.659Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:02.660Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:02.660Z] [LOG]       Total Expected: 131.10h
[2025-10-22T10:06:02.661Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:02.662Z] [LOG]       Weekday: 24.10h (includes 7.10h live)
[2025-10-22T10:06:02.662Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:02.663Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:02.664Z] [LOG]       Total Actual: 28.60h
[2025-10-22T10:06:02.665Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:02.666Z] [LOG]       Weekday: 117.60h × Rs.235.29 = Rs.27670.28
[2025-10-22T10:06:02.666Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:06:02.667Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:02.667Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:02.668Z] [LOG]       Total Expected Earned: Rs.33670.22
[2025-10-22T10:06:02.669Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:02.670Z] [LOG]       Weekday: 24.10h × Rs.235.29 = Rs.5670.66
[2025-10-22T10:06:02.671Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:06:02.671Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:02.674Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:02.675Z] [LOG]       Total Actual Earned: Rs.7670.64
[2025-10-22T10:06:02.677Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:02.678Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:02
[2025-10-22T10:06:02.678Z] [LOG]       Expected Earned (until NOW): Rs.33670.22
[2025-10-22T10:06:02.679Z] [LOG]       Actual Earned (until NOW): Rs.7670.64
[2025-10-22T10:06:02.679Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:02.680Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-22T10:06:02.681Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:02.681Z] [LOG]       📉 Shortfall: 102.50 hours (77.22% of expected)
[2025-10-22T10:06:02.682Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:02.683Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:02.683Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:02.684Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:06:02.685Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:02.685Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:02.687Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:02.687Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:02.688Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:02.691Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:02.692Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:02.693Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:02.693Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:02.694Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:02.695Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:02.695Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:02.696Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:02.697Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:02.697Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:02.697Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:02.698Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:02.698Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:02.698Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:02.698Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:02.699Z] [LOG] Regular deductions for Safna Nawas null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:02.699Z] [LOG] Combined deductions for Safna Nawas null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.575000000004,
      "details": "Shortfall: 102.50h of 131.10h expected (calculated at Oct 22, 2025, 15:36:02)"
    }
  ],
  "total": 25999.575000000004
}
[2025-10-22T10:06:02.879Z] [LOG] Creating components for record 41b71425-0980-4533-bd2b-58ed498648ec: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:02.881Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-22T10:06:03.060Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:03.249Z] [LOG] Created payroll_record_component: b686a34c-fb07-49bc-a4ea-562104f3b817 for Attendance Deduction
[2025-10-22T10:06:03.606Z] [LOG] ✅ Financial balances updated successfully for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:03.607Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:03.607Z] [LOG] 
======================================================================
[2025-10-22T10:06:03.608Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Safna Nawas null
[2025-10-22T10:06:03.609Z] [LOG] ======================================================================
[2025-10-22T10:06:03.609Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:06:03.610Z] [LOG]    Total Deductions: Rs.25999.58
[2025-10-22T10:06:03.610Z] [LOG]       - Attendance Deduction: Rs.25999.58
[2025-10-22T10:06:03.611Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:03.612Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:03.612Z] [LOG]    NET SALARY: Rs.24000.42
[2025-10-22T10:06:03.613Z] [LOG] ======================================================================

[2025-10-22T10:06:03.614Z] [LOG] ✅ Safna Nawas null: Calculation completed successfully
[2025-10-22T10:06:03.615Z] [LOG] 📊 Progress: 5/34 (14.7%)
[2025-10-22T10:06:03.615Z] [LOG] 
🧮 Processing: Kaushal Thambi (EMP465256103)
[2025-10-22T10:06:03.616Z] [LOG] 📋 Record ID: 4440f7a7-da1d-4209-8020-4960d213897f
[2025-10-22T10:06:03.617Z] [LOG] 
======================================================================
[2025-10-22T10:06:03.617Z] [LOG] 🧮 CALCULATING PAYROLL: Kaushal Thambi (EMP465256103)
[2025-10-22T10:06:03.618Z] [LOG] ======================================================================
[2025-10-22T10:06:04.353Z] [LOG] 🔍 Component filtering for employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-22T10:06:04.354Z] [LOG]    Total components: 10
[2025-10-22T10:06:04.356Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:04.357Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-22T10:06:05.447Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:05.448Z] [LOG] 🔄 Processing financial records for employee 9e8125c4-ce58-411a-b617-9f75d481c613 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:05.629Z] [LOG] 📊 Found 0 active loans for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-22T10:06:05.813Z] [LOG] 📊 Found 0 active advances for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-22T10:06:05.991Z] [LOG] 📊 Found 0 approved bonuses for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-22T10:06:05.992Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:05.993Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:05.994Z] [LOG] 💰 GROSS CALCULATION for Kaushal Thambi:
[2025-10-22T10:06:05.994Z] [LOG]    Base Salary: 50000
[2025-10-22T10:06:05.995Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:05.995Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:05.996Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:06.177Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:06.354Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:06.356Z] [LOG]    Employee ID: 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-22T10:06:06.356Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:06.357Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:06.358Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:06:06.540Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:06.541Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:06:06.542Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:06:06.542Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:06:06.543Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:06.544Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:06.544Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:07.084Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:07.085Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:07.265Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:07.266Z] [LOG]       Weekday: 8.50h
[2025-10-22T10:06:07.266Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:07.267Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:07.448Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:07.449Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:07.449Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:07.450Z] [LOG]       Current Time: 15:36:07
[2025-10-22T10:06:07.451Z] [LOG]       Expected Hours (scheduled → now): 7.10h
[2025-10-22T10:06:07.452Z] [LOG]       Actual Hours (check-in → now): 7.10h
[2025-10-22T10:06:07.452Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:07.453Z] [LOG]       Weekday: 117.60h
[2025-10-22T10:06:07.454Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:07.455Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:07.457Z] [LOG]       Total Expected: 131.10h
[2025-10-22T10:06:07.457Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:07.458Z] [LOG]       Weekday: 15.60h (includes 7.10h live)
[2025-10-22T10:06:07.459Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:07.460Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:07.460Z] [LOG]       Total Actual: 20.10h
[2025-10-22T10:06:07.461Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:07.462Z] [LOG]       Weekday: 117.60h × Rs.235.29 = Rs.27670.59
[2025-10-22T10:06:07.462Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:06:07.463Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:07.464Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:07.464Z] [LOG]       Total Expected Earned: Rs.33670.53
[2025-10-22T10:06:07.465Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:07.466Z] [LOG]       Weekday: 15.60h × Rs.235.29 = Rs.3671.01
[2025-10-22T10:06:07.467Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:06:07.467Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:07.469Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:07.470Z] [LOG]       Total Actual Earned: Rs.5670.99
[2025-10-22T10:06:07.473Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:07.474Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:07
[2025-10-22T10:06:07.475Z] [LOG]       Expected Earned (until NOW): Rs.33670.53
[2025-10-22T10:06:07.476Z] [LOG]       Actual Earned (until NOW): Rs.5670.99
[2025-10-22T10:06:07.476Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:07.477Z] [LOG]       Attendance Deduction: Rs.27999.54
[2025-10-22T10:06:07.478Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:07.478Z] [LOG]       📉 Shortfall: 111.00 hours (83.16% of expected)
[2025-10-22T10:06:07.479Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:07.480Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:07.481Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:07.481Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:06:07.482Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:07.482Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:07.484Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:07.484Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:07.485Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:07.486Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:07.487Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:07.488Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:07.490Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:07.491Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:07.492Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:07.492Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:07.493Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:07.493Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:07.494Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:07.495Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:07.495Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:07.496Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:07.496Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:07.497Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:07.497Z] [LOG] Regular deductions for Kaushal Thambi: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:07.498Z] [LOG] Combined deductions for Kaushal Thambi: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 27999.539999999997,
      "details": "Shortfall: 111.00h of 131.10h expected (calculated at Oct 22, 2025, 15:36:07)"
    }
  ],
  "total": 27999.539999999997
}
[2025-10-22T10:06:07.682Z] [LOG] Creating components for record 4440f7a7-da1d-4209-8020-4960d213897f: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:07.684Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 27999.539999999997
}
[2025-10-22T10:06:07.862Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:08.041Z] [LOG] Created payroll_record_component: ddffddc5-d0af-4a4a-9dc2-06c94aaa179e for Attendance Deduction
[2025-10-22T10:06:08.401Z] [LOG] ✅ Financial balances updated successfully for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-22T10:06:08.401Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:08.402Z] [LOG] 
======================================================================
[2025-10-22T10:06:08.403Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Kaushal Thambi
[2025-10-22T10:06:08.403Z] [LOG] ======================================================================
[2025-10-22T10:06:08.404Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:06:08.405Z] [LOG]    Total Deductions: Rs.27999.54
[2025-10-22T10:06:08.406Z] [LOG]       - Attendance Deduction: Rs.27999.54
[2025-10-22T10:06:08.407Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:08.407Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:08.408Z] [LOG]    NET SALARY: Rs.22000.46
[2025-10-22T10:06:08.409Z] [LOG] ======================================================================

[2025-10-22T10:06:08.410Z] [LOG] ✅ Kaushal Thambi: Calculation completed successfully
[2025-10-22T10:06:08.410Z] [LOG] 📊 Progress: 6/34 (17.6%)
[2025-10-22T10:06:08.411Z] [LOG] 
🧮 Processing: Office Team null (EMP000041)
[2025-10-22T10:06:08.412Z] [LOG] 📋 Record ID: 4e8dc84c-0899-4ef6-ae58-76f641658479
[2025-10-22T10:06:08.413Z] [LOG] 
======================================================================
[2025-10-22T10:06:08.413Z] [LOG] 🧮 CALCULATING PAYROLL: Office Team null (EMP000041)
[2025-10-22T10:06:08.414Z] [LOG] ======================================================================
[2025-10-22T10:06:09.166Z] [LOG] 🔍 Component filtering for employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:09.166Z] [LOG]    Total components: 10
[2025-10-22T10:06:09.167Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:09.168Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-22T10:06:10.271Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:10.274Z] [LOG] 🔄 Processing financial records for employee 01442b21-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:10.452Z] [LOG] 📊 Found 0 active loans for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:10.630Z] [LOG] 📊 Found 0 active advances for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:10.806Z] [LOG] 📊 Found 0 approved bonuses for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:10.807Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:10.808Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:10.809Z] [LOG] 💰 GROSS CALCULATION for Office Team null:
[2025-10-22T10:06:10.809Z] [LOG]    Base Salary: 1
[2025-10-22T10:06:10.810Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:10.811Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:10.811Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:11.007Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:11.188Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:11.189Z] [LOG]    Employee ID: 01442b21-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:11.189Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:11.190Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:11.190Z] [LOG]    Base Salary (Full Month): Rs.1.00
[2025-10-22T10:06:11.372Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:11.373Z] [LOG]       Daily Salary: Rs.0.04
[2025-10-22T10:06:11.375Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-22T10:06:11.376Z] [LOG]       Saturday Hourly Rate: Rs.0.01
[2025-10-22T10:06:11.376Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:11.377Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:11.378Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:12.099Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:12.100Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:12.281Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:12.282Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:12.282Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:12.283Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:12.465Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:12.466Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:12.466Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:12.467Z] [LOG]       Current Time: 15:36:12
[2025-10-22T10:06:12.467Z] [LOG]       Expected Hours (scheduled → now): 7.10h
[2025-10-22T10:06:12.468Z] [LOG]       Actual Hours (check-in → now): 7.10h
[2025-10-22T10:06:12.468Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:12.468Z] [LOG]       Weekday: 117.60h
[2025-10-22T10:06:12.469Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:12.469Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:12.470Z] [LOG]       Total Expected: 131.10h
[2025-10-22T10:06:12.470Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:12.470Z] [LOG]       Weekday: 24.10h (includes 7.10h live)
[2025-10-22T10:06:12.471Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:12.472Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:12.472Z] [LOG]       Total Actual: 28.60h
[2025-10-22T10:06:12.472Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:12.473Z] [LOG]       Weekday: 117.60h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:12.473Z] [LOG]       Saturday: 13.50h × Rs.0.01 = Rs.0.14
[2025-10-22T10:06:12.474Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:12.474Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:12.475Z] [LOG]       Total Expected Earned: Rs.0.14
[2025-10-22T10:06:12.475Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:12.475Z] [LOG]       Weekday: 24.10h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:12.476Z] [LOG]       Saturday: 4.50h × Rs.0.01 = Rs.0.04
[2025-10-22T10:06:12.476Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:12.477Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:12.477Z] [LOG]       Total Actual Earned: Rs.0.04
[2025-10-22T10:06:12.478Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:12.478Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:12
[2025-10-22T10:06:12.479Z] [LOG]       Expected Earned (until NOW): Rs.0.14
[2025-10-22T10:06:12.479Z] [LOG]       Actual Earned (until NOW): Rs.0.04
[2025-10-22T10:06:12.479Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:12.480Z] [LOG]       Attendance Deduction: Rs.0.09
[2025-10-22T10:06:12.481Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:12.482Z] [LOG]       📉 Shortfall: 102.50 hours (66.67% of expected)
[2025-10-22T10:06:12.482Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:12.483Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:12.483Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:12.484Z] [LOG]    Gross Salary: 1
[2025-10-22T10:06:12.484Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:12.485Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:12.485Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:12.485Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:12.486Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:12.486Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:12.486Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:12.487Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:12.487Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:12.488Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:12.488Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:12.489Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:12.489Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:12.489Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:12.490Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:12.490Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:12.491Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:12.491Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:12.491Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:12.492Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:12.492Z] [LOG] Regular deductions for Office Team null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:12.493Z] [LOG] Combined deductions for Office Team null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 0.09000000000000001,
      "details": "Shortfall: 102.50h of 131.10h expected (calculated at Oct 22, 2025, 15:36:12)"
    }
  ],
  "total": 0.09000000000000001
}
[2025-10-22T10:06:12.676Z] [LOG] Creating components for record 4e8dc84c-0899-4ef6-ae58-76f641658479: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:12.678Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 0.09000000000000001
}
[2025-10-22T10:06:12.862Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:13.043Z] [LOG] Created payroll_record_component: d8e2d9c0-50b0-4f8e-ab65-e14eceb73684 for Attendance Deduction
[2025-10-22T10:06:13.396Z] [LOG] ✅ Financial balances updated successfully for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:13.397Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:13.398Z] [LOG] 
======================================================================
[2025-10-22T10:06:13.399Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Office Team null
[2025-10-22T10:06:13.400Z] [LOG] ======================================================================
[2025-10-22T10:06:13.400Z] [LOG]    Gross Salary: Rs.1.00
[2025-10-22T10:06:13.401Z] [LOG]    Total Deductions: Rs.0.09
[2025-10-22T10:06:13.402Z] [LOG]       - Attendance Deduction: Rs.0.09
[2025-10-22T10:06:13.403Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:13.403Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:13.404Z] [LOG]    NET SALARY: Rs.0.91
[2025-10-22T10:06:13.406Z] [LOG] ======================================================================

[2025-10-22T10:06:13.409Z] [LOG] ✅ Office Team null: Calculation completed successfully
[2025-10-22T10:06:13.409Z] [LOG] 📊 Progress: 7/34 (20.6%)
[2025-10-22T10:06:13.410Z] [LOG] 
🧮 Processing: Ishara null (EMP000011)
[2025-10-22T10:06:13.410Z] [LOG] 📋 Record ID: 512da848-f307-4bbe-a826-e763a2896c3c
[2025-10-22T10:06:13.411Z] [LOG] 
======================================================================
[2025-10-22T10:06:13.411Z] [LOG] 🧮 CALCULATING PAYROLL: Ishara null (EMP000011)
[2025-10-22T10:06:13.411Z] [LOG] ======================================================================
[2025-10-22T10:06:14.137Z] [LOG] 🔍 Component filtering for employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:14.138Z] [LOG]    Total components: 10
[2025-10-22T10:06:14.138Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:14.139Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-22T10:06:15.246Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:15.247Z] [LOG] 🔄 Processing financial records for employee 0143ac0c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:15.448Z] [LOG] 📊 Found 0 active loans for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:15.627Z] [LOG] 📊 Found 0 active advances for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:15.806Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:15.806Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:15.807Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:15.807Z] [LOG] 💰 GROSS CALCULATION for Ishara null:
[2025-10-22T10:06:15.808Z] [LOG]    Base Salary: 50000
[2025-10-22T10:06:15.808Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:15.808Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:15.808Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:15.984Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:16.159Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:16.159Z] [LOG]    Employee ID: 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:16.159Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:16.160Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:16.160Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:06:16.364Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:16.364Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:06:16.364Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:06:16.365Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:06:16.365Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:16.365Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:16.365Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:16.918Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:16.918Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:17.191Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:17.191Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:17.192Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:17.192Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:17.376Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:17.376Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:17.377Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:17.377Z] [LOG]       Current Time: 15:36:17
[2025-10-22T10:06:17.377Z] [LOG]       Expected Hours (scheduled → now): 7.10h
[2025-10-22T10:06:17.377Z] [LOG]       Actual Hours (check-in → now): 7.10h
[2025-10-22T10:06:17.377Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:17.378Z] [LOG]       Weekday: 117.60h
[2025-10-22T10:06:17.378Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:17.378Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:17.378Z] [LOG]       Total Expected: 131.10h
[2025-10-22T10:06:17.379Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:17.379Z] [LOG]       Weekday: 24.10h (includes 7.10h live)
[2025-10-22T10:06:17.379Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:17.379Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:17.380Z] [LOG]       Total Actual: 28.60h
[2025-10-22T10:06:17.380Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:17.380Z] [LOG]       Weekday: 117.60h × Rs.235.29 = Rs.27671.24
[2025-10-22T10:06:17.380Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:06:17.380Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:17.381Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:17.381Z] [LOG]       Total Expected Earned: Rs.33671.18
[2025-10-22T10:06:17.381Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:17.381Z] [LOG]       Weekday: 24.10h × Rs.235.29 = Rs.5671.62
[2025-10-22T10:06:17.381Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:06:17.382Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:17.382Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:17.382Z] [LOG]       Total Actual Earned: Rs.7671.60
[2025-10-22T10:06:17.382Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:17.383Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:17
[2025-10-22T10:06:17.383Z] [LOG]       Expected Earned (until NOW): Rs.33671.18
[2025-10-22T10:06:17.383Z] [LOG]       Actual Earned (until NOW): Rs.7671.60
[2025-10-22T10:06:17.383Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:17.384Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-22T10:06:17.384Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:17.384Z] [LOG]       📉 Shortfall: 102.50 hours (77.22% of expected)
[2025-10-22T10:06:17.384Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:17.385Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:17.385Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:17.385Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:06:17.386Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:17.386Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:17.386Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:17.386Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:17.386Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:17.387Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:17.387Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:17.387Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:17.387Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:17.388Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:17.388Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:17.388Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:17.388Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:17.389Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:17.389Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:17.389Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:17.389Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:17.389Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:17.389Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:17.390Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:17.390Z] [LOG] Regular deductions for Ishara null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:17.390Z] [LOG] Combined deductions for Ishara null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.574999999997,
      "details": "Shortfall: 102.50h of 131.10h expected (calculated at Oct 22, 2025, 15:36:17)"
    }
  ],
  "total": 25999.574999999997
}
[2025-10-22T10:06:17.585Z] [LOG] Creating components for record 512da848-f307-4bbe-a826-e763a2896c3c: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:17.586Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-22T10:06:17.763Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:17.943Z] [LOG] Created payroll_record_component: 7a14c10b-6582-4cb0-bcf0-593b4da53724 for Attendance Deduction
[2025-10-22T10:06:18.301Z] [LOG] ✅ Financial balances updated successfully for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:18.302Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:18.302Z] [LOG] 
======================================================================
[2025-10-22T10:06:18.302Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ishara null
[2025-10-22T10:06:18.302Z] [LOG] ======================================================================
[2025-10-22T10:06:18.302Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:06:18.303Z] [LOG]    Total Deductions: Rs.25999.57
[2025-10-22T10:06:18.303Z] [LOG]       - Attendance Deduction: Rs.25999.57
[2025-10-22T10:06:18.303Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:18.303Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:18.303Z] [LOG]    NET SALARY: Rs.24000.43
[2025-10-22T10:06:18.304Z] [LOG] ======================================================================

[2025-10-22T10:06:18.304Z] [LOG] ✅ Ishara null: Calculation completed successfully
[2025-10-22T10:06:18.305Z] [LOG] 📊 Progress: 8/34 (23.5%)
[2025-10-22T10:06:18.305Z] [LOG] 
🧮 Processing: Sujevan Selvaratnam null (EMP000026)
[2025-10-22T10:06:18.305Z] [LOG] 📋 Record ID: 581c14ca-e17f-4444-b563-d13dada18419
[2025-10-22T10:06:18.306Z] [LOG] 
======================================================================
[2025-10-22T10:06:18.306Z] [LOG] 🧮 CALCULATING PAYROLL: Sujevan Selvaratnam null (EMP000026)
[2025-10-22T10:06:18.306Z] [LOG] ======================================================================
[2025-10-22T10:06:19.021Z] [LOG] 🔍 Component filtering for employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:19.021Z] [LOG]    Total components: 10
[2025-10-22T10:06:19.021Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:19.021Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-22T10:06:20.120Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:20.121Z] [LOG] 🔄 Processing financial records for employee 0143e6c3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:20.297Z] [LOG] 📊 Found 0 active loans for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:20.476Z] [LOG] 📊 Found 0 active advances for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:20.660Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:20.660Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:20.661Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:20.661Z] [LOG] 💰 GROSS CALCULATION for Sujevan Selvaratnam null:
[2025-10-22T10:06:20.662Z] [LOG]    Base Salary: 1
[2025-10-22T10:06:20.662Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:20.662Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:20.662Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:20.840Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:21.020Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:21.020Z] [LOG]    Employee ID: 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:21.020Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:21.020Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:21.021Z] [LOG]    Base Salary (Full Month): Rs.1.00
[2025-10-22T10:06:21.202Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:21.202Z] [LOG]       Daily Salary: Rs.0.04
[2025-10-22T10:06:21.203Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-22T10:06:21.203Z] [LOG]       Saturday Hourly Rate: Rs.0.01
[2025-10-22T10:06:21.203Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:21.203Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:21.204Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:21.785Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:21.785Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:21.966Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:21.966Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:21.966Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:21.967Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:22.145Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:22.145Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:22.146Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:22.146Z] [LOG]       Current Time: 15:36:22
[2025-10-22T10:06:22.146Z] [LOG]       Expected Hours (scheduled → now): 7.11h
[2025-10-22T10:06:22.147Z] [LOG]       Actual Hours (check-in → now): 7.11h
[2025-10-22T10:06:22.147Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:22.147Z] [LOG]       Weekday: 117.61h
[2025-10-22T10:06:22.147Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:22.148Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:22.148Z] [LOG]       Total Expected: 131.11h
[2025-10-22T10:06:22.148Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:22.148Z] [LOG]       Weekday: 24.11h (includes 7.11h live)
[2025-10-22T10:06:22.148Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:22.149Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:22.149Z] [LOG]       Total Actual: 28.61h
[2025-10-22T10:06:22.149Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:22.149Z] [LOG]       Weekday: 117.61h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:22.150Z] [LOG]       Saturday: 13.50h × Rs.0.01 = Rs.0.14
[2025-10-22T10:06:22.150Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:22.150Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:22.151Z] [LOG]       Total Expected Earned: Rs.0.14
[2025-10-22T10:06:22.151Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:22.151Z] [LOG]       Weekday: 24.11h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:22.151Z] [LOG]       Saturday: 4.50h × Rs.0.01 = Rs.0.04
[2025-10-22T10:06:22.151Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:22.152Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:22.152Z] [LOG]       Total Actual Earned: Rs.0.04
[2025-10-22T10:06:22.153Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:22.153Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:22
[2025-10-22T10:06:22.153Z] [LOG]       Expected Earned (until NOW): Rs.0.14
[2025-10-22T10:06:22.153Z] [LOG]       Actual Earned (until NOW): Rs.0.04
[2025-10-22T10:06:22.154Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:22.154Z] [LOG]       Attendance Deduction: Rs.0.09
[2025-10-22T10:06:22.154Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:22.155Z] [LOG]       📉 Shortfall: 102.50 hours (66.67% of expected)
[2025-10-22T10:06:22.155Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:22.156Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:22.156Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:22.157Z] [LOG]    Gross Salary: 1
[2025-10-22T10:06:22.157Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:22.157Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:22.158Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:22.158Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:22.159Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:22.159Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:22.159Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:22.159Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:22.160Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:22.160Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:22.160Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:22.160Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:22.160Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:22.161Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:22.161Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:22.161Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:22.161Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:22.161Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:22.161Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:22.162Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:22.162Z] [LOG] Regular deductions for Sujevan Selvaratnam null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:22.162Z] [LOG] Combined deductions for Sujevan Selvaratnam null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 0.09000000000000001,
      "details": "Shortfall: 102.50h of 131.11h expected (calculated at Oct 22, 2025, 15:36:22)"
    }
  ],
  "total": 0.09000000000000001
}
[2025-10-22T10:06:22.356Z] [LOG] Creating components for record 581c14ca-e17f-4444-b563-d13dada18419: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:22.357Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 0.09000000000000001
}
[2025-10-22T10:06:22.534Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:22.713Z] [LOG] Created payroll_record_component: 8daca452-95ef-44b3-821f-1dd22b3289b5 for Attendance Deduction
[2025-10-22T10:06:23.081Z] [LOG] ✅ Financial balances updated successfully for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:23.082Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:23.082Z] [LOG] 
======================================================================
[2025-10-22T10:06:23.082Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sujevan Selvaratnam null
[2025-10-22T10:06:23.082Z] [LOG] ======================================================================
[2025-10-22T10:06:23.083Z] [LOG]    Gross Salary: Rs.1.00
[2025-10-22T10:06:23.083Z] [LOG]    Total Deductions: Rs.0.09
[2025-10-22T10:06:23.083Z] [LOG]       - Attendance Deduction: Rs.0.09
[2025-10-22T10:06:23.084Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:23.084Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:23.084Z] [LOG]    NET SALARY: Rs.0.91
[2025-10-22T10:06:23.084Z] [LOG] ======================================================================

[2025-10-22T10:06:23.085Z] [LOG] ✅ Sujevan Selvaratnam null: Calculation completed successfully
[2025-10-22T10:06:23.085Z] [LOG] 📊 Progress: 9/34 (26.5%)
[2025-10-22T10:06:23.085Z] [LOG] 
🧮 Processing: Nimdiya Ranasinghe null (EMP000045)
[2025-10-22T10:06:23.085Z] [LOG] 📋 Record ID: 5937a692-f2d1-44e5-bf42-9d1c74ed16d9
[2025-10-22T10:06:23.086Z] [LOG] 
======================================================================
[2025-10-22T10:06:23.086Z] [LOG] 🧮 CALCULATING PAYROLL: Nimdiya Ranasinghe null (EMP000045)
[2025-10-22T10:06:23.086Z] [LOG] ======================================================================
[2025-10-22T10:06:23.806Z] [LOG] 🔍 Component filtering for employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:23.806Z] [LOG]    Total components: 10
[2025-10-22T10:06:23.806Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:23.806Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-22T10:06:24.882Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:24.883Z] [LOG] 🔄 Processing financial records for employee 01444074-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:25.061Z] [LOG] 📊 Found 0 active loans for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:25.238Z] [LOG] 📊 Found 0 active advances for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:25.413Z] [LOG] 📊 Found 0 approved bonuses for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:25.414Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:25.414Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:25.415Z] [LOG] 💰 GROSS CALCULATION for Nimdiya Ranasinghe null:
[2025-10-22T10:06:25.415Z] [LOG]    Base Salary: 35000
[2025-10-22T10:06:25.415Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:25.415Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:25.415Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:25.597Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:25.777Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:25.777Z] [LOG]    Employee ID: 01444074-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:25.778Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:25.778Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:25.778Z] [LOG]    Base Salary (Full Month): Rs.35000.00
[2025-10-22T10:06:25.954Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:25.954Z] [LOG]       Daily Salary: Rs.1400.00
[2025-10-22T10:06:25.954Z] [LOG]       Weekday Hourly Rate: Rs.164.71
[2025-10-22T10:06:25.955Z] [LOG]       Saturday Hourly Rate: Rs.311.11
[2025-10-22T10:06:25.955Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:25.956Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:25.956Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:26.495Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:26.506Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:26.704Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:26.705Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:26.707Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:26.707Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:26.883Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:26.885Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:26.887Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:26.888Z] [LOG]       Current Time: 15:36:26
[2025-10-22T10:06:26.890Z] [LOG]       Expected Hours (scheduled → now): 7.11h
[2025-10-22T10:06:26.892Z] [LOG]       Actual Hours (check-in → now): 7.11h
[2025-10-22T10:06:26.893Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:26.895Z] [LOG]       Weekday: 117.61h
[2025-10-22T10:06:26.896Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:26.901Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:26.902Z] [LOG]       Total Expected: 131.11h
[2025-10-22T10:06:26.903Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:26.904Z] [LOG]       Weekday: 24.11h (includes 7.11h live)
[2025-10-22T10:06:26.904Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:26.908Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:26.908Z] [LOG]       Total Actual: 28.61h
[2025-10-22T10:06:26.908Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:26.909Z] [LOG]       Weekday: 117.61h × Rs.164.71 = Rs.19371.13
[2025-10-22T10:06:26.910Z] [LOG]       Saturday: 13.50h × Rs.311.11 = Rs.4199.99
[2025-10-22T10:06:26.910Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:26.910Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:26.911Z] [LOG]       Total Expected Earned: Rs.23571.11
[2025-10-22T10:06:26.911Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:26.912Z] [LOG]       Weekday: 24.11h × Rs.164.71 = Rs.3970.74
[2025-10-22T10:06:26.912Z] [LOG]       Saturday: 4.50h × Rs.311.11 = Rs.1400.00
[2025-10-22T10:06:26.912Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:26.913Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:26.913Z] [LOG]       Total Actual Earned: Rs.5370.74
[2025-10-22T10:06:26.914Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:26.914Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:26
[2025-10-22T10:06:26.914Z] [LOG]       Expected Earned (until NOW): Rs.23571.11
[2025-10-22T10:06:26.915Z] [LOG]       Actual Earned (until NOW): Rs.5370.74
[2025-10-22T10:06:26.915Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:26.915Z] [LOG]       Attendance Deduction: Rs.18200.38
[2025-10-22T10:06:26.915Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:26.916Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:06:26.916Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:26.916Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:26.917Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:26.917Z] [LOG]    Gross Salary: 35000
[2025-10-22T10:06:26.917Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:26.918Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:26.918Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:26.918Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:26.918Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:26.919Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:26.919Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:26.919Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:26.919Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:26.920Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:26.920Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:26.920Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:26.920Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:26.920Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:26.921Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:26.921Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:26.921Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:26.921Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:26.924Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:26.926Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:26.927Z] [LOG] Regular deductions for Nimdiya Ranasinghe null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:26.928Z] [LOG] Combined deductions for Nimdiya Ranasinghe null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 18200.375,
      "details": "Shortfall: 102.50h of 131.11h expected (calculated at Oct 22, 2025, 15:36:26)"
    }
  ],
  "total": 18200.375
}
[2025-10-22T10:06:27.108Z] [LOG] Creating components for record 5937a692-f2d1-44e5-bf42-9d1c74ed16d9: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:27.109Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 18200.375
}
[2025-10-22T10:06:27.284Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:27.460Z] [LOG] Created payroll_record_component: df1ad42e-dca9-4e73-8683-788a67a5662a for Attendance Deduction
[2025-10-22T10:06:27.816Z] [LOG] ✅ Financial balances updated successfully for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:27.817Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:27.817Z] [LOG] 
======================================================================
[2025-10-22T10:06:27.818Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Nimdiya Ranasinghe null
[2025-10-22T10:06:27.818Z] [LOG] ======================================================================
[2025-10-22T10:06:27.818Z] [LOG]    Gross Salary: Rs.35000.00
[2025-10-22T10:06:27.819Z] [LOG]    Total Deductions: Rs.18200.38
[2025-10-22T10:06:27.819Z] [LOG]       - Attendance Deduction: Rs.18200.38
[2025-10-22T10:06:27.820Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:27.820Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:27.820Z] [LOG]    NET SALARY: Rs.16799.63
[2025-10-22T10:06:27.821Z] [LOG] ======================================================================

[2025-10-22T10:06:27.821Z] [LOG] ✅ Nimdiya Ranasinghe null: Calculation completed successfully
[2025-10-22T10:06:27.821Z] [LOG] 📊 Progress: 10/34 (29.4%)
[2025-10-22T10:06:27.825Z] [LOG] 
🧮 Processing: Piyumi null (EMP000025)
[2025-10-22T10:06:27.825Z] [LOG] 📋 Record ID: 5bc2279e-fd4f-461c-881a-e72cdec3aca8
[2025-10-22T10:06:27.826Z] [LOG] 
======================================================================
[2025-10-22T10:06:27.826Z] [LOG] 🧮 CALCULATING PAYROLL: Piyumi null (EMP000025)
[2025-10-22T10:06:27.827Z] [LOG] ======================================================================
[2025-10-22T10:06:28.531Z] [LOG] 🔍 Component filtering for employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:28.532Z] [LOG]    Total components: 10
[2025-10-22T10:06:28.532Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:28.533Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-22T10:06:29.610Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:29.610Z] [LOG] 🔄 Processing financial records for employee 0143e565-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:29.793Z] [LOG] 📊 Found 0 active loans for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:29.976Z] [LOG] 📊 Found 0 active advances for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:30.139Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:30.139Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:30.140Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:30.141Z] [LOG] 💰 GROSS CALCULATION for Piyumi null:
[2025-10-22T10:06:30.141Z] [LOG]    Base Salary: 50000
[2025-10-22T10:06:30.141Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:30.142Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:30.143Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:30.322Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:30.499Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:30.499Z] [LOG]    Employee ID: 0143e565-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:30.500Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:30.500Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:30.500Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:06:30.678Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:30.680Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:06:30.681Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:06:30.682Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:06:30.683Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:30.683Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:30.684Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:31.223Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:31.224Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:31.401Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:31.401Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:31.402Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:31.402Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:31.580Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:31.581Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:31.581Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:31.583Z] [LOG]       Current Time: 15:36:31
[2025-10-22T10:06:31.583Z] [LOG]       Expected Hours (scheduled → now): 7.11h
[2025-10-22T10:06:31.584Z] [LOG]       Actual Hours (check-in → now): 7.11h
[2025-10-22T10:06:31.584Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:31.585Z] [LOG]       Weekday: 117.61h
[2025-10-22T10:06:31.586Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:31.586Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:31.587Z] [LOG]       Total Expected: 131.11h
[2025-10-22T10:06:31.588Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:31.589Z] [LOG]       Weekday: 24.11h (includes 7.11h live)
[2025-10-22T10:06:31.589Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:31.590Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:31.594Z] [LOG]       Total Actual: 28.61h
[2025-10-22T10:06:31.595Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:31.596Z] [LOG]       Weekday: 117.61h × Rs.235.29 = Rs.27672.17
[2025-10-22T10:06:31.597Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:06:31.598Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:31.599Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:31.600Z] [LOG]       Total Expected Earned: Rs.33672.11
[2025-10-22T10:06:31.601Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:31.602Z] [LOG]       Weekday: 24.11h × Rs.235.29 = Rs.5672.55
[2025-10-22T10:06:31.603Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:06:31.603Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:31.604Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:31.605Z] [LOG]       Total Actual Earned: Rs.7672.53
[2025-10-22T10:06:31.606Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:31.607Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:31
[2025-10-22T10:06:31.607Z] [LOG]       Expected Earned (until NOW): Rs.33672.11
[2025-10-22T10:06:31.608Z] [LOG]       Actual Earned (until NOW): Rs.7672.53
[2025-10-22T10:06:31.608Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:31.609Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-22T10:06:31.611Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:31.611Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:06:31.612Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:31.612Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:31.613Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:31.613Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:06:31.614Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:31.615Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:31.615Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:31.616Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:31.616Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:31.616Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:31.617Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:31.617Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:31.617Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:31.618Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:31.618Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:31.618Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:31.619Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:31.619Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:31.619Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:31.620Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:31.620Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:31.620Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:31.621Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:31.621Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:31.621Z] [LOG] Regular deductions for Piyumi null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:31.622Z] [LOG] Combined deductions for Piyumi null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.575000000004,
      "details": "Shortfall: 102.50h of 131.11h expected (calculated at Oct 22, 2025, 15:36:31)"
    }
  ],
  "total": 25999.575000000004
}
[2025-10-22T10:06:31.806Z] [LOG] Creating components for record 5bc2279e-fd4f-461c-881a-e72cdec3aca8: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:31.807Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-22T10:06:31.986Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:32.168Z] [LOG] Created payroll_record_component: c5bf44ca-a303-4f3f-a09d-a3c83ec21f4b for Attendance Deduction
[2025-10-22T10:06:32.530Z] [LOG] ✅ Financial balances updated successfully for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:32.531Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:32.531Z] [LOG] 
======================================================================
[2025-10-22T10:06:32.532Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Piyumi null
[2025-10-22T10:06:32.532Z] [LOG] ======================================================================
[2025-10-22T10:06:32.533Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:06:32.534Z] [LOG]    Total Deductions: Rs.25999.58
[2025-10-22T10:06:32.534Z] [LOG]       - Attendance Deduction: Rs.25999.58
[2025-10-22T10:06:32.535Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:32.535Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:32.536Z] [LOG]    NET SALARY: Rs.24000.42
[2025-10-22T10:06:32.537Z] [LOG] ======================================================================

[2025-10-22T10:06:32.539Z] [LOG] ✅ Piyumi null: Calculation completed successfully
[2025-10-22T10:06:32.540Z] [LOG] 📊 Progress: 11/34 (32.4%)
[2025-10-22T10:06:32.545Z] [LOG] 
🧮 Processing: Waruni null (EMP000024)
[2025-10-22T10:06:32.547Z] [LOG] 📋 Record ID: 5dc4d3c9-c0eb-43cb-a75a-511b1ee22192
[2025-10-22T10:06:32.548Z] [LOG] 
======================================================================
[2025-10-22T10:06:32.550Z] [LOG] 🧮 CALCULATING PAYROLL: Waruni null (EMP000024)
[2025-10-22T10:06:32.551Z] [LOG] ======================================================================
[2025-10-22T10:06:33.272Z] [LOG] 🔍 Component filtering for employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:33.273Z] [LOG]    Total components: 10
[2025-10-22T10:06:33.273Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:33.274Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-22T10:06:34.373Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:34.374Z] [LOG] 🔄 Processing financial records for employee 0143e40c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:34.552Z] [LOG] 📊 Found 0 active loans for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:34.736Z] [LOG] 📊 Found 0 active advances for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:34.915Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:34.916Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:34.916Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:34.917Z] [LOG] 💰 GROSS CALCULATION for Waruni null:
[2025-10-22T10:06:34.917Z] [LOG]    Base Salary: 50000
[2025-10-22T10:06:34.917Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:34.918Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:34.918Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:35.097Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:35.275Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:35.277Z] [LOG]    Employee ID: 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:35.278Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:35.279Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:35.280Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:06:35.458Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:35.459Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:06:35.462Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:06:35.462Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:06:35.463Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:35.464Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:35.464Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:36.005Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:36.006Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:36.187Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:36.188Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:36.189Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:36.190Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:36.371Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:36.372Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:36.373Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:36.373Z] [LOG]       Current Time: 15:36:36
[2025-10-22T10:06:36.374Z] [LOG]       Expected Hours (scheduled → now): 7.11h
[2025-10-22T10:06:36.374Z] [LOG]       Actual Hours (check-in → now): 7.11h
[2025-10-22T10:06:36.375Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:36.375Z] [LOG]       Weekday: 117.61h
[2025-10-22T10:06:36.376Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:36.377Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:36.377Z] [LOG]       Total Expected: 131.11h
[2025-10-22T10:06:36.378Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:36.379Z] [LOG]       Weekday: 24.11h (includes 7.11h live)
[2025-10-22T10:06:36.379Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:36.380Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:36.380Z] [LOG]       Total Actual: 28.61h
[2025-10-22T10:06:36.381Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:36.381Z] [LOG]       Weekday: 117.61h × Rs.235.29 = Rs.27672.48
[2025-10-22T10:06:36.382Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:06:36.383Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:36.383Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:36.384Z] [LOG]       Total Expected Earned: Rs.33672.42
[2025-10-22T10:06:36.385Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:36.385Z] [LOG]       Weekday: 24.11h × Rs.235.29 = Rs.5672.87
[2025-10-22T10:06:36.386Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:06:36.386Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:36.387Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:36.387Z] [LOG]       Total Actual Earned: Rs.7672.85
[2025-10-22T10:06:36.388Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:36.389Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:36
[2025-10-22T10:06:36.389Z] [LOG]       Expected Earned (until NOW): Rs.33672.42
[2025-10-22T10:06:36.390Z] [LOG]       Actual Earned (until NOW): Rs.7672.85
[2025-10-22T10:06:36.390Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:36.391Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-22T10:06:36.391Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:36.391Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:06:36.392Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:36.394Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:36.395Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:36.396Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:06:36.397Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:36.397Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:36.398Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:36.399Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:36.399Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:36.400Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:36.400Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:36.400Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:36.401Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:36.401Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:36.402Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:36.402Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:36.403Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:36.403Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:36.404Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:36.404Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:36.404Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:36.405Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:36.405Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:36.405Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:36.406Z] [LOG] Regular deductions for Waruni null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:36.406Z] [LOG] Combined deductions for Waruni null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.574999999997,
      "details": "Shortfall: 102.50h of 131.11h expected (calculated at Oct 22, 2025, 15:36:36)"
    }
  ],
  "total": 25999.574999999997
}
[2025-10-22T10:06:36.591Z] [LOG] Creating components for record 5dc4d3c9-c0eb-43cb-a75a-511b1ee22192: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:36.591Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-22T10:06:36.768Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:36.950Z] [LOG] Created payroll_record_component: a9ea09e0-36d9-4f19-a058-4d3a31bf8fd8 for Attendance Deduction
[2025-10-22T10:06:37.308Z] [LOG] ✅ Financial balances updated successfully for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:37.309Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:37.309Z] [LOG] 
======================================================================
[2025-10-22T10:06:37.309Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Waruni null
[2025-10-22T10:06:37.309Z] [LOG] ======================================================================
[2025-10-22T10:06:37.309Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:06:37.310Z] [LOG]    Total Deductions: Rs.25999.57
[2025-10-22T10:06:37.310Z] [LOG]       - Attendance Deduction: Rs.25999.57
[2025-10-22T10:06:37.310Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:37.310Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:37.310Z] [LOG]    NET SALARY: Rs.24000.43
[2025-10-22T10:06:37.311Z] [LOG] ======================================================================

[2025-10-22T10:06:37.311Z] [LOG] ✅ Waruni null: Calculation completed successfully
[2025-10-22T10:06:37.311Z] [LOG] 📊 Progress: 12/34 (35.3%)
[2025-10-22T10:06:37.311Z] [LOG] 
🧮 Processing: Saru null (EMP000022)
[2025-10-22T10:06:37.312Z] [LOG] 📋 Record ID: 6569194c-1a20-4579-9d68-cefd9d14e377
[2025-10-22T10:06:37.312Z] [LOG] 
======================================================================
[2025-10-22T10:06:37.312Z] [LOG] 🧮 CALCULATING PAYROLL: Saru null (EMP000022)
[2025-10-22T10:06:37.312Z] [LOG] ======================================================================
[2025-10-22T10:06:38.031Z] [LOG] 🔍 Component filtering for employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:38.033Z] [LOG]    Total components: 10
[2025-10-22T10:06:38.033Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:38.033Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-22T10:06:39.099Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:39.100Z] [LOG] 🔄 Processing financial records for employee 0143cc7e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:39.278Z] [LOG] 📊 Found 0 active loans for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:39.454Z] [LOG] 📊 Found 0 active advances for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:39.636Z] [LOG] 📊 Found 0 approved bonuses for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:39.637Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:39.638Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:39.638Z] [LOG] 💰 GROSS CALCULATION for Saru null:
[2025-10-22T10:06:39.639Z] [LOG]    Base Salary: 50000
[2025-10-22T10:06:39.640Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:39.640Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:39.641Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:39.819Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:40.021Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:40.022Z] [LOG]    Employee ID: 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:40.022Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:40.023Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:40.024Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:06:40.208Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:40.208Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:06:40.209Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:06:40.210Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:06:40.210Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:40.211Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:40.212Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:40.747Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:40.748Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:40.925Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:40.925Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:40.926Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:40.927Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:41.104Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:41.105Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:41.105Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:41.106Z] [LOG]       Current Time: 15:36:41
[2025-10-22T10:06:41.107Z] [LOG]       Expected Hours (scheduled → now): 7.11h
[2025-10-22T10:06:41.107Z] [LOG]       Actual Hours (check-in → now): 7.11h
[2025-10-22T10:06:41.108Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:41.109Z] [LOG]       Weekday: 117.61h
[2025-10-22T10:06:41.109Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:41.110Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:41.111Z] [LOG]       Total Expected: 131.11h
[2025-10-22T10:06:41.111Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:41.112Z] [LOG]       Weekday: 24.11h (includes 7.11h live)
[2025-10-22T10:06:41.113Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:41.113Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:41.114Z] [LOG]       Total Actual: 28.61h
[2025-10-22T10:06:41.115Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:41.117Z] [LOG]       Weekday: 117.61h × Rs.235.29 = Rs.27672.79
[2025-10-22T10:06:41.118Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:06:41.118Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:41.119Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:41.120Z] [LOG]       Total Expected Earned: Rs.33672.73
[2025-10-22T10:06:41.120Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:41.121Z] [LOG]       Weekday: 24.11h × Rs.235.29 = Rs.5673.18
[2025-10-22T10:06:41.122Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:06:41.122Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:41.123Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:41.124Z] [LOG]       Total Actual Earned: Rs.7673.16
[2025-10-22T10:06:41.125Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:41.126Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:41
[2025-10-22T10:06:41.128Z] [LOG]       Expected Earned (until NOW): Rs.33672.73
[2025-10-22T10:06:41.128Z] [LOG]       Actual Earned (until NOW): Rs.7673.16
[2025-10-22T10:06:41.129Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:41.130Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-22T10:06:41.131Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:41.132Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:06:41.133Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:41.134Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:41.135Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:41.136Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:06:41.136Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:41.137Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:41.138Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:41.138Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:41.139Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:41.139Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:41.140Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:41.141Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:41.141Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:41.142Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:41.143Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:41.143Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:41.144Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:41.145Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:41.146Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:41.147Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:41.147Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:41.148Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:41.148Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:41.149Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:41.149Z] [LOG] Regular deductions for Saru null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:41.150Z] [LOG] Combined deductions for Saru null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.574999999997,
      "details": "Shortfall: 102.50h of 131.11h expected (calculated at Oct 22, 2025, 15:36:41)"
    }
  ],
  "total": 25999.574999999997
}
[2025-10-22T10:06:41.330Z] [LOG] Creating components for record 6569194c-1a20-4579-9d68-cefd9d14e377: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:41.332Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-22T10:06:41.511Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:41.691Z] [LOG] Created payroll_record_component: 309b155c-a7f5-4a04-9c57-a5a399a30c0a for Attendance Deduction
[2025-10-22T10:06:42.067Z] [LOG] ✅ Financial balances updated successfully for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:42.068Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:42.069Z] [LOG] 
======================================================================
[2025-10-22T10:06:42.070Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Saru null
[2025-10-22T10:06:42.070Z] [LOG] ======================================================================
[2025-10-22T10:06:42.071Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:06:42.071Z] [LOG]    Total Deductions: Rs.25999.57
[2025-10-22T10:06:42.072Z] [LOG]       - Attendance Deduction: Rs.25999.57
[2025-10-22T10:06:42.073Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:42.073Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:42.074Z] [LOG]    NET SALARY: Rs.24000.43
[2025-10-22T10:06:42.074Z] [LOG] ======================================================================

[2025-10-22T10:06:42.076Z] [LOG] ✅ Saru null: Calculation completed successfully
[2025-10-22T10:06:42.076Z] [LOG] 📊 Progress: 13/34 (38.2%)
[2025-10-22T10:06:42.077Z] [LOG] 
🧮 Processing: Ratheeshanan null (EMP000047)
[2025-10-22T10:06:42.078Z] [LOG] 📋 Record ID: 68408321-dff1-432b-a0d2-7d6b6c83005d
[2025-10-22T10:06:42.080Z] [LOG] 
======================================================================
[2025-10-22T10:06:42.080Z] [LOG] 🧮 CALCULATING PAYROLL: Ratheeshanan null (EMP000047)
[2025-10-22T10:06:42.081Z] [LOG] ======================================================================
[2025-10-22T10:06:42.796Z] [LOG] 🔍 Component filtering for employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:42.797Z] [LOG]    Total components: 10
[2025-10-22T10:06:42.797Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:42.798Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-22T10:06:43.891Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:43.892Z] [LOG] 🔄 Processing financial records for employee 01444966-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:44.074Z] [LOG] 📊 Found 0 active loans for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:44.269Z] [LOG] 📊 Found 0 active advances for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:44.446Z] [LOG] 📊 Found 0 approved bonuses for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:44.446Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:44.448Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:44.448Z] [LOG] 💰 GROSS CALCULATION for Ratheeshanan null:
[2025-10-22T10:06:44.449Z] [LOG]    Base Salary: 25000
[2025-10-22T10:06:44.450Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:44.450Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:44.451Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:44.632Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:44.813Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:44.814Z] [LOG]    Employee ID: 01444966-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:44.814Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:44.815Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:44.815Z] [LOG]    Base Salary (Full Month): Rs.25000.00
[2025-10-22T10:06:44.995Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:44.995Z] [LOG]       Daily Salary: Rs.1000.00
[2025-10-22T10:06:44.996Z] [LOG]       Weekday Hourly Rate: Rs.117.65
[2025-10-22T10:06:44.997Z] [LOG]       Saturday Hourly Rate: Rs.222.22
[2025-10-22T10:06:44.997Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:44.998Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:44.999Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:45.549Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:45.549Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:45.730Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:45.731Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:45.732Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:45.732Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:45.910Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:45.911Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:45.912Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:45.912Z] [LOG]       Current Time: 15:36:45
[2025-10-22T10:06:45.913Z] [LOG]       Expected Hours (scheduled → now): 7.11h
[2025-10-22T10:06:45.913Z] [LOG]       Actual Hours (check-in → now): 7.11h
[2025-10-22T10:06:45.914Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:45.914Z] [LOG]       Weekday: 117.61h
[2025-10-22T10:06:45.915Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:45.915Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:45.915Z] [LOG]       Total Expected: 131.11h
[2025-10-22T10:06:45.916Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:45.916Z] [LOG]       Weekday: 24.11h (includes 7.11h live)
[2025-10-22T10:06:45.917Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:45.917Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:45.917Z] [LOG]       Total Actual: 28.61h
[2025-10-22T10:06:45.918Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:45.918Z] [LOG]       Weekday: 117.61h × Rs.117.65 = Rs.13837.14
[2025-10-22T10:06:45.918Z] [LOG]       Saturday: 13.50h × Rs.222.22 = Rs.2999.97
[2025-10-22T10:06:45.919Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:45.919Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:45.920Z] [LOG]       Total Expected Earned: Rs.16837.11
[2025-10-22T10:06:45.920Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:45.920Z] [LOG]       Weekday: 24.11h × Rs.117.65 = Rs.2836.87
[2025-10-22T10:06:45.921Z] [LOG]       Saturday: 4.50h × Rs.222.22 = Rs.999.99
[2025-10-22T10:06:45.921Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:45.922Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:45.922Z] [LOG]       Total Actual Earned: Rs.3836.86
[2025-10-22T10:06:45.923Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:45.923Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:45
[2025-10-22T10:06:45.924Z] [LOG]       Expected Earned (until NOW): Rs.16837.11
[2025-10-22T10:06:45.924Z] [LOG]       Actual Earned (until NOW): Rs.3836.86
[2025-10-22T10:06:45.924Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:45.925Z] [LOG]       Attendance Deduction: Rs.13000.25
[2025-10-22T10:06:45.925Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:45.926Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:06:45.927Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:45.928Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:45.928Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:45.929Z] [LOG]    Gross Salary: 25000
[2025-10-22T10:06:45.929Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:45.929Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:45.930Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:45.930Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:45.931Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:45.931Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:45.931Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:45.931Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:45.932Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:45.932Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:45.932Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:45.933Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:45.933Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:45.933Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:45.933Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:45.933Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:45.933Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:45.934Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:45.934Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:45.934Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:45.934Z] [LOG] Regular deductions for Ratheeshanan null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:45.935Z] [LOG] Combined deductions for Ratheeshanan null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 13000.254999999997,
      "details": "Shortfall: 102.50h of 131.11h expected (calculated at Oct 22, 2025, 15:36:45)"
    }
  ],
  "total": 13000.254999999997
}
[2025-10-22T10:06:46.113Z] [LOG] Creating components for record 68408321-dff1-432b-a0d2-7d6b6c83005d: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:46.113Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 13000.254999999997
}
[2025-10-22T10:06:46.289Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:46.471Z] [LOG] Created payroll_record_component: b9368052-6aed-43a1-9743-0a9f4cb30d0f for Attendance Deduction
[2025-10-22T10:06:46.830Z] [LOG] ✅ Financial balances updated successfully for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:46.830Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:46.831Z] [LOG] 
======================================================================
[2025-10-22T10:06:46.831Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ratheeshanan null
[2025-10-22T10:06:46.831Z] [LOG] ======================================================================
[2025-10-22T10:06:46.831Z] [LOG]    Gross Salary: Rs.25000.00
[2025-10-22T10:06:46.832Z] [LOG]    Total Deductions: Rs.13000.25
[2025-10-22T10:06:46.832Z] [LOG]       - Attendance Deduction: Rs.13000.25
[2025-10-22T10:06:46.832Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:46.832Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:46.833Z] [LOG]    NET SALARY: Rs.11999.75
[2025-10-22T10:06:46.833Z] [LOG] ======================================================================

[2025-10-22T10:06:46.833Z] [LOG] ✅ Ratheeshanan null: Calculation completed successfully
[2025-10-22T10:06:46.833Z] [LOG] 📊 Progress: 14/34 (41.2%)
[2025-10-22T10:06:46.834Z] [LOG] 
🧮 Processing: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-22T10:06:46.834Z] [LOG] 📋 Record ID: 7fd61987-12f1-4ea3-b6c3-604490c07f74
[2025-10-22T10:06:46.834Z] [LOG] 
======================================================================
[2025-10-22T10:06:46.835Z] [LOG] 🧮 CALCULATING PAYROLL: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-22T10:06:46.835Z] [LOG] ======================================================================
[2025-10-22T10:06:47.549Z] [LOG] 🔍 Component filtering for employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:47.550Z] [LOG]    Total components: 10
[2025-10-22T10:06:47.551Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:47.551Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-22T10:06:48.624Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:48.625Z] [LOG] 🔄 Processing financial records for employee 0144461e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:48.809Z] [LOG] 📊 Found 0 active loans for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:48.993Z] [LOG] 📊 Found 0 active advances for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:49.170Z] [LOG] 📊 Found 0 approved bonuses for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:49.171Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:49.172Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:49.173Z] [LOG] 💰 GROSS CALCULATION for Ashen Nirmal Wadugodapitiya null:
[2025-10-22T10:06:49.174Z] [LOG]    Base Salary: 50000
[2025-10-22T10:06:49.174Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:49.175Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:49.175Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:49.352Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:49.531Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:49.532Z] [LOG]    Employee ID: 0144461e-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:49.532Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:49.533Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:49.534Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:06:49.714Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:49.715Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:06:49.715Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:06:49.716Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:06:49.716Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:49.717Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:49.718Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:50.269Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:50.270Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:50.449Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:50.450Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:50.450Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:50.451Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:50.630Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:50.631Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:50.632Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:50.633Z] [LOG]       Current Time: 15:36:50
[2025-10-22T10:06:50.634Z] [LOG]       Expected Hours (scheduled → now): 7.11h
[2025-10-22T10:06:50.634Z] [LOG]       Actual Hours (check-in → now): 7.11h
[2025-10-22T10:06:50.635Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:50.635Z] [LOG]       Weekday: 117.61h
[2025-10-22T10:06:50.636Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:50.637Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:50.637Z] [LOG]       Total Expected: 131.11h
[2025-10-22T10:06:50.638Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:50.639Z] [LOG]       Weekday: 24.11h (includes 7.11h live)
[2025-10-22T10:06:50.640Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:50.640Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:50.641Z] [LOG]       Total Actual: 28.61h
[2025-10-22T10:06:50.642Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:50.646Z] [LOG]       Weekday: 117.61h × Rs.235.29 = Rs.27673.41
[2025-10-22T10:06:50.647Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:06:50.648Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:50.648Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:50.649Z] [LOG]       Total Expected Earned: Rs.33673.35
[2025-10-22T10:06:50.651Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:50.652Z] [LOG]       Weekday: 24.11h × Rs.235.29 = Rs.5673.80
[2025-10-22T10:06:50.652Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:06:50.653Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:50.653Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:50.654Z] [LOG]       Total Actual Earned: Rs.7673.78
[2025-10-22T10:06:50.655Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:50.656Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:50
[2025-10-22T10:06:50.657Z] [LOG]       Expected Earned (until NOW): Rs.33673.35
[2025-10-22T10:06:50.657Z] [LOG]       Actual Earned (until NOW): Rs.7673.78
[2025-10-22T10:06:50.658Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:50.658Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-22T10:06:50.659Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:50.662Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:06:50.662Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:50.663Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:50.663Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:50.664Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:06:50.664Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:50.665Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:50.665Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:50.666Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:50.666Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:50.666Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:50.667Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:50.667Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:50.668Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:50.668Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:50.668Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:50.669Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:50.669Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:50.670Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:50.670Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:50.670Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:50.671Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:50.671Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:50.671Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:50.672Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:50.672Z] [LOG] Regular deductions for Ashen Nirmal Wadugodapitiya null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:50.673Z] [LOG] Combined deductions for Ashen Nirmal Wadugodapitiya null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.575000000004,
      "details": "Shortfall: 102.50h of 131.11h expected (calculated at Oct 22, 2025, 15:36:50)"
    }
  ],
  "total": 25999.575000000004
}
[2025-10-22T10:06:50.853Z] [LOG] Creating components for record 7fd61987-12f1-4ea3-b6c3-604490c07f74: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:50.855Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-22T10:06:51.038Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:51.230Z] [LOG] Created payroll_record_component: 1472d882-f80e-41d4-9031-4c17db8c66bb for Attendance Deduction
[2025-10-22T10:06:51.584Z] [LOG] ✅ Financial balances updated successfully for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:51.584Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:51.585Z] [LOG] 
======================================================================
[2025-10-22T10:06:51.585Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ashen Nirmal Wadugodapitiya null
[2025-10-22T10:06:51.586Z] [LOG] ======================================================================
[2025-10-22T10:06:51.586Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:06:51.586Z] [LOG]    Total Deductions: Rs.25999.58
[2025-10-22T10:06:51.587Z] [LOG]       - Attendance Deduction: Rs.25999.58
[2025-10-22T10:06:51.587Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:51.587Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:51.588Z] [LOG]    NET SALARY: Rs.24000.42
[2025-10-22T10:06:51.588Z] [LOG] ======================================================================

[2025-10-22T10:06:51.588Z] [LOG] ✅ Ashen Nirmal Wadugodapitiya null: Calculation completed successfully
[2025-10-22T10:06:51.589Z] [LOG] 📊 Progress: 15/34 (44.1%)
[2025-10-22T10:06:51.589Z] [LOG] 
🧮 Processing: Prasanthan null (EMP000001)
[2025-10-22T10:06:51.589Z] [LOG] 📋 Record ID: 8208aa6f-4aeb-4cdb-9dc2-0138da3dd64a
[2025-10-22T10:06:51.590Z] [LOG] 
======================================================================
[2025-10-22T10:06:51.591Z] [LOG] 🧮 CALCULATING PAYROLL: Prasanthan null (EMP000001)
[2025-10-22T10:06:51.591Z] [LOG] ======================================================================
[2025-10-22T10:06:52.314Z] [LOG] 🔍 Component filtering for employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:52.315Z] [LOG]    Total components: 10
[2025-10-22T10:06:52.315Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:52.316Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-22T10:06:53.400Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:53.401Z] [LOG] 🔄 Processing financial records for employee 014397c7-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:53.581Z] [LOG] 📊 Found 0 active loans for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:53.760Z] [LOG] 📊 Found 0 active advances for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:53.939Z] [LOG] 📊 Found 0 approved bonuses for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:53.940Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:53.941Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:53.941Z] [LOG] 💰 GROSS CALCULATION for Prasanthan null:
[2025-10-22T10:06:53.942Z] [LOG]    Base Salary: 150000
[2025-10-22T10:06:53.943Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:53.944Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:53.945Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:54.136Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:54.316Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:54.317Z] [LOG]    Employee ID: 014397c7-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:54.317Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:54.318Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:54.319Z] [LOG]    Base Salary (Full Month): Rs.150000.00
[2025-10-22T10:06:54.501Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:54.502Z] [LOG]       Daily Salary: Rs.6000.00
[2025-10-22T10:06:54.502Z] [LOG]       Weekday Hourly Rate: Rs.705.88
[2025-10-22T10:06:54.503Z] [LOG]       Saturday Hourly Rate: Rs.1333.33
[2025-10-22T10:06:54.504Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:54.504Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:54.505Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:55.054Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:55.055Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:06:55.234Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:06:55.235Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:06:55.236Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:55.236Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:55.415Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:06:55.415Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:06:55.416Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:06:55.417Z] [LOG]       Current Time: 15:36:55
[2025-10-22T10:06:55.418Z] [LOG]       Expected Hours (scheduled → now): 7.12h
[2025-10-22T10:06:55.418Z] [LOG]       Actual Hours (check-in → now): 7.12h
[2025-10-22T10:06:55.419Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:06:55.419Z] [LOG]       Weekday: 117.62h
[2025-10-22T10:06:55.420Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:06:55.421Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:55.421Z] [LOG]       Total Expected: 131.12h
[2025-10-22T10:06:55.422Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:06:55.423Z] [LOG]       Weekday: 24.12h (includes 7.12h live)
[2025-10-22T10:06:55.423Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:06:55.424Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:06:55.425Z] [LOG]       Total Actual: 28.62h
[2025-10-22T10:06:55.425Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:06:55.429Z] [LOG]       Weekday: 117.62h × Rs.705.88 = Rs.83022.35
[2025-10-22T10:06:55.429Z] [LOG]       Saturday: 13.50h × Rs.1333.33 = Rs.17999.95
[2025-10-22T10:06:55.430Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:55.431Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:55.432Z] [LOG]       Total Expected Earned: Rs.101022.31
[2025-10-22T10:06:55.432Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:06:55.433Z] [LOG]       Weekday: 24.12h × Rs.705.88 = Rs.17022.57
[2025-10-22T10:06:55.434Z] [LOG]       Saturday: 4.50h × Rs.1333.33 = Rs.5999.98
[2025-10-22T10:06:55.434Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:06:55.435Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:55.436Z] [LOG]       Total Actual Earned: Rs.23022.56
[2025-10-22T10:06:55.437Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:06:55.437Z] [LOG]       Calculated At: Oct 22, 2025, 15:36:55
[2025-10-22T10:06:55.438Z] [LOG]       Expected Earned (until NOW): Rs.101022.31
[2025-10-22T10:06:55.439Z] [LOG]       Actual Earned (until NOW): Rs.23022.56
[2025-10-22T10:06:55.439Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:06:55.440Z] [LOG]       Attendance Deduction: Rs.77999.75
[2025-10-22T10:06:55.440Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:06:55.441Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:06:55.442Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:06:55.445Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:06:55.446Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:06:55.447Z] [LOG]    Gross Salary: 150000
[2025-10-22T10:06:55.448Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:06:55.448Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:06:55.449Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:55.450Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:06:55.450Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:55.451Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:06:55.451Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:55.452Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:06:55.453Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:55.453Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:06:55.454Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:55.454Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:06:55.455Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:55.456Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:06:55.456Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:55.457Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:06:55.457Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:55.458Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:06:55.459Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:55.461Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:06:55.462Z] [LOG] Regular deductions for Prasanthan null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:06:55.464Z] [LOG] Combined deductions for Prasanthan null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 77999.75,
      "details": "Shortfall: 102.50h of 131.12h expected (calculated at Oct 22, 2025, 15:36:55)"
    }
  ],
  "total": 77999.75
}
[2025-10-22T10:06:55.647Z] [LOG] Creating components for record 8208aa6f-4aeb-4cdb-9dc2-0138da3dd64a: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:06:55.648Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 77999.75
}
[2025-10-22T10:06:55.827Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:06:56.006Z] [LOG] Created payroll_record_component: 47ddaba6-cdc9-467f-b17d-f91a298dc24b for Attendance Deduction
[2025-10-22T10:06:56.360Z] [LOG] ✅ Financial balances updated successfully for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:56.361Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:06:56.362Z] [LOG] 
======================================================================
[2025-10-22T10:06:56.362Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Prasanthan null
[2025-10-22T10:06:56.363Z] [LOG] ======================================================================
[2025-10-22T10:06:56.364Z] [LOG]    Gross Salary: Rs.150000.00
[2025-10-22T10:06:56.364Z] [LOG]    Total Deductions: Rs.77999.75
[2025-10-22T10:06:56.365Z] [LOG]       - Attendance Deduction: Rs.77999.75
[2025-10-22T10:06:56.365Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:06:56.366Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:06:56.366Z] [LOG]    NET SALARY: Rs.72000.25
[2025-10-22T10:06:56.367Z] [LOG] ======================================================================

[2025-10-22T10:06:56.368Z] [LOG] ✅ Prasanthan null: Calculation completed successfully
[2025-10-22T10:06:56.369Z] [LOG] 📊 Progress: 16/34 (47.1%)
[2025-10-22T10:06:56.369Z] [LOG] 
🧮 Processing: Franklin null (EMP000018)
[2025-10-22T10:06:56.370Z] [LOG] 📋 Record ID: 8a44eb53-923e-4551-bb76-328cd52a0a61
[2025-10-22T10:06:56.371Z] [LOG] 
======================================================================
[2025-10-22T10:06:56.372Z] [LOG] 🧮 CALCULATING PAYROLL: Franklin null (EMP000018)
[2025-10-22T10:06:56.373Z] [LOG] ======================================================================
[2025-10-22T10:06:57.128Z] [LOG] 🔍 Component filtering for employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-22T10:06:57.129Z] [LOG]    Total components: 10
[2025-10-22T10:06:57.130Z] [LOG]    Applicable components: 10
[2025-10-22T10:06:57.130Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-22T10:06:58.226Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:06:58.227Z] [LOG] 🔄 Processing financial records for employee 0143c037-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:06:58.406Z] [LOG] 📊 Found 0 active loans for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:58.591Z] [LOG] 📊 Found 0 active advances for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:58.770Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:58.771Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:06:58.772Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:06:58.772Z] [LOG] 💰 GROSS CALCULATION for Franklin null:
[2025-10-22T10:06:58.773Z] [LOG]    Base Salary: 50000
[2025-10-22T10:06:58.774Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:06:58.774Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:06:58.775Z] [LOG]    Fixed amount: 0
[2025-10-22T10:06:58.952Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:06:59.174Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:06:59.175Z] [LOG]    Employee ID: 0143c037-7105-11f0-a50f-98e743540430
[2025-10-22T10:06:59.176Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:06:59.177Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:06:59.177Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:06:59.354Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:06:59.354Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:06:59.354Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:06:59.355Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:06:59.355Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:06:59.355Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:06:59.355Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:06:59.921Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:06:59.922Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:00.097Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:00.098Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:00.098Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:00.098Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:00.277Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:00.278Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:00.279Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:00.280Z] [LOG]       Current Time: 15:37:00
[2025-10-22T10:07:00.280Z] [LOG]       Expected Hours (scheduled → now): 7.12h
[2025-10-22T10:07:00.281Z] [LOG]       Actual Hours (check-in → now): 7.12h
[2025-10-22T10:07:00.281Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:00.282Z] [LOG]       Weekday: 117.62h
[2025-10-22T10:07:00.283Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:00.283Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:00.284Z] [LOG]       Total Expected: 131.12h
[2025-10-22T10:07:00.284Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:00.285Z] [LOG]       Weekday: 24.12h (includes 7.12h live)
[2025-10-22T10:07:00.286Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:00.286Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:00.287Z] [LOG]       Total Actual: 28.62h
[2025-10-22T10:07:00.288Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:00.288Z] [LOG]       Weekday: 117.62h × Rs.235.29 = Rs.27674.04
[2025-10-22T10:07:00.289Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:07:00.290Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:00.290Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:00.291Z] [LOG]       Total Expected Earned: Rs.33673.98
[2025-10-22T10:07:00.291Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:00.292Z] [LOG]       Weekday: 24.12h × Rs.235.29 = Rs.5674.43
[2025-10-22T10:07:00.293Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:07:00.294Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:00.295Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:00.296Z] [LOG]       Total Actual Earned: Rs.7674.41
[2025-10-22T10:07:00.297Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:00.298Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:00
[2025-10-22T10:07:00.299Z] [LOG]       Expected Earned (until NOW): Rs.33673.98
[2025-10-22T10:07:00.300Z] [LOG]       Actual Earned (until NOW): Rs.7674.41
[2025-10-22T10:07:00.301Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:00.302Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:00.303Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:00.303Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:07:00.304Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:00.305Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:00.307Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:00.312Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:07:00.313Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:00.316Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:00.316Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:00.316Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:00.317Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:00.317Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:00.317Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:00.318Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:00.318Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:00.319Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:00.319Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:00.319Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:00.320Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:00.320Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:00.320Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:00.320Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:00.320Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:00.321Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:00.321Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:00.321Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:00.321Z] [LOG] Regular deductions for Franklin null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:00.322Z] [LOG] Combined deductions for Franklin null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.575,
      "details": "Shortfall: 102.50h of 131.12h expected (calculated at Oct 22, 2025, 15:37:00)"
    }
  ],
  "total": 25999.575
}
[2025-10-22T10:07:00.504Z] [LOG] Creating components for record 8a44eb53-923e-4551-bb76-328cd52a0a61: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:00.506Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-22T10:07:00.684Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:00.862Z] [LOG] Created payroll_record_component: f8712294-f4c1-41d3-a518-3c3df0d95707 for Attendance Deduction
[2025-10-22T10:07:01.216Z] [LOG] ✅ Financial balances updated successfully for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:01.217Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:01.218Z] [LOG] 
======================================================================
[2025-10-22T10:07:01.218Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Franklin null
[2025-10-22T10:07:01.219Z] [LOG] ======================================================================
[2025-10-22T10:07:01.219Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:07:01.220Z] [LOG]    Total Deductions: Rs.25999.58
[2025-10-22T10:07:01.221Z] [LOG]       - Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:01.221Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:01.222Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:01.222Z] [LOG]    NET SALARY: Rs.24000.42
[2025-10-22T10:07:01.223Z] [LOG] ======================================================================

[2025-10-22T10:07:01.224Z] [LOG] ✅ Franklin null: Calculation completed successfully
[2025-10-22T10:07:01.225Z] [LOG] 📊 Progress: 17/34 (50.0%)
[2025-10-22T10:07:01.225Z] [LOG] 
🧮 Processing: Ammaar Ilham (EMP000023)
[2025-10-22T10:07:01.227Z] [LOG] 📋 Record ID: 8c08e831-2b16-47cb-a184-6aa2ea54ad02
[2025-10-22T10:07:01.227Z] [LOG] 
======================================================================
[2025-10-22T10:07:01.228Z] [LOG] 🧮 CALCULATING PAYROLL: Ammaar Ilham (EMP000023)
[2025-10-22T10:07:01.231Z] [LOG] ======================================================================
[2025-10-22T10:07:01.957Z] [LOG] 🔍 Component filtering for employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:01.958Z] [LOG]    Total components: 10
[2025-10-22T10:07:01.958Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:01.959Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-22T10:07:03.035Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:03.036Z] [LOG] 🔄 Processing financial records for employee 0143de00-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:03.212Z] [LOG] 📊 Found 0 active loans for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:03.393Z] [LOG] 📊 Found 0 active advances for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:03.571Z] [LOG] 📊 Found 0 approved bonuses for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:03.572Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:03.573Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:03.573Z] [LOG] 💰 GROSS CALCULATION for Ammaar Ilham:
[2025-10-22T10:07:03.573Z] [LOG]    Base Salary: 70000
[2025-10-22T10:07:03.574Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:03.574Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:03.574Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:03.754Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:03.934Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:03.935Z] [LOG]    Employee ID: 0143de00-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:03.936Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:03.937Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:03.937Z] [LOG]    Base Salary (Full Month): Rs.70000.00
[2025-10-22T10:07:04.119Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:04.119Z] [LOG]       Daily Salary: Rs.2800.00
[2025-10-22T10:07:04.120Z] [LOG]       Weekday Hourly Rate: Rs.329.41
[2025-10-22T10:07:04.121Z] [LOG]       Saturday Hourly Rate: Rs.622.22
[2025-10-22T10:07:04.121Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:04.122Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:04.123Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:04.665Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:04.665Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:04.851Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:04.853Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:04.853Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:04.854Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:05.033Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:05.034Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:05.034Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:05.035Z] [LOG]       Current Time: 15:37:05
[2025-10-22T10:07:05.036Z] [LOG]       Expected Hours (scheduled → now): 7.12h
[2025-10-22T10:07:05.036Z] [LOG]       Actual Hours (check-in → now): 7.12h
[2025-10-22T10:07:05.037Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:05.038Z] [LOG]       Weekday: 117.62h
[2025-10-22T10:07:05.038Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:05.039Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:05.040Z] [LOG]       Total Expected: 131.12h
[2025-10-22T10:07:05.040Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:05.041Z] [LOG]       Weekday: 24.12h (includes 7.12h live)
[2025-10-22T10:07:05.042Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:05.042Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:05.043Z] [LOG]       Total Actual: 28.62h
[2025-10-22T10:07:05.043Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:05.044Z] [LOG]       Weekday: 117.62h × Rs.329.41 = Rs.38744.57
[2025-10-22T10:07:05.044Z] [LOG]       Saturday: 13.50h × Rs.622.22 = Rs.8399.97
[2025-10-22T10:07:05.044Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:05.045Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:05.045Z] [LOG]       Total Expected Earned: Rs.47144.54
[2025-10-22T10:07:05.045Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:05.046Z] [LOG]       Weekday: 24.12h × Rs.329.41 = Rs.7944.73
[2025-10-22T10:07:05.046Z] [LOG]       Saturday: 4.50h × Rs.622.22 = Rs.2799.99
[2025-10-22T10:07:05.046Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:05.046Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:05.046Z] [LOG]       Total Actual Earned: Rs.10744.72
[2025-10-22T10:07:05.047Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:05.047Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:05
[2025-10-22T10:07:05.047Z] [LOG]       Expected Earned (until NOW): Rs.47144.54
[2025-10-22T10:07:05.047Z] [LOG]       Actual Earned (until NOW): Rs.10744.72
[2025-10-22T10:07:05.047Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:05.048Z] [LOG]       Attendance Deduction: Rs.36399.82
[2025-10-22T10:07:05.048Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:05.048Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:07:05.048Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:05.048Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:05.048Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:05.048Z] [LOG]    Gross Salary: 70000
[2025-10-22T10:07:05.049Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:05.049Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:05.049Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:05.049Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:05.049Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:05.050Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:05.050Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:05.050Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:05.050Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:05.050Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:05.051Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:05.051Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:05.051Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:05.051Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:05.051Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:05.051Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:05.051Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:05.051Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:05.052Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:05.052Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:05.052Z] [LOG] Regular deductions for Ammaar Ilham: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:05.052Z] [LOG] Combined deductions for Ammaar Ilham: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 36399.815,
      "details": "Shortfall: 102.50h of 131.12h expected (calculated at Oct 22, 2025, 15:37:05)"
    }
  ],
  "total": 36399.815
}
[2025-10-22T10:07:05.232Z] [LOG] Creating components for record 8c08e831-2b16-47cb-a184-6aa2ea54ad02: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:05.233Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 36399.815
}
[2025-10-22T10:07:05.423Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:05.599Z] [LOG] Created payroll_record_component: 8c7dc3b6-ad7d-4796-bc68-473f8ef29cae for Attendance Deduction
[2025-10-22T10:07:05.954Z] [LOG] ✅ Financial balances updated successfully for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:05.954Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:05.955Z] [LOG] 
======================================================================
[2025-10-22T10:07:05.955Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ammaar Ilham
[2025-10-22T10:07:05.955Z] [LOG] ======================================================================
[2025-10-22T10:07:05.955Z] [LOG]    Gross Salary: Rs.70000.00
[2025-10-22T10:07:05.956Z] [LOG]    Total Deductions: Rs.36399.82
[2025-10-22T10:07:05.956Z] [LOG]       - Attendance Deduction: Rs.36399.82
[2025-10-22T10:07:05.956Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:05.957Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:05.957Z] [LOG]    NET SALARY: Rs.33600.18
[2025-10-22T10:07:05.957Z] [LOG] ======================================================================

[2025-10-22T10:07:05.958Z] [LOG] ✅ Ammaar Ilham: Calculation completed successfully
[2025-10-22T10:07:05.958Z] [LOG] 📊 Progress: 18/34 (52.9%)
[2025-10-22T10:07:05.958Z] [LOG] 
🧮 Processing: P.D.P Dilini Madushani null (EMP000043)
[2025-10-22T10:07:05.959Z] [LOG] 📋 Record ID: 93014d73-380b-42bc-b2b1-91eb957794c9
[2025-10-22T10:07:05.960Z] [LOG] 
======================================================================
[2025-10-22T10:07:05.961Z] [LOG] 🧮 CALCULATING PAYROLL: P.D.P Dilini Madushani null (EMP000043)
[2025-10-22T10:07:05.961Z] [LOG] ======================================================================
[2025-10-22T10:07:06.697Z] [LOG] 🔍 Component filtering for employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:06.698Z] [LOG]    Total components: 10
[2025-10-22T10:07:06.698Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:06.699Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-22T10:07:07.848Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:07.848Z] [LOG] 🔄 Processing financial records for employee 014435dc-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:08.027Z] [LOG] 📊 Found 0 active loans for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:08.203Z] [LOG] 📊 Found 0 active advances for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:08.385Z] [LOG] 📊 Found 0 approved bonuses for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:08.385Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:08.386Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:08.387Z] [LOG] 💰 GROSS CALCULATION for P.D.P Dilini Madushani null:
[2025-10-22T10:07:08.388Z] [LOG]    Base Salary: 50000
[2025-10-22T10:07:08.388Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:08.389Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:08.389Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:08.570Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:08.746Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:08.747Z] [LOG]    Employee ID: 014435dc-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:08.747Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:08.748Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:08.748Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:07:08.925Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:08.927Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:07:08.928Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:07:08.929Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:07:08.929Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:08.930Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:08.930Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:09.461Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:09.462Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:09.637Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:09.638Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:09.639Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:09.639Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:09.824Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:09.824Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:09.825Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:09.827Z] [LOG]       Current Time: 15:37:09
[2025-10-22T10:07:09.827Z] [LOG]       Expected Hours (scheduled → now): 7.12h
[2025-10-22T10:07:09.828Z] [LOG]       Actual Hours (check-in → now): 7.12h
[2025-10-22T10:07:09.829Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:09.829Z] [LOG]       Weekday: 117.62h
[2025-10-22T10:07:09.830Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:09.831Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:09.831Z] [LOG]       Total Expected: 131.12h
[2025-10-22T10:07:09.832Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:09.833Z] [LOG]       Weekday: 24.12h (includes 7.12h live)
[2025-10-22T10:07:09.833Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:09.834Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:09.834Z] [LOG]       Total Actual: 28.62h
[2025-10-22T10:07:09.835Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:09.837Z] [LOG]       Weekday: 117.62h × Rs.235.29 = Rs.27674.67
[2025-10-22T10:07:09.838Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:07:09.839Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:09.839Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:09.840Z] [LOG]       Total Expected Earned: Rs.33674.61
[2025-10-22T10:07:09.841Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:09.841Z] [LOG]       Weekday: 24.12h × Rs.235.29 = Rs.5675.05
[2025-10-22T10:07:09.842Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:07:09.845Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:09.845Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:09.845Z] [LOG]       Total Actual Earned: Rs.7675.03
[2025-10-22T10:07:09.846Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:09.847Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:09
[2025-10-22T10:07:09.848Z] [LOG]       Expected Earned (until NOW): Rs.33674.61
[2025-10-22T10:07:09.849Z] [LOG]       Actual Earned (until NOW): Rs.7675.03
[2025-10-22T10:07:09.849Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:09.850Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:09.850Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:09.850Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:07:09.851Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:09.851Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:09.852Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:09.852Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:07:09.852Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:09.853Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:09.853Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:09.854Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:09.854Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:09.854Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:09.855Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:09.855Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:09.855Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:09.855Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:09.856Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:09.856Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:09.856Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:09.857Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:09.857Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:09.857Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:09.858Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:09.858Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:09.858Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:09.859Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:09.859Z] [LOG] Regular deductions for P.D.P Dilini Madushani null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:09.861Z] [LOG] Combined deductions for P.D.P Dilini Madushani null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.575,
      "details": "Shortfall: 102.50h of 131.12h expected (calculated at Oct 22, 2025, 15:37:09)"
    }
  ],
  "total": 25999.575
}
[2025-10-22T10:07:10.057Z] [LOG] Creating components for record 93014d73-380b-42bc-b2b1-91eb957794c9: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:10.058Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-22T10:07:10.235Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:10.411Z] [LOG] Created payroll_record_component: 3ed65a65-5111-4e7b-9128-81982f923005 for Attendance Deduction
[2025-10-22T10:07:10.762Z] [LOG] ✅ Financial balances updated successfully for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:10.763Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:10.763Z] [LOG] 
======================================================================
[2025-10-22T10:07:10.764Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: P.D.P Dilini Madushani null
[2025-10-22T10:07:10.764Z] [LOG] ======================================================================
[2025-10-22T10:07:10.765Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:07:10.766Z] [LOG]    Total Deductions: Rs.25999.58
[2025-10-22T10:07:10.766Z] [LOG]       - Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:10.767Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:10.767Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:10.768Z] [LOG]    NET SALARY: Rs.24000.42
[2025-10-22T10:07:10.769Z] [LOG] ======================================================================

[2025-10-22T10:07:10.770Z] [LOG] ✅ P.D.P Dilini Madushani null: Calculation completed successfully
[2025-10-22T10:07:10.771Z] [LOG] 📊 Progress: 19/34 (55.9%)
[2025-10-22T10:07:10.771Z] [LOG] 
🧮 Processing: Shandeep null (EMP000034)
[2025-10-22T10:07:10.772Z] [LOG] 📋 Record ID: a168185d-4c32-48da-ab8a-50ac408b39f8
[2025-10-22T10:07:10.772Z] [LOG] 
======================================================================
[2025-10-22T10:07:10.775Z] [LOG] 🧮 CALCULATING PAYROLL: Shandeep null (EMP000034)
[2025-10-22T10:07:10.776Z] [LOG] ======================================================================
[2025-10-22T10:07:11.484Z] [LOG] 🔍 Component filtering for employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:11.485Z] [LOG]    Total components: 10
[2025-10-22T10:07:11.485Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:11.486Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-22T10:07:12.560Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:12.561Z] [LOG] 🔄 Processing financial records for employee 0143fc5a-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:12.738Z] [LOG] 📊 Found 0 active loans for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:12.914Z] [LOG] 📊 Found 0 active advances for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:13.091Z] [LOG] 📊 Found 0 approved bonuses for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:13.092Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:13.094Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:13.095Z] [LOG] 💰 GROSS CALCULATION for Shandeep null:
[2025-10-22T10:07:13.096Z] [LOG]    Base Salary: 80000
[2025-10-22T10:07:13.096Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:13.097Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:13.098Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:13.278Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:13.454Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:13.455Z] [LOG]    Employee ID: 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:13.455Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:13.456Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:13.456Z] [LOG]    Base Salary (Full Month): Rs.80000.00
[2025-10-22T10:07:13.633Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:13.634Z] [LOG]       Daily Salary: Rs.3200.00
[2025-10-22T10:07:13.634Z] [LOG]       Weekday Hourly Rate: Rs.376.47
[2025-10-22T10:07:13.635Z] [LOG]       Saturday Hourly Rate: Rs.711.11
[2025-10-22T10:07:13.635Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:13.636Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:13.637Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:14.177Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:14.178Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:14.364Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:14.365Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:14.366Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:14.366Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:14.545Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:14.546Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:14.547Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:14.548Z] [LOG]       Current Time: 15:37:14
[2025-10-22T10:07:14.548Z] [LOG]       Expected Hours (scheduled → now): 7.12h
[2025-10-22T10:07:14.549Z] [LOG]       Actual Hours (check-in → now): 7.12h
[2025-10-22T10:07:14.550Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:14.550Z] [LOG]       Weekday: 117.62h
[2025-10-22T10:07:14.551Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:14.551Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:14.552Z] [LOG]       Total Expected: 131.12h
[2025-10-22T10:07:14.553Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:14.554Z] [LOG]       Weekday: 24.12h (includes 7.12h live)
[2025-10-22T10:07:14.554Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:14.555Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:14.556Z] [LOG]       Total Actual: 28.62h
[2025-10-22T10:07:14.556Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:14.558Z] [LOG]       Weekday: 117.62h × Rs.376.47 = Rs.44280.67
[2025-10-22T10:07:14.559Z] [LOG]       Saturday: 13.50h × Rs.711.11 = Rs.9599.99
[2025-10-22T10:07:14.562Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:14.563Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:14.563Z] [LOG]       Total Expected Earned: Rs.53880.65
[2025-10-22T10:07:14.564Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:14.565Z] [LOG]       Weekday: 24.12h × Rs.376.47 = Rs.9080.72
[2025-10-22T10:07:14.566Z] [LOG]       Saturday: 4.50h × Rs.711.11 = Rs.3199.99
[2025-10-22T10:07:14.566Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:14.567Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:14.568Z] [LOG]       Total Actual Earned: Rs.12280.72
[2025-10-22T10:07:14.569Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:14.570Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:14
[2025-10-22T10:07:14.571Z] [LOG]       Expected Earned (until NOW): Rs.53880.65
[2025-10-22T10:07:14.571Z] [LOG]       Actual Earned (until NOW): Rs.12280.72
[2025-10-22T10:07:14.572Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:14.572Z] [LOG]       Attendance Deduction: Rs.41599.94
[2025-10-22T10:07:14.573Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:14.574Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:07:14.574Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:14.575Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:14.575Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:14.578Z] [LOG]    Gross Salary: 80000
[2025-10-22T10:07:14.579Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:14.579Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:14.580Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:14.581Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:14.581Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:14.582Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:14.582Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:14.582Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:14.583Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:14.583Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:14.583Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:14.584Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:14.584Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:14.584Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:14.584Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:14.585Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:14.585Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:14.585Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:14.586Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:14.586Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:14.586Z] [LOG] Regular deductions for Shandeep null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:14.587Z] [LOG] Combined deductions for Shandeep null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 41599.935000000005,
      "details": "Shortfall: 102.50h of 131.12h expected (calculated at Oct 22, 2025, 15:37:14)"
    }
  ],
  "total": 41599.935000000005
}
[2025-10-22T10:07:14.769Z] [LOG] Creating components for record a168185d-4c32-48da-ab8a-50ac408b39f8: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:14.770Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 41599.935000000005
}
[2025-10-22T10:07:14.946Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:15.134Z] [LOG] Created payroll_record_component: bee305b2-8d82-4439-a82a-9911c41f7efd for Attendance Deduction
[2025-10-22T10:07:15.503Z] [LOG] ✅ Financial balances updated successfully for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:15.503Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:15.504Z] [LOG] 
======================================================================
[2025-10-22T10:07:15.505Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Shandeep null
[2025-10-22T10:07:15.505Z] [LOG] ======================================================================
[2025-10-22T10:07:15.506Z] [LOG]    Gross Salary: Rs.80000.00
[2025-10-22T10:07:15.506Z] [LOG]    Total Deductions: Rs.41599.94
[2025-10-22T10:07:15.507Z] [LOG]       - Attendance Deduction: Rs.41599.94
[2025-10-22T10:07:15.507Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:15.508Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:15.509Z] [LOG]    NET SALARY: Rs.38400.06
[2025-10-22T10:07:15.511Z] [LOG] ======================================================================

[2025-10-22T10:07:15.512Z] [LOG] ✅ Shandeep null: Calculation completed successfully
[2025-10-22T10:07:15.513Z] [LOG] 📊 Progress: 20/34 (58.8%)
[2025-10-22T10:07:15.513Z] [LOG] 
🧮 Processing: customer null (EMP000036)
[2025-10-22T10:07:15.514Z] [LOG] 📋 Record ID: a2c3434d-965b-4bd9-bd49-4ffd281c7985
[2025-10-22T10:07:15.515Z] [LOG] 
======================================================================
[2025-10-22T10:07:15.517Z] [LOG] 🧮 CALCULATING PAYROLL: customer null (EMP000036)
[2025-10-22T10:07:15.518Z] [LOG] ======================================================================
[2025-10-22T10:07:16.272Z] [LOG] 🔍 Component filtering for employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:16.273Z] [LOG]    Total components: 10
[2025-10-22T10:07:16.273Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:16.274Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-22T10:07:17.348Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:17.349Z] [LOG] 🔄 Processing financial records for employee 014409a2-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:17.533Z] [LOG] 📊 Found 0 active loans for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:17.713Z] [LOG] 📊 Found 0 active advances for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:17.891Z] [LOG] 📊 Found 0 approved bonuses for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:17.891Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:17.892Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:17.894Z] [LOG] 💰 GROSS CALCULATION for customer null:
[2025-10-22T10:07:17.895Z] [LOG]    Base Salary: 0
[2025-10-22T10:07:17.895Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:17.896Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:17.897Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:18.091Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:18.269Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:18.269Z] [LOG]    Employee ID: 014409a2-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:18.270Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:18.271Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:18.271Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-22T10:07:18.447Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:18.448Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-22T10:07:18.448Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-22T10:07:18.449Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-22T10:07:18.449Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:18.450Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:18.451Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:18.986Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:18.987Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:19.165Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:19.166Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:19.166Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:19.167Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:19.348Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:19.348Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:19.349Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:19.350Z] [LOG]       Current Time: 15:37:19
[2025-10-22T10:07:19.351Z] [LOG]       Expected Hours (scheduled → now): 7.12h
[2025-10-22T10:07:19.351Z] [LOG]       Actual Hours (check-in → now): 7.12h
[2025-10-22T10:07:19.352Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:19.353Z] [LOG]       Weekday: 117.62h
[2025-10-22T10:07:19.353Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:19.354Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:19.354Z] [LOG]       Total Expected: 131.12h
[2025-10-22T10:07:19.355Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:19.356Z] [LOG]       Weekday: 24.12h (includes 7.12h live)
[2025-10-22T10:07:19.357Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:19.357Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:19.361Z] [LOG]       Total Actual: 28.62h
[2025-10-22T10:07:19.363Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:19.365Z] [LOG]       Weekday: 117.62h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:19.365Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:19.366Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:19.367Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:19.367Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-22T10:07:19.368Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:19.369Z] [LOG]       Weekday: 24.12h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:19.369Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:19.370Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:19.370Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:19.371Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-22T10:07:19.372Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:19.373Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:19
[2025-10-22T10:07:19.374Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-22T10:07:19.374Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-22T10:07:19.375Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:19.375Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-22T10:07:19.378Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:19.380Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-22T10:07:19.380Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:19.381Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:19.382Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:19.382Z] [LOG]    Gross Salary: 0
[2025-10-22T10:07:19.382Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:19.383Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:19.383Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:19.383Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:19.383Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:19.384Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:19.384Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:19.384Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:19.385Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:19.385Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:19.385Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:19.386Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:19.386Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:19.386Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:19.387Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:19.387Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:19.387Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:19.387Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:19.388Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:19.388Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:19.388Z] [LOG] Regular deductions for customer null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:19.389Z] [LOG] Combined deductions for customer null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 0,
      "details": "Shortfall: 102.50h of 131.12h expected (calculated at Oct 22, 2025, 15:37:19)"
    }
  ],
  "total": 0
}
[2025-10-22T10:07:19.569Z] [LOG] Creating components for record a2c3434d-965b-4bd9-bd49-4ffd281c7985: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:19.571Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 0
}
[2025-10-22T10:07:19.769Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:19.950Z] [LOG] Created payroll_record_component: abc4f69c-ed9f-494d-9503-a12742d62e25 for Attendance Deduction
[2025-10-22T10:07:20.312Z] [LOG] ✅ Financial balances updated successfully for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:20.312Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:20.313Z] [LOG] 
======================================================================
[2025-10-22T10:07:20.313Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: customer null
[2025-10-22T10:07:20.314Z] [LOG] ======================================================================
[2025-10-22T10:07:20.315Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-22T10:07:20.315Z] [LOG]    Total Deductions: Rs.0.00
[2025-10-22T10:07:20.316Z] [LOG]       - Attendance Deduction: Rs.0.00
[2025-10-22T10:07:20.316Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:20.317Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:20.318Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-22T10:07:20.318Z] [LOG] ======================================================================

[2025-10-22T10:07:20.319Z] [LOG] ✅ customer null: Calculation completed successfully
[2025-10-22T10:07:20.320Z] [LOG] 📊 Progress: 21/34 (61.8%)
[2025-10-22T10:07:20.321Z] [LOG] 
🧮 Processing: Hari null (EMP000017)
[2025-10-22T10:07:20.321Z] [LOG] 📋 Record ID: a4070444-fdd4-49bc-b59f-97289e094a15
[2025-10-22T10:07:20.322Z] [LOG] 
======================================================================
[2025-10-22T10:07:20.324Z] [LOG] 🧮 CALCULATING PAYROLL: Hari null (EMP000017)
[2025-10-22T10:07:20.325Z] [LOG] ======================================================================
[2025-10-22T10:07:21.033Z] [LOG] 🔍 Component filtering for employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:21.034Z] [LOG]    Total components: 10
[2025-10-22T10:07:21.034Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:21.035Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-22T10:07:22.125Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:22.125Z] [LOG] 🔄 Processing financial records for employee 0143bc58-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:22.302Z] [LOG] 📊 Found 0 active loans for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:22.482Z] [LOG] 📊 Found 0 active advances for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:22.661Z] [LOG] 📊 Found 0 approved bonuses for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:22.662Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:22.663Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:22.664Z] [LOG] 💰 GROSS CALCULATION for Hari null:
[2025-10-22T10:07:22.664Z] [LOG]    Base Salary: 50000
[2025-10-22T10:07:22.665Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:22.665Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:22.666Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:22.846Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:23.028Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:23.029Z] [LOG]    Employee ID: 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:23.030Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:23.030Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:23.031Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:07:23.211Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:23.212Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:07:23.213Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:07:23.213Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:07:23.214Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:23.214Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:23.215Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:23.758Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:23.759Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:23.941Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:23.942Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:23.942Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:23.944Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:24.138Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:24.138Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:24.139Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:24.140Z] [LOG]       Current Time: 15:37:24
[2025-10-22T10:07:24.141Z] [LOG]       Expected Hours (scheduled → now): 7.12h
[2025-10-22T10:07:24.141Z] [LOG]       Actual Hours (check-in → now): 7.12h
[2025-10-22T10:07:24.142Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:24.143Z] [LOG]       Weekday: 117.62h
[2025-10-22T10:07:24.145Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:24.145Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:24.146Z] [LOG]       Total Expected: 131.12h
[2025-10-22T10:07:24.147Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:24.147Z] [LOG]       Weekday: 24.12h (includes 7.12h live)
[2025-10-22T10:07:24.148Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:24.148Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:24.149Z] [LOG]       Total Actual: 28.62h
[2025-10-22T10:07:24.151Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:24.152Z] [LOG]       Weekday: 117.62h × Rs.235.29 = Rs.27675.60
[2025-10-22T10:07:24.153Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:07:24.153Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:24.154Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:24.155Z] [LOG]       Total Expected Earned: Rs.33675.54
[2025-10-22T10:07:24.156Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:24.157Z] [LOG]       Weekday: 24.12h × Rs.235.29 = Rs.5675.99
[2025-10-22T10:07:24.158Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:07:24.158Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:24.159Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:24.167Z] [LOG]       Total Actual Earned: Rs.7675.97
[2025-10-22T10:07:24.169Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:24.170Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:24
[2025-10-22T10:07:24.170Z] [LOG]       Expected Earned (until NOW): Rs.33675.54
[2025-10-22T10:07:24.171Z] [LOG]       Actual Earned (until NOW): Rs.7675.97
[2025-10-22T10:07:24.172Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:24.173Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-22T10:07:24.173Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:24.174Z] [LOG]       📉 Shortfall: 102.50 hours (77.21% of expected)
[2025-10-22T10:07:24.174Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:24.175Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:24.175Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:24.179Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:07:24.180Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:24.181Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:24.182Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:24.183Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:24.183Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:24.184Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:24.184Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:24.185Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:24.185Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:24.185Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:24.185Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:24.186Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:24.186Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:24.186Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:24.187Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:24.187Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:24.187Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:24.188Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:24.188Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:24.188Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:24.188Z] [LOG] Regular deductions for Hari null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:24.189Z] [LOG] Combined deductions for Hari null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.574999999997,
      "details": "Shortfall: 102.50h of 131.12h expected (calculated at Oct 22, 2025, 15:37:24)"
    }
  ],
  "total": 25999.574999999997
}
[2025-10-22T10:07:24.375Z] [LOG] Creating components for record a4070444-fdd4-49bc-b59f-97289e094a15: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:24.376Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-22T10:07:24.553Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:24.734Z] [LOG] Created payroll_record_component: 8e376ef1-86a3-4ad9-9b66-b173caacd0d1 for Attendance Deduction
[2025-10-22T10:07:25.159Z] [LOG] ✅ Financial balances updated successfully for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:25.159Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:25.160Z] [LOG] 
======================================================================
[2025-10-22T10:07:25.160Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Hari null
[2025-10-22T10:07:25.160Z] [LOG] ======================================================================
[2025-10-22T10:07:25.161Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:07:25.161Z] [LOG]    Total Deductions: Rs.25999.57
[2025-10-22T10:07:25.161Z] [LOG]       - Attendance Deduction: Rs.25999.57
[2025-10-22T10:07:25.162Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:25.162Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:25.162Z] [LOG]    NET SALARY: Rs.24000.43
[2025-10-22T10:07:25.163Z] [LOG] ======================================================================

[2025-10-22T10:07:25.163Z] [LOG] ✅ Hari null: Calculation completed successfully
[2025-10-22T10:07:25.163Z] [LOG] 📊 Progress: 22/34 (64.7%)
[2025-10-22T10:07:25.164Z] [LOG] 
🧮 Processing: Saruban null (EMP000007)
[2025-10-22T10:07:25.164Z] [LOG] 📋 Record ID: a5257ed6-108c-4f59-9e8e-70e18de93f5e
[2025-10-22T10:07:25.164Z] [LOG] 
======================================================================
[2025-10-22T10:07:25.164Z] [LOG] 🧮 CALCULATING PAYROLL: Saruban null (EMP000007)
[2025-10-22T10:07:25.165Z] [LOG] ======================================================================
[2025-10-22T10:07:25.876Z] [LOG] 🔍 Component filtering for employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:25.877Z] [LOG]    Total components: 10
[2025-10-22T10:07:25.878Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:25.878Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-22T10:07:26.973Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:26.974Z] [LOG] 🔄 Processing financial records for employee 0143a6e3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:27.151Z] [LOG] 📊 Found 0 active loans for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:27.330Z] [LOG] 📊 Found 0 active advances for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:27.513Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:27.514Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:27.515Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:27.516Z] [LOG] 💰 GROSS CALCULATION for Saruban null:
[2025-10-22T10:07:27.516Z] [LOG]    Base Salary: 0
[2025-10-22T10:07:27.517Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:27.517Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:27.518Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:27.696Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:27.875Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:27.875Z] [LOG]    Employee ID: 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:27.876Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:27.877Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:27.877Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-22T10:07:28.058Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:28.061Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-22T10:07:28.061Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-22T10:07:28.062Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-22T10:07:28.063Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:28.063Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:28.064Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:28.617Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:28.618Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:28.799Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:28.800Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:28.800Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:28.801Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:28.979Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:28.980Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:28.980Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:28.982Z] [LOG]       Current Time: 15:37:28
[2025-10-22T10:07:28.982Z] [LOG]       Expected Hours (scheduled → now): 7.12h
[2025-10-22T10:07:28.983Z] [LOG]       Actual Hours (check-in → now): 7.12h
[2025-10-22T10:07:28.984Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:28.984Z] [LOG]       Weekday: 117.62h
[2025-10-22T10:07:28.985Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:28.986Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:28.987Z] [LOG]       Total Expected: 131.12h
[2025-10-22T10:07:28.988Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:28.989Z] [LOG]       Weekday: 24.12h (includes 7.12h live)
[2025-10-22T10:07:28.989Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:28.991Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:28.992Z] [LOG]       Total Actual: 28.62h
[2025-10-22T10:07:28.996Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:28.997Z] [LOG]       Weekday: 117.62h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:28.997Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:28.999Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:28.999Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:29.000Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-22T10:07:29.000Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:29.001Z] [LOG]       Weekday: 24.12h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:29.001Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:29.001Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:29.002Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:29.002Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-22T10:07:29.003Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:29.003Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:29
[2025-10-22T10:07:29.003Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-22T10:07:29.004Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-22T10:07:29.004Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:29.004Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-22T10:07:29.004Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:29.005Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-22T10:07:29.005Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:29.005Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:29.006Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:29.006Z] [LOG]    Gross Salary: 0
[2025-10-22T10:07:29.006Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:29.006Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:29.007Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:29.007Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:29.007Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:29.007Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:29.008Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:29.008Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:29.008Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:29.008Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:29.008Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:29.009Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:29.011Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:29.012Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:29.015Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:29.015Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:29.016Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:29.016Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:29.016Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:29.016Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:29.017Z] [LOG] Regular deductions for Saruban null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:29.017Z] [LOG] Combined deductions for Saruban null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 0,
      "details": "Shortfall: 102.50h of 131.12h expected (calculated at Oct 22, 2025, 15:37:29)"
    }
  ],
  "total": 0
}
[2025-10-22T10:07:29.195Z] [LOG] Creating components for record a5257ed6-108c-4f59-9e8e-70e18de93f5e: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:29.196Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 0
}
[2025-10-22T10:07:29.372Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:29.562Z] [LOG] Created payroll_record_component: e80227ef-f0a0-4ebb-9aff-2bc52468ba80 for Attendance Deduction
[2025-10-22T10:07:29.943Z] [LOG] ✅ Financial balances updated successfully for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:29.944Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:29.945Z] [LOG] 
======================================================================
[2025-10-22T10:07:29.945Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Saruban null
[2025-10-22T10:07:29.946Z] [LOG] ======================================================================
[2025-10-22T10:07:29.947Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-22T10:07:29.947Z] [LOG]    Total Deductions: Rs.0.00
[2025-10-22T10:07:29.948Z] [LOG]       - Attendance Deduction: Rs.0.00
[2025-10-22T10:07:29.948Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:29.949Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:29.949Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-22T10:07:29.950Z] [LOG] ======================================================================

[2025-10-22T10:07:29.951Z] [LOG] ✅ Saruban null: Calculation completed successfully
[2025-10-22T10:07:29.952Z] [LOG] 📊 Progress: 23/34 (67.6%)
[2025-10-22T10:07:29.953Z] [LOG] 
🧮 Processing: Anoj null (EMP000014)
[2025-10-22T10:07:29.953Z] [LOG] 📋 Record ID: a9614f84-adfd-4abc-8b23-6a44149c9347
[2025-10-22T10:07:29.954Z] [LOG] 
======================================================================
[2025-10-22T10:07:29.957Z] [LOG] 🧮 CALCULATING PAYROLL: Anoj null (EMP000014)
[2025-10-22T10:07:29.957Z] [LOG] ======================================================================
[2025-10-22T10:07:30.721Z] [LOG] 🔍 Component filtering for employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:30.722Z] [LOG]    Total components: 10
[2025-10-22T10:07:30.722Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:30.723Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-22T10:07:31.825Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:31.826Z] [LOG] 🔄 Processing financial records for employee 0143afc6-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:32.004Z] [LOG] 📊 Found 0 active loans for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:32.180Z] [LOG] 📊 Found 0 active advances for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:32.359Z] [LOG] 📊 Found 0 approved bonuses for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:32.360Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:32.360Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:32.360Z] [LOG] 💰 GROSS CALCULATION for Anoj null:
[2025-10-22T10:07:32.361Z] [LOG]    Base Salary: 50000
[2025-10-22T10:07:32.361Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:32.361Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:32.361Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:32.548Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:32.727Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:32.728Z] [LOG]    Employee ID: 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:32.728Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:32.729Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:32.729Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:07:32.908Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:32.909Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:07:32.910Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:07:32.910Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:07:32.910Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:32.911Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:32.911Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:33.441Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:33.442Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:33.621Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:33.622Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:33.622Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:33.623Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:33.798Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:33.799Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:33.799Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:33.800Z] [LOG]       Current Time: 15:37:33
[2025-10-22T10:07:33.801Z] [LOG]       Expected Hours (scheduled → now): 7.13h
[2025-10-22T10:07:33.801Z] [LOG]       Actual Hours (check-in → now): 7.13h
[2025-10-22T10:07:33.802Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:33.802Z] [LOG]       Weekday: 117.63h
[2025-10-22T10:07:33.802Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:33.803Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:33.803Z] [LOG]       Total Expected: 131.13h
[2025-10-22T10:07:33.804Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:33.804Z] [LOG]       Weekday: 24.13h (includes 7.13h live)
[2025-10-22T10:07:33.805Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:33.805Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:33.806Z] [LOG]       Total Actual: 28.63h
[2025-10-22T10:07:33.806Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:33.807Z] [LOG]       Weekday: 117.63h × Rs.235.29 = Rs.27676.23
[2025-10-22T10:07:33.808Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:07:33.808Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:33.809Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:33.810Z] [LOG]       Total Expected Earned: Rs.33676.17
[2025-10-22T10:07:33.810Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:33.811Z] [LOG]       Weekday: 24.13h × Rs.235.29 = Rs.5676.62
[2025-10-22T10:07:33.812Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:07:33.812Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:33.813Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:33.813Z] [LOG]       Total Actual Earned: Rs.7676.60
[2025-10-22T10:07:33.814Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:33.815Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:33
[2025-10-22T10:07:33.815Z] [LOG]       Expected Earned (until NOW): Rs.33676.17
[2025-10-22T10:07:33.816Z] [LOG]       Actual Earned (until NOW): Rs.7676.60
[2025-10-22T10:07:33.816Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:33.817Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:33.817Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:33.817Z] [LOG]       📉 Shortfall: 102.50 hours (77.20% of expected)
[2025-10-22T10:07:33.818Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:33.818Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:33.819Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:33.819Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:07:33.819Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:33.820Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:33.820Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:33.821Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:33.822Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:33.822Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:33.823Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:33.823Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:33.824Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:33.824Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:33.825Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:33.825Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:33.826Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:33.827Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:33.827Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:33.828Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:33.828Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:33.829Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:33.829Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:33.830Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:33.831Z] [LOG] Regular deductions for Anoj null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:33.832Z] [LOG] Combined deductions for Anoj null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.575,
      "details": "Shortfall: 102.50h of 131.13h expected (calculated at Oct 22, 2025, 15:37:33)"
    }
  ],
  "total": 25999.575
}
[2025-10-22T10:07:34.023Z] [LOG] Creating components for record a9614f84-adfd-4abc-8b23-6a44149c9347: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:34.029Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-22T10:07:34.205Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:34.392Z] [LOG] Created payroll_record_component: bfff171e-9764-467b-992b-d26f4d0d0abc for Attendance Deduction
[2025-10-22T10:07:34.771Z] [LOG] ✅ Financial balances updated successfully for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:34.772Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:34.773Z] [LOG] 
======================================================================
[2025-10-22T10:07:34.773Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Anoj null
[2025-10-22T10:07:34.774Z] [LOG] ======================================================================
[2025-10-22T10:07:34.775Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:07:34.775Z] [LOG]    Total Deductions: Rs.25999.58
[2025-10-22T10:07:34.776Z] [LOG]       - Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:34.776Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:34.777Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:34.777Z] [LOG]    NET SALARY: Rs.24000.42
[2025-10-22T10:07:34.778Z] [LOG] ======================================================================

[2025-10-22T10:07:34.779Z] [LOG] ✅ Anoj null: Calculation completed successfully
[2025-10-22T10:07:34.780Z] [LOG] 📊 Progress: 24/34 (70.6%)
[2025-10-22T10:07:34.780Z] [LOG] 
🧮 Processing: Chamodi null (EMP000032)
[2025-10-22T10:07:34.781Z] [LOG] 📋 Record ID: b9d9a6b6-a35a-4e97-9dae-f9ae2e081101
[2025-10-22T10:07:34.782Z] [LOG] 
======================================================================
[2025-10-22T10:07:34.783Z] [LOG] 🧮 CALCULATING PAYROLL: Chamodi null (EMP000032)
[2025-10-22T10:07:34.785Z] [LOG] ======================================================================
[2025-10-22T10:07:35.508Z] [LOG] 🔍 Component filtering for employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:35.508Z] [LOG]    Total components: 10
[2025-10-22T10:07:35.509Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:35.509Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-22T10:07:36.590Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:36.590Z] [LOG] 🔄 Processing financial records for employee 0143f302-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:36.771Z] [LOG] 📊 Found 0 active loans for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:36.952Z] [LOG] 📊 Found 0 active advances for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:37.128Z] [LOG] 📊 Found 0 approved bonuses for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:37.129Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:37.130Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:37.130Z] [LOG] 💰 GROSS CALCULATION for Chamodi null:
[2025-10-22T10:07:37.131Z] [LOG]    Base Salary: 50000
[2025-10-22T10:07:37.132Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:37.132Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:37.133Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:37.356Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:37.534Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:37.535Z] [LOG]    Employee ID: 0143f302-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:37.536Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:37.536Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:37.537Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:07:37.717Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:37.718Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:07:37.719Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:07:37.719Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:07:37.720Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:37.720Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:37.721Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:38.253Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:38.254Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:38.434Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:38.434Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:38.435Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:38.436Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:38.613Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:38.613Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:38.614Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:38.615Z] [LOG]       Current Time: 15:37:38
[2025-10-22T10:07:38.616Z] [LOG]       Expected Hours (scheduled → now): 7.13h
[2025-10-22T10:07:38.616Z] [LOG]       Actual Hours (check-in → now): 7.13h
[2025-10-22T10:07:38.617Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:38.618Z] [LOG]       Weekday: 117.63h
[2025-10-22T10:07:38.618Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:38.619Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:38.620Z] [LOG]       Total Expected: 131.13h
[2025-10-22T10:07:38.620Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:38.621Z] [LOG]       Weekday: 24.13h (includes 7.13h live)
[2025-10-22T10:07:38.622Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:38.622Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:38.623Z] [LOG]       Total Actual: 28.63h
[2025-10-22T10:07:38.623Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:38.625Z] [LOG]       Weekday: 117.63h × Rs.235.29 = Rs.27676.55
[2025-10-22T10:07:38.626Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:07:38.627Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:38.627Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:38.628Z] [LOG]       Total Expected Earned: Rs.33676.49
[2025-10-22T10:07:38.629Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:38.630Z] [LOG]       Weekday: 24.13h × Rs.235.29 = Rs.5676.93
[2025-10-22T10:07:38.630Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:07:38.631Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:38.632Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:38.632Z] [LOG]       Total Actual Earned: Rs.7676.91
[2025-10-22T10:07:38.633Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:38.634Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:38
[2025-10-22T10:07:38.634Z] [LOG]       Expected Earned (until NOW): Rs.33676.49
[2025-10-22T10:07:38.635Z] [LOG]       Actual Earned (until NOW): Rs.7676.91
[2025-10-22T10:07:38.636Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:38.637Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:38.637Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:38.638Z] [LOG]       📉 Shortfall: 102.50 hours (77.20% of expected)
[2025-10-22T10:07:38.638Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:38.639Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:38.639Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:38.640Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:07:38.640Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:38.641Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:38.642Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:38.642Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:38.643Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:38.643Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:38.643Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:38.644Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:38.644Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:38.644Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:38.645Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:38.645Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:38.645Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:38.646Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:38.646Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:38.646Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:38.647Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:38.647Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:38.647Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:38.647Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:38.648Z] [LOG] Regular deductions for Chamodi null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:38.648Z] [LOG] Combined deductions for Chamodi null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.575,
      "details": "Shortfall: 102.50h of 131.13h expected (calculated at Oct 22, 2025, 15:37:38)"
    }
  ],
  "total": 25999.575
}
[2025-10-22T10:07:38.831Z] [LOG] Creating components for record b9d9a6b6-a35a-4e97-9dae-f9ae2e081101: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:38.835Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-22T10:07:39.014Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:39.193Z] [LOG] Created payroll_record_component: f804d32f-582a-4d20-b31a-7ccd2a99a800 for Attendance Deduction
[2025-10-22T10:07:39.551Z] [LOG] ✅ Financial balances updated successfully for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:39.552Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:39.552Z] [LOG] 
======================================================================
[2025-10-22T10:07:39.553Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Chamodi null
[2025-10-22T10:07:39.554Z] [LOG] ======================================================================
[2025-10-22T10:07:39.554Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:07:39.559Z] [LOG]    Total Deductions: Rs.25999.58
[2025-10-22T10:07:39.559Z] [LOG]       - Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:39.560Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:39.560Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:39.561Z] [LOG]    NET SALARY: Rs.24000.42
[2025-10-22T10:07:39.562Z] [LOG] ======================================================================

[2025-10-22T10:07:39.562Z] [LOG] ✅ Chamodi null: Calculation completed successfully
[2025-10-22T10:07:39.563Z] [LOG] 📊 Progress: 25/34 (73.5%)
[2025-10-22T10:07:39.564Z] [LOG] 
🧮 Processing: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-22T10:07:39.565Z] [LOG] 📋 Record ID: bafb9c69-a4ad-43e3-a437-f8f2bbdd0a78
[2025-10-22T10:07:39.565Z] [LOG] 
======================================================================
[2025-10-22T10:07:39.566Z] [LOG] 🧮 CALCULATING PAYROLL: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-22T10:07:39.567Z] [LOG] ======================================================================
[2025-10-22T10:07:40.321Z] [LOG] 🔍 Component filtering for employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:40.322Z] [LOG]    Total components: 10
[2025-10-22T10:07:40.322Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:40.322Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-22T10:07:41.404Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:41.406Z] [LOG] 🔄 Processing financial records for employee 0144315c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:41.584Z] [LOG] 📊 Found 0 active loans for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:41.773Z] [LOG] 📊 Found 0 active advances for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:41.956Z] [LOG] 📊 Found 0 approved bonuses for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:41.956Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:41.958Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:41.958Z] [LOG] 💰 GROSS CALCULATION for G.M Supathala Sadaru Madhushan null:
[2025-10-22T10:07:41.959Z] [LOG]    Base Salary: 50000
[2025-10-22T10:07:41.959Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:41.960Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:41.961Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:42.138Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:42.319Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:42.320Z] [LOG]    Employee ID: 0144315c-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:42.320Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:42.321Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:42.322Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:07:42.523Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:42.524Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:07:42.525Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:07:42.525Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:07:42.526Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:42.526Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:42.527Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:43.062Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:43.062Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:43.240Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:43.241Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:43.242Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:43.242Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:43.420Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:43.420Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:43.421Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:43.422Z] [LOG]       Current Time: 15:37:43
[2025-10-22T10:07:43.423Z] [LOG]       Expected Hours (scheduled → now): 7.13h
[2025-10-22T10:07:43.424Z] [LOG]       Actual Hours (check-in → now): 7.13h
[2025-10-22T10:07:43.424Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:43.425Z] [LOG]       Weekday: 117.63h
[2025-10-22T10:07:43.426Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:43.427Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:43.427Z] [LOG]       Total Expected: 131.13h
[2025-10-22T10:07:43.428Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:43.429Z] [LOG]       Weekday: 24.13h (includes 7.13h live)
[2025-10-22T10:07:43.429Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:43.430Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:43.432Z] [LOG]       Total Actual: 28.63h
[2025-10-22T10:07:43.433Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:43.434Z] [LOG]       Weekday: 117.63h × Rs.235.29 = Rs.27676.86
[2025-10-22T10:07:43.435Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:07:43.435Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:43.436Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:43.436Z] [LOG]       Total Expected Earned: Rs.33676.80
[2025-10-22T10:07:43.437Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:43.438Z] [LOG]       Weekday: 24.13h × Rs.235.29 = Rs.5677.25
[2025-10-22T10:07:43.440Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:07:43.441Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:43.442Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:43.443Z] [LOG]       Total Actual Earned: Rs.7677.23
[2025-10-22T10:07:43.445Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:43.446Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:43
[2025-10-22T10:07:43.447Z] [LOG]       Expected Earned (until NOW): Rs.33676.80
[2025-10-22T10:07:43.447Z] [LOG]       Actual Earned (until NOW): Rs.7677.23
[2025-10-22T10:07:43.448Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:43.448Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:43.449Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:43.450Z] [LOG]       📉 Shortfall: 102.50 hours (77.20% of expected)
[2025-10-22T10:07:43.450Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:43.451Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:43.451Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:43.452Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:07:43.453Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:43.453Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:43.454Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:43.455Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:43.457Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:43.458Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:43.458Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:43.459Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:43.461Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:43.462Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:43.463Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:43.463Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:43.464Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:43.465Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:43.465Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:43.467Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:43.467Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:43.468Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:43.468Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:43.469Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:43.469Z] [LOG] Regular deductions for G.M Supathala Sadaru Madhushan null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:43.470Z] [LOG] Combined deductions for G.M Supathala Sadaru Madhushan null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.575000000004,
      "details": "Shortfall: 102.50h of 131.13h expected (calculated at Oct 22, 2025, 15:37:43)"
    }
  ],
  "total": 25999.575000000004
}
[2025-10-22T10:07:43.656Z] [LOG] Creating components for record bafb9c69-a4ad-43e3-a437-f8f2bbdd0a78: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:43.658Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-22T10:07:43.835Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:44.013Z] [LOG] Created payroll_record_component: 0f1d1307-f2f3-49e5-9907-cab935fdd7d3 for Attendance Deduction
[2025-10-22T10:07:44.365Z] [LOG] ✅ Financial balances updated successfully for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:44.366Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:44.366Z] [LOG] 
======================================================================
[2025-10-22T10:07:44.367Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: G.M Supathala Sadaru Madhushan null
[2025-10-22T10:07:44.368Z] [LOG] ======================================================================
[2025-10-22T10:07:44.368Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:07:44.369Z] [LOG]    Total Deductions: Rs.25999.58
[2025-10-22T10:07:44.370Z] [LOG]       - Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:44.370Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:44.371Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:44.374Z] [LOG]    NET SALARY: Rs.24000.42
[2025-10-22T10:07:44.374Z] [LOG] ======================================================================

[2025-10-22T10:07:44.375Z] [LOG] ✅ G.M Supathala Sadaru Madhushan null: Calculation completed successfully
[2025-10-22T10:07:44.377Z] [LOG] 📊 Progress: 26/34 (76.5%)
[2025-10-22T10:07:44.378Z] [LOG] 
🧮 Processing: Viruna Damsiha Cooray null (EMP000038)
[2025-10-22T10:07:44.379Z] [LOG] 📋 Record ID: c48deae8-1cbb-4639-b2bc-baab7fb2dd7e
[2025-10-22T10:07:44.380Z] [LOG] 
======================================================================
[2025-10-22T10:07:44.381Z] [LOG] 🧮 CALCULATING PAYROLL: Viruna Damsiha Cooray null (EMP000038)
[2025-10-22T10:07:44.382Z] [LOG] ======================================================================
[2025-10-22T10:07:45.090Z] [LOG] 🔍 Component filtering for employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:45.091Z] [LOG]    Total components: 10
[2025-10-22T10:07:45.092Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:45.092Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-22T10:07:46.161Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:46.162Z] [LOG] 🔄 Processing financial records for employee 01441633-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:46.339Z] [LOG] 📊 Found 0 active loans for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:46.518Z] [LOG] 📊 Found 0 active advances for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:46.699Z] [LOG] 📊 Found 0 approved bonuses for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:46.700Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:46.701Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:46.702Z] [LOG] 💰 GROSS CALCULATION for Viruna Damsiha Cooray null:
[2025-10-22T10:07:46.702Z] [LOG]    Base Salary: 50000
[2025-10-22T10:07:46.703Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:46.704Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:46.704Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:46.883Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:47.062Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:47.063Z] [LOG]    Employee ID: 01441633-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:47.063Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:47.064Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:47.064Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:07:47.246Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:47.247Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:07:47.248Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:07:47.248Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:07:47.249Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:47.249Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:47.250Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:47.779Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:47.779Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:47.958Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:47.959Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:47.959Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:47.960Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:48.138Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:48.139Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:48.140Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:48.141Z] [LOG]       Current Time: 15:37:48
[2025-10-22T10:07:48.142Z] [LOG]       Expected Hours (scheduled → now): 7.13h
[2025-10-22T10:07:48.142Z] [LOG]       Actual Hours (check-in → now): 7.13h
[2025-10-22T10:07:48.143Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:48.144Z] [LOG]       Weekday: 117.63h
[2025-10-22T10:07:48.144Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:48.145Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:48.146Z] [LOG]       Total Expected: 131.13h
[2025-10-22T10:07:48.146Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:48.147Z] [LOG]       Weekday: 24.13h (includes 7.13h live)
[2025-10-22T10:07:48.148Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:48.148Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:48.149Z] [LOG]       Total Actual: 28.63h
[2025-10-22T10:07:48.150Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:48.151Z] [LOG]       Weekday: 117.63h × Rs.235.29 = Rs.27677.17
[2025-10-22T10:07:48.152Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:07:48.152Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:48.153Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:48.154Z] [LOG]       Total Expected Earned: Rs.33677.11
[2025-10-22T10:07:48.155Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:48.157Z] [LOG]       Weekday: 24.13h × Rs.235.29 = Rs.5677.56
[2025-10-22T10:07:48.158Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:07:48.158Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:48.159Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:48.160Z] [LOG]       Total Actual Earned: Rs.7677.54
[2025-10-22T10:07:48.162Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:48.163Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:48
[2025-10-22T10:07:48.164Z] [LOG]       Expected Earned (until NOW): Rs.33677.11
[2025-10-22T10:07:48.164Z] [LOG]       Actual Earned (until NOW): Rs.7677.54
[2025-10-22T10:07:48.165Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:48.165Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-22T10:07:48.166Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:48.166Z] [LOG]       📉 Shortfall: 102.50 hours (77.20% of expected)
[2025-10-22T10:07:48.167Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:48.168Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:48.168Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:48.169Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:07:48.170Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:48.170Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:48.171Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:48.173Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:48.173Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:48.174Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:48.175Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:48.176Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:48.177Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:48.178Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:48.178Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:48.179Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:48.179Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:48.179Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:48.180Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:48.180Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:48.180Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:48.181Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:48.181Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:48.181Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:48.182Z] [LOG] Regular deductions for Viruna Damsiha Cooray null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:48.182Z] [LOG] Combined deductions for Viruna Damsiha Cooray null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.574999999997,
      "details": "Shortfall: 102.50h of 131.13h expected (calculated at Oct 22, 2025, 15:37:48)"
    }
  ],
  "total": 25999.574999999997
}
[2025-10-22T10:07:48.358Z] [LOG] Creating components for record c48deae8-1cbb-4639-b2bc-baab7fb2dd7e: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:48.360Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-22T10:07:48.541Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:48.721Z] [LOG] Created payroll_record_component: 9f866a25-15d9-4338-927a-051ced0bfe8f for Attendance Deduction
[2025-10-22T10:07:49.076Z] [LOG] ✅ Financial balances updated successfully for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:49.077Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:49.077Z] [LOG] 
======================================================================
[2025-10-22T10:07:49.078Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Viruna Damsiha Cooray null
[2025-10-22T10:07:49.078Z] [LOG] ======================================================================
[2025-10-22T10:07:49.079Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:07:49.080Z] [LOG]    Total Deductions: Rs.25999.57
[2025-10-22T10:07:49.080Z] [LOG]       - Attendance Deduction: Rs.25999.57
[2025-10-22T10:07:49.081Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:49.081Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:49.082Z] [LOG]    NET SALARY: Rs.24000.43
[2025-10-22T10:07:49.082Z] [LOG] ======================================================================

[2025-10-22T10:07:49.084Z] [LOG] ✅ Viruna Damsiha Cooray null: Calculation completed successfully
[2025-10-22T10:07:49.084Z] [LOG] 📊 Progress: 27/34 (79.4%)
[2025-10-22T10:07:49.085Z] [LOG] 
🧮 Processing: Faizan Faizan (EMP000003)
[2025-10-22T10:07:49.086Z] [LOG] 📋 Record ID: d9367305-df61-46d1-aa82-2922040618da
[2025-10-22T10:07:49.086Z] [LOG] 
======================================================================
[2025-10-22T10:07:49.091Z] [LOG] 🧮 CALCULATING PAYROLL: Faizan Faizan (EMP000003)
[2025-10-22T10:07:49.092Z] [LOG] ======================================================================
[2025-10-22T10:07:49.802Z] [LOG] 🔍 Component filtering for employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:49.803Z] [LOG]    Total components: 10
[2025-10-22T10:07:49.803Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:49.803Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-22T10:07:50.869Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:50.870Z] [LOG] 🔄 Processing financial records for employee 0143a057-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:51.050Z] [LOG] 📊 Found 0 active loans for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:51.227Z] [LOG] 📊 Found 0 active advances for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:51.406Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:51.407Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:51.408Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:51.409Z] [LOG] 💰 GROSS CALCULATION for Faizan Faizan:
[2025-10-22T10:07:51.410Z] [LOG]    Base Salary: 50000
[2025-10-22T10:07:51.410Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:51.411Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:51.411Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:51.591Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:51.772Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:51.773Z] [LOG]    Employee ID: 0143a057-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:51.774Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:51.774Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:51.775Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:07:51.957Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:51.958Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:07:51.959Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:07:51.959Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:07:51.960Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:51.960Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:51.961Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:52.497Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:52.498Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:52.694Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:52.695Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:52.695Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:52.696Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:52.889Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:52.890Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:52.891Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:52.892Z] [LOG]       Current Time: 15:37:52
[2025-10-22T10:07:52.892Z] [LOG]       Expected Hours (scheduled → now): 7.13h
[2025-10-22T10:07:52.893Z] [LOG]       Actual Hours (check-in → now): 7.13h
[2025-10-22T10:07:52.893Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:52.894Z] [LOG]       Weekday: 117.63h
[2025-10-22T10:07:52.895Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:52.895Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:52.896Z] [LOG]       Total Expected: 131.13h
[2025-10-22T10:07:52.897Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:52.898Z] [LOG]       Weekday: 24.13h (includes 7.13h live)
[2025-10-22T10:07:52.898Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:52.899Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:52.899Z] [LOG]       Total Actual: 28.63h
[2025-10-22T10:07:52.901Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:52.902Z] [LOG]       Weekday: 117.63h × Rs.235.29 = Rs.27677.48
[2025-10-22T10:07:52.903Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:07:52.904Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:52.904Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:52.907Z] [LOG]       Total Expected Earned: Rs.33677.42
[2025-10-22T10:07:52.908Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:52.908Z] [LOG]       Weekday: 24.13h × Rs.235.29 = Rs.5677.87
[2025-10-22T10:07:52.909Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:07:52.910Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:52.911Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:52.912Z] [LOG]       Total Actual Earned: Rs.7677.85
[2025-10-22T10:07:52.913Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:52.914Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:52
[2025-10-22T10:07:52.915Z] [LOG]       Expected Earned (until NOW): Rs.33677.42
[2025-10-22T10:07:52.916Z] [LOG]       Actual Earned (until NOW): Rs.7677.85
[2025-10-22T10:07:52.916Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:52.917Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:52.917Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:52.918Z] [LOG]       📉 Shortfall: 102.50 hours (77.20% of expected)
[2025-10-22T10:07:52.918Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:52.918Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:52.919Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:52.919Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:07:52.919Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:52.920Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:52.920Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:52.920Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:52.921Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:52.921Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:52.922Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:52.923Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:52.923Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:52.924Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:52.925Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:52.925Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:52.926Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:52.926Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:52.927Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:52.927Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:52.927Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:52.927Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:52.928Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:52.928Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:52.928Z] [LOG] Regular deductions for Faizan Faizan: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:52.929Z] [LOG] Combined deductions for Faizan Faizan: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.575,
      "details": "Shortfall: 102.50h of 131.13h expected (calculated at Oct 22, 2025, 15:37:52)"
    }
  ],
  "total": 25999.575
}
[2025-10-22T10:07:53.111Z] [LOG] Creating components for record d9367305-df61-46d1-aa82-2922040618da: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:53.113Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-22T10:07:53.307Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:53.486Z] [LOG] Created payroll_record_component: 03641383-5f11-4757-90f1-205030a50da3 for Attendance Deduction
[2025-10-22T10:07:53.842Z] [LOG] ✅ Financial balances updated successfully for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:53.843Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:53.843Z] [LOG] 
======================================================================
[2025-10-22T10:07:53.844Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Faizan Faizan
[2025-10-22T10:07:53.844Z] [LOG] ======================================================================
[2025-10-22T10:07:53.845Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:07:53.846Z] [LOG]    Total Deductions: Rs.25999.58
[2025-10-22T10:07:53.846Z] [LOG]       - Attendance Deduction: Rs.25999.58
[2025-10-22T10:07:53.847Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:53.847Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:53.848Z] [LOG]    NET SALARY: Rs.24000.42
[2025-10-22T10:07:53.849Z] [LOG] ======================================================================

[2025-10-22T10:07:53.850Z] [LOG] ✅ Faizan Faizan: Calculation completed successfully
[2025-10-22T10:07:53.850Z] [LOG] 📊 Progress: 28/34 (82.4%)
[2025-10-22T10:07:53.851Z] [LOG] 
🧮 Processing: Sumaiya null (EMP000016)
[2025-10-22T10:07:53.852Z] [LOG] 📋 Record ID: de42a090-fa98-4708-98e1-8b6d703baec4
[2025-10-22T10:07:53.852Z] [LOG] 
======================================================================
[2025-10-22T10:07:53.853Z] [LOG] 🧮 CALCULATING PAYROLL: Sumaiya null (EMP000016)
[2025-10-22T10:07:53.858Z] [LOG] ======================================================================
[2025-10-22T10:07:54.570Z] [LOG] 🔍 Component filtering for employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:54.571Z] [LOG]    Total components: 10
[2025-10-22T10:07:54.571Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:54.572Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-22T10:07:55.662Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:07:55.663Z] [LOG] 🔄 Processing financial records for employee 0143b22f-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:07:55.843Z] [LOG] 📊 Found 0 active loans for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:56.020Z] [LOG] 📊 Found 0 active advances for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:56.199Z] [LOG] 📊 Found 0 approved bonuses for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:56.200Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:07:56.201Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:07:56.202Z] [LOG] 💰 GROSS CALCULATION for Sumaiya null:
[2025-10-22T10:07:56.202Z] [LOG]    Base Salary: 60000
[2025-10-22T10:07:56.203Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:07:56.204Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:07:56.204Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:56.388Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:07:56.567Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:07:56.567Z] [LOG]    Employee ID: 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:56.568Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:07:56.568Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:07:56.569Z] [LOG]    Base Salary (Full Month): Rs.60000.00
[2025-10-22T10:07:56.752Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:07:56.752Z] [LOG]       Daily Salary: Rs.2400.00
[2025-10-22T10:07:56.753Z] [LOG]       Weekday Hourly Rate: Rs.282.35
[2025-10-22T10:07:56.754Z] [LOG]       Saturday Hourly Rate: Rs.533.33
[2025-10-22T10:07:56.754Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:07:56.755Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:07:56.756Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:07:57.297Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:07:57.298Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:07:57.480Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:07:57.481Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:07:57.481Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:57.482Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:57.661Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:07:57.661Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:07:57.662Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:07:57.663Z] [LOG]       Current Time: 15:37:57
[2025-10-22T10:07:57.664Z] [LOG]       Expected Hours (scheduled → now): 7.13h
[2025-10-22T10:07:57.664Z] [LOG]       Actual Hours (check-in → now): 7.13h
[2025-10-22T10:07:57.665Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:07:57.665Z] [LOG]       Weekday: 117.63h
[2025-10-22T10:07:57.666Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:07:57.666Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:57.667Z] [LOG]       Total Expected: 131.13h
[2025-10-22T10:07:57.668Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:07:57.669Z] [LOG]       Weekday: 24.13h (includes 7.13h live)
[2025-10-22T10:07:57.669Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:07:57.670Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:07:57.670Z] [LOG]       Total Actual: 28.63h
[2025-10-22T10:07:57.671Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:07:57.676Z] [LOG]       Weekday: 117.63h × Rs.282.35 = Rs.33213.59
[2025-10-22T10:07:57.677Z] [LOG]       Saturday: 13.50h × Rs.533.33 = Rs.7199.96
[2025-10-22T10:07:57.677Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:57.678Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:57.679Z] [LOG]       Total Expected Earned: Rs.40413.54
[2025-10-22T10:07:57.679Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:07:57.680Z] [LOG]       Weekday: 24.13h × Rs.282.35 = Rs.6813.86
[2025-10-22T10:07:57.680Z] [LOG]       Saturday: 4.50h × Rs.533.33 = Rs.2399.99
[2025-10-22T10:07:57.681Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:07:57.682Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:57.682Z] [LOG]       Total Actual Earned: Rs.9213.85
[2025-10-22T10:07:57.684Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:07:57.684Z] [LOG]       Calculated At: Oct 22, 2025, 15:37:57
[2025-10-22T10:07:57.685Z] [LOG]       Expected Earned (until NOW): Rs.40413.54
[2025-10-22T10:07:57.686Z] [LOG]       Actual Earned (until NOW): Rs.9213.85
[2025-10-22T10:07:57.686Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:07:57.687Z] [LOG]       Attendance Deduction: Rs.31199.69
[2025-10-22T10:07:57.687Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:07:57.690Z] [LOG]       📉 Shortfall: 102.50 hours (77.20% of expected)
[2025-10-22T10:07:57.690Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:07:57.691Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:07:57.691Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:07:57.692Z] [LOG]    Gross Salary: 60000
[2025-10-22T10:07:57.693Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:07:57.693Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:07:57.693Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:57.694Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:07:57.694Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:57.694Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:07:57.695Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:57.695Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:07:57.696Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:57.696Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:07:57.696Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:57.697Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:07:57.697Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:57.697Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:07:57.698Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:57.698Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:07:57.698Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:57.699Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:07:57.699Z] [LOG]    Fixed amount: 0
[2025-10-22T10:07:57.699Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:07:57.700Z] [LOG] Regular deductions for Sumaiya null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:07:57.700Z] [LOG] Combined deductions for Sumaiya null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 31199.695,
      "details": "Shortfall: 102.50h of 131.13h expected (calculated at Oct 22, 2025, 15:37:57)"
    }
  ],
  "total": 31199.695
}
[2025-10-22T10:07:57.892Z] [LOG] Creating components for record de42a090-fa98-4708-98e1-8b6d703baec4: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:07:57.894Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 31199.695
}
[2025-10-22T10:07:58.117Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:07:58.299Z] [LOG] Created payroll_record_component: bd7c5662-ceda-47e2-9e37-276770ab6d2d for Attendance Deduction
[2025-10-22T10:07:58.654Z] [LOG] ✅ Financial balances updated successfully for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-22T10:07:58.656Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:07:58.656Z] [LOG] 
======================================================================
[2025-10-22T10:07:58.657Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sumaiya null
[2025-10-22T10:07:58.658Z] [LOG] ======================================================================
[2025-10-22T10:07:58.658Z] [LOG]    Gross Salary: Rs.60000.00
[2025-10-22T10:07:58.659Z] [LOG]    Total Deductions: Rs.31199.69
[2025-10-22T10:07:58.659Z] [LOG]       - Attendance Deduction: Rs.31199.69
[2025-10-22T10:07:58.660Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:07:58.660Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:07:58.661Z] [LOG]    NET SALARY: Rs.28800.31
[2025-10-22T10:07:58.662Z] [LOG] ======================================================================

[2025-10-22T10:07:58.663Z] [LOG] ✅ Sumaiya null: Calculation completed successfully
[2025-10-22T10:07:58.663Z] [LOG] 📊 Progress: 29/34 (85.3%)
[2025-10-22T10:07:58.664Z] [LOG] 
🧮 Processing: Maryam null (EMP000035)
[2025-10-22T10:07:58.665Z] [LOG] 📋 Record ID: e009714e-fa6b-4109-a785-7d4dd6c8093d
[2025-10-22T10:07:58.667Z] [LOG] 
======================================================================
[2025-10-22T10:07:58.668Z] [LOG] 🧮 CALCULATING PAYROLL: Maryam null (EMP000035)
[2025-10-22T10:07:58.669Z] [LOG] ======================================================================
[2025-10-22T10:07:59.394Z] [LOG] 🔍 Component filtering for employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-22T10:07:59.395Z] [LOG]    Total components: 10
[2025-10-22T10:07:59.395Z] [LOG]    Applicable components: 10
[2025-10-22T10:07:59.396Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-22T10:08:00.474Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:08:00.475Z] [LOG] 🔄 Processing financial records for employee 01440221-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:08:00.658Z] [LOG] 📊 Found 0 active loans for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:00.838Z] [LOG] 📊 Found 0 active advances for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:01.021Z] [LOG] 📊 Found 0 approved bonuses for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:01.022Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:08:01.023Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:08:01.024Z] [LOG] 💰 GROSS CALCULATION for Maryam null:
[2025-10-22T10:08:01.025Z] [LOG]    Base Salary: 40000
[2025-10-22T10:08:01.025Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:08:01.026Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:08:01.026Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:01.206Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:08:01.386Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:08:01.386Z] [LOG]    Employee ID: 01440221-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:01.387Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:08:01.388Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:08:01.389Z] [LOG]    Base Salary (Full Month): Rs.40000.00
[2025-10-22T10:08:01.567Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:08:01.568Z] [LOG]       Daily Salary: Rs.1600.00
[2025-10-22T10:08:01.568Z] [LOG]       Weekday Hourly Rate: Rs.188.24
[2025-10-22T10:08:01.569Z] [LOG]       Saturday Hourly Rate: Rs.355.56
[2025-10-22T10:08:01.569Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:08:01.570Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:08:01.571Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:08:02.142Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:08:02.142Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:08:02.328Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:08:02.328Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:08:02.329Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:08:02.329Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:02.509Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:08:02.510Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:08:02.511Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:08:02.512Z] [LOG]       Current Time: 15:38:02
[2025-10-22T10:08:02.513Z] [LOG]       Expected Hours (scheduled → now): 7.13h
[2025-10-22T10:08:02.513Z] [LOG]       Actual Hours (check-in → now): 7.13h
[2025-10-22T10:08:02.514Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:08:02.515Z] [LOG]       Weekday: 117.63h
[2025-10-22T10:08:02.516Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:08:02.517Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:02.517Z] [LOG]       Total Expected: 131.13h
[2025-10-22T10:08:02.518Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:08:02.519Z] [LOG]       Weekday: 24.13h (includes 7.13h live)
[2025-10-22T10:08:02.519Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:08:02.519Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:02.520Z] [LOG]       Total Actual: 28.63h
[2025-10-22T10:08:02.520Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:08:02.520Z] [LOG]       Weekday: 117.63h × Rs.188.24 = Rs.22143.43
[2025-10-22T10:08:02.521Z] [LOG]       Saturday: 13.50h × Rs.355.56 = Rs.4800.06
[2025-10-22T10:08:02.521Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:02.522Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:02.523Z] [LOG]       Total Expected Earned: Rs.26943.49
[2025-10-22T10:08:02.523Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:08:02.524Z] [LOG]       Weekday: 24.13h × Rs.188.24 = Rs.4542.99
[2025-10-22T10:08:02.524Z] [LOG]       Saturday: 4.50h × Rs.355.56 = Rs.1600.02
[2025-10-22T10:08:02.524Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:02.525Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:02.527Z] [LOG]       Total Actual Earned: Rs.6143.01
[2025-10-22T10:08:02.529Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:08:02.530Z] [LOG]       Calculated At: Oct 22, 2025, 15:38:02
[2025-10-22T10:08:02.530Z] [LOG]       Expected Earned (until NOW): Rs.26943.49
[2025-10-22T10:08:02.531Z] [LOG]       Actual Earned (until NOW): Rs.6143.01
[2025-10-22T10:08:02.531Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:02.531Z] [LOG]       Attendance Deduction: Rs.20800.48
[2025-10-22T10:08:02.532Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:08:02.532Z] [LOG]       📉 Shortfall: 102.50 hours (77.20% of expected)
[2025-10-22T10:08:02.532Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:08:02.533Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:08:02.533Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:08:02.534Z] [LOG]    Gross Salary: 40000
[2025-10-22T10:08:02.534Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:08:02.535Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:08:02.535Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:02.535Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:08:02.536Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:02.536Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:08:02.536Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:02.537Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:08:02.537Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:02.537Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:08:02.538Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:02.538Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:08:02.539Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:02.539Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:08:02.540Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:02.540Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:08:02.540Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:02.541Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:08:02.541Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:02.543Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:08:02.544Z] [LOG] Regular deductions for Maryam null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:08:02.544Z] [LOG] Combined deductions for Maryam null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 20800.480000000003,
      "details": "Shortfall: 102.50h of 131.13h expected (calculated at Oct 22, 2025, 15:38:02)"
    }
  ],
  "total": 20800.480000000003
}
[2025-10-22T10:08:02.725Z] [LOG] Creating components for record e009714e-fa6b-4109-a785-7d4dd6c8093d: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:08:02.725Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 20800.480000000003
}
[2025-10-22T10:08:02.907Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:08:03.084Z] [LOG] Created payroll_record_component: 0624b482-1660-42d7-b7de-c94060fcf1a6 for Attendance Deduction
[2025-10-22T10:08:03.439Z] [LOG] ✅ Financial balances updated successfully for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:03.440Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:08:03.440Z] [LOG] 
======================================================================
[2025-10-22T10:08:03.441Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Maryam null
[2025-10-22T10:08:03.442Z] [LOG] ======================================================================
[2025-10-22T10:08:03.442Z] [LOG]    Gross Salary: Rs.40000.00
[2025-10-22T10:08:03.443Z] [LOG]    Total Deductions: Rs.20800.48
[2025-10-22T10:08:03.443Z] [LOG]       - Attendance Deduction: Rs.20800.48
[2025-10-22T10:08:03.444Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:08:03.445Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:08:03.445Z] [LOG]    NET SALARY: Rs.19199.52
[2025-10-22T10:08:03.446Z] [LOG] ======================================================================

[2025-10-22T10:08:03.447Z] [LOG] ✅ Maryam null: Calculation completed successfully
[2025-10-22T10:08:03.447Z] [LOG] 📊 Progress: 30/34 (88.2%)
[2025-10-22T10:08:03.448Z] [LOG] 
🧮 Processing: Sithira null (EMP000039)
[2025-10-22T10:08:03.449Z] [LOG] 📋 Record ID: ea2c5008-f7cd-4537-a547-1c2383a80392
[2025-10-22T10:08:03.451Z] [LOG] 
======================================================================
[2025-10-22T10:08:03.452Z] [LOG] 🧮 CALCULATING PAYROLL: Sithira null (EMP000039)
[2025-10-22T10:08:03.453Z] [LOG] ======================================================================
[2025-10-22T10:08:04.309Z] [LOG] 🔍 Component filtering for employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-22T10:08:04.310Z] [LOG]    Total components: 10
[2025-10-22T10:08:04.310Z] [LOG]    Applicable components: 10
[2025-10-22T10:08:04.311Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-22T10:08:05.426Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:08:05.427Z] [LOG] 🔄 Processing financial records for employee 01441e19-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:08:05.663Z] [LOG] 📊 Found 0 active loans for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:05.855Z] [LOG] 📊 Found 0 active advances for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:06.424Z] [LOG] 📊 Found 0 approved bonuses for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:06.425Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:08:06.426Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:08:06.426Z] [LOG] 💰 GROSS CALCULATION for Sithira null:
[2025-10-22T10:08:06.427Z] [LOG]    Base Salary: 40000
[2025-10-22T10:08:06.427Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:08:06.428Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:08:06.429Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:06.608Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:08:06.789Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:08:06.790Z] [LOG]    Employee ID: 01441e19-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:06.790Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:08:06.791Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:08:06.791Z] [LOG]    Base Salary (Full Month): Rs.40000.00
[2025-10-22T10:08:06.973Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:08:06.974Z] [LOG]       Daily Salary: Rs.1600.00
[2025-10-22T10:08:06.974Z] [LOG]       Weekday Hourly Rate: Rs.188.24
[2025-10-22T10:08:06.975Z] [LOG]       Saturday Hourly Rate: Rs.355.56
[2025-10-22T10:08:06.975Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:08:06.976Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:08:06.977Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:08:07.530Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:08:07.530Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:08:07.713Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:08:07.714Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:08:07.714Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:08:07.715Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:07.897Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:08:07.897Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:08:07.898Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:08:07.899Z] [LOG]       Current Time: 15:38:07
[2025-10-22T10:08:07.900Z] [LOG]       Expected Hours (scheduled → now): 7.14h
[2025-10-22T10:08:07.900Z] [LOG]       Actual Hours (check-in → now): 7.14h
[2025-10-22T10:08:07.901Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:08:07.902Z] [LOG]       Weekday: 117.64h
[2025-10-22T10:08:07.902Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:08:07.903Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:07.903Z] [LOG]       Total Expected: 131.14h
[2025-10-22T10:08:07.904Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:08:07.905Z] [LOG]       Weekday: 24.14h (includes 7.14h live)
[2025-10-22T10:08:07.906Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:08:07.906Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:07.907Z] [LOG]       Total Actual: 28.64h
[2025-10-22T10:08:07.907Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:08:07.909Z] [LOG]       Weekday: 117.64h × Rs.188.24 = Rs.22143.71
[2025-10-22T10:08:07.909Z] [LOG]       Saturday: 13.50h × Rs.355.56 = Rs.4800.06
[2025-10-22T10:08:07.910Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:07.911Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:07.911Z] [LOG]       Total Expected Earned: Rs.26943.77
[2025-10-22T10:08:07.912Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:08:07.912Z] [LOG]       Weekday: 24.14h × Rs.188.24 = Rs.4543.27
[2025-10-22T10:08:07.913Z] [LOG]       Saturday: 4.50h × Rs.355.56 = Rs.1600.02
[2025-10-22T10:08:07.914Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:07.914Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:07.915Z] [LOG]       Total Actual Earned: Rs.6143.29
[2025-10-22T10:08:07.916Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:08:07.917Z] [LOG]       Calculated At: Oct 22, 2025, 15:38:07
[2025-10-22T10:08:07.917Z] [LOG]       Expected Earned (until NOW): Rs.26943.77
[2025-10-22T10:08:07.918Z] [LOG]       Actual Earned (until NOW): Rs.6143.29
[2025-10-22T10:08:07.919Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:07.919Z] [LOG]       Attendance Deduction: Rs.20800.48
[2025-10-22T10:08:07.920Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:08:07.921Z] [LOG]       📉 Shortfall: 102.50 hours (77.20% of expected)
[2025-10-22T10:08:07.921Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:08:07.922Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:08:07.923Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:08:07.926Z] [LOG]    Gross Salary: 40000
[2025-10-22T10:08:07.927Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:08:07.927Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:08:07.928Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:07.929Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:08:07.929Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:07.930Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:08:07.930Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:07.931Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:08:07.932Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:07.932Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:08:07.933Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:07.933Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:08:07.934Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:07.935Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:08:07.935Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:07.936Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:08:07.936Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:07.937Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:08:07.937Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:07.939Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:08:07.940Z] [LOG] Regular deductions for Sithira null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:08:07.941Z] [LOG] Combined deductions for Sithira null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 20800.480000000003,
      "details": "Shortfall: 102.50h of 131.14h expected (calculated at Oct 22, 2025, 15:38:07)"
    }
  ],
  "total": 20800.480000000003
}
[2025-10-22T10:08:08.132Z] [LOG] Creating components for record ea2c5008-f7cd-4537-a547-1c2383a80392: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:08:08.134Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 20800.480000000003
}
[2025-10-22T10:08:08.314Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:08:08.496Z] [LOG] Created payroll_record_component: c1d6e84e-523d-4254-ae79-7fcfd99dc364 for Attendance Deduction
[2025-10-22T10:08:08.863Z] [LOG] ✅ Financial balances updated successfully for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:08.864Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:08:08.864Z] [LOG] 
======================================================================
[2025-10-22T10:08:08.865Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sithira null
[2025-10-22T10:08:08.866Z] [LOG] ======================================================================
[2025-10-22T10:08:08.866Z] [LOG]    Gross Salary: Rs.40000.00
[2025-10-22T10:08:08.867Z] [LOG]    Total Deductions: Rs.20800.48
[2025-10-22T10:08:08.867Z] [LOG]       - Attendance Deduction: Rs.20800.48
[2025-10-22T10:08:08.868Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:08:08.869Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:08:08.869Z] [LOG]    NET SALARY: Rs.19199.52
[2025-10-22T10:08:08.870Z] [LOG] ======================================================================

[2025-10-22T10:08:08.871Z] [LOG] ✅ Sithira null: Calculation completed successfully
[2025-10-22T10:08:08.872Z] [LOG] 📊 Progress: 31/34 (91.2%)
[2025-10-22T10:08:08.872Z] [LOG] 
🧮 Processing: Chemil null (EMP000040)
[2025-10-22T10:08:08.874Z] [LOG] 📋 Record ID: f623c1c6-b69b-488a-be71-83a1a8b34a26
[2025-10-22T10:08:08.876Z] [LOG] 
======================================================================
[2025-10-22T10:08:08.877Z] [LOG] 🧮 CALCULATING PAYROLL: Chemil null (EMP000040)
[2025-10-22T10:08:08.878Z] [LOG] ======================================================================
[2025-10-22T10:08:09.666Z] [LOG] 🔍 Component filtering for employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-22T10:08:09.666Z] [LOG]    Total components: 10
[2025-10-22T10:08:09.667Z] [LOG]    Applicable components: 10
[2025-10-22T10:08:09.667Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-22T10:08:10.948Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:08:10.949Z] [LOG] 🔄 Processing financial records for employee 01442599-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:08:11.158Z] [LOG] 📊 Found 0 active loans for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:11.514Z] [LOG] 📊 Found 0 active advances for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:12.402Z] [LOG] 📊 Found 0 approved bonuses for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:12.402Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:08:12.403Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:08:12.404Z] [LOG] 💰 GROSS CALCULATION for Chemil null:
[2025-10-22T10:08:12.405Z] [LOG]    Base Salary: 250000
[2025-10-22T10:08:12.405Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:08:12.406Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:08:12.406Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:12.768Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:08:13.406Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:08:13.406Z] [LOG]    Employee ID: 01442599-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:13.407Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:08:13.407Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:08:13.408Z] [LOG]    Base Salary (Full Month): Rs.250000.00
[2025-10-22T10:08:13.734Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:08:13.735Z] [LOG]       Daily Salary: Rs.10000.00
[2025-10-22T10:08:13.736Z] [LOG]       Weekday Hourly Rate: Rs.1176.47
[2025-10-22T10:08:13.736Z] [LOG]       Saturday Hourly Rate: Rs.2222.22
[2025-10-22T10:08:13.737Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:08:13.737Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:08:13.738Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:08:15.176Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:08:15.177Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:08:16.335Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:08:16.336Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:08:16.336Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:08:16.337Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:16.523Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:08:16.523Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:08:16.524Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:08:16.525Z] [LOG]       Current Time: 15:38:16
[2025-10-22T10:08:16.526Z] [LOG]       Expected Hours (scheduled → now): 7.14h
[2025-10-22T10:08:16.526Z] [LOG]       Actual Hours (check-in → now): 7.14h
[2025-10-22T10:08:16.527Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:08:16.528Z] [LOG]       Weekday: 117.64h
[2025-10-22T10:08:16.528Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:08:16.529Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:16.530Z] [LOG]       Total Expected: 131.14h
[2025-10-22T10:08:16.530Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:08:16.531Z] [LOG]       Weekday: 24.14h (includes 7.14h live)
[2025-10-22T10:08:16.532Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:08:16.532Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:16.533Z] [LOG]       Total Actual: 28.64h
[2025-10-22T10:08:16.535Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:08:16.536Z] [LOG]       Weekday: 117.64h × Rs.1176.47 = Rs.138397.49
[2025-10-22T10:08:16.537Z] [LOG]       Saturday: 13.50h × Rs.2222.22 = Rs.29999.97
[2025-10-22T10:08:16.537Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:16.538Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:16.539Z] [LOG]       Total Expected Earned: Rs.168397.46
[2025-10-22T10:08:16.539Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:08:16.541Z] [LOG]       Weekday: 24.14h × Rs.1176.47 = Rs.28397.54
[2025-10-22T10:08:16.541Z] [LOG]       Saturday: 4.50h × Rs.2222.22 = Rs.9999.99
[2025-10-22T10:08:16.542Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:16.543Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:16.544Z] [LOG]       Total Actual Earned: Rs.38397.53
[2025-10-22T10:08:16.546Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:08:16.547Z] [LOG]       Calculated At: Oct 22, 2025, 15:38:16
[2025-10-22T10:08:16.548Z] [LOG]       Expected Earned (until NOW): Rs.168397.46
[2025-10-22T10:08:16.548Z] [LOG]       Actual Earned (until NOW): Rs.38397.53
[2025-10-22T10:08:16.549Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:16.549Z] [LOG]       Attendance Deduction: Rs.129999.93
[2025-10-22T10:08:16.550Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:08:16.551Z] [LOG]       📉 Shortfall: 102.50 hours (77.20% of expected)
[2025-10-22T10:08:16.551Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:08:16.552Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:08:16.553Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:08:16.553Z] [LOG]    Gross Salary: 250000
[2025-10-22T10:08:16.554Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:08:16.555Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:08:16.555Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:16.556Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:08:16.557Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:16.557Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:08:16.558Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:16.558Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:08:16.559Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:16.560Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:08:16.560Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:16.560Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:08:16.561Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:16.561Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:08:16.561Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:16.562Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:08:16.562Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:16.562Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:08:16.563Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:16.563Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:08:16.563Z] [LOG] Regular deductions for Chemil null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:08:16.564Z] [LOG] Combined deductions for Chemil null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 129999.925,
      "details": "Shortfall: 102.50h of 131.14h expected (calculated at Oct 22, 2025, 15:38:16)"
    }
  ],
  "total": 129999.925
}
[2025-10-22T10:08:17.249Z] [LOG] Creating components for record f623c1c6-b69b-488a-be71-83a1a8b34a26: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:08:17.250Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 129999.925
}
[2025-10-22T10:08:17.949Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:08:18.139Z] [LOG] Created payroll_record_component: 6c3b25a0-aee2-4323-a429-1c599054d96a for Attendance Deduction
[2025-10-22T10:08:18.506Z] [LOG] ✅ Financial balances updated successfully for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:18.507Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:08:18.507Z] [LOG] 
======================================================================
[2025-10-22T10:08:18.507Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Chemil null
[2025-10-22T10:08:18.508Z] [LOG] ======================================================================
[2025-10-22T10:08:18.508Z] [LOG]    Gross Salary: Rs.250000.00
[2025-10-22T10:08:18.508Z] [LOG]    Total Deductions: Rs.129999.93
[2025-10-22T10:08:18.509Z] [LOG]       - Attendance Deduction: Rs.129999.93
[2025-10-22T10:08:18.509Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:08:18.509Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:08:18.510Z] [LOG]    NET SALARY: Rs.120000.07
[2025-10-22T10:08:18.510Z] [LOG] ======================================================================

[2025-10-22T10:08:18.510Z] [LOG] ✅ Chemil null: Calculation completed successfully
[2025-10-22T10:08:18.511Z] [LOG] 📊 Progress: 32/34 (94.1%)
[2025-10-22T10:08:18.511Z] [LOG] 
🧮 Processing: Ruvindu Hewabandu null (EMP000027)
[2025-10-22T10:08:18.511Z] [LOG] 📋 Record ID: fce4a011-1f22-436d-be02-f5a18d5f2831
[2025-10-22T10:08:18.511Z] [LOG] 
======================================================================
[2025-10-22T10:08:18.512Z] [LOG] 🧮 CALCULATING PAYROLL: Ruvindu Hewabandu null (EMP000027)
[2025-10-22T10:08:18.512Z] [LOG] ======================================================================
[2025-10-22T10:08:19.395Z] [LOG] 🔍 Component filtering for employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-22T10:08:19.396Z] [LOG]    Total components: 10
[2025-10-22T10:08:19.396Z] [LOG]    Applicable components: 10
[2025-10-22T10:08:19.397Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-22T10:08:21.314Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:08:21.315Z] [LOG] 🔄 Processing financial records for employee 0143e915-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:08:21.497Z] [LOG] 📊 Found 0 active loans for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:21.686Z] [LOG] 📊 Found 0 active advances for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:21.876Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:21.877Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:08:21.878Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:08:21.879Z] [LOG] 💰 GROSS CALCULATION for Ruvindu Hewabandu null:
[2025-10-22T10:08:21.880Z] [LOG]    Base Salary: 0
[2025-10-22T10:08:21.880Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:08:21.881Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:08:21.881Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:22.092Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:08:22.282Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:08:22.286Z] [LOG]    Employee ID: 0143e915-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:22.286Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:08:22.287Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:08:22.287Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-22T10:08:22.470Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:08:22.471Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-22T10:08:22.471Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-22T10:08:22.472Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-22T10:08:22.472Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:08:22.472Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:08:22.473Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:08:23.073Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:08:23.074Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:08:23.377Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:08:23.377Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:08:23.378Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:08:23.379Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:23.568Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:08:23.569Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:08:23.569Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:08:23.570Z] [LOG]       Current Time: 15:38:23
[2025-10-22T10:08:23.571Z] [LOG]       Expected Hours (scheduled → now): 7.14h
[2025-10-22T10:08:23.572Z] [LOG]       Actual Hours (check-in → now): 7.14h
[2025-10-22T10:08:23.572Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:08:23.573Z] [LOG]       Weekday: 117.64h
[2025-10-22T10:08:23.574Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:08:23.574Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:23.575Z] [LOG]       Total Expected: 131.14h
[2025-10-22T10:08:23.575Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:08:23.576Z] [LOG]       Weekday: 24.14h (includes 7.14h live)
[2025-10-22T10:08:23.577Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:08:23.577Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:23.578Z] [LOG]       Total Actual: 28.64h
[2025-10-22T10:08:23.579Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:08:23.580Z] [LOG]       Weekday: 117.64h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:23.580Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:23.582Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:23.583Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:23.584Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-22T10:08:23.584Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:08:23.585Z] [LOG]       Weekday: 24.14h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:23.585Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:23.586Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:23.587Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:23.587Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-22T10:08:23.589Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:08:23.590Z] [LOG]       Calculated At: Oct 22, 2025, 15:38:23
[2025-10-22T10:08:23.590Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-22T10:08:23.591Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-22T10:08:23.591Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:23.594Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-22T10:08:23.595Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:08:23.596Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-22T10:08:23.597Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:08:23.597Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:08:23.598Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:08:23.599Z] [LOG]    Gross Salary: 0
[2025-10-22T10:08:23.599Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:08:23.600Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:08:23.601Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:23.601Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:08:23.602Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:23.602Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:08:23.603Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:23.603Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:08:23.604Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:23.605Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:08:23.606Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:23.606Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:08:23.607Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:23.608Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:08:23.608Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:23.609Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:08:23.610Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:23.610Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:08:23.610Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:23.611Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:08:23.611Z] [LOG] Regular deductions for Ruvindu Hewabandu null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:08:23.612Z] [LOG] Combined deductions for Ruvindu Hewabandu null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 0,
      "details": "Shortfall: 102.50h of 131.14h expected (calculated at Oct 22, 2025, 15:38:23)"
    }
  ],
  "total": 0
}
[2025-10-22T10:08:23.853Z] [LOG] Creating components for record fce4a011-1f22-436d-be02-f5a18d5f2831: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:08:23.855Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 0
}
[2025-10-22T10:08:24.049Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:08:24.593Z] [LOG] Created payroll_record_component: d219b40a-e1de-40f3-9644-a64187dd4c98 for Attendance Deduction
[2025-10-22T10:08:26.258Z] [LOG] ✅ Financial balances updated successfully for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:26.259Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:08:26.259Z] [LOG] 
======================================================================
[2025-10-22T10:08:26.260Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ruvindu Hewabandu null
[2025-10-22T10:08:26.261Z] [LOG] ======================================================================
[2025-10-22T10:08:26.261Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-22T10:08:26.262Z] [LOG]    Total Deductions: Rs.0.00
[2025-10-22T10:08:26.262Z] [LOG]       - Attendance Deduction: Rs.0.00
[2025-10-22T10:08:26.263Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:08:26.264Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:08:26.264Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-22T10:08:26.265Z] [LOG] ======================================================================

[2025-10-22T10:08:26.266Z] [LOG] ✅ Ruvindu Hewabandu null: Calculation completed successfully
[2025-10-22T10:08:26.266Z] [LOG] 📊 Progress: 33/34 (97.1%)
[2025-10-22T10:08:26.267Z] [LOG] 
🧮 Processing: Rasanga null (EMP000028)
[2025-10-22T10:08:26.268Z] [LOG] 📋 Record ID: fe57aae3-5bae-4d91-8461-e6b4148a77a0
[2025-10-22T10:08:26.269Z] [LOG] 
======================================================================
[2025-10-22T10:08:26.270Z] [LOG] 🧮 CALCULATING PAYROLL: Rasanga null (EMP000028)
[2025-10-22T10:08:26.272Z] [LOG] ======================================================================
[2025-10-22T10:08:27.059Z] [LOG] 🔍 Component filtering for employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-22T10:08:27.060Z] [LOG]    Total components: 10
[2025-10-22T10:08:27.060Z] [LOG]    Applicable components: 10
[2025-10-22T10:08:27.061Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-22T10:08:28.260Z] [LOG] 
🔄 Processing financial records...
[2025-10-22T10:08:28.261Z] [LOG] 🔄 Processing financial records for employee 0143eaec-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-22T10:08:28.474Z] [LOG] 📊 Found 0 active loans for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:28.657Z] [LOG] 📊 Found 0 active advances for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:28.868Z] [LOG] 📊 Found 0 approved bonuses for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:28.868Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-22T10:08:28.870Z] [LOG] 
💰 Calculating gross salary components...
[2025-10-22T10:08:28.870Z] [LOG] 💰 GROSS CALCULATION for Rasanga null:
[2025-10-22T10:08:28.871Z] [LOG]    Base Salary: 50000
[2025-10-22T10:08:28.871Z] [LOG]    📋 Processing 1 configured earning components
[2025-10-22T10:08:28.872Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-22T10:08:28.873Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:29.350Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-22T10:08:29.532Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-22T10:08:29.533Z] [LOG]    Employee ID: 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:29.533Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-22T10:08:29.534Z] [LOG]    📅 Calculation Until: 2025-10-21 (PARTIAL - Until Today)
[2025-10-22T10:08:29.535Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-22T10:08:29.890Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-22T10:08:29.891Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-22T10:08:29.892Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-22T10:08:29.892Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-22T10:08:29.893Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-22T10:08:29.893Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-22T10:08:29.894Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-22T10:08:30.433Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-22T10:08:30.434Z] [LOG]       Weekdays: 13, Saturdays: 3, Sundays: 0
[2025-10-22T10:08:30.616Z] [LOG] 
   ⏰ Completed Hours (Until Yesterday):
[2025-10-22T10:08:30.617Z] [LOG]       Weekday: 17.00h
[2025-10-22T10:08:30.617Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:08:30.618Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:30.801Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-22T10:08:30.802Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-22T10:08:30.802Z] [LOG]       Check-in Time: 08:30:00
[2025-10-22T10:08:30.803Z] [LOG]       Current Time: 15:38:30
[2025-10-22T10:08:30.804Z] [LOG]       Expected Hours (scheduled → now): 7.14h
[2025-10-22T10:08:30.805Z] [LOG]       Actual Hours (check-in → now): 7.14h
[2025-10-22T10:08:30.805Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-22T10:08:30.806Z] [LOG]       Weekday: 117.64h
[2025-10-22T10:08:30.806Z] [LOG]       Saturday: 13.50h
[2025-10-22T10:08:30.807Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:30.808Z] [LOG]       Total Expected: 131.14h
[2025-10-22T10:08:30.809Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-22T10:08:30.810Z] [LOG]       Weekday: 24.14h (includes 7.14h live)
[2025-10-22T10:08:30.810Z] [LOG]       Saturday: 4.50h
[2025-10-22T10:08:30.811Z] [LOG]       Sunday: 0.00h
[2025-10-22T10:08:30.811Z] [LOG]       Total Actual: 28.64h
[2025-10-22T10:08:30.812Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-22T10:08:30.813Z] [LOG]       Weekday: 117.64h × Rs.235.29 = Rs.27679.96
[2025-10-22T10:08:30.814Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-22T10:08:30.815Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:30.815Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:30.816Z] [LOG]       Total Expected Earned: Rs.33679.90
[2025-10-22T10:08:30.816Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-22T10:08:30.817Z] [LOG]       Weekday: 24.14h × Rs.235.29 = Rs.5680.35
[2025-10-22T10:08:30.818Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-22T10:08:30.819Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-22T10:08:30.819Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:30.820Z] [LOG]       Total Actual Earned: Rs.7680.33
[2025-10-22T10:08:30.821Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-22T10:08:30.822Z] [LOG]       Calculated At: Oct 22, 2025, 15:38:30
[2025-10-22T10:08:30.823Z] [LOG]       Expected Earned (until NOW): Rs.33679.90
[2025-10-22T10:08:30.823Z] [LOG]       Actual Earned (until NOW): Rs.7680.33
[2025-10-22T10:08:30.824Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-22T10:08:30.824Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-22T10:08:30.825Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-22T10:08:30.826Z] [LOG]       📉 Shortfall: 102.50 hours (77.20% of expected)
[2025-10-22T10:08:30.826Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-22T10:08:30.827Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-22T10:08:30.827Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-22T10:08:30.827Z] [LOG]    Gross Salary: 50000
[2025-10-22T10:08:30.828Z] [LOG]    📋 Processing 9 configured deduction components
[2025-10-22T10:08:30.828Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-22T10:08:30.828Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:30.829Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-22T10:08:30.829Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:30.830Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-22T10:08:30.830Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:30.830Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-22T10:08:30.831Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:30.831Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-22T10:08:30.831Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:30.832Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-22T10:08:30.832Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:30.832Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-22T10:08:30.833Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:30.833Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-22T10:08:30.833Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:30.834Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-22T10:08:30.834Z] [LOG]    Fixed amount: 0
[2025-10-22T10:08:30.834Z] [LOG]    📊 Total Deductions: 0
[2025-10-22T10:08:30.834Z] [LOG] Regular deductions for Rasanga null: {
  "components": [],
  "total": 0
}
[2025-10-22T10:08:30.835Z] [LOG] Combined deductions for Rasanga null: {
  "components": [
    {
      "code": "ATTENDANCE_DED",
      "name": "Attendance Deduction",
      "type": "deduction",
      "category": "attendance",
      "amount": 25999.575,
      "details": "Shortfall: 102.50h of 131.14h expected (calculated at Oct 22, 2025, 15:38:30)"
    }
  ],
  "total": 25999.575
}
[2025-10-22T10:08:31.034Z] [LOG] Creating components for record fe57aae3-5bae-4d91-8461-e6b4148a77a0: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-22T10:08:31.036Z] [LOG] Processing component: {
  "name": "Attendance Deduction",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-22T10:08:31.228Z] [LOG] Using existing component ID: 1a4950fc-0ef8-4b7c-bf9f-25ccfe2ae02f
[2025-10-22T10:08:31.419Z] [LOG] Created payroll_record_component: 5e6c3677-8813-403f-b0eb-8344eb4d65fa for Attendance Deduction
[2025-10-22T10:08:31.788Z] [LOG] ✅ Financial balances updated successfully for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-22T10:08:31.789Z] [LOG] ✅ Financial balances updated successfully
[2025-10-22T10:08:31.789Z] [LOG] 
======================================================================
[2025-10-22T10:08:31.790Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Rasanga null
[2025-10-22T10:08:31.791Z] [LOG] ======================================================================
[2025-10-22T10:08:31.791Z] [LOG]    Gross Salary: Rs.50000.00
[2025-10-22T10:08:31.792Z] [LOG]    Total Deductions: Rs.25999.58
[2025-10-22T10:08:31.792Z] [LOG]       - Attendance Deduction: Rs.25999.58
[2025-10-22T10:08:31.793Z] [LOG]       - Other Deductions: Rs.0.00
[2025-10-22T10:08:31.794Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-22T10:08:31.794Z] [LOG]    NET SALARY: Rs.24000.42
[2025-10-22T10:08:31.795Z] [LOG] ======================================================================

[2025-10-22T10:08:31.796Z] [LOG] ✅ Rasanga null: Calculation completed successfully
[2025-10-22T10:08:31.796Z] [LOG] 📊 Progress: 34/34 (100.0%)
[2025-10-22T10:08:31.798Z] [LOG] 
============================================================
[2025-10-22T10:08:31.798Z] [LOG] 📈 Processing Summary: 34 successful, 0 failed
[2025-10-22T10:08:34.811Z] [LOG] 🎉 Payroll calculation completed successfully!
[2025-10-22T10:08:34.812Z] [LOG] 📊 Final Summary: 34 processed, 0 errors
[2025-10-22T10:08:34.813Z] [INFO] ================================================================================
[2025-10-22T10:08:34.813Z] [INFO] ⏰ Completed at: 2025-10-22T10:08:34.813Z
[2025-10-22T10:08:34.813Z] [INFO] 📊 Total log entries: 4096