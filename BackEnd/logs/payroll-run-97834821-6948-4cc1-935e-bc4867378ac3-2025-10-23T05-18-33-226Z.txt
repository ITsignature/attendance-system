[2025-10-23T05:18:33.227Z] [INFO] 🚀 Payroll calculation logging started for run: 97834821-6948-4cc1-935e-bc4867378ac3
[2025-10-23T05:18:33.227Z] [INFO] 📁 Log file: E:\smart_attendance_system\BackEnd\logs\payroll-run-97834821-6948-4cc1-935e-bc4867378ac3-2025-10-23T05-18-33-226Z.txt
[2025-10-23T05:18:33.227Z] [INFO] ⏰ Started at: 2025-10-23T05:18:33.227Z
[2025-10-23T05:18:33.227Z] [INFO] ================================================================================
[2025-10-23T05:18:33.227Z] [LOG] 🚀 Starting payroll calculation for run: 97834821-6948-4cc1-935e-bc4867378ac3
[2025-10-23T05:18:33.227Z] [LOG] 👤 Client ID: it-signature, User ID: 059304ea-24a5-4d78-a290-cf09b9e53c4c
[2025-10-23T05:18:33.887Z] [LOG] ✅ Payroll run verified: October (MONTHLY_2025_10_REGULAR)
[2025-10-23T05:18:34.442Z] [LOG] 📊 Status updated to 'calculating'
[2025-10-23T05:18:35.499Z] [LOG] 👥 Processing 34 employee records:
[2025-10-23T05:18:35.500Z] [LOG] ============================================================
[2025-10-23T05:18:35.500Z] [LOG] 
🧮 Processing: Piyumi null (EMP000025)
[2025-10-23T05:18:35.501Z] [LOG] 📋 Record ID: 00f17bdd-8f3c-46eb-a0a7-f887e7ac86ac
[2025-10-23T05:18:35.502Z] [LOG] 
======================================================================
[2025-10-23T05:18:35.503Z] [LOG] 🧮 CALCULATING PAYROLL: Piyumi null (EMP000025)
[2025-10-23T05:18:35.503Z] [LOG] ======================================================================
[2025-10-23T05:18:39.074Z] [LOG] 🔍 Component filtering for employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-23T05:18:39.074Z] [LOG]    Total components: 13
[2025-10-23T05:18:39.075Z] [LOG]    Applicable components: 13
[2025-10-23T05:18:39.075Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:18:43.247Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:18:43.247Z] [LOG] 🔄 Processing financial records for employee 0143e565-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:18:44.492Z] [LOG] 📊 Found 0 active loans for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T05:18:45.467Z] [LOG] 📊 Found 0 active advances for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T05:18:46.217Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T05:18:46.218Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:18:46.219Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:18:47.479Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:18:47.479Z] [LOG]    Employee ID: 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T05:18:47.480Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:18:47.480Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:18:47.480Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:18:48.126Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:18:48.126Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:18:48.127Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:18:48.127Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:18:48.128Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:18:48.128Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:18:48.128Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:18:49.952Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:18:49.953Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:18:50.642Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:18:50.642Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:18:50.643Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:18:50.643Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:18:50.644Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:18:50.644Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:18:50.644Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:18:50.645Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:18:51.177Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:18:51.177Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:18:51.178Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:18:51.178Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:18:52.016Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:18:52.016Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:18:52.017Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:18:52.018Z] [LOG]       Current Time: 10:48:52
[2025-10-23T05:18:52.018Z] [LOG]       Expected Hours (scheduled → now): 2.31h
[2025-10-23T05:18:52.019Z] [LOG]       Actual Hours (check-in → now): 2.31h
[2025-10-23T05:18:52.019Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:18:52.020Z] [LOG]       Weekday: 121.31h
[2025-10-23T05:18:52.020Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:18:52.020Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:18:52.021Z] [LOG]       Total Expected: 134.81h
[2025-10-23T05:18:52.021Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:18:52.021Z] [LOG]       Weekday: 27.81h (includes 2.31h live)
[2025-10-23T05:18:52.022Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:18:52.023Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:18:52.023Z] [LOG]       Total Actual: 32.31h
[2025-10-23T05:18:52.024Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:18:52.024Z] [LOG]       Weekday: 121.31h × Rs.235.29 = Rs.28544.08
[2025-10-23T05:18:52.025Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:18:52.025Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:18:52.025Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:18:52.026Z] [LOG]       Total Expected Earned: Rs.34544.02
[2025-10-23T05:18:52.026Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:18:52.027Z] [LOG]       Weekday: 27.81h × Rs.235.29 = Rs.6544.46
[2025-10-23T05:18:52.027Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:18:52.027Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:18:52.028Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:18:52.028Z] [LOG]       Total Actual Earned: Rs.8544.44
[2025-10-23T05:18:52.029Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:18:52.030Z] [LOG]       Calculated At: Oct 23, 2025, 10:48:52
[2025-10-23T05:18:52.030Z] [LOG]       Expected Earned (until NOW): Rs.34544.02
[2025-10-23T05:18:52.031Z] [LOG]       Actual Earned (until NOW): Rs.8544.44
[2025-10-23T05:18:52.031Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:18:52.032Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:18:52.033Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:18:52.033Z] [LOG]       📉 Shortfall: 102.50 hours (75.27% of expected)
[2025-10-23T05:18:52.034Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:18:52.034Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:18:52.034Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:18:52.035Z] [LOG]    Actual Earned Base: Rs.8544.44
[2025-10-23T05:18:52.035Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:18:52.035Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:18:52.036Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:18:52.036Z] [LOG]    Gross Salary: 8544.441679066667
[2025-10-23T05:18:52.037Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:18:52.038Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:18:52.038Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.038Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:18:52.039Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.039Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:18:52.039Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.040Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:18:52.040Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.040Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:18:52.040Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.040Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:18:52.040Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.041Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:18:52.041Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.041Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:18:52.041Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.042Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:18:52.042Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.042Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:18:52.043Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.043Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:18:52.043Z] [LOG]    EPF/ETF calculated on: Rs.8544.44
[2025-10-23T05:18:52.043Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:18:52.044Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:18:52.045Z] [LOG] 💰 GROSS CALCULATION for Piyumi null:
[2025-10-23T05:18:52.046Z] [LOG]    Base Salary: 50000
[2025-10-23T05:18:52.046Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:18:52.047Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:18:52.047Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.048Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:18:52.048Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.048Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:18:52.049Z] [LOG]    Fixed amount: 0
[2025-10-23T05:18:52.509Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:18:52.509Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:18:52.510Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:18:52.510Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:18:52.510Z] [LOG]    Actual Earned Base: Rs.8544.44
[2025-10-23T05:18:52.511Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:18:52.511Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:18:52.511Z] [LOG]    = Gross Salary: Rs.8544.44
[2025-10-23T05:18:52.512Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:18:52.512Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:18:52.512Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:18:52.513Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:18:52.513Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:18:52.513Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:18:52.513Z] [LOG]    Gross Salary: Rs.8544.44
[2025-10-23T05:18:52.514Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:18:52.514Z] [LOG]    = NET SALARY: Rs.8544.44
[2025-10-23T05:18:52.514Z] [LOG] 
💾 Database Update:
[2025-10-23T05:18:52.515Z] [LOG]    Total Earnings: Rs.8544.44 (Base: 8544.44 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:18:52.515Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:18:53.382Z] [LOG] 
📝 Components to save:
[2025-10-23T05:18:53.383Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:18:53.383Z] [LOG]    Deduction components: 1
[2025-10-23T05:18:53.384Z] [LOG] Creating components for record 00f17bdd-8f3c-46eb-a0a7-f887e7ac86ac: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:18:53.385Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8544.441679066667
}
[2025-10-23T05:18:53.789Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:18:54.267Z] [LOG] Created payroll_record_component: 0e7e367b-5b5b-4b57-b4b0-1886b2c77db6 for Base Salary
[2025-10-23T05:18:54.268Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T05:18:54.507Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:18:54.749Z] [LOG] Created payroll_record_component: 2e7b9590-9bd4-45ca-b12b-ac6c9df3b91a for Attendance Shortfall (Info)
[2025-10-23T05:18:55.548Z] [LOG] ✅ Financial balances updated successfully for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T05:18:55.549Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:18:55.549Z] [LOG] 
======================================================================
[2025-10-23T05:18:55.550Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Piyumi null
[2025-10-23T05:18:55.550Z] [LOG] ======================================================================
[2025-10-23T05:18:55.550Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:18:55.551Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8544.44
[2025-10-23T05:18:55.551Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:18:55.551Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:18:55.552Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:18:55.552Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:18:55.553Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:18:55.553Z] [LOG]    GROSS SALARY: Rs.8544.44
[2025-10-23T05:18:55.553Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:18:55.554Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:18:55.554Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:18:55.555Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:18:55.555Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:18:55.555Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:18:55.556Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:18:55.557Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:18:55.557Z] [LOG]    NET SALARY: Rs.8544.44
[2025-10-23T05:18:55.558Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:18:55.558Z] [LOG] ======================================================================

[2025-10-23T05:18:55.558Z] [LOG] ✅ Piyumi null: Calculation completed successfully
[2025-10-23T05:18:55.559Z] [LOG] 📊 Progress: 1/34 (2.9%)
[2025-10-23T05:18:55.559Z] [LOG] 
🧮 Processing: Saruban null (EMP000007)
[2025-10-23T05:18:55.560Z] [LOG] 📋 Record ID: 053bb50b-4aed-4d40-902f-186f4890af87
[2025-10-23T05:18:55.560Z] [LOG] 
======================================================================
[2025-10-23T05:18:55.560Z] [LOG] 🧮 CALCULATING PAYROLL: Saruban null (EMP000007)
[2025-10-23T05:18:55.561Z] [LOG] ======================================================================
[2025-10-23T05:18:56.484Z] [LOG] 🔍 Component filtering for employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-23T05:18:56.485Z] [LOG]    Total components: 13
[2025-10-23T05:18:56.485Z] [LOG]    Applicable components: 13
[2025-10-23T05:18:56.486Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:18:58.190Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:18:58.191Z] [LOG] 🔄 Processing financial records for employee 0143a6e3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:18:58.458Z] [LOG] 📊 Found 0 active loans for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T05:18:58.676Z] [LOG] 📊 Found 0 active advances for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T05:18:58.972Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T05:18:58.972Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:18:58.973Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:18:59.266Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:18:59.266Z] [LOG]    Employee ID: 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T05:18:59.267Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:18:59.267Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:18:59.267Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-23T05:18:59.550Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:18:59.550Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-23T05:18:59.551Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T05:18:59.551Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-23T05:18:59.551Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:18:59.552Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:18:59.552Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:19:00.394Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:19:00.395Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:19:00.608Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:19:00.609Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:19:00.609Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:19:00.609Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:19:00.610Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:19:00.610Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:19:00.610Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:19:00.611Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:19:00.804Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:19:00.805Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:19:00.805Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:19:00.805Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:19:01.082Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:19:01.083Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:19:01.083Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:19:01.084Z] [LOG]       Current Time: 10:49:01
[2025-10-23T05:19:01.085Z] [LOG]       Expected Hours (scheduled → now): 2.32h
[2025-10-23T05:19:01.085Z] [LOG]       Actual Hours (check-in → now): 2.32h
[2025-10-23T05:19:01.086Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:19:01.086Z] [LOG]       Weekday: 121.32h
[2025-10-23T05:19:01.086Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:19:01.087Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:01.087Z] [LOG]       Total Expected: 134.82h
[2025-10-23T05:19:01.087Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:19:01.088Z] [LOG]       Weekday: 27.82h (includes 2.32h live)
[2025-10-23T05:19:01.088Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:19:01.089Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:01.089Z] [LOG]       Total Actual: 32.32h
[2025-10-23T05:19:01.090Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:19:01.091Z] [LOG]       Weekday: 121.32h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:01.091Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:01.092Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:01.092Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:01.092Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-23T05:19:01.093Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:19:01.093Z] [LOG]       Weekday: 27.82h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:01.094Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:01.094Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:01.094Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:01.094Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-23T05:19:01.095Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:19:01.096Z] [LOG]       Calculated At: Oct 23, 2025, 10:49:01
[2025-10-23T05:19:01.096Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-23T05:19:01.097Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-23T05:19:01.097Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:01.097Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-23T05:19:01.098Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:19:01.098Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-23T05:19:01.099Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:19:01.099Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:19:01.100Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T05:19:01.101Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:19:01.101Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:19:01.101Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:19:01.101Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:19:01.102Z] [LOG]    Gross Salary: 0
[2025-10-23T05:19:01.102Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:19:01.102Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:19:01.103Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.103Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:19:01.103Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.103Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:19:01.104Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.104Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:19:01.104Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.105Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:19:01.105Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.106Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:19:01.106Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.106Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:19:01.107Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.107Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:19:01.107Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.107Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:19:01.107Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.108Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:19:01.108Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.108Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:19:01.108Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-23T05:19:01.108Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:19:01.109Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:19:01.109Z] [LOG] 💰 GROSS CALCULATION for Saruban null:
[2025-10-23T05:19:01.109Z] [LOG]    Base Salary: 0
[2025-10-23T05:19:01.109Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:19:01.110Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:19:01.110Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.111Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:19:01.111Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.112Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:19:01.112Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:01.324Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:19:01.324Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:01.325Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:19:01.325Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:19:01.326Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:19:01.326Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:19:01.326Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:19:01.327Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-23T05:19:01.327Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:19:01.328Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:19:01.328Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:01.328Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:19:01.329Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:19:01.329Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-23T05:19:01.330Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:19:01.330Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-23T05:19:01.330Z] [LOG] 
💾 Database Update:
[2025-10-23T05:19:01.331Z] [LOG]    Total Earnings: Rs.0.00 (Base: 0.00 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:19:01.331Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:19:01.628Z] [LOG] 
📝 Components to save:
[2025-10-23T05:19:01.628Z] [LOG]    Gross/Earnings components: 0
[2025-10-23T05:19:01.629Z] [LOG]    Deduction components: 0
[2025-10-23T05:19:01.629Z] [LOG] Creating components for record 053bb50b-4aed-4d40-902f-186f4890af87: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-23T05:19:02.115Z] [LOG] ✅ Financial balances updated successfully for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:02.115Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:19:02.116Z] [LOG] 
======================================================================
[2025-10-23T05:19:02.116Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Saruban null
[2025-10-23T05:19:02.116Z] [LOG] ======================================================================
[2025-10-23T05:19:02.117Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T05:19:02.117Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-23T05:19:02.117Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:19:02.118Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:02.118Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:02.119Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:19:02.119Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:02.119Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-23T05:19:02.120Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:02.120Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:19:02.120Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:19:02.121Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:19:02.121Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:19:02.122Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-23T05:19:02.123Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:02.123Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:02.124Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-23T05:19:02.124Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:19:02.124Z] [LOG] ======================================================================

[2025-10-23T05:19:02.125Z] [LOG] ✅ Saruban null: Calculation completed successfully
[2025-10-23T05:19:02.125Z] [LOG] 📊 Progress: 2/34 (5.9%)
[2025-10-23T05:19:02.125Z] [LOG] 
🧮 Processing: Kaushal Thambi (EMP465256103)
[2025-10-23T05:19:02.126Z] [LOG] 📋 Record ID: 0676f58c-1d4d-4790-b61f-bd8ad5c08855
[2025-10-23T05:19:02.126Z] [LOG] 
======================================================================
[2025-10-23T05:19:02.127Z] [LOG] 🧮 CALCULATING PAYROLL: Kaushal Thambi (EMP465256103)
[2025-10-23T05:19:02.127Z] [LOG] ======================================================================
[2025-10-23T05:19:03.071Z] [LOG] 🔍 Component filtering for employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-23T05:19:03.072Z] [LOG]    Total components: 13
[2025-10-23T05:19:03.072Z] [LOG]    Applicable components: 13
[2025-10-23T05:19:03.072Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T05:19:04.648Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:19:04.648Z] [LOG] 🔄 Processing financial records for employee 9e8125c4-ce58-411a-b617-9f75d481c613 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:19:04.953Z] [LOG] 📊 Found 0 active loans for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T05:19:05.483Z] [LOG] 📊 Found 0 active advances for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T05:19:05.840Z] [LOG] 📊 Found 0 approved bonuses for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T05:19:05.840Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:19:05.840Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:19:06.203Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:19:06.204Z] [LOG]    Employee ID: 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T05:19:06.204Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:19:06.204Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:19:06.205Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:19:06.535Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:19:06.535Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:19:06.536Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:19:06.536Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:19:06.536Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:19:06.537Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:19:06.537Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:19:07.762Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:19:07.762Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:19:08.067Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:19:08.068Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:19:08.068Z] [LOG]       Total completed sessions found: 2
[2025-10-23T05:19:08.069Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:19:08.069Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:19:08.069Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:19:08.390Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:19:08.391Z] [LOG]          Weekday: 8.50h
[2025-10-23T05:19:08.391Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:19:08.392Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:19:08.742Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:19:08.742Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:19:08.742Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:19:08.743Z] [LOG]       Current Time: 10:49:08
[2025-10-23T05:19:08.744Z] [LOG]       Expected Hours (scheduled → now): 2.32h
[2025-10-23T05:19:08.744Z] [LOG]       Actual Hours (check-in → now): 2.32h
[2025-10-23T05:19:08.744Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:19:08.745Z] [LOG]       Weekday: 121.32h
[2025-10-23T05:19:08.745Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:19:08.746Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:08.746Z] [LOG]       Total Expected: 134.82h
[2025-10-23T05:19:08.746Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:19:08.747Z] [LOG]       Weekday: 10.82h (includes 2.32h live)
[2025-10-23T05:19:08.747Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:19:08.747Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:08.748Z] [LOG]       Total Actual: 15.32h
[2025-10-23T05:19:08.748Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:19:08.748Z] [LOG]       Weekday: 121.32h × Rs.235.29 = Rs.28545.17
[2025-10-23T05:19:08.749Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:19:08.749Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:08.749Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:08.750Z] [LOG]       Total Expected Earned: Rs.34545.11
[2025-10-23T05:19:08.750Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:19:08.751Z] [LOG]       Weekday: 10.82h × Rs.235.29 = Rs.2545.62
[2025-10-23T05:19:08.751Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:19:08.751Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:08.752Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:08.752Z] [LOG]       Total Actual Earned: Rs.4545.60
[2025-10-23T05:19:08.753Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:19:08.753Z] [LOG]       Calculated At: Oct 23, 2025, 10:49:08
[2025-10-23T05:19:08.754Z] [LOG]       Expected Earned (until NOW): Rs.34545.11
[2025-10-23T05:19:08.754Z] [LOG]       Actual Earned (until NOW): Rs.4545.60
[2025-10-23T05:19:08.754Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:08.755Z] [LOG]       Attendance Deduction: Rs.29999.51
[2025-10-23T05:19:08.755Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:19:08.756Z] [LOG]       📉 Shortfall: 119.50 hours (86.84% of expected)
[2025-10-23T05:19:08.757Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:19:08.758Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:19:08.759Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:19:08.759Z] [LOG]    Actual Earned Base: Rs.4545.60
[2025-10-23T05:19:08.759Z] [LOG]    Attendance Shortfall: Rs.29999.51
[2025-10-23T05:19:08.759Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:19:08.760Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:19:08.760Z] [LOG]    Gross Salary: 4545.604797191667
[2025-10-23T05:19:08.761Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:19:08.761Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:19:08.761Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.762Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:19:08.762Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.762Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:19:08.763Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.763Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:19:08.763Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.764Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:19:08.764Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.765Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:19:08.765Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.766Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:19:08.766Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.767Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:19:08.767Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.767Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:19:08.768Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.768Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:19:08.768Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.769Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:19:08.769Z] [LOG]    EPF/ETF calculated on: Rs.4545.60
[2025-10-23T05:19:08.769Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:19:08.770Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:19:08.770Z] [LOG] 💰 GROSS CALCULATION for Kaushal Thambi:
[2025-10-23T05:19:08.770Z] [LOG]    Base Salary: 50000
[2025-10-23T05:19:08.771Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:19:08.771Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:19:08.771Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.772Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:19:08.772Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:08.772Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:19:08.773Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:09.311Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:19:09.312Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:09.312Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:19:09.313Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:19:09.313Z] [LOG]    Actual Earned Base: Rs.4545.60
[2025-10-23T05:19:09.313Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:19:09.314Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:19:09.314Z] [LOG]    = Gross Salary: Rs.4545.60
[2025-10-23T05:19:09.314Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:19:09.315Z] [LOG]    Attendance Shortfall (Info): Rs.29999.51
[2025-10-23T05:19:09.315Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:19:09.315Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:09.316Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:19:09.316Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:19:09.317Z] [LOG]    Gross Salary: Rs.4545.60
[2025-10-23T05:19:09.317Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:19:09.317Z] [LOG]    = NET SALARY: Rs.4545.60
[2025-10-23T05:19:09.318Z] [LOG] 
💾 Database Update:
[2025-10-23T05:19:09.318Z] [LOG]    Total Earnings: Rs.4545.60 (Base: 4545.60 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:19:09.318Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:19:09.547Z] [LOG] 
📝 Components to save:
[2025-10-23T05:19:09.548Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:19:09.549Z] [LOG]    Deduction components: 1
[2025-10-23T05:19:09.549Z] [LOG] Creating components for record 0676f58c-1d4d-4790-b61f-bd8ad5c08855: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:19:09.550Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 4545.604797191667
}
[2025-10-23T05:19:09.790Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:19:10.028Z] [LOG] Created payroll_record_component: 5bad70dc-7f9c-438c-91b3-d0782e545462 for Base Salary
[2025-10-23T05:19:10.029Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 29999.505
}
[2025-10-23T05:19:10.276Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:19:10.530Z] [LOG] Created payroll_record_component: 6061d055-625d-4acc-8654-ad99e08e0fad for Attendance Shortfall (Info)
[2025-10-23T05:19:10.989Z] [LOG] ✅ Financial balances updated successfully for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T05:19:10.990Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:19:10.990Z] [LOG] 
======================================================================
[2025-10-23T05:19:10.991Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Kaushal Thambi
[2025-10-23T05:19:10.991Z] [LOG] ======================================================================
[2025-10-23T05:19:10.991Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:19:10.992Z] [LOG]    Actual Earned Base (Attendance-based): Rs.4545.60
[2025-10-23T05:19:10.992Z] [LOG]    Attendance Shortfall: Rs.29999.51
[2025-10-23T05:19:10.992Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:10.993Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:10.993Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:19:10.993Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:10.994Z] [LOG]    GROSS SALARY: Rs.4545.60
[2025-10-23T05:19:10.994Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:10.994Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:19:10.994Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:19:10.995Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:19:10.995Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:19:10.995Z] [LOG]       - Attendance Shortfall (Info): Rs.29999.51
[2025-10-23T05:19:10.996Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:10.996Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:10.997Z] [LOG]    NET SALARY: Rs.4545.60
[2025-10-23T05:19:10.997Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:19:10.997Z] [LOG] ======================================================================

[2025-10-23T05:19:10.998Z] [LOG] ✅ Kaushal Thambi: Calculation completed successfully
[2025-10-23T05:19:10.998Z] [LOG] 📊 Progress: 3/34 (8.8%)
[2025-10-23T05:19:10.998Z] [LOG] 
🧮 Processing: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-23T05:19:10.999Z] [LOG] 📋 Record ID: 0b183d17-633e-4a4f-8dde-2c63c96818f8
[2025-10-23T05:19:10.999Z] [LOG] 
======================================================================
[2025-10-23T05:19:11.000Z] [LOG] 🧮 CALCULATING PAYROLL: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-23T05:19:11.000Z] [LOG] ======================================================================
[2025-10-23T05:19:11.948Z] [LOG] 🔍 Component filtering for employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-23T05:19:11.948Z] [LOG]    Total components: 13
[2025-10-23T05:19:11.948Z] [LOG]    Applicable components: 13
[2025-10-23T05:19:11.949Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T05:19:13.868Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:19:13.868Z] [LOG] 🔄 Processing financial records for employee 0144315c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:19:14.116Z] [LOG] 📊 Found 0 active loans for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:14.373Z] [LOG] 📊 Found 0 active advances for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:14.594Z] [LOG] 📊 Found 0 approved bonuses for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:14.594Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:19:14.595Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:19:15.048Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:19:15.049Z] [LOG]    Employee ID: 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:15.049Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:19:15.050Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:19:15.050Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:19:15.244Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:19:15.244Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:19:15.244Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:19:15.245Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:19:15.245Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:19:15.245Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:19:15.246Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:19:15.950Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:19:15.950Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:19:16.141Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:19:16.142Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:19:16.142Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:19:16.142Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:19:16.143Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:19:16.143Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:19:16.143Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:19:16.144Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:19:16.334Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:19:16.335Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:19:16.335Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:19:16.335Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:19:16.528Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:19:16.528Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:19:16.529Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:19:16.530Z] [LOG]       Current Time: 10:49:16
[2025-10-23T05:19:16.530Z] [LOG]       Expected Hours (scheduled → now): 2.32h
[2025-10-23T05:19:16.530Z] [LOG]       Actual Hours (check-in → now): 2.32h
[2025-10-23T05:19:16.531Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:19:16.531Z] [LOG]       Weekday: 121.32h
[2025-10-23T05:19:16.532Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:19:16.532Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:16.532Z] [LOG]       Total Expected: 134.82h
[2025-10-23T05:19:16.533Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:19:16.533Z] [LOG]       Weekday: 27.82h (includes 2.32h live)
[2025-10-23T05:19:16.533Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:19:16.533Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:16.534Z] [LOG]       Total Actual: 32.32h
[2025-10-23T05:19:16.534Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:19:16.535Z] [LOG]       Weekday: 121.32h × Rs.235.29 = Rs.28545.68
[2025-10-23T05:19:16.535Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:19:16.535Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:16.536Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:16.536Z] [LOG]       Total Expected Earned: Rs.34545.62
[2025-10-23T05:19:16.536Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:19:16.537Z] [LOG]       Weekday: 27.82h × Rs.235.29 = Rs.6546.06
[2025-10-23T05:19:16.537Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:19:16.537Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:16.538Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:16.538Z] [LOG]       Total Actual Earned: Rs.8546.04
[2025-10-23T05:19:16.541Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:19:16.541Z] [LOG]       Calculated At: Oct 23, 2025, 10:49:16
[2025-10-23T05:19:16.542Z] [LOG]       Expected Earned (until NOW): Rs.34545.62
[2025-10-23T05:19:16.542Z] [LOG]       Actual Earned (until NOW): Rs.8546.04
[2025-10-23T05:19:16.543Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:16.544Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:19:16.544Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:19:16.545Z] [LOG]       📉 Shortfall: 102.50 hours (75.26% of expected)
[2025-10-23T05:19:16.545Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:19:16.545Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:19:16.546Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:19:16.546Z] [LOG]    Actual Earned Base: Rs.8546.04
[2025-10-23T05:19:16.547Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:19:16.547Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:19:16.547Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:19:16.548Z] [LOG]    Gross Salary: 8546.043742533333
[2025-10-23T05:19:16.548Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:19:16.549Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:19:16.549Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.549Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:19:16.550Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.550Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:19:16.550Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.551Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:19:16.551Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.551Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:19:16.552Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.552Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:19:16.552Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.552Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:19:16.553Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.553Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:19:16.553Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.554Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:19:16.554Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.554Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:19:16.555Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.555Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:19:16.556Z] [LOG]    EPF/ETF calculated on: Rs.8546.04
[2025-10-23T05:19:16.556Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:19:16.557Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:19:16.557Z] [LOG] 💰 GROSS CALCULATION for G.M Supathala Sadaru Madhushan null:
[2025-10-23T05:19:16.558Z] [LOG]    Base Salary: 50000
[2025-10-23T05:19:16.559Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:19:16.559Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:19:16.560Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.560Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:19:16.561Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.561Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:19:16.561Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:16.986Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:19:16.986Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:16.987Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:19:16.987Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:19:16.988Z] [LOG]    Actual Earned Base: Rs.8546.04
[2025-10-23T05:19:16.988Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:19:16.988Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:19:16.990Z] [LOG]    = Gross Salary: Rs.8546.04
[2025-10-23T05:19:16.990Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:19:16.991Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:19:16.991Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:19:16.992Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:16.992Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:19:16.992Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:19:16.993Z] [LOG]    Gross Salary: Rs.8546.04
[2025-10-23T05:19:16.993Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:19:16.993Z] [LOG]    = NET SALARY: Rs.8546.04
[2025-10-23T05:19:16.994Z] [LOG] 
💾 Database Update:
[2025-10-23T05:19:16.994Z] [LOG]    Total Earnings: Rs.8546.04 (Base: 8546.04 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:19:16.994Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:19:17.190Z] [LOG] 
📝 Components to save:
[2025-10-23T05:19:17.190Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:19:17.191Z] [LOG]    Deduction components: 1
[2025-10-23T05:19:17.191Z] [LOG] Creating components for record 0b183d17-633e-4a4f-8dde-2c63c96818f8: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:19:17.192Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8546.043742533333
}
[2025-10-23T05:19:17.391Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:19:17.584Z] [LOG] Created payroll_record_component: 1e91ce34-89b7-476f-93c5-1f622bfc4ca7 for Base Salary
[2025-10-23T05:19:17.585Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T05:19:17.788Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:19:18.055Z] [LOG] Created payroll_record_component: 978a732d-355e-462a-9f4a-e6d35f9666c5 for Attendance Shortfall (Info)
[2025-10-23T05:19:18.498Z] [LOG] ✅ Financial balances updated successfully for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:18.499Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:19:18.499Z] [LOG] 
======================================================================
[2025-10-23T05:19:18.499Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: G.M Supathala Sadaru Madhushan null
[2025-10-23T05:19:18.500Z] [LOG] ======================================================================
[2025-10-23T05:19:18.500Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:19:18.501Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8546.04
[2025-10-23T05:19:18.501Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:19:18.501Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:18.501Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:18.502Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:19:18.502Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:18.502Z] [LOG]    GROSS SALARY: Rs.8546.04
[2025-10-23T05:19:18.502Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:18.503Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:19:18.503Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:19:18.503Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:19:18.504Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:19:18.504Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:19:18.504Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:18.506Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:18.507Z] [LOG]    NET SALARY: Rs.8546.04
[2025-10-23T05:19:18.507Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:19:18.508Z] [LOG] ======================================================================

[2025-10-23T05:19:18.508Z] [LOG] ✅ G.M Supathala Sadaru Madhushan null: Calculation completed successfully
[2025-10-23T05:19:18.508Z] [LOG] 📊 Progress: 4/34 (11.8%)
[2025-10-23T05:19:18.509Z] [LOG] 
🧮 Processing: Dharshika null (EMP000009)
[2025-10-23T05:19:18.509Z] [LOG] 📋 Record ID: 1cb997e4-2d84-4ac9-8e9a-2994da0c4594
[2025-10-23T05:19:18.509Z] [LOG] 
======================================================================
[2025-10-23T05:19:18.510Z] [LOG] 🧮 CALCULATING PAYROLL: Dharshika null (EMP000009)
[2025-10-23T05:19:18.510Z] [LOG] ======================================================================
[2025-10-23T05:19:19.403Z] [LOG] 🔍 Component filtering for employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-23T05:19:19.404Z] [LOG]    Total components: 13
[2025-10-23T05:19:19.404Z] [LOG]    Applicable components: 13
[2025-10-23T05:19:19.404Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:19:20.753Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:19:20.754Z] [LOG] 🔄 Processing financial records for employee 0143a994-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:19:20.991Z] [LOG] 📊 Found 0 active loans for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:21.238Z] [LOG] 📊 Found 0 active advances for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:21.492Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:21.493Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:19:21.493Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:19:21.711Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:19:21.711Z] [LOG]    Employee ID: 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:21.711Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:19:21.712Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:19:21.712Z] [LOG]    Base Salary (Full Month): Rs.100000.00
[2025-10-23T05:19:21.962Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:19:21.963Z] [LOG]       Daily Salary: Rs.4000.00
[2025-10-23T05:19:21.963Z] [LOG]       Weekday Hourly Rate: Rs.470.59
[2025-10-23T05:19:21.964Z] [LOG]       Saturday Hourly Rate: Rs.888.89
[2025-10-23T05:19:21.964Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:19:21.964Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:19:21.965Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:19:22.751Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:19:22.752Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:19:22.959Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:19:22.959Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:19:22.959Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:19:22.960Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:19:22.960Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:19:22.960Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:19:22.961Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:19:22.961Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:19:23.388Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:19:23.389Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:19:23.390Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:19:23.390Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:19:23.636Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:19:23.636Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:19:23.637Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:19:23.638Z] [LOG]       Current Time: 10:49:23
[2025-10-23T05:19:23.638Z] [LOG]       Expected Hours (scheduled → now): 2.32h
[2025-10-23T05:19:23.638Z] [LOG]       Actual Hours (check-in → now): 2.32h
[2025-10-23T05:19:23.639Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:19:23.639Z] [LOG]       Weekday: 121.32h
[2025-10-23T05:19:23.640Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:19:23.640Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:23.640Z] [LOG]       Total Expected: 134.82h
[2025-10-23T05:19:23.641Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:19:23.641Z] [LOG]       Weekday: 27.82h (includes 2.32h live)
[2025-10-23T05:19:23.642Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:19:23.642Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:23.642Z] [LOG]       Total Actual: 32.32h
[2025-10-23T05:19:23.643Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:19:23.643Z] [LOG]       Weekday: 121.32h × Rs.470.59 = Rs.57093.50
[2025-10-23T05:19:23.643Z] [LOG]       Saturday: 13.50h × Rs.888.89 = Rs.12000.01
[2025-10-23T05:19:23.644Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:23.644Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:23.644Z] [LOG]       Total Expected Earned: Rs.69093.51
[2025-10-23T05:19:23.644Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:19:23.645Z] [LOG]       Weekday: 27.82h × Rs.470.59 = Rs.13093.33
[2025-10-23T05:19:23.645Z] [LOG]       Saturday: 4.50h × Rs.888.89 = Rs.4000.01
[2025-10-23T05:19:23.645Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:23.646Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:23.646Z] [LOG]       Total Actual Earned: Rs.17093.34
[2025-10-23T05:19:23.647Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:19:23.647Z] [LOG]       Calculated At: Oct 23, 2025, 10:49:23
[2025-10-23T05:19:23.648Z] [LOG]       Expected Earned (until NOW): Rs.69093.51
[2025-10-23T05:19:23.648Z] [LOG]       Actual Earned (until NOW): Rs.17093.34
[2025-10-23T05:19:23.649Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:23.649Z] [LOG]       Attendance Deduction: Rs.52000.17
[2025-10-23T05:19:23.650Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:19:23.650Z] [LOG]       📉 Shortfall: 102.50 hours (75.26% of expected)
[2025-10-23T05:19:23.651Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:19:23.652Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:19:23.653Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T05:19:23.653Z] [LOG]    Actual Earned Base: Rs.17093.34
[2025-10-23T05:19:23.653Z] [LOG]    Attendance Shortfall: Rs.52000.17
[2025-10-23T05:19:23.654Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:19:23.654Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:19:23.654Z] [LOG]    Gross Salary: 17093.339851455556
[2025-10-23T05:19:23.655Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:19:23.655Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:19:23.656Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.656Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:19:23.657Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.657Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:19:23.657Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.658Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:19:23.658Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.659Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:19:23.659Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.660Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:19:23.660Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.661Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:19:23.661Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.662Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:19:23.663Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.663Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:19:23.664Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.664Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:19:23.664Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.665Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:19:23.665Z] [LOG]    EPF/ETF calculated on: Rs.17093.34
[2025-10-23T05:19:23.665Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:19:23.665Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:19:23.666Z] [LOG] 💰 GROSS CALCULATION for Dharshika null:
[2025-10-23T05:19:23.666Z] [LOG]    Base Salary: 100000
[2025-10-23T05:19:23.666Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:19:23.667Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:19:23.667Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.667Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:19:23.668Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:23.668Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:19:23.669Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:24.013Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:19:24.014Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:24.015Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:19:24.015Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:19:24.015Z] [LOG]    Actual Earned Base: Rs.17093.34
[2025-10-23T05:19:24.016Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:19:24.016Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:19:24.016Z] [LOG]    = Gross Salary: Rs.17093.34
[2025-10-23T05:19:24.017Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:19:24.017Z] [LOG]    Attendance Shortfall (Info): Rs.52000.17
[2025-10-23T05:19:24.018Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:19:24.018Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:24.018Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:19:24.019Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:19:24.019Z] [LOG]    Gross Salary: Rs.17093.34
[2025-10-23T05:19:24.020Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:19:24.020Z] [LOG]    = NET SALARY: Rs.17093.34
[2025-10-23T05:19:24.020Z] [LOG] 
💾 Database Update:
[2025-10-23T05:19:24.021Z] [LOG]    Total Earnings: Rs.17093.34 (Base: 17093.34 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:19:24.022Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:19:24.351Z] [LOG] 
📝 Components to save:
[2025-10-23T05:19:24.351Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:19:24.352Z] [LOG]    Deduction components: 1
[2025-10-23T05:19:24.352Z] [LOG] Creating components for record 1cb997e4-2d84-4ac9-8e9a-2994da0c4594: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:19:24.353Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 17093.339851455556
}
[2025-10-23T05:19:24.589Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:19:24.780Z] [LOG] Created payroll_record_component: c0ce407a-e373-42b0-84d6-9a0c2e2f0ca7 for Base Salary
[2025-10-23T05:19:24.780Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 52000.17499999999
}
[2025-10-23T05:19:24.991Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:19:25.229Z] [LOG] Created payroll_record_component: b5ff6984-ab8e-47d4-a2c0-11b3a5df5edb for Attendance Shortfall (Info)
[2025-10-23T05:19:25.710Z] [LOG] ✅ Financial balances updated successfully for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:25.710Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:19:25.710Z] [LOG] 
======================================================================
[2025-10-23T05:19:25.711Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Dharshika null
[2025-10-23T05:19:25.711Z] [LOG] ======================================================================
[2025-10-23T05:19:25.712Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T05:19:25.712Z] [LOG]    Actual Earned Base (Attendance-based): Rs.17093.34
[2025-10-23T05:19:25.712Z] [LOG]    Attendance Shortfall: Rs.52000.17
[2025-10-23T05:19:25.713Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:25.713Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:25.713Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:19:25.714Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:25.714Z] [LOG]    GROSS SALARY: Rs.17093.34
[2025-10-23T05:19:25.714Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:25.715Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:19:25.715Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:19:25.715Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:19:25.715Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:19:25.716Z] [LOG]       - Attendance Shortfall (Info): Rs.52000.17
[2025-10-23T05:19:25.716Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:25.716Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:25.717Z] [LOG]    NET SALARY: Rs.17093.34
[2025-10-23T05:19:25.717Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:19:25.717Z] [LOG] ======================================================================

[2025-10-23T05:19:25.718Z] [LOG] ✅ Dharshika null: Calculation completed successfully
[2025-10-23T05:19:25.718Z] [LOG] 📊 Progress: 5/34 (14.7%)
[2025-10-23T05:19:25.718Z] [LOG] 
🧮 Processing: Prasanthan null (EMP000001)
[2025-10-23T05:19:25.719Z] [LOG] 📋 Record ID: 2b24daef-29ee-4c41-8c36-32cfc60f4121
[2025-10-23T05:19:25.719Z] [LOG] 
======================================================================
[2025-10-23T05:19:25.719Z] [LOG] 🧮 CALCULATING PAYROLL: Prasanthan null (EMP000001)
[2025-10-23T05:19:25.720Z] [LOG] ======================================================================
[2025-10-23T05:19:26.750Z] [LOG] 🔍 Component filtering for employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-23T05:19:26.750Z] [LOG]    Total components: 13
[2025-10-23T05:19:26.751Z] [LOG]    Applicable components: 13
[2025-10-23T05:19:26.751Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:19:28.111Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:19:28.112Z] [LOG] 🔄 Processing financial records for employee 014397c7-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:19:28.349Z] [LOG] 📊 Found 0 active loans for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:28.591Z] [LOG] 📊 Found 0 active advances for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:28.829Z] [LOG] 📊 Found 0 approved bonuses for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:28.829Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:19:28.830Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:19:29.068Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:19:29.069Z] [LOG]    Employee ID: 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:29.069Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:19:29.069Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:19:29.070Z] [LOG]    Base Salary (Full Month): Rs.150000.00
[2025-10-23T05:19:29.316Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:19:29.317Z] [LOG]       Daily Salary: Rs.6000.00
[2025-10-23T05:19:29.317Z] [LOG]       Weekday Hourly Rate: Rs.705.88
[2025-10-23T05:19:29.317Z] [LOG]       Saturday Hourly Rate: Rs.1333.33
[2025-10-23T05:19:29.318Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:19:29.318Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:19:29.319Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:19:30.169Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:19:30.169Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:19:30.428Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:19:30.428Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:19:30.429Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:19:30.429Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:19:30.429Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:19:30.430Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:19:30.430Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:19:30.430Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:19:30.649Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:19:30.650Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:19:30.650Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:19:30.650Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:19:30.859Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:19:30.860Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:19:30.860Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:19:30.861Z] [LOG]       Current Time: 10:49:30
[2025-10-23T05:19:30.862Z] [LOG]       Expected Hours (scheduled → now): 2.33h
[2025-10-23T05:19:30.862Z] [LOG]       Actual Hours (check-in → now): 2.33h
[2025-10-23T05:19:30.862Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:19:30.863Z] [LOG]       Weekday: 121.33h
[2025-10-23T05:19:30.863Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:19:30.863Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:30.864Z] [LOG]       Total Expected: 134.83h
[2025-10-23T05:19:30.864Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:19:30.864Z] [LOG]       Weekday: 27.83h (includes 2.33h live)
[2025-10-23T05:19:30.865Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:19:30.865Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:30.866Z] [LOG]       Total Actual: 32.33h
[2025-10-23T05:19:30.866Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:19:30.866Z] [LOG]       Weekday: 121.33h × Rs.705.88 = Rs.85641.06
[2025-10-23T05:19:30.867Z] [LOG]       Saturday: 13.50h × Rs.1333.33 = Rs.17999.95
[2025-10-23T05:19:30.867Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:30.868Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:30.868Z] [LOG]       Total Expected Earned: Rs.103641.01
[2025-10-23T05:19:30.868Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:19:30.868Z] [LOG]       Weekday: 27.83h × Rs.705.88 = Rs.19641.28
[2025-10-23T05:19:30.868Z] [LOG]       Saturday: 4.50h × Rs.1333.33 = Rs.5999.98
[2025-10-23T05:19:30.869Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:30.869Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:30.869Z] [LOG]       Total Actual Earned: Rs.25641.26
[2025-10-23T05:19:30.870Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:19:30.870Z] [LOG]       Calculated At: Oct 23, 2025, 10:49:30
[2025-10-23T05:19:30.871Z] [LOG]       Expected Earned (until NOW): Rs.103641.01
[2025-10-23T05:19:30.871Z] [LOG]       Actual Earned (until NOW): Rs.25641.26
[2025-10-23T05:19:30.871Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:30.872Z] [LOG]       Attendance Deduction: Rs.77999.75
[2025-10-23T05:19:30.872Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:19:30.873Z] [LOG]       📉 Shortfall: 102.50 hours (75.26% of expected)
[2025-10-23T05:19:30.873Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:19:30.874Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:19:30.874Z] [LOG]    Base Salary (Full): Rs.150000.00
[2025-10-23T05:19:30.875Z] [LOG]    Actual Earned Base: Rs.25641.26
[2025-10-23T05:19:30.875Z] [LOG]    Attendance Shortfall: Rs.77999.75
[2025-10-23T05:19:30.876Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:19:30.877Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:19:30.877Z] [LOG]    Gross Salary: 25641.264430811112
[2025-10-23T05:19:30.878Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:19:30.878Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:19:30.879Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.879Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:19:30.879Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.880Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:19:30.880Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.880Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:19:30.881Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.881Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:19:30.881Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.882Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:19:30.882Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.882Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:19:30.882Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.883Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:19:30.883Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.884Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:19:30.884Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.884Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:19:30.884Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.884Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:19:30.885Z] [LOG]    EPF/ETF calculated on: Rs.25641.26
[2025-10-23T05:19:30.885Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:19:30.886Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:19:30.886Z] [LOG] 💰 GROSS CALCULATION for Prasanthan null:
[2025-10-23T05:19:30.886Z] [LOG]    Base Salary: 150000
[2025-10-23T05:19:30.886Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:19:30.887Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:19:30.887Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.887Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:19:30.888Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:30.888Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:19:30.888Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:31.148Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:19:31.148Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:31.148Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:19:31.149Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:19:31.149Z] [LOG]    Actual Earned Base: Rs.25641.26
[2025-10-23T05:19:31.149Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:19:31.150Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:19:31.150Z] [LOG]    = Gross Salary: Rs.25641.26
[2025-10-23T05:19:31.150Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:19:31.151Z] [LOG]    Attendance Shortfall (Info): Rs.77999.75
[2025-10-23T05:19:31.151Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:19:31.151Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:31.152Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:19:31.152Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:19:31.152Z] [LOG]    Gross Salary: Rs.25641.26
[2025-10-23T05:19:31.152Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:19:31.153Z] [LOG]    = NET SALARY: Rs.25641.26
[2025-10-23T05:19:31.153Z] [LOG] 
💾 Database Update:
[2025-10-23T05:19:31.153Z] [LOG]    Total Earnings: Rs.25641.26 (Base: 25641.26 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:19:31.154Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:19:31.388Z] [LOG] 
📝 Components to save:
[2025-10-23T05:19:31.388Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:19:31.389Z] [LOG]    Deduction components: 1
[2025-10-23T05:19:31.389Z] [LOG] Creating components for record 2b24daef-29ee-4c41-8c36-32cfc60f4121: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:19:31.389Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 25641.264430811112
}
[2025-10-23T05:19:31.591Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:19:31.830Z] [LOG] Created payroll_record_component: 7a671ff7-fff6-4fc9-9662-4af64f0bd7ef for Base Salary
[2025-10-23T05:19:31.831Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 77999.75
}
[2025-10-23T05:19:32.035Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:19:32.240Z] [LOG] Created payroll_record_component: eb1cf3bf-f7a2-4028-a7b4-b849ca749b97 for Attendance Shortfall (Info)
[2025-10-23T05:19:32.668Z] [LOG] ✅ Financial balances updated successfully for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:32.668Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:19:32.668Z] [LOG] 
======================================================================
[2025-10-23T05:19:32.669Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Prasanthan null
[2025-10-23T05:19:32.669Z] [LOG] ======================================================================
[2025-10-23T05:19:32.669Z] [LOG]    Base Salary (Full): Rs.150000.00
[2025-10-23T05:19:32.669Z] [LOG]    Actual Earned Base (Attendance-based): Rs.25641.26
[2025-10-23T05:19:32.669Z] [LOG]    Attendance Shortfall: Rs.77999.75
[2025-10-23T05:19:32.670Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:32.670Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:32.670Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:19:32.670Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:32.670Z] [LOG]    GROSS SALARY: Rs.25641.26
[2025-10-23T05:19:32.671Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:32.671Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:19:32.671Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:19:32.671Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:19:32.671Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:19:32.672Z] [LOG]       - Attendance Shortfall (Info): Rs.77999.75
[2025-10-23T05:19:32.672Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:32.672Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:32.672Z] [LOG]    NET SALARY: Rs.25641.26
[2025-10-23T05:19:32.673Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:19:32.673Z] [LOG] ======================================================================

[2025-10-23T05:19:32.674Z] [LOG] ✅ Prasanthan null: Calculation completed successfully
[2025-10-23T05:19:32.674Z] [LOG] 📊 Progress: 6/34 (17.6%)
[2025-10-23T05:19:32.674Z] [LOG] 
🧮 Processing: Nimdiya Ranasinghe null (EMP000045)
[2025-10-23T05:19:32.674Z] [LOG] 📋 Record ID: 3b5bfead-2bf4-4c91-9303-086c50a4fde8
[2025-10-23T05:19:32.675Z] [LOG] 
======================================================================
[2025-10-23T05:19:32.675Z] [LOG] 🧮 CALCULATING PAYROLL: Nimdiya Ranasinghe null (EMP000045)
[2025-10-23T05:19:32.675Z] [LOG] ======================================================================
[2025-10-23T05:19:33.561Z] [LOG] 🔍 Component filtering for employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-23T05:19:33.562Z] [LOG]    Total components: 13
[2025-10-23T05:19:33.562Z] [LOG]    Applicable components: 13
[2025-10-23T05:19:33.562Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:19:34.941Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:19:34.941Z] [LOG] 🔄 Processing financial records for employee 01444074-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:19:35.163Z] [LOG] 📊 Found 0 active loans for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:35.390Z] [LOG] 📊 Found 0 active advances for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:35.630Z] [LOG] 📊 Found 0 approved bonuses for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:35.630Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:19:35.631Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:19:35.869Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:19:35.869Z] [LOG]    Employee ID: 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:35.870Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:19:35.870Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:19:35.871Z] [LOG]    Base Salary (Full Month): Rs.35000.00
[2025-10-23T05:19:36.061Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:19:36.062Z] [LOG]       Daily Salary: Rs.1400.00
[2025-10-23T05:19:36.062Z] [LOG]       Weekday Hourly Rate: Rs.164.71
[2025-10-23T05:19:36.063Z] [LOG]       Saturday Hourly Rate: Rs.311.11
[2025-10-23T05:19:36.063Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:19:36.063Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:19:36.064Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:19:36.748Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:19:36.749Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:19:36.990Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:19:36.990Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:19:36.991Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:19:36.991Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:19:36.991Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:19:36.992Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:19:36.992Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:19:36.992Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:19:37.228Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:19:37.228Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:19:37.228Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:19:37.229Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:19:37.482Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:19:37.482Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:19:37.483Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:19:37.483Z] [LOG]       Current Time: 10:49:37
[2025-10-23T05:19:37.484Z] [LOG]       Expected Hours (scheduled → now): 2.33h
[2025-10-23T05:19:37.484Z] [LOG]       Actual Hours (check-in → now): 2.33h
[2025-10-23T05:19:37.484Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:19:37.485Z] [LOG]       Weekday: 121.33h
[2025-10-23T05:19:37.485Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:19:37.485Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:37.485Z] [LOG]       Total Expected: 134.83h
[2025-10-23T05:19:37.486Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:19:37.486Z] [LOG]       Weekday: 27.83h (includes 2.33h live)
[2025-10-23T05:19:37.486Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:19:37.486Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:37.487Z] [LOG]       Total Actual: 32.33h
[2025-10-23T05:19:37.487Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:19:37.487Z] [LOG]       Weekday: 121.33h × Rs.164.71 = Rs.19983.78
[2025-10-23T05:19:37.487Z] [LOG]       Saturday: 13.50h × Rs.311.11 = Rs.4199.99
[2025-10-23T05:19:37.488Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:37.488Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:37.488Z] [LOG]       Total Expected Earned: Rs.24183.77
[2025-10-23T05:19:37.488Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:19:37.488Z] [LOG]       Weekday: 27.83h × Rs.164.71 = Rs.4583.40
[2025-10-23T05:19:37.488Z] [LOG]       Saturday: 4.50h × Rs.311.11 = Rs.1400.00
[2025-10-23T05:19:37.489Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:37.489Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:37.490Z] [LOG]       Total Actual Earned: Rs.5983.39
[2025-10-23T05:19:37.490Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:19:37.490Z] [LOG]       Calculated At: Oct 23, 2025, 10:49:37
[2025-10-23T05:19:37.491Z] [LOG]       Expected Earned (until NOW): Rs.24183.77
[2025-10-23T05:19:37.491Z] [LOG]       Actual Earned (until NOW): Rs.5983.39
[2025-10-23T05:19:37.491Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:37.491Z] [LOG]       Attendance Deduction: Rs.18200.38
[2025-10-23T05:19:37.491Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:19:37.491Z] [LOG]       📉 Shortfall: 102.50 hours (75.26% of expected)
[2025-10-23T05:19:37.491Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:19:37.491Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:19:37.492Z] [LOG]    Base Salary (Full): Rs.35000.00
[2025-10-23T05:19:37.492Z] [LOG]    Actual Earned Base: Rs.5983.39
[2025-10-23T05:19:37.492Z] [LOG]    Attendance Shortfall: Rs.18200.38
[2025-10-23T05:19:37.493Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:19:37.493Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:19:37.493Z] [LOG]    Gross Salary: 5983.393072283333
[2025-10-23T05:19:37.493Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:19:37.494Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:19:37.494Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.494Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:19:37.495Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.495Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:19:37.495Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.496Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:19:37.496Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.496Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:19:37.496Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.497Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:19:37.497Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.497Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:19:37.498Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.498Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:19:37.498Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.498Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:19:37.499Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.499Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:19:37.499Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.499Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:19:37.500Z] [LOG]    EPF/ETF calculated on: Rs.5983.39
[2025-10-23T05:19:37.500Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:19:37.500Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:19:37.500Z] [LOG] 💰 GROSS CALCULATION for Nimdiya Ranasinghe null:
[2025-10-23T05:19:37.501Z] [LOG]    Base Salary: 35000
[2025-10-23T05:19:37.501Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:19:37.501Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:19:37.501Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.501Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:19:37.502Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.502Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:19:37.502Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:37.709Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:19:37.710Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:37.710Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:19:37.710Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:19:37.710Z] [LOG]    Actual Earned Base: Rs.5983.39
[2025-10-23T05:19:37.711Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:19:37.711Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:19:37.711Z] [LOG]    = Gross Salary: Rs.5983.39
[2025-10-23T05:19:37.711Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:19:37.712Z] [LOG]    Attendance Shortfall (Info): Rs.18200.38
[2025-10-23T05:19:37.712Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:19:37.712Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:37.713Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:19:37.713Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:19:37.713Z] [LOG]    Gross Salary: Rs.5983.39
[2025-10-23T05:19:37.714Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:19:37.714Z] [LOG]    = NET SALARY: Rs.5983.39
[2025-10-23T05:19:37.714Z] [LOG] 
💾 Database Update:
[2025-10-23T05:19:37.715Z] [LOG]    Total Earnings: Rs.5983.39 (Base: 5983.39 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:19:37.715Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:19:37.917Z] [LOG] 
📝 Components to save:
[2025-10-23T05:19:37.918Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:19:37.918Z] [LOG]    Deduction components: 1
[2025-10-23T05:19:37.918Z] [LOG] Creating components for record 3b5bfead-2bf4-4c91-9303-086c50a4fde8: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:19:37.919Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 5983.393072283333
}
[2025-10-23T05:19:38.115Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:19:38.347Z] [LOG] Created payroll_record_component: 1b2915ae-a7fb-4cb9-af89-dc75c2170d30 for Base Salary
[2025-10-23T05:19:38.348Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 18200.375000000004
}
[2025-10-23T05:19:38.589Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:19:38.832Z] [LOG] Created payroll_record_component: c4a957ae-b540-4955-838d-b02e4c2e8717 for Attendance Shortfall (Info)
[2025-10-23T05:19:39.317Z] [LOG] ✅ Financial balances updated successfully for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:39.318Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:19:39.318Z] [LOG] 
======================================================================
[2025-10-23T05:19:39.318Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Nimdiya Ranasinghe null
[2025-10-23T05:19:39.318Z] [LOG] ======================================================================
[2025-10-23T05:19:39.319Z] [LOG]    Base Salary (Full): Rs.35000.00
[2025-10-23T05:19:39.319Z] [LOG]    Actual Earned Base (Attendance-based): Rs.5983.39
[2025-10-23T05:19:39.319Z] [LOG]    Attendance Shortfall: Rs.18200.38
[2025-10-23T05:19:39.320Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:39.320Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:39.320Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:19:39.320Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:39.321Z] [LOG]    GROSS SALARY: Rs.5983.39
[2025-10-23T05:19:39.321Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:39.321Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:19:39.321Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:19:39.322Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:19:39.322Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:19:39.322Z] [LOG]       - Attendance Shortfall (Info): Rs.18200.38
[2025-10-23T05:19:39.323Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:39.323Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:39.324Z] [LOG]    NET SALARY: Rs.5983.39
[2025-10-23T05:19:39.324Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:19:39.324Z] [LOG] ======================================================================

[2025-10-23T05:19:39.324Z] [LOG] ✅ Nimdiya Ranasinghe null: Calculation completed successfully
[2025-10-23T05:19:39.324Z] [LOG] 📊 Progress: 7/34 (20.6%)
[2025-10-23T05:19:39.325Z] [LOG] 
🧮 Processing: Rasanga null (EMP000028)
[2025-10-23T05:19:39.325Z] [LOG] 📋 Record ID: 3e85eaf9-bae5-4bbf-8bac-48b1c13b2337
[2025-10-23T05:19:39.325Z] [LOG] 
======================================================================
[2025-10-23T05:19:39.325Z] [LOG] 🧮 CALCULATING PAYROLL: Rasanga null (EMP000028)
[2025-10-23T05:19:39.325Z] [LOG] ======================================================================
[2025-10-23T05:19:40.270Z] [LOG] 🔍 Component filtering for employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-23T05:19:40.270Z] [LOG]    Total components: 13
[2025-10-23T05:19:40.271Z] [LOG]    Applicable components: 13
[2025-10-23T05:19:40.271Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T05:19:41.997Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:19:41.997Z] [LOG] 🔄 Processing financial records for employee 0143eaec-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:19:42.227Z] [LOG] 📊 Found 0 active loans for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:42.415Z] [LOG] 📊 Found 0 active advances for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:42.632Z] [LOG] 📊 Found 0 approved bonuses for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:42.633Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:19:42.634Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:19:42.933Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:19:42.934Z] [LOG]    Employee ID: 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:42.934Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:19:42.935Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:19:42.935Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:19:43.129Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:19:43.129Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:19:43.130Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:19:43.130Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:19:43.130Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:19:43.130Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:19:43.131Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:19:44.030Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:19:44.030Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:19:44.268Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:19:44.269Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:19:44.269Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:19:44.269Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:19:44.270Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:19:44.270Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:19:44.270Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:19:44.271Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:19:44.491Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:19:44.492Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:19:44.492Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:19:44.492Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:19:44.753Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:19:44.753Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:19:44.754Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:19:44.754Z] [LOG]       Current Time: 10:49:44
[2025-10-23T05:19:44.755Z] [LOG]       Expected Hours (scheduled → now): 2.33h
[2025-10-23T05:19:44.755Z] [LOG]       Actual Hours (check-in → now): 2.33h
[2025-10-23T05:19:44.755Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:19:44.755Z] [LOG]       Weekday: 121.33h
[2025-10-23T05:19:44.756Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:19:44.756Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:44.756Z] [LOG]       Total Expected: 134.83h
[2025-10-23T05:19:44.757Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:19:44.757Z] [LOG]       Weekday: 27.83h (includes 2.33h live)
[2025-10-23T05:19:44.757Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:19:44.757Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:44.758Z] [LOG]       Total Actual: 32.33h
[2025-10-23T05:19:44.758Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:19:44.758Z] [LOG]       Weekday: 121.33h × Rs.235.29 = Rs.28547.52
[2025-10-23T05:19:44.758Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:19:44.758Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:44.758Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:44.759Z] [LOG]       Total Expected Earned: Rs.34547.46
[2025-10-23T05:19:44.759Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:19:44.759Z] [LOG]       Weekday: 27.83h × Rs.235.29 = Rs.6547.91
[2025-10-23T05:19:44.760Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:19:44.760Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:44.760Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:44.761Z] [LOG]       Total Actual Earned: Rs.8547.89
[2025-10-23T05:19:44.761Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:19:44.762Z] [LOG]       Calculated At: Oct 23, 2025, 10:49:44
[2025-10-23T05:19:44.762Z] [LOG]       Expected Earned (until NOW): Rs.34547.46
[2025-10-23T05:19:44.762Z] [LOG]       Actual Earned (until NOW): Rs.8547.89
[2025-10-23T05:19:44.763Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:44.763Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:19:44.763Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:19:44.764Z] [LOG]       📉 Shortfall: 102.50 hours (75.26% of expected)
[2025-10-23T05:19:44.764Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:19:44.765Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:19:44.765Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:19:44.765Z] [LOG]    Actual Earned Base: Rs.8547.89
[2025-10-23T05:19:44.766Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:19:44.766Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:19:44.767Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:19:44.767Z] [LOG]    Gross Salary: 8547.888481491666
[2025-10-23T05:19:44.768Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:19:44.768Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:19:44.768Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.769Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:19:44.769Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.769Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:19:44.769Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.769Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:19:44.770Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.770Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:19:44.770Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.770Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:19:44.770Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.772Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:19:44.772Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.773Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:19:44.773Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.773Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:19:44.773Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.774Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:19:44.774Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.774Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:19:44.774Z] [LOG]    EPF/ETF calculated on: Rs.8547.89
[2025-10-23T05:19:44.774Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:19:44.775Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:19:44.775Z] [LOG] 💰 GROSS CALCULATION for Rasanga null:
[2025-10-23T05:19:44.775Z] [LOG]    Base Salary: 50000
[2025-10-23T05:19:44.775Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:19:44.775Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:19:44.776Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.776Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:19:44.776Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:44.777Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:19:44.777Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:45.004Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:19:45.005Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:45.005Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:19:45.006Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:19:45.006Z] [LOG]    Actual Earned Base: Rs.8547.89
[2025-10-23T05:19:45.006Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:19:45.007Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:19:45.007Z] [LOG]    = Gross Salary: Rs.8547.89
[2025-10-23T05:19:45.007Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:19:45.007Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:19:45.008Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:19:45.008Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:45.008Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:19:45.008Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:19:45.009Z] [LOG]    Gross Salary: Rs.8547.89
[2025-10-23T05:19:45.009Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:19:45.009Z] [LOG]    = NET SALARY: Rs.8547.89
[2025-10-23T05:19:45.010Z] [LOG] 
💾 Database Update:
[2025-10-23T05:19:45.010Z] [LOG]    Total Earnings: Rs.8547.89 (Base: 8547.89 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:19:45.010Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:19:45.235Z] [LOG] 
📝 Components to save:
[2025-10-23T05:19:45.236Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:19:45.236Z] [LOG]    Deduction components: 1
[2025-10-23T05:19:45.236Z] [LOG] Creating components for record 3e85eaf9-bae5-4bbf-8bac-48b1c13b2337: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:19:45.237Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8547.888481491666
}
[2025-10-23T05:19:45.928Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:19:46.137Z] [LOG] Created payroll_record_component: 6f4ddf4e-5806-4b6e-bea7-bcd79facfaea for Base Salary
[2025-10-23T05:19:46.137Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:19:46.348Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:19:46.594Z] [LOG] Created payroll_record_component: 9187cf9c-f862-4b59-8714-26874f9e6c4b for Attendance Shortfall (Info)
[2025-10-23T05:19:47.070Z] [LOG] ✅ Financial balances updated successfully for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:47.071Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:19:47.071Z] [LOG] 
======================================================================
[2025-10-23T05:19:47.071Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Rasanga null
[2025-10-23T05:19:47.072Z] [LOG] ======================================================================
[2025-10-23T05:19:47.072Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:19:47.072Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8547.89
[2025-10-23T05:19:47.073Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:19:47.073Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:47.073Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:47.073Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:19:47.074Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:47.074Z] [LOG]    GROSS SALARY: Rs.8547.89
[2025-10-23T05:19:47.074Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:47.075Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:19:47.075Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:19:47.075Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:19:47.076Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:19:47.076Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:19:47.076Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:47.077Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:47.077Z] [LOG]    NET SALARY: Rs.8547.89
[2025-10-23T05:19:47.077Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:19:47.077Z] [LOG] ======================================================================

[2025-10-23T05:19:47.078Z] [LOG] ✅ Rasanga null: Calculation completed successfully
[2025-10-23T05:19:47.078Z] [LOG] 📊 Progress: 8/34 (23.5%)
[2025-10-23T05:19:47.078Z] [LOG] 
🧮 Processing: Waruni null (EMP000024)
[2025-10-23T05:19:47.078Z] [LOG] 📋 Record ID: 44dd9334-7a2d-4da1-9f7b-68afb58994f6
[2025-10-23T05:19:47.079Z] [LOG] 
======================================================================
[2025-10-23T05:19:47.079Z] [LOG] 🧮 CALCULATING PAYROLL: Waruni null (EMP000024)
[2025-10-23T05:19:47.079Z] [LOG] ======================================================================
[2025-10-23T05:19:48.029Z] [LOG] 🔍 Component filtering for employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-23T05:19:48.029Z] [LOG]    Total components: 13
[2025-10-23T05:19:48.030Z] [LOG]    Applicable components: 13
[2025-10-23T05:19:48.030Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:19:49.788Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:19:49.788Z] [LOG] 🔄 Processing financial records for employee 0143e40c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:19:50.029Z] [LOG] 📊 Found 0 active loans for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:50.276Z] [LOG] 📊 Found 0 active advances for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:50.509Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:50.510Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:19:50.510Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:19:50.801Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:19:50.802Z] [LOG]    Employee ID: 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:50.802Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:19:50.802Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:19:50.803Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:19:51.624Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:19:51.625Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:19:51.625Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:19:51.625Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:19:51.625Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:19:51.626Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:19:51.626Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:19:52.353Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:19:52.353Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:19:52.947Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:19:52.947Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:19:52.948Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:19:52.948Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:19:52.948Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:19:52.948Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:19:52.949Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:19:52.949Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:19:53.159Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:19:53.159Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:19:53.160Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:19:53.160Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:19:53.372Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:19:53.372Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:19:53.372Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:19:53.373Z] [LOG]       Current Time: 10:49:53
[2025-10-23T05:19:53.374Z] [LOG]       Expected Hours (scheduled → now): 2.33h
[2025-10-23T05:19:53.374Z] [LOG]       Actual Hours (check-in → now): 2.33h
[2025-10-23T05:19:53.374Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:19:53.374Z] [LOG]       Weekday: 121.33h
[2025-10-23T05:19:53.375Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:19:53.375Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:53.375Z] [LOG]       Total Expected: 134.83h
[2025-10-23T05:19:53.376Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:19:53.376Z] [LOG]       Weekday: 27.83h (includes 2.33h live)
[2025-10-23T05:19:53.376Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:19:53.376Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:19:53.377Z] [LOG]       Total Actual: 32.33h
[2025-10-23T05:19:53.377Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:19:53.377Z] [LOG]       Weekday: 121.33h × Rs.235.29 = Rs.28548.09
[2025-10-23T05:19:53.378Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:19:53.378Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:53.378Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:53.379Z] [LOG]       Total Expected Earned: Rs.34548.03
[2025-10-23T05:19:53.379Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:19:53.379Z] [LOG]       Weekday: 27.83h × Rs.235.29 = Rs.6548.47
[2025-10-23T05:19:53.380Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:19:53.380Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:19:53.380Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:53.381Z] [LOG]       Total Actual Earned: Rs.8548.45
[2025-10-23T05:19:53.381Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:19:53.381Z] [LOG]       Calculated At: Oct 23, 2025, 10:49:53
[2025-10-23T05:19:53.382Z] [LOG]       Expected Earned (until NOW): Rs.34548.03
[2025-10-23T05:19:53.382Z] [LOG]       Actual Earned (until NOW): Rs.8548.45
[2025-10-23T05:19:53.382Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:19:53.382Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:19:53.382Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:19:53.382Z] [LOG]       📉 Shortfall: 102.50 hours (75.26% of expected)
[2025-10-23T05:19:53.383Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:19:53.383Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:19:53.384Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:19:53.385Z] [LOG]    Actual Earned Base: Rs.8548.45
[2025-10-23T05:19:53.385Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:19:53.386Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:19:53.386Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:19:53.386Z] [LOG]    Gross Salary: 8548.451804966668
[2025-10-23T05:19:53.387Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:19:53.387Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:19:53.388Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.388Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:19:53.389Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.389Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:19:53.390Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.390Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:19:53.390Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.390Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:19:53.390Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.390Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:19:53.391Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.391Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:19:53.391Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.391Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:19:53.391Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.391Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:19:53.391Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.392Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:19:53.392Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.392Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:19:53.392Z] [LOG]    EPF/ETF calculated on: Rs.8548.45
[2025-10-23T05:19:53.392Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:19:53.392Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:19:53.393Z] [LOG] 💰 GROSS CALCULATION for Waruni null:
[2025-10-23T05:19:53.393Z] [LOG]    Base Salary: 50000
[2025-10-23T05:19:53.393Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:19:53.394Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:19:53.394Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.394Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:19:53.394Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.395Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:19:53.395Z] [LOG]    Fixed amount: 0
[2025-10-23T05:19:53.597Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:19:53.598Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:53.598Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:19:53.598Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:19:53.598Z] [LOG]    Actual Earned Base: Rs.8548.45
[2025-10-23T05:19:53.598Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:19:53.599Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:19:53.599Z] [LOG]    = Gross Salary: Rs.8548.45
[2025-10-23T05:19:53.599Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:19:53.599Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:19:53.600Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:19:53.600Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:53.600Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:19:53.601Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:19:53.601Z] [LOG]    Gross Salary: Rs.8548.45
[2025-10-23T05:19:53.601Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:19:53.601Z] [LOG]    = NET SALARY: Rs.8548.45
[2025-10-23T05:19:53.602Z] [LOG] 
💾 Database Update:
[2025-10-23T05:19:53.602Z] [LOG]    Total Earnings: Rs.8548.45 (Base: 8548.45 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:19:53.602Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:19:53.868Z] [LOG] 
📝 Components to save:
[2025-10-23T05:19:53.868Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:19:53.869Z] [LOG]    Deduction components: 1
[2025-10-23T05:19:53.869Z] [LOG] Creating components for record 44dd9334-7a2d-4da1-9f7b-68afb58994f6: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:19:53.870Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8548.451804966668
}
[2025-10-23T05:19:54.116Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:19:54.348Z] [LOG] Created payroll_record_component: 9f582b18-3152-448e-a0f2-c3fd1b722a98 for Base Salary
[2025-10-23T05:19:54.348Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T05:19:54.588Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:19:54.779Z] [LOG] Created payroll_record_component: 22f8bd5b-e40e-4643-8ba5-80bc8b191ece for Attendance Shortfall (Info)
[2025-10-23T05:19:55.206Z] [LOG] ✅ Financial balances updated successfully for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:55.207Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:19:55.207Z] [LOG] 
======================================================================
[2025-10-23T05:19:55.207Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Waruni null
[2025-10-23T05:19:55.207Z] [LOG] ======================================================================
[2025-10-23T05:19:55.207Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:19:55.208Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8548.45
[2025-10-23T05:19:55.208Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:19:55.208Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:55.208Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:19:55.208Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:19:55.208Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:55.208Z] [LOG]    GROSS SALARY: Rs.8548.45
[2025-10-23T05:19:55.209Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:55.209Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:19:55.209Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:19:55.210Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:19:55.210Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:19:55.210Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:19:55.210Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:19:55.211Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:19:55.211Z] [LOG]    NET SALARY: Rs.8548.45
[2025-10-23T05:19:55.211Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:19:55.211Z] [LOG] ======================================================================

[2025-10-23T05:19:55.212Z] [LOG] ✅ Waruni null: Calculation completed successfully
[2025-10-23T05:19:55.212Z] [LOG] 📊 Progress: 9/34 (26.5%)
[2025-10-23T05:19:55.212Z] [LOG] 
🧮 Processing: Viruna Damsiha Cooray null (EMP000038)
[2025-10-23T05:19:55.213Z] [LOG] 📋 Record ID: 46066a0c-93da-4fb8-bbed-bb2cc43a673e
[2025-10-23T05:19:55.213Z] [LOG] 
======================================================================
[2025-10-23T05:19:55.213Z] [LOG] 🧮 CALCULATING PAYROLL: Viruna Damsiha Cooray null (EMP000038)
[2025-10-23T05:19:55.214Z] [LOG] ======================================================================
[2025-10-23T05:19:56.192Z] [LOG] 🔍 Component filtering for employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-23T05:19:56.193Z] [LOG]    Total components: 13
[2025-10-23T05:19:56.193Z] [LOG]    Applicable components: 13
[2025-10-23T05:19:56.193Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:19:57.636Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:19:57.636Z] [LOG] 🔄 Processing financial records for employee 01441633-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:19:57.869Z] [LOG] 📊 Found 0 active loans for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:58.227Z] [LOG] 📊 Found 0 active advances for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:58.430Z] [LOG] 📊 Found 0 approved bonuses for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:58.431Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:19:58.431Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:19:58.668Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:19:58.669Z] [LOG]    Employee ID: 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T05:19:58.669Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:19:58.670Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:19:58.670Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:19:58.918Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:19:58.918Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:19:58.919Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:19:58.919Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:19:58.919Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:19:58.919Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:19:58.919Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:19:59.557Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:19:59.557Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:19:59.789Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:19:59.789Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:19:59.790Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:19:59.790Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:19:59.790Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:19:59.791Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:19:59.791Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:19:59.791Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:20:00.029Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:20:00.029Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:20:00.029Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:20:00.030Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:20:00.426Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:20:00.427Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:20:00.427Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:20:00.428Z] [LOG]       Current Time: 10:50:00
[2025-10-23T05:20:00.428Z] [LOG]       Expected Hours (scheduled → now): 2.33h
[2025-10-23T05:20:00.428Z] [LOG]       Actual Hours (check-in → now): 2.33h
[2025-10-23T05:20:00.428Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:20:00.429Z] [LOG]       Weekday: 121.33h
[2025-10-23T05:20:00.429Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:20:00.429Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:00.430Z] [LOG]       Total Expected: 134.83h
[2025-10-23T05:20:00.430Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:20:00.430Z] [LOG]       Weekday: 27.83h (includes 2.33h live)
[2025-10-23T05:20:00.430Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:20:00.431Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:00.431Z] [LOG]       Total Actual: 32.33h
[2025-10-23T05:20:00.431Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:20:00.431Z] [LOG]       Weekday: 121.33h × Rs.235.29 = Rs.28548.55
[2025-10-23T05:20:00.432Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:20:00.432Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:00.432Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:00.433Z] [LOG]       Total Expected Earned: Rs.34548.49
[2025-10-23T05:20:00.433Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:20:00.433Z] [LOG]       Weekday: 27.83h × Rs.235.29 = Rs.6548.93
[2025-10-23T05:20:00.434Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:20:00.434Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:00.434Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:00.435Z] [LOG]       Total Actual Earned: Rs.8548.91
[2025-10-23T05:20:00.435Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:20:00.436Z] [LOG]       Calculated At: Oct 23, 2025, 10:50:00
[2025-10-23T05:20:00.436Z] [LOG]       Expected Earned (until NOW): Rs.34548.49
[2025-10-23T05:20:00.436Z] [LOG]       Actual Earned (until NOW): Rs.8548.91
[2025-10-23T05:20:00.436Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:00.436Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:20:00.436Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:20:00.437Z] [LOG]       📉 Shortfall: 102.50 hours (75.26% of expected)
[2025-10-23T05:20:00.437Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:20:00.437Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:20:00.438Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:20:00.438Z] [LOG]    Actual Earned Base: Rs.8548.91
[2025-10-23T05:20:00.438Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:20:00.439Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:20:00.439Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:20:00.440Z] [LOG]    Gross Salary: 8548.91284265
[2025-10-23T05:20:00.440Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:20:00.441Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:20:00.441Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.442Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:20:00.442Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.442Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:20:00.443Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.443Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:20:00.443Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.443Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:20:00.443Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.443Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:20:00.443Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.443Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:20:00.444Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.444Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:20:00.444Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.444Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:20:00.444Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.445Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:20:00.445Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.445Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:20:00.445Z] [LOG]    EPF/ETF calculated on: Rs.8548.91
[2025-10-23T05:20:00.445Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:20:00.446Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:20:00.446Z] [LOG] 💰 GROSS CALCULATION for Viruna Damsiha Cooray null:
[2025-10-23T05:20:00.446Z] [LOG]    Base Salary: 50000
[2025-10-23T05:20:00.447Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:20:00.447Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:20:00.447Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.448Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:20:00.448Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.448Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:20:00.448Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:00.638Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:20:00.639Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:00.639Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:20:00.640Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:20:00.640Z] [LOG]    Actual Earned Base: Rs.8548.91
[2025-10-23T05:20:00.640Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:20:00.640Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:20:00.641Z] [LOG]    = Gross Salary: Rs.8548.91
[2025-10-23T05:20:00.641Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:20:00.641Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:20:00.642Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:20:00.642Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:00.642Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:20:00.642Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:20:00.642Z] [LOG]    Gross Salary: Rs.8548.91
[2025-10-23T05:20:00.643Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:20:00.643Z] [LOG]    = NET SALARY: Rs.8548.91
[2025-10-23T05:20:00.643Z] [LOG] 
💾 Database Update:
[2025-10-23T05:20:00.643Z] [LOG]    Total Earnings: Rs.8548.91 (Base: 8548.91 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:20:00.644Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:20:00.832Z] [LOG] 
📝 Components to save:
[2025-10-23T05:20:00.832Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:20:00.833Z] [LOG]    Deduction components: 1
[2025-10-23T05:20:00.833Z] [LOG] Creating components for record 46066a0c-93da-4fb8-bbed-bb2cc43a673e: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:20:00.833Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8548.91284265
}
[2025-10-23T05:20:01.024Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:20:01.435Z] [LOG] Created payroll_record_component: 6a0ab9a0-178c-4a6a-bcc8-572147203037 for Base Salary
[2025-10-23T05:20:01.435Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T05:20:01.631Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:20:01.822Z] [LOG] Created payroll_record_component: bd2adde4-e5d9-443a-a1ba-223975a2a8fb for Attendance Shortfall (Info)
[2025-10-23T05:20:02.271Z] [LOG] ✅ Financial balances updated successfully for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:02.271Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:20:02.271Z] [LOG] 
======================================================================
[2025-10-23T05:20:02.272Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Viruna Damsiha Cooray null
[2025-10-23T05:20:02.272Z] [LOG] ======================================================================
[2025-10-23T05:20:02.272Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:20:02.273Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8548.91
[2025-10-23T05:20:02.273Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:20:02.273Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:02.274Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:02.274Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:20:02.274Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:02.275Z] [LOG]    GROSS SALARY: Rs.8548.91
[2025-10-23T05:20:02.275Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:02.275Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:20:02.276Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:20:02.276Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:20:02.277Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:20:02.277Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:20:02.277Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:02.277Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:02.278Z] [LOG]    NET SALARY: Rs.8548.91
[2025-10-23T05:20:02.278Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:20:02.279Z] [LOG] ======================================================================

[2025-10-23T05:20:02.279Z] [LOG] ✅ Viruna Damsiha Cooray null: Calculation completed successfully
[2025-10-23T05:20:02.279Z] [LOG] 📊 Progress: 10/34 (29.4%)
[2025-10-23T05:20:02.280Z] [LOG] 
🧮 Processing: P.D.P Dilini Madushani null (EMP000043)
[2025-10-23T05:20:02.280Z] [LOG] 📋 Record ID: 474010c1-2627-43c4-be8b-32db1f25f2bc
[2025-10-23T05:20:02.280Z] [LOG] 
======================================================================
[2025-10-23T05:20:02.281Z] [LOG] 🧮 CALCULATING PAYROLL: P.D.P Dilini Madushani null (EMP000043)
[2025-10-23T05:20:02.281Z] [LOG] ======================================================================
[2025-10-23T05:20:03.159Z] [LOG] 🔍 Component filtering for employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-23T05:20:03.159Z] [LOG]    Total components: 13
[2025-10-23T05:20:03.159Z] [LOG]    Applicable components: 13
[2025-10-23T05:20:03.160Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:20:04.595Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:20:04.595Z] [LOG] 🔄 Processing financial records for employee 014435dc-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:20:04.830Z] [LOG] 📊 Found 0 active loans for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:05.025Z] [LOG] 📊 Found 0 active advances for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:05.246Z] [LOG] 📊 Found 0 approved bonuses for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:05.246Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:20:05.247Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:20:05.472Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:20:05.472Z] [LOG]    Employee ID: 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:05.473Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:20:05.473Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:20:05.473Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:20:05.682Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:20:05.682Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:20:05.683Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:20:05.683Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:20:05.683Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:20:05.683Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:20:05.684Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:20:06.349Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:20:06.350Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:20:06.598Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:20:06.598Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:20:06.599Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:20:06.599Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:20:06.599Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:20:06.600Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:20:06.600Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:20:06.600Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:20:06.837Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:20:06.837Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:20:06.838Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:20:06.838Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:20:07.069Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:20:07.070Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:20:07.070Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:20:07.071Z] [LOG]       Current Time: 10:50:07
[2025-10-23T05:20:07.071Z] [LOG]       Expected Hours (scheduled → now): 2.34h
[2025-10-23T05:20:07.072Z] [LOG]       Actual Hours (check-in → now): 2.34h
[2025-10-23T05:20:07.072Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:20:07.072Z] [LOG]       Weekday: 121.34h
[2025-10-23T05:20:07.072Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:20:07.073Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:07.073Z] [LOG]       Total Expected: 134.84h
[2025-10-23T05:20:07.073Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:20:07.073Z] [LOG]       Weekday: 27.84h (includes 2.34h live)
[2025-10-23T05:20:07.074Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:20:07.074Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:07.074Z] [LOG]       Total Actual: 32.34h
[2025-10-23T05:20:07.075Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:20:07.075Z] [LOG]       Weekday: 121.34h × Rs.235.29 = Rs.28548.98
[2025-10-23T05:20:07.075Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:20:07.075Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:07.076Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:07.076Z] [LOG]       Total Expected Earned: Rs.34548.92
[2025-10-23T05:20:07.076Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:20:07.077Z] [LOG]       Weekday: 27.84h × Rs.235.29 = Rs.6549.37
[2025-10-23T05:20:07.077Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:20:07.077Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:07.078Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:07.078Z] [LOG]       Total Actual Earned: Rs.8549.35
[2025-10-23T05:20:07.079Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:20:07.079Z] [LOG]       Calculated At: Oct 23, 2025, 10:50:07
[2025-10-23T05:20:07.080Z] [LOG]       Expected Earned (until NOW): Rs.34548.92
[2025-10-23T05:20:07.080Z] [LOG]       Actual Earned (until NOW): Rs.8549.35
[2025-10-23T05:20:07.080Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:07.081Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:20:07.081Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:20:07.082Z] [LOG]       📉 Shortfall: 102.50 hours (75.25% of expected)
[2025-10-23T05:20:07.082Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:20:07.082Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:20:07.083Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:20:07.083Z] [LOG]    Actual Earned Base: Rs.8549.35
[2025-10-23T05:20:07.083Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:20:07.084Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:20:07.084Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:20:07.084Z] [LOG]    Gross Salary: 8549.347018058334
[2025-10-23T05:20:07.085Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:20:07.085Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:20:07.085Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.085Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:20:07.086Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.086Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:20:07.086Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.087Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:20:07.087Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.088Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:20:07.088Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.089Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:20:07.089Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.090Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:20:07.090Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.090Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:20:07.091Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.091Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:20:07.091Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.092Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:20:07.092Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.092Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:20:07.092Z] [LOG]    EPF/ETF calculated on: Rs.8549.35
[2025-10-23T05:20:07.092Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:20:07.092Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:20:07.092Z] [LOG] 💰 GROSS CALCULATION for P.D.P Dilini Madushani null:
[2025-10-23T05:20:07.093Z] [LOG]    Base Salary: 50000
[2025-10-23T05:20:07.093Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:20:07.093Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:20:07.093Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.094Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:20:07.094Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.094Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:20:07.095Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:07.308Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:20:07.309Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:07.309Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:20:07.309Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:20:07.309Z] [LOG]    Actual Earned Base: Rs.8549.35
[2025-10-23T05:20:07.310Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:20:07.310Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:20:07.310Z] [LOG]    = Gross Salary: Rs.8549.35
[2025-10-23T05:20:07.311Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:20:07.311Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:20:07.311Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:20:07.312Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:07.312Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:20:07.312Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:20:07.313Z] [LOG]    Gross Salary: Rs.8549.35
[2025-10-23T05:20:07.313Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:20:07.313Z] [LOG]    = NET SALARY: Rs.8549.35
[2025-10-23T05:20:07.313Z] [LOG] 
💾 Database Update:
[2025-10-23T05:20:07.314Z] [LOG]    Total Earnings: Rs.8549.35 (Base: 8549.35 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:20:07.314Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:20:07.550Z] [LOG] 
📝 Components to save:
[2025-10-23T05:20:07.550Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:20:07.550Z] [LOG]    Deduction components: 1
[2025-10-23T05:20:07.551Z] [LOG] Creating components for record 474010c1-2627-43c4-be8b-32db1f25f2bc: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:20:07.551Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8549.347018058334
}
[2025-10-23T05:20:07.789Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:20:08.028Z] [LOG] Created payroll_record_component: ef89d9be-fe5b-464f-b694-289246892f3d for Base Salary
[2025-10-23T05:20:08.029Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T05:20:08.270Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:20:08.508Z] [LOG] Created payroll_record_component: 130e3913-7d3e-46e4-b403-84bcf7ad1bd9 for Attendance Shortfall (Info)
[2025-10-23T05:20:08.988Z] [LOG] ✅ Financial balances updated successfully for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:08.989Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:20:08.989Z] [LOG] 
======================================================================
[2025-10-23T05:20:08.989Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: P.D.P Dilini Madushani null
[2025-10-23T05:20:08.990Z] [LOG] ======================================================================
[2025-10-23T05:20:08.990Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:20:08.991Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8549.35
[2025-10-23T05:20:08.991Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:20:08.991Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:08.992Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:08.992Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:20:08.993Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:08.993Z] [LOG]    GROSS SALARY: Rs.8549.35
[2025-10-23T05:20:08.993Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:08.994Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:20:08.994Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:20:08.994Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:20:08.995Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:20:08.995Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:20:08.995Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:08.996Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:08.996Z] [LOG]    NET SALARY: Rs.8549.35
[2025-10-23T05:20:08.996Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:20:08.997Z] [LOG] ======================================================================

[2025-10-23T05:20:08.997Z] [LOG] ✅ P.D.P Dilini Madushani null: Calculation completed successfully
[2025-10-23T05:20:08.998Z] [LOG] 📊 Progress: 11/34 (32.4%)
[2025-10-23T05:20:08.998Z] [LOG] 
🧮 Processing: Shandeep null (EMP000034)
[2025-10-23T05:20:08.998Z] [LOG] 📋 Record ID: 48671b3f-d0df-47ee-be28-594a6971f1ca
[2025-10-23T05:20:08.999Z] [LOG] 
======================================================================
[2025-10-23T05:20:08.999Z] [LOG] 🧮 CALCULATING PAYROLL: Shandeep null (EMP000034)
[2025-10-23T05:20:08.999Z] [LOG] ======================================================================
[2025-10-23T05:20:09.955Z] [LOG] 🔍 Component filtering for employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-23T05:20:09.956Z] [LOG]    Total components: 13
[2025-10-23T05:20:09.956Z] [LOG]    Applicable components: 13
[2025-10-23T05:20:09.957Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:20:11.405Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:20:11.405Z] [LOG] 🔄 Processing financial records for employee 0143fc5a-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:20:11.639Z] [LOG] 📊 Found 0 active loans for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:11.879Z] [LOG] 📊 Found 0 active advances for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:12.070Z] [LOG] 📊 Found 0 approved bonuses for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:12.071Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:20:12.071Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:20:12.280Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:20:12.281Z] [LOG]    Employee ID: 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:12.281Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:20:12.281Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:20:12.282Z] [LOG]    Base Salary (Full Month): Rs.80000.00
[2025-10-23T05:20:12.522Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:20:12.522Z] [LOG]       Daily Salary: Rs.3200.00
[2025-10-23T05:20:12.522Z] [LOG]       Weekday Hourly Rate: Rs.376.47
[2025-10-23T05:20:12.523Z] [LOG]       Saturday Hourly Rate: Rs.711.11
[2025-10-23T05:20:12.523Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:20:12.523Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:20:12.524Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:20:13.221Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:20:13.222Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:20:13.479Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:20:13.480Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:20:13.480Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:20:13.480Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:20:13.481Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:20:13.481Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:20:13.481Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:20:13.482Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:20:13.711Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:20:13.711Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:20:13.711Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:20:13.712Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:20:13.957Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:20:13.957Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:20:13.958Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:20:13.958Z] [LOG]       Current Time: 10:50:13
[2025-10-23T05:20:13.959Z] [LOG]       Expected Hours (scheduled → now): 2.34h
[2025-10-23T05:20:13.959Z] [LOG]       Actual Hours (check-in → now): 2.34h
[2025-10-23T05:20:13.959Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:20:13.960Z] [LOG]       Weekday: 121.34h
[2025-10-23T05:20:13.960Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:20:13.960Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:13.961Z] [LOG]       Total Expected: 134.84h
[2025-10-23T05:20:13.961Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:20:13.961Z] [LOG]       Weekday: 27.84h (includes 2.34h live)
[2025-10-23T05:20:13.961Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:20:13.962Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:13.962Z] [LOG]       Total Actual: 32.34h
[2025-10-23T05:20:13.962Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:20:13.963Z] [LOG]       Weekday: 121.34h × Rs.376.47 = Rs.45679.82
[2025-10-23T05:20:13.963Z] [LOG]       Saturday: 13.50h × Rs.711.11 = Rs.9599.99
[2025-10-23T05:20:13.963Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:13.964Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:13.964Z] [LOG]       Total Expected Earned: Rs.55279.80
[2025-10-23T05:20:13.964Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:20:13.965Z] [LOG]       Weekday: 27.84h × Rs.376.47 = Rs.10479.87
[2025-10-23T05:20:13.965Z] [LOG]       Saturday: 4.50h × Rs.711.11 = Rs.3199.99
[2025-10-23T05:20:13.965Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:13.965Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:13.966Z] [LOG]       Total Actual Earned: Rs.13679.87
[2025-10-23T05:20:13.967Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:20:13.967Z] [LOG]       Calculated At: Oct 23, 2025, 10:50:13
[2025-10-23T05:20:13.967Z] [LOG]       Expected Earned (until NOW): Rs.55279.80
[2025-10-23T05:20:13.967Z] [LOG]       Actual Earned (until NOW): Rs.13679.87
[2025-10-23T05:20:13.968Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:13.968Z] [LOG]       Attendance Deduction: Rs.41599.93
[2025-10-23T05:20:13.968Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:20:13.969Z] [LOG]       📉 Shortfall: 102.50 hours (75.25% of expected)
[2025-10-23T05:20:13.969Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:20:13.969Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:20:13.970Z] [LOG]    Base Salary (Full): Rs.80000.00
[2025-10-23T05:20:13.970Z] [LOG]    Actual Earned Base: Rs.13679.87
[2025-10-23T05:20:13.971Z] [LOG]    Attendance Shortfall: Rs.41599.93
[2025-10-23T05:20:13.971Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:20:13.971Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:20:13.972Z] [LOG]    Gross Salary: 13679.869553275003
[2025-10-23T05:20:13.972Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:20:13.973Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:20:13.974Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.974Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:20:13.974Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.975Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:20:13.975Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.975Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:20:13.976Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.976Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:20:13.976Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.976Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:20:13.977Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.977Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:20:13.977Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.978Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:20:13.978Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.978Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:20:13.979Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.980Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:20:13.980Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.980Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:20:13.981Z] [LOG]    EPF/ETF calculated on: Rs.13679.87
[2025-10-23T05:20:13.981Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:20:13.982Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:20:13.982Z] [LOG] 💰 GROSS CALCULATION for Shandeep null:
[2025-10-23T05:20:13.982Z] [LOG]    Base Salary: 80000
[2025-10-23T05:20:13.982Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:20:13.983Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:20:13.983Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.983Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:20:13.984Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:13.984Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:20:13.984Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:14.192Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:20:14.192Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:14.193Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:20:14.193Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:20:14.194Z] [LOG]    Actual Earned Base: Rs.13679.87
[2025-10-23T05:20:14.194Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:20:14.194Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:20:14.194Z] [LOG]    = Gross Salary: Rs.13679.87
[2025-10-23T05:20:14.195Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:20:14.195Z] [LOG]    Attendance Shortfall (Info): Rs.41599.93
[2025-10-23T05:20:14.195Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:20:14.196Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:14.196Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:20:14.196Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:20:14.197Z] [LOG]    Gross Salary: Rs.13679.87
[2025-10-23T05:20:14.197Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:20:14.197Z] [LOG]    = NET SALARY: Rs.13679.87
[2025-10-23T05:20:14.198Z] [LOG] 
💾 Database Update:
[2025-10-23T05:20:14.198Z] [LOG]    Total Earnings: Rs.13679.87 (Base: 13679.87 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:20:14.199Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:20:14.429Z] [LOG] 
📝 Components to save:
[2025-10-23T05:20:14.430Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:20:14.430Z] [LOG]    Deduction components: 1
[2025-10-23T05:20:14.431Z] [LOG] Creating components for record 48671b3f-d0df-47ee-be28-594a6971f1ca: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:20:14.431Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 13679.869553275003
}
[2025-10-23T05:20:14.672Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:20:14.908Z] [LOG] Created payroll_record_component: ab54393f-cb67-48c0-ae36-99e34c7e63d6 for Base Salary
[2025-10-23T05:20:14.909Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 41599.935
}
[2025-10-23T05:20:15.101Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:20:15.309Z] [LOG] Created payroll_record_component: cfa9c98b-894b-412b-86be-8f7cb7606ffc for Attendance Shortfall (Info)
[2025-10-23T05:20:15.876Z] [LOG] ✅ Financial balances updated successfully for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:15.877Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:20:15.877Z] [LOG] 
======================================================================
[2025-10-23T05:20:15.878Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Shandeep null
[2025-10-23T05:20:15.878Z] [LOG] ======================================================================
[2025-10-23T05:20:15.878Z] [LOG]    Base Salary (Full): Rs.80000.00
[2025-10-23T05:20:15.879Z] [LOG]    Actual Earned Base (Attendance-based): Rs.13679.87
[2025-10-23T05:20:15.879Z] [LOG]    Attendance Shortfall: Rs.41599.93
[2025-10-23T05:20:15.879Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:15.880Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:15.880Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:20:15.880Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:15.881Z] [LOG]    GROSS SALARY: Rs.13679.87
[2025-10-23T05:20:15.881Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:15.881Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:20:15.882Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:20:15.882Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:20:15.882Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:20:15.882Z] [LOG]       - Attendance Shortfall (Info): Rs.41599.93
[2025-10-23T05:20:15.883Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:15.883Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:15.883Z] [LOG]    NET SALARY: Rs.13679.87
[2025-10-23T05:20:15.883Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:20:15.884Z] [LOG] ======================================================================

[2025-10-23T05:20:15.884Z] [LOG] ✅ Shandeep null: Calculation completed successfully
[2025-10-23T05:20:15.884Z] [LOG] 📊 Progress: 12/34 (35.3%)
[2025-10-23T05:20:15.885Z] [LOG] 
🧮 Processing: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-23T05:20:15.885Z] [LOG] 📋 Record ID: 5d85beae-9108-4380-821e-6eb0709a9f54
[2025-10-23T05:20:15.885Z] [LOG] 
======================================================================
[2025-10-23T05:20:15.886Z] [LOG] 🧮 CALCULATING PAYROLL: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-23T05:20:15.886Z] [LOG] ======================================================================
[2025-10-23T05:20:16.846Z] [LOG] 🔍 Component filtering for employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-23T05:20:16.846Z] [LOG]    Total components: 13
[2025-10-23T05:20:16.847Z] [LOG]    Applicable components: 13
[2025-10-23T05:20:16.847Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:20:18.202Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:20:18.203Z] [LOG] 🔄 Processing financial records for employee 0144461e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:20:18.438Z] [LOG] 📊 Found 0 active loans for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:18.648Z] [LOG] 📊 Found 0 active advances for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:19.055Z] [LOG] 📊 Found 0 approved bonuses for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:19.056Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:20:19.057Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:20:19.263Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:20:19.263Z] [LOG]    Employee ID: 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:19.263Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:20:19.264Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:20:19.264Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:20:19.492Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:20:19.492Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:20:19.492Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:20:19.493Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:20:19.493Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:20:19.493Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:20:19.494Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:20:20.194Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:20:20.194Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:20:20.387Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:20:20.388Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:20:20.388Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:20:20.388Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:20:20.388Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:20:20.389Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:20:20.389Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:20:20.389Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:20:20.597Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:20:20.598Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:20:20.598Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:20:20.598Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:20:20.843Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:20:20.843Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:20:20.844Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:20:20.844Z] [LOG]       Current Time: 10:50:20
[2025-10-23T05:20:20.845Z] [LOG]       Expected Hours (scheduled → now): 2.34h
[2025-10-23T05:20:20.845Z] [LOG]       Actual Hours (check-in → now): 2.34h
[2025-10-23T05:20:20.845Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:20:20.845Z] [LOG]       Weekday: 121.34h
[2025-10-23T05:20:20.846Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:20:20.846Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:20.846Z] [LOG]       Total Expected: 134.84h
[2025-10-23T05:20:20.847Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:20:20.847Z] [LOG]       Weekday: 27.84h (includes 2.34h live)
[2025-10-23T05:20:20.847Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:20:20.847Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:20.848Z] [LOG]       Total Actual: 32.34h
[2025-10-23T05:20:20.848Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:20:20.848Z] [LOG]       Weekday: 121.34h × Rs.235.29 = Rs.28549.88
[2025-10-23T05:20:20.848Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:20:20.849Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:20.849Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:20.849Z] [LOG]       Total Expected Earned: Rs.34549.82
[2025-10-23T05:20:20.850Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:20:20.850Z] [LOG]       Weekday: 27.84h × Rs.235.29 = Rs.6550.27
[2025-10-23T05:20:20.850Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:20:20.850Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:20.851Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:20.851Z] [LOG]       Total Actual Earned: Rs.8550.25
[2025-10-23T05:20:20.852Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:20:20.852Z] [LOG]       Calculated At: Oct 23, 2025, 10:50:20
[2025-10-23T05:20:20.852Z] [LOG]       Expected Earned (until NOW): Rs.34549.82
[2025-10-23T05:20:20.853Z] [LOG]       Actual Earned (until NOW): Rs.8550.25
[2025-10-23T05:20:20.853Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:20.853Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:20:20.854Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:20:20.854Z] [LOG]       📉 Shortfall: 102.50 hours (75.25% of expected)
[2025-10-23T05:20:20.854Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:20:20.855Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:20:20.855Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:20:20.855Z] [LOG]    Actual Earned Base: Rs.8550.25
[2025-10-23T05:20:20.855Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:20:20.856Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:20:20.856Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:20:20.857Z] [LOG]    Gross Salary: 8550.247263741667
[2025-10-23T05:20:20.857Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:20:20.857Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:20:20.858Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.858Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:20:20.858Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.859Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:20:20.859Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.859Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:20:20.859Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.860Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:20:20.860Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.860Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:20:20.861Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.861Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:20:20.861Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.862Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:20:20.862Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.862Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:20:20.863Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.863Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:20:20.863Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.864Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:20:20.864Z] [LOG]    EPF/ETF calculated on: Rs.8550.25
[2025-10-23T05:20:20.864Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:20:20.865Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:20:20.865Z] [LOG] 💰 GROSS CALCULATION for Ashen Nirmal Wadugodapitiya null:
[2025-10-23T05:20:20.865Z] [LOG]    Base Salary: 50000
[2025-10-23T05:20:20.866Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:20:20.866Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:20:20.866Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.866Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:20:20.867Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:20.867Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:20:20.867Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:21.266Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:20:21.267Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:21.267Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:20:21.267Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:20:21.268Z] [LOG]    Actual Earned Base: Rs.8550.25
[2025-10-23T05:20:21.268Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:20:21.268Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:20:21.269Z] [LOG]    = Gross Salary: Rs.8550.25
[2025-10-23T05:20:21.269Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:20:21.269Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:20:21.270Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:20:21.270Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:21.270Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:20:21.271Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:20:21.271Z] [LOG]    Gross Salary: Rs.8550.25
[2025-10-23T05:20:21.271Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:20:21.271Z] [LOG]    = NET SALARY: Rs.8550.25
[2025-10-23T05:20:21.272Z] [LOG] 
💾 Database Update:
[2025-10-23T05:20:21.272Z] [LOG]    Total Earnings: Rs.8550.25 (Base: 8550.25 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:20:21.272Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:20:21.477Z] [LOG] 
📝 Components to save:
[2025-10-23T05:20:21.477Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:20:21.478Z] [LOG]    Deduction components: 1
[2025-10-23T05:20:21.478Z] [LOG] Creating components for record 5d85beae-9108-4380-821e-6eb0709a9f54: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:20:21.479Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8550.247263741667
}
[2025-10-23T05:20:21.722Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:20:21.949Z] [LOG] Created payroll_record_component: fcac200a-06bc-4dae-b68b-492b5106634c for Base Salary
[2025-10-23T05:20:21.950Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T05:20:22.198Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:20:22.432Z] [LOG] Created payroll_record_component: 089e8274-6554-4b5d-8914-3b49ee526831 for Attendance Shortfall (Info)
[2025-10-23T05:20:22.908Z] [LOG] ✅ Financial balances updated successfully for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:22.909Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:20:22.909Z] [LOG] 
======================================================================
[2025-10-23T05:20:22.909Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ashen Nirmal Wadugodapitiya null
[2025-10-23T05:20:22.910Z] [LOG] ======================================================================
[2025-10-23T05:20:22.910Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:20:22.910Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8550.25
[2025-10-23T05:20:22.911Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:20:22.911Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:22.911Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:22.912Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:20:22.912Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:22.912Z] [LOG]    GROSS SALARY: Rs.8550.25
[2025-10-23T05:20:22.912Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:22.913Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:20:22.913Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:20:22.913Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:20:22.914Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:20:22.914Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:20:22.914Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:22.915Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:22.915Z] [LOG]    NET SALARY: Rs.8550.25
[2025-10-23T05:20:22.915Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:20:22.916Z] [LOG] ======================================================================

[2025-10-23T05:20:22.916Z] [LOG] ✅ Ashen Nirmal Wadugodapitiya null: Calculation completed successfully
[2025-10-23T05:20:22.916Z] [LOG] 📊 Progress: 13/34 (38.2%)
[2025-10-23T05:20:22.917Z] [LOG] 
🧮 Processing: Office Team null (EMP000041)
[2025-10-23T05:20:22.917Z] [LOG] 📋 Record ID: 64471b91-429b-436f-bd25-d2aa2df6541c
[2025-10-23T05:20:22.917Z] [LOG] 
======================================================================
[2025-10-23T05:20:22.918Z] [LOG] 🧮 CALCULATING PAYROLL: Office Team null (EMP000041)
[2025-10-23T05:20:22.918Z] [LOG] ======================================================================
[2025-10-23T05:20:23.870Z] [LOG] 🔍 Component filtering for employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-23T05:20:23.871Z] [LOG]    Total components: 13
[2025-10-23T05:20:23.871Z] [LOG]    Applicable components: 13
[2025-10-23T05:20:23.872Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:20:25.389Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:20:25.390Z] [LOG] 🔄 Processing financial records for employee 01442b21-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:20:25.629Z] [LOG] 📊 Found 0 active loans for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:25.823Z] [LOG] 📊 Found 0 active advances for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:26.029Z] [LOG] 📊 Found 0 approved bonuses for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:26.029Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:20:26.030Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:20:26.291Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:20:26.292Z] [LOG]    Employee ID: 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:26.292Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:20:26.292Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:20:26.293Z] [LOG]    Base Salary (Full Month): Rs.1.00
[2025-10-23T05:20:26.511Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:20:26.511Z] [LOG]       Daily Salary: Rs.0.04
[2025-10-23T05:20:26.511Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T05:20:26.512Z] [LOG]       Saturday Hourly Rate: Rs.0.01
[2025-10-23T05:20:26.512Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:20:26.512Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:20:26.513Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:20:27.165Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:20:27.165Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:20:27.391Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:20:27.391Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:20:27.391Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:20:27.392Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:20:27.392Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:20:27.393Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:20:27.393Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:20:27.393Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:20:27.630Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:20:27.630Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:20:27.631Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:20:27.631Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:20:27.874Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:20:27.875Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:20:27.875Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:20:27.876Z] [LOG]       Current Time: 10:50:27
[2025-10-23T05:20:27.876Z] [LOG]       Expected Hours (scheduled → now): 2.34h
[2025-10-23T05:20:27.876Z] [LOG]       Actual Hours (check-in → now): 2.34h
[2025-10-23T05:20:27.877Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:20:27.877Z] [LOG]       Weekday: 121.34h
[2025-10-23T05:20:27.877Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:20:27.877Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:27.878Z] [LOG]       Total Expected: 134.84h
[2025-10-23T05:20:27.878Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:20:27.878Z] [LOG]       Weekday: 27.84h (includes 2.34h live)
[2025-10-23T05:20:27.878Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:20:27.879Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:27.879Z] [LOG]       Total Actual: 32.34h
[2025-10-23T05:20:27.879Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:20:27.879Z] [LOG]       Weekday: 121.34h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:27.880Z] [LOG]       Saturday: 13.50h × Rs.0.01 = Rs.0.14
[2025-10-23T05:20:27.880Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:27.880Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:27.881Z] [LOG]       Total Expected Earned: Rs.0.14
[2025-10-23T05:20:27.881Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:20:27.881Z] [LOG]       Weekday: 27.84h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:27.881Z] [LOG]       Saturday: 4.50h × Rs.0.01 = Rs.0.04
[2025-10-23T05:20:27.882Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:27.882Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:27.882Z] [LOG]       Total Actual Earned: Rs.0.04
[2025-10-23T05:20:27.883Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:20:27.883Z] [LOG]       Calculated At: Oct 23, 2025, 10:50:27
[2025-10-23T05:20:27.884Z] [LOG]       Expected Earned (until NOW): Rs.0.14
[2025-10-23T05:20:27.884Z] [LOG]       Actual Earned (until NOW): Rs.0.04
[2025-10-23T05:20:27.884Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:27.885Z] [LOG]       Attendance Deduction: Rs.0.09
[2025-10-23T05:20:27.885Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:20:27.885Z] [LOG]       📉 Shortfall: 102.50 hours (66.67% of expected)
[2025-10-23T05:20:27.885Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:20:27.886Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:20:27.886Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T05:20:27.886Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T05:20:27.887Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T05:20:27.887Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:20:27.888Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:20:27.888Z] [LOG]    Gross Salary: 0.045
[2025-10-23T05:20:27.888Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:20:27.889Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:20:27.890Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.890Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:20:27.890Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.890Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:20:27.891Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.891Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:20:27.891Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.891Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:20:27.891Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.891Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:20:27.892Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.892Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:20:27.892Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.892Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:20:27.892Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.893Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:20:27.893Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.893Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:20:27.893Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.893Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:20:27.893Z] [LOG]    EPF/ETF calculated on: Rs.0.04
[2025-10-23T05:20:27.893Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:20:27.894Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:20:27.894Z] [LOG] 💰 GROSS CALCULATION for Office Team null:
[2025-10-23T05:20:27.894Z] [LOG]    Base Salary: 1
[2025-10-23T05:20:27.895Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:20:27.896Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:20:27.896Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.896Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:20:27.897Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:27.897Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:20:27.898Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:28.108Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:20:28.108Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:28.108Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:20:28.108Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:20:28.109Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T05:20:28.109Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:20:28.109Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:20:28.110Z] [LOG]    = Gross Salary: Rs.0.04
[2025-10-23T05:20:28.110Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:20:28.110Z] [LOG]    Attendance Shortfall (Info): Rs.0.09
[2025-10-23T05:20:28.111Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:20:28.111Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:28.111Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:20:28.112Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:20:28.112Z] [LOG]    Gross Salary: Rs.0.04
[2025-10-23T05:20:28.112Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:20:28.113Z] [LOG]    = NET SALARY: Rs.0.04
[2025-10-23T05:20:28.113Z] [LOG] 
💾 Database Update:
[2025-10-23T05:20:28.113Z] [LOG]    Total Earnings: Rs.0.04 (Base: 0.04 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:20:28.114Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:20:28.349Z] [LOG] 
📝 Components to save:
[2025-10-23T05:20:28.349Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:20:28.350Z] [LOG]    Deduction components: 1
[2025-10-23T05:20:28.350Z] [LOG] Creating components for record 64471b91-429b-436f-bd25-d2aa2df6541c: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:20:28.351Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 0.045
}
[2025-10-23T05:20:28.591Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:20:28.829Z] [LOG] Created payroll_record_component: 322fcbaa-4c9a-4c42-8892-fa4c88349410 for Base Salary
[2025-10-23T05:20:28.829Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 0.09000000000000001
}
[2025-10-23T05:20:29.070Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:20:29.308Z] [LOG] Created payroll_record_component: 53cb827d-96bf-4b00-8af1-3c809c8fa31c for Attendance Shortfall (Info)
[2025-10-23T05:20:29.800Z] [LOG] ✅ Financial balances updated successfully for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:29.800Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:20:29.801Z] [LOG] 
======================================================================
[2025-10-23T05:20:29.801Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Office Team null
[2025-10-23T05:20:29.801Z] [LOG] ======================================================================
[2025-10-23T05:20:29.802Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T05:20:29.802Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.04
[2025-10-23T05:20:29.802Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T05:20:29.803Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:29.803Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:29.803Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:20:29.804Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:29.804Z] [LOG]    GROSS SALARY: Rs.0.04
[2025-10-23T05:20:29.804Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:29.805Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:20:29.805Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:20:29.805Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:20:29.806Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:20:29.807Z] [LOG]       - Attendance Shortfall (Info): Rs.0.09
[2025-10-23T05:20:29.807Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:29.808Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:29.808Z] [LOG]    NET SALARY: Rs.0.04
[2025-10-23T05:20:29.809Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:20:29.809Z] [LOG] ======================================================================

[2025-10-23T05:20:29.809Z] [LOG] ✅ Office Team null: Calculation completed successfully
[2025-10-23T05:20:29.810Z] [LOG] 📊 Progress: 14/34 (41.2%)
[2025-10-23T05:20:29.810Z] [LOG] 
🧮 Processing: Anoj null (EMP000014)
[2025-10-23T05:20:29.811Z] [LOG] 📋 Record ID: 64eba6c6-267d-4a3a-b253-9dbe1ee4da54
[2025-10-23T05:20:29.811Z] [LOG] 
======================================================================
[2025-10-23T05:20:29.811Z] [LOG] 🧮 CALCULATING PAYROLL: Anoj null (EMP000014)
[2025-10-23T05:20:29.811Z] [LOG] ======================================================================
[2025-10-23T05:20:30.695Z] [LOG] 🔍 Component filtering for employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-23T05:20:30.695Z] [LOG]    Total components: 13
[2025-10-23T05:20:30.695Z] [LOG]    Applicable components: 13
[2025-10-23T05:20:30.696Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:20:32.200Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:20:32.200Z] [LOG] 🔄 Processing financial records for employee 0143afc6-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:20:32.401Z] [LOG] 📊 Found 0 active loans for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:32.606Z] [LOG] 📊 Found 0 active advances for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:32.864Z] [LOG] 📊 Found 0 approved bonuses for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:32.865Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:20:32.865Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:20:33.170Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:20:33.171Z] [LOG]    Employee ID: 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:33.171Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:20:33.172Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:20:33.172Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:20:33.391Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:20:33.391Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:20:33.391Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:20:33.392Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:20:33.392Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:20:33.393Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:20:33.393Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:20:34.110Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:20:34.110Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:20:34.350Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:20:34.351Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:20:34.351Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:20:34.351Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:20:34.352Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:20:34.352Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:20:34.352Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:20:34.353Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:20:34.592Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:20:34.592Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:20:34.592Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:20:34.593Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:20:34.845Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:20:34.845Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:20:34.845Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:20:34.846Z] [LOG]       Current Time: 10:50:34
[2025-10-23T05:20:34.847Z] [LOG]       Expected Hours (scheduled → now): 2.34h
[2025-10-23T05:20:34.847Z] [LOG]       Actual Hours (check-in → now): 2.34h
[2025-10-23T05:20:34.847Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:20:34.847Z] [LOG]       Weekday: 121.34h
[2025-10-23T05:20:34.848Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:20:34.848Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:34.848Z] [LOG]       Total Expected: 134.84h
[2025-10-23T05:20:34.848Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:20:34.849Z] [LOG]       Weekday: 27.84h (includes 2.34h live)
[2025-10-23T05:20:34.849Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:20:34.849Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:34.850Z] [LOG]       Total Actual: 32.34h
[2025-10-23T05:20:34.850Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:20:34.850Z] [LOG]       Weekday: 121.34h × Rs.235.29 = Rs.28550.80
[2025-10-23T05:20:34.851Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:20:34.851Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:34.851Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:34.852Z] [LOG]       Total Expected Earned: Rs.34550.74
[2025-10-23T05:20:34.852Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:20:34.853Z] [LOG]       Weekday: 27.84h × Rs.235.29 = Rs.6551.18
[2025-10-23T05:20:34.853Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:20:34.853Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:34.853Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:34.854Z] [LOG]       Total Actual Earned: Rs.8551.16
[2025-10-23T05:20:34.854Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:20:34.855Z] [LOG]       Calculated At: Oct 23, 2025, 10:50:34
[2025-10-23T05:20:34.855Z] [LOG]       Expected Earned (until NOW): Rs.34550.74
[2025-10-23T05:20:34.855Z] [LOG]       Actual Earned (until NOW): Rs.8551.16
[2025-10-23T05:20:34.856Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:34.857Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:20:34.857Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:20:34.858Z] [LOG]       📉 Shortfall: 102.50 hours (75.25% of expected)
[2025-10-23T05:20:34.858Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:20:34.859Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:20:34.859Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:20:34.859Z] [LOG]    Actual Earned Base: Rs.8551.16
[2025-10-23T05:20:34.859Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:20:34.860Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:20:34.860Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:20:34.861Z] [LOG]    Gross Salary: 8551.162411125
[2025-10-23T05:20:34.862Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:20:34.862Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:20:34.862Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.863Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:20:34.863Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.864Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:20:34.864Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.864Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:20:34.865Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.865Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:20:34.865Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.866Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:20:34.866Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.866Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:20:34.866Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.867Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:20:34.867Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.867Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:20:34.868Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.868Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:20:34.868Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.869Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:20:34.869Z] [LOG]    EPF/ETF calculated on: Rs.8551.16
[2025-10-23T05:20:34.869Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:20:34.869Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:20:34.870Z] [LOG] 💰 GROSS CALCULATION for Anoj null:
[2025-10-23T05:20:34.870Z] [LOG]    Base Salary: 50000
[2025-10-23T05:20:34.870Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:20:34.871Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:20:34.871Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.871Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:20:34.871Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:34.872Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:20:34.872Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:35.152Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:20:35.152Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:35.153Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:20:35.153Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:20:35.153Z] [LOG]    Actual Earned Base: Rs.8551.16
[2025-10-23T05:20:35.155Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:20:35.155Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:20:35.156Z] [LOG]    = Gross Salary: Rs.8551.16
[2025-10-23T05:20:35.156Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:20:35.156Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:20:35.157Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:20:35.157Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:35.157Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:20:35.158Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:20:35.158Z] [LOG]    Gross Salary: Rs.8551.16
[2025-10-23T05:20:35.159Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:20:35.159Z] [LOG]    = NET SALARY: Rs.8551.16
[2025-10-23T05:20:35.159Z] [LOG] 
💾 Database Update:
[2025-10-23T05:20:35.160Z] [LOG]    Total Earnings: Rs.8551.16 (Base: 8551.16 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:20:35.160Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:20:35.389Z] [LOG] 
📝 Components to save:
[2025-10-23T05:20:35.389Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:20:35.389Z] [LOG]    Deduction components: 1
[2025-10-23T05:20:35.390Z] [LOG] Creating components for record 64eba6c6-267d-4a3a-b253-9dbe1ee4da54: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:20:35.391Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8551.162411125
}
[2025-10-23T05:20:35.630Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:20:35.823Z] [LOG] Created payroll_record_component: a5572f28-a3b5-400f-a4a8-36b0159c377f for Base Salary
[2025-10-23T05:20:35.824Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T05:20:36.031Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:20:36.269Z] [LOG] Created payroll_record_component: 075c36a8-70d7-44a2-96d1-2714884b8920 for Attendance Shortfall (Info)
[2025-10-23T05:20:36.669Z] [LOG] ✅ Financial balances updated successfully for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:36.669Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:20:36.669Z] [LOG] 
======================================================================
[2025-10-23T05:20:36.670Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Anoj null
[2025-10-23T05:20:36.670Z] [LOG] ======================================================================
[2025-10-23T05:20:36.670Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:20:36.671Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8551.16
[2025-10-23T05:20:36.671Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:20:36.671Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:36.672Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:36.672Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:20:36.672Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:36.673Z] [LOG]    GROSS SALARY: Rs.8551.16
[2025-10-23T05:20:36.673Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:36.673Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:20:36.674Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:20:36.674Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:20:36.675Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:20:36.675Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:20:36.675Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:36.676Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:36.676Z] [LOG]    NET SALARY: Rs.8551.16
[2025-10-23T05:20:36.676Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:20:36.677Z] [LOG] ======================================================================

[2025-10-23T05:20:36.677Z] [LOG] ✅ Anoj null: Calculation completed successfully
[2025-10-23T05:20:36.677Z] [LOG] 📊 Progress: 15/34 (44.1%)
[2025-10-23T05:20:36.678Z] [LOG] 
🧮 Processing: Faizan Faizan (EMP000003)
[2025-10-23T05:20:36.678Z] [LOG] 📋 Record ID: 75bb662b-eb79-476d-b110-07838e51b59b
[2025-10-23T05:20:36.678Z] [LOG] 
======================================================================
[2025-10-23T05:20:36.679Z] [LOG] 🧮 CALCULATING PAYROLL: Faizan Faizan (EMP000003)
[2025-10-23T05:20:36.679Z] [LOG] ======================================================================
[2025-10-23T05:20:37.631Z] [LOG] 🔍 Component filtering for employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-23T05:20:37.631Z] [LOG]    Total components: 13
[2025-10-23T05:20:37.631Z] [LOG]    Applicable components: 13
[2025-10-23T05:20:37.632Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T05:20:39.556Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:20:39.557Z] [LOG] 🔄 Processing financial records for employee 0143a057-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:20:39.789Z] [LOG] 📊 Found 0 active loans for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:40.045Z] [LOG] 📊 Found 0 active advances for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:40.271Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:40.272Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:20:40.273Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:20:40.665Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:20:40.666Z] [LOG]    Employee ID: 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:40.666Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:20:40.666Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:20:40.666Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:20:40.873Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:20:40.874Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:20:40.874Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:20:40.874Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:20:40.874Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:20:40.874Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:20:40.875Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:20:41.549Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:20:41.549Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:20:41.737Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:20:41.737Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:20:41.737Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:20:41.737Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:20:41.738Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:20:41.738Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:20:41.738Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:20:41.738Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:20:41.933Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:20:41.933Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:20:41.933Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:20:41.933Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:20:42.131Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:20:42.132Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:20:42.132Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:20:42.133Z] [LOG]       Current Time: 10:50:42
[2025-10-23T05:20:42.133Z] [LOG]       Expected Hours (scheduled → now): 2.35h
[2025-10-23T05:20:42.133Z] [LOG]       Actual Hours (check-in → now): 2.35h
[2025-10-23T05:20:42.134Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:20:42.134Z] [LOG]       Weekday: 121.35h
[2025-10-23T05:20:42.134Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:20:42.134Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:42.134Z] [LOG]       Total Expected: 134.85h
[2025-10-23T05:20:42.135Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:20:42.135Z] [LOG]       Weekday: 27.85h (includes 2.35h live)
[2025-10-23T05:20:42.135Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:20:42.136Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:42.136Z] [LOG]       Total Actual: 32.35h
[2025-10-23T05:20:42.136Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:20:42.136Z] [LOG]       Weekday: 121.35h × Rs.235.29 = Rs.28551.27
[2025-10-23T05:20:42.137Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:20:42.137Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:42.137Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:42.137Z] [LOG]       Total Expected Earned: Rs.34551.21
[2025-10-23T05:20:42.137Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:20:42.138Z] [LOG]       Weekday: 27.85h × Rs.235.29 = Rs.6551.66
[2025-10-23T05:20:42.138Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:20:42.138Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:42.139Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:42.139Z] [LOG]       Total Actual Earned: Rs.8551.64
[2025-10-23T05:20:42.140Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:20:42.140Z] [LOG]       Calculated At: Oct 23, 2025, 10:50:42
[2025-10-23T05:20:42.140Z] [LOG]       Expected Earned (until NOW): Rs.34551.21
[2025-10-23T05:20:42.141Z] [LOG]       Actual Earned (until NOW): Rs.8551.64
[2025-10-23T05:20:42.141Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:42.141Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:20:42.141Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:20:42.141Z] [LOG]       📉 Shortfall: 102.50 hours (75.25% of expected)
[2025-10-23T05:20:42.141Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:20:42.142Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:20:42.142Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:20:42.142Z] [LOG]    Actual Earned Base: Rs.8551.64
[2025-10-23T05:20:42.142Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:20:42.143Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:20:42.143Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:20:42.143Z] [LOG]    Gross Salary: 8551.638611941667
[2025-10-23T05:20:42.143Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:20:42.144Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:20:42.144Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.144Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:20:42.144Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.145Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:20:42.145Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.145Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:20:42.145Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.145Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:20:42.146Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.146Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:20:42.146Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.146Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:20:42.146Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.147Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:20:42.147Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.147Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:20:42.147Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.147Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:20:42.147Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.147Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:20:42.147Z] [LOG]    EPF/ETF calculated on: Rs.8551.64
[2025-10-23T05:20:42.147Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:20:42.147Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:20:42.149Z] [LOG] 💰 GROSS CALCULATION for Faizan Faizan:
[2025-10-23T05:20:42.149Z] [LOG]    Base Salary: 50000
[2025-10-23T05:20:42.149Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:20:42.150Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:20:42.150Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.150Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:20:42.150Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.150Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:20:42.151Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:42.442Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:20:42.442Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:42.442Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:20:42.442Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:20:42.442Z] [LOG]    Actual Earned Base: Rs.8551.64
[2025-10-23T05:20:42.442Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:20:42.443Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:20:42.443Z] [LOG]    = Gross Salary: Rs.8551.64
[2025-10-23T05:20:42.443Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:20:42.443Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:20:42.443Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:20:42.444Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:42.444Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:20:42.444Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:20:42.444Z] [LOG]    Gross Salary: Rs.8551.64
[2025-10-23T05:20:42.444Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:20:42.444Z] [LOG]    = NET SALARY: Rs.8551.64
[2025-10-23T05:20:42.445Z] [LOG] 
💾 Database Update:
[2025-10-23T05:20:42.445Z] [LOG]    Total Earnings: Rs.8551.64 (Base: 8551.64 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:20:42.445Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:20:42.668Z] [LOG] 
📝 Components to save:
[2025-10-23T05:20:42.669Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:20:42.669Z] [LOG]    Deduction components: 1
[2025-10-23T05:20:42.669Z] [LOG] Creating components for record 75bb662b-eb79-476d-b110-07838e51b59b: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:20:42.670Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8551.638611941667
}
[2025-10-23T05:20:42.908Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:20:43.151Z] [LOG] Created payroll_record_component: b15a82e4-9164-4797-84a6-3065bf7405a7 for Base Salary
[2025-10-23T05:20:43.151Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T05:20:43.396Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:20:43.643Z] [LOG] Created payroll_record_component: a4ef7524-6cfa-44df-b6ce-6c55d29adfee for Attendance Shortfall (Info)
[2025-10-23T05:20:44.131Z] [LOG] ✅ Financial balances updated successfully for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:44.131Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:20:44.131Z] [LOG] 
======================================================================
[2025-10-23T05:20:44.132Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Faizan Faizan
[2025-10-23T05:20:44.132Z] [LOG] ======================================================================
[2025-10-23T05:20:44.132Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:20:44.132Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8551.64
[2025-10-23T05:20:44.133Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:20:44.133Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:44.133Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:44.134Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:20:44.134Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:44.135Z] [LOG]    GROSS SALARY: Rs.8551.64
[2025-10-23T05:20:44.135Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:44.135Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:20:44.136Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:20:44.136Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:20:44.136Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:20:44.137Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:20:44.137Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:44.137Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:44.138Z] [LOG]    NET SALARY: Rs.8551.64
[2025-10-23T05:20:44.138Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:20:44.138Z] [LOG] ======================================================================

[2025-10-23T05:20:44.138Z] [LOG] ✅ Faizan Faizan: Calculation completed successfully
[2025-10-23T05:20:44.138Z] [LOG] 📊 Progress: 16/34 (47.1%)
[2025-10-23T05:20:44.138Z] [LOG] 
🧮 Processing: Sithira null (EMP000039)
[2025-10-23T05:20:44.138Z] [LOG] 📋 Record ID: 7f122661-8b47-4a7d-bc2b-6ff41cd43551
[2025-10-23T05:20:44.139Z] [LOG] 
======================================================================
[2025-10-23T05:20:44.139Z] [LOG] 🧮 CALCULATING PAYROLL: Sithira null (EMP000039)
[2025-10-23T05:20:44.139Z] [LOG] ======================================================================
[2025-10-23T05:20:45.091Z] [LOG] 🔍 Component filtering for employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-23T05:20:45.091Z] [LOG]    Total components: 13
[2025-10-23T05:20:45.091Z] [LOG]    Applicable components: 13
[2025-10-23T05:20:45.092Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T05:20:46.630Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:20:46.631Z] [LOG] 🔄 Processing financial records for employee 01441e19-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:20:46.845Z] [LOG] 📊 Found 0 active loans for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:47.069Z] [LOG] 📊 Found 0 active advances for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:47.260Z] [LOG] 📊 Found 0 approved bonuses for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:47.261Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:20:47.261Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:20:47.451Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:20:47.452Z] [LOG]    Employee ID: 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:47.452Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:20:47.452Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:20:47.453Z] [LOG]    Base Salary (Full Month): Rs.40000.00
[2025-10-23T05:20:47.875Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:20:47.875Z] [LOG]       Daily Salary: Rs.1600.00
[2025-10-23T05:20:47.875Z] [LOG]       Weekday Hourly Rate: Rs.188.24
[2025-10-23T05:20:47.876Z] [LOG]       Saturday Hourly Rate: Rs.355.56
[2025-10-23T05:20:47.876Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:20:47.876Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:20:47.876Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:20:48.517Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:20:48.518Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:20:48.756Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:20:48.756Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:20:48.757Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:20:48.757Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:20:48.757Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:20:48.758Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:20:48.758Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:20:48.758Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:20:48.990Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:20:48.991Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:20:48.991Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:20:48.992Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:20:49.229Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:20:49.230Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:20:49.230Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:20:49.230Z] [LOG]       Current Time: 10:50:49
[2025-10-23T05:20:49.231Z] [LOG]       Expected Hours (scheduled → now): 2.35h
[2025-10-23T05:20:49.231Z] [LOG]       Actual Hours (check-in → now): 2.35h
[2025-10-23T05:20:49.231Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:20:49.232Z] [LOG]       Weekday: 121.35h
[2025-10-23T05:20:49.232Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:20:49.232Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:49.233Z] [LOG]       Total Expected: 134.85h
[2025-10-23T05:20:49.233Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:20:49.233Z] [LOG]       Weekday: 27.85h (includes 2.35h live)
[2025-10-23T05:20:49.233Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:20:49.234Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:49.234Z] [LOG]       Total Actual: 32.35h
[2025-10-23T05:20:49.234Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:20:49.234Z] [LOG]       Weekday: 121.35h × Rs.188.24 = Rs.22842.36
[2025-10-23T05:20:49.235Z] [LOG]       Saturday: 13.50h × Rs.355.56 = Rs.4800.06
[2025-10-23T05:20:49.235Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:49.235Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:49.236Z] [LOG]       Total Expected Earned: Rs.27642.42
[2025-10-23T05:20:49.236Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:20:49.236Z] [LOG]       Weekday: 27.85h × Rs.188.24 = Rs.5241.92
[2025-10-23T05:20:49.236Z] [LOG]       Saturday: 4.50h × Rs.355.56 = Rs.1600.02
[2025-10-23T05:20:49.237Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:49.237Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:49.237Z] [LOG]       Total Actual Earned: Rs.6841.94
[2025-10-23T05:20:49.238Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:20:49.239Z] [LOG]       Calculated At: Oct 23, 2025, 10:50:49
[2025-10-23T05:20:49.239Z] [LOG]       Expected Earned (until NOW): Rs.27642.42
[2025-10-23T05:20:49.240Z] [LOG]       Actual Earned (until NOW): Rs.6841.94
[2025-10-23T05:20:49.241Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:49.241Z] [LOG]       Attendance Deduction: Rs.20800.48
[2025-10-23T05:20:49.241Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:20:49.242Z] [LOG]       📉 Shortfall: 102.50 hours (75.25% of expected)
[2025-10-23T05:20:49.243Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:20:49.243Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:20:49.245Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T05:20:49.245Z] [LOG]    Actual Earned Base: Rs.6841.94
[2025-10-23T05:20:49.245Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T05:20:49.245Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:20:49.246Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:20:49.246Z] [LOG]    Gross Salary: 6841.940796377778
[2025-10-23T05:20:49.246Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:20:49.247Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:20:49.247Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.247Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:20:49.247Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.248Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:20:49.248Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.248Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:20:49.249Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.249Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:20:49.249Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.249Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:20:49.250Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.250Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:20:49.250Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.250Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:20:49.251Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.251Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:20:49.251Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.251Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:20:49.252Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.252Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:20:49.252Z] [LOG]    EPF/ETF calculated on: Rs.6841.94
[2025-10-23T05:20:49.253Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:20:49.253Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:20:49.253Z] [LOG] 💰 GROSS CALCULATION for Sithira null:
[2025-10-23T05:20:49.253Z] [LOG]    Base Salary: 40000
[2025-10-23T05:20:49.253Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:20:49.254Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:20:49.254Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.254Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:20:49.254Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.254Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:20:49.254Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:49.469Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:20:49.470Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:49.470Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:20:49.470Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:20:49.470Z] [LOG]    Actual Earned Base: Rs.6841.94
[2025-10-23T05:20:49.471Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:20:49.471Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:20:49.471Z] [LOG]    = Gross Salary: Rs.6841.94
[2025-10-23T05:20:49.472Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:20:49.472Z] [LOG]    Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T05:20:49.472Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:20:49.472Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:49.473Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:20:49.473Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:20:49.473Z] [LOG]    Gross Salary: Rs.6841.94
[2025-10-23T05:20:49.473Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:20:49.474Z] [LOG]    = NET SALARY: Rs.6841.94
[2025-10-23T05:20:49.474Z] [LOG] 
💾 Database Update:
[2025-10-23T05:20:49.474Z] [LOG]    Total Earnings: Rs.6841.94 (Base: 6841.94 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:20:49.474Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:20:49.718Z] [LOG] 
📝 Components to save:
[2025-10-23T05:20:49.718Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:20:49.718Z] [LOG]    Deduction components: 1
[2025-10-23T05:20:49.719Z] [LOG] Creating components for record 7f122661-8b47-4a7d-bc2b-6ff41cd43551: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:20:49.719Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 6841.940796377778
}
[2025-10-23T05:20:49.982Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:20:50.190Z] [LOG] Created payroll_record_component: c3efb3b5-20f8-48c0-a45d-23acf2ce8ffa for Base Salary
[2025-10-23T05:20:50.190Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 20800.480000000003
}
[2025-10-23T05:20:50.381Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:20:50.597Z] [LOG] Created payroll_record_component: 2f08eee1-3edf-4cb4-bafe-c4e59e166808 for Attendance Shortfall (Info)
[2025-10-23T05:20:50.987Z] [LOG] ✅ Financial balances updated successfully for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:50.988Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:20:50.988Z] [LOG] 
======================================================================
[2025-10-23T05:20:50.989Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sithira null
[2025-10-23T05:20:50.989Z] [LOG] ======================================================================
[2025-10-23T05:20:50.989Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T05:20:50.989Z] [LOG]    Actual Earned Base (Attendance-based): Rs.6841.94
[2025-10-23T05:20:50.989Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T05:20:50.989Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:50.990Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:50.990Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:20:50.990Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:50.990Z] [LOG]    GROSS SALARY: Rs.6841.94
[2025-10-23T05:20:50.990Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:50.990Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:20:50.991Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:20:50.991Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:20:50.991Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:20:50.991Z] [LOG]       - Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T05:20:50.992Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:50.992Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:50.992Z] [LOG]    NET SALARY: Rs.6841.94
[2025-10-23T05:20:50.993Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:20:50.993Z] [LOG] ======================================================================

[2025-10-23T05:20:50.993Z] [LOG] ✅ Sithira null: Calculation completed successfully
[2025-10-23T05:20:50.993Z] [LOG] 📊 Progress: 17/34 (50.0%)
[2025-10-23T05:20:50.994Z] [LOG] 
🧮 Processing: customer null (EMP000036)
[2025-10-23T05:20:50.994Z] [LOG] 📋 Record ID: 80912463-82a6-40ae-ac2f-2c8560e4ac8e
[2025-10-23T05:20:50.994Z] [LOG] 
======================================================================
[2025-10-23T05:20:50.995Z] [LOG] 🧮 CALCULATING PAYROLL: customer null (EMP000036)
[2025-10-23T05:20:50.995Z] [LOG] ======================================================================
[2025-10-23T05:20:51.963Z] [LOG] 🔍 Component filtering for employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-23T05:20:51.963Z] [LOG]    Total components: 13
[2025-10-23T05:20:51.964Z] [LOG]    Applicable components: 13
[2025-10-23T05:20:51.964Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:20:53.367Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:20:53.368Z] [LOG] 🔄 Processing financial records for employee 014409a2-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:20:54.145Z] [LOG] 📊 Found 0 active loans for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:54.334Z] [LOG] 📊 Found 0 active advances for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:54.588Z] [LOG] 📊 Found 0 approved bonuses for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:54.589Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:20:54.589Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:20:54.832Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:20:54.832Z] [LOG]    Employee ID: 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:54.833Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:20:54.833Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:20:54.833Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-23T05:20:55.034Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:20:55.034Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-23T05:20:55.034Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T05:20:55.035Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-23T05:20:55.035Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:20:55.035Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:20:55.035Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:20:55.679Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:20:55.679Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:20:55.871Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:20:55.872Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:20:55.872Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:20:55.872Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:20:55.872Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:20:55.873Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:20:55.873Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:20:55.873Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:20:56.066Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:20:56.067Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:20:56.067Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:20:56.067Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:20:56.263Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:20:56.263Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:20:56.264Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:20:56.264Z] [LOG]       Current Time: 10:50:56
[2025-10-23T05:20:56.265Z] [LOG]       Expected Hours (scheduled → now): 2.35h
[2025-10-23T05:20:56.265Z] [LOG]       Actual Hours (check-in → now): 2.35h
[2025-10-23T05:20:56.265Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:20:56.266Z] [LOG]       Weekday: 121.35h
[2025-10-23T05:20:56.266Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:20:56.266Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:56.266Z] [LOG]       Total Expected: 134.85h
[2025-10-23T05:20:56.266Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:20:56.267Z] [LOG]       Weekday: 27.85h (includes 2.35h live)
[2025-10-23T05:20:56.267Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:20:56.267Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:20:56.267Z] [LOG]       Total Actual: 32.35h
[2025-10-23T05:20:56.267Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:20:56.268Z] [LOG]       Weekday: 121.35h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:56.268Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:56.268Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:56.268Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:56.269Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-23T05:20:56.269Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:20:56.269Z] [LOG]       Weekday: 27.85h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:56.269Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:56.270Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:20:56.270Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:56.270Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-23T05:20:56.271Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:20:56.271Z] [LOG]       Calculated At: Oct 23, 2025, 10:50:56
[2025-10-23T05:20:56.271Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-23T05:20:56.272Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-23T05:20:56.272Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:20:56.272Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-23T05:20:56.273Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:20:56.273Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-23T05:20:56.273Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:20:56.273Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:20:56.274Z] [LOG]    Base Salary (Full): Rs.NaN
[2025-10-23T05:20:56.274Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:20:56.274Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:20:56.275Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:20:56.275Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:20:56.275Z] [LOG]    Gross Salary: 0
[2025-10-23T05:20:56.275Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:20:56.276Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:20:56.276Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.276Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:20:56.277Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.277Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:20:56.278Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.278Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:20:56.278Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.278Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:20:56.278Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.279Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:20:56.279Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.279Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:20:56.279Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.279Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:20:56.280Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.280Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:20:56.281Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.281Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:20:56.281Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.281Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:20:56.281Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-23T05:20:56.282Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:20:56.282Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:20:56.282Z] [LOG] 💰 GROSS CALCULATION for customer null:
[2025-10-23T05:20:56.282Z] [LOG]    Base Salary: 0
[2025-10-23T05:20:56.283Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:20:56.283Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:20:56.283Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.283Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:20:56.283Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.283Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:20:56.284Z] [LOG]    Fixed amount: 0
[2025-10-23T05:20:56.474Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:20:56.475Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:56.475Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:20:56.475Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:20:56.475Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:20:56.475Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:20:56.475Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:20:56.475Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-23T05:20:56.475Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:20:56.475Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:20:56.476Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:56.476Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:20:56.476Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:20:56.476Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-23T05:20:56.476Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:20:56.477Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-23T05:20:56.477Z] [LOG] 
💾 Database Update:
[2025-10-23T05:20:56.477Z] [LOG]    Total Earnings: Rs.0.00 (Base: 0.00 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:20:56.477Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:20:56.675Z] [LOG] 
📝 Components to save:
[2025-10-23T05:20:56.676Z] [LOG]    Gross/Earnings components: 0
[2025-10-23T05:20:56.676Z] [LOG]    Deduction components: 0
[2025-10-23T05:20:56.677Z] [LOG] Creating components for record 80912463-82a6-40ae-ac2f-2c8560e4ac8e: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-23T05:20:57.070Z] [LOG] ✅ Financial balances updated successfully for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T05:20:57.071Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:20:57.071Z] [LOG] 
======================================================================
[2025-10-23T05:20:57.071Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: customer null
[2025-10-23T05:20:57.072Z] [LOG] ======================================================================
[2025-10-23T05:20:57.072Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T05:20:57.073Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-23T05:20:57.073Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:20:57.073Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:57.074Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:20:57.074Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:20:57.074Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:57.074Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-23T05:20:57.075Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:57.075Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:20:57.075Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:20:57.076Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:20:57.076Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:20:57.076Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-23T05:20:57.076Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:20:57.077Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:20:57.077Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-23T05:20:57.077Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:20:57.078Z] [LOG] ======================================================================

[2025-10-23T05:20:57.078Z] [LOG] ✅ customer null: Calculation completed successfully
[2025-10-23T05:20:57.078Z] [LOG] 📊 Progress: 18/34 (52.9%)
[2025-10-23T05:20:57.079Z] [LOG] 
🧮 Processing: Sumaiya null (EMP000016)
[2025-10-23T05:20:57.079Z] [LOG] 📋 Record ID: 83d74487-328f-4661-9bfa-93eb5c662eff
[2025-10-23T05:20:57.079Z] [LOG] 
======================================================================
[2025-10-23T05:20:57.080Z] [LOG] 🧮 CALCULATING PAYROLL: Sumaiya null (EMP000016)
[2025-10-23T05:20:57.080Z] [LOG] ======================================================================
[2025-10-23T05:20:58.204Z] [LOG] 🔍 Component filtering for employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-23T05:20:58.205Z] [LOG]    Total components: 13
[2025-10-23T05:20:58.205Z] [LOG]    Applicable components: 13
[2025-10-23T05:20:58.205Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:20:59.635Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:20:59.636Z] [LOG] 🔄 Processing financial records for employee 0143b22f-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:20:59.830Z] [LOG] 📊 Found 0 active loans for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:00.029Z] [LOG] 📊 Found 0 active advances for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:00.350Z] [LOG] 📊 Found 0 approved bonuses for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:00.350Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:21:00.351Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:21:00.604Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:21:00.604Z] [LOG]    Employee ID: 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:00.604Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:21:00.604Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:21:00.605Z] [LOG]    Base Salary (Full Month): Rs.60000.00
[2025-10-23T05:21:00.836Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:21:00.837Z] [LOG]       Daily Salary: Rs.2400.00
[2025-10-23T05:21:00.837Z] [LOG]       Weekday Hourly Rate: Rs.282.35
[2025-10-23T05:21:00.837Z] [LOG]       Saturday Hourly Rate: Rs.533.33
[2025-10-23T05:21:00.837Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:21:00.838Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:21:00.838Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:21:01.476Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:21:01.477Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:21:01.716Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:21:01.717Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:21:01.717Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:21:01.717Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:21:01.718Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:21:01.718Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:21:01.718Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:21:01.718Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:21:01.952Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:21:01.953Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:21:01.953Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:21:01.953Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:21:02.202Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:21:02.202Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:21:02.203Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:21:02.203Z] [LOG]       Current Time: 10:51:02
[2025-10-23T05:21:02.204Z] [LOG]       Expected Hours (scheduled → now): 2.35h
[2025-10-23T05:21:02.204Z] [LOG]       Actual Hours (check-in → now): 2.35h
[2025-10-23T05:21:02.204Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:21:02.204Z] [LOG]       Weekday: 121.35h
[2025-10-23T05:21:02.205Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:21:02.205Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:02.205Z] [LOG]       Total Expected: 134.85h
[2025-10-23T05:21:02.206Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:21:02.206Z] [LOG]       Weekday: 27.85h (includes 2.35h live)
[2025-10-23T05:21:02.206Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:21:02.207Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:02.207Z] [LOG]       Total Actual: 32.35h
[2025-10-23T05:21:02.207Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:21:02.207Z] [LOG]       Weekday: 121.35h × Rs.282.35 = Rs.34263.35
[2025-10-23T05:21:02.207Z] [LOG]       Saturday: 13.50h × Rs.533.33 = Rs.7199.96
[2025-10-23T05:21:02.208Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:02.208Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:02.208Z] [LOG]       Total Expected Earned: Rs.41463.30
[2025-10-23T05:21:02.208Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:21:02.208Z] [LOG]       Weekday: 27.85h × Rs.282.35 = Rs.7863.62
[2025-10-23T05:21:02.209Z] [LOG]       Saturday: 4.50h × Rs.533.33 = Rs.2399.99
[2025-10-23T05:21:02.209Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:02.209Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:02.209Z] [LOG]       Total Actual Earned: Rs.10263.61
[2025-10-23T05:21:02.210Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:21:02.210Z] [LOG]       Calculated At: Oct 23, 2025, 10:51:02
[2025-10-23T05:21:02.210Z] [LOG]       Expected Earned (until NOW): Rs.41463.30
[2025-10-23T05:21:02.211Z] [LOG]       Actual Earned (until NOW): Rs.10263.61
[2025-10-23T05:21:02.211Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:02.211Z] [LOG]       Attendance Deduction: Rs.31199.70
[2025-10-23T05:21:02.211Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:21:02.212Z] [LOG]       📉 Shortfall: 102.50 hours (75.25% of expected)
[2025-10-23T05:21:02.212Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:21:02.212Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:21:02.213Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T05:21:02.213Z] [LOG]    Actual Earned Base: Rs.10263.61
[2025-10-23T05:21:02.213Z] [LOG]    Attendance Shortfall: Rs.31199.70
[2025-10-23T05:21:02.214Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:21:02.214Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:21:02.214Z] [LOG]    Gross Salary: 10263.605204083335
[2025-10-23T05:21:02.215Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:21:02.215Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:21:02.215Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.216Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:21:02.216Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.217Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:21:02.217Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.218Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:21:02.218Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.218Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:21:02.218Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.219Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:21:02.219Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.219Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:21:02.219Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.220Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:21:02.220Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.220Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:21:02.221Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.221Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:21:02.221Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.221Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:21:02.222Z] [LOG]    EPF/ETF calculated on: Rs.10263.61
[2025-10-23T05:21:02.222Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:21:02.222Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:21:02.223Z] [LOG] 💰 GROSS CALCULATION for Sumaiya null:
[2025-10-23T05:21:02.223Z] [LOG]    Base Salary: 60000
[2025-10-23T05:21:02.223Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:21:02.224Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:21:02.224Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.224Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:21:02.224Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.224Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:21:02.224Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:02.475Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:21:02.475Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:02.475Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:21:02.476Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:21:02.476Z] [LOG]    Actual Earned Base: Rs.10263.61
[2025-10-23T05:21:02.476Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:21:02.476Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:21:02.477Z] [LOG]    = Gross Salary: Rs.10263.61
[2025-10-23T05:21:02.477Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:21:02.477Z] [LOG]    Attendance Shortfall (Info): Rs.31199.70
[2025-10-23T05:21:02.477Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:21:02.478Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:02.478Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:21:02.478Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:21:02.479Z] [LOG]    Gross Salary: Rs.10263.61
[2025-10-23T05:21:02.479Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:21:02.479Z] [LOG]    = NET SALARY: Rs.10263.61
[2025-10-23T05:21:02.479Z] [LOG] 
💾 Database Update:
[2025-10-23T05:21:02.480Z] [LOG]    Total Earnings: Rs.10263.61 (Base: 10263.61 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:21:02.480Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:21:02.681Z] [LOG] 
📝 Components to save:
[2025-10-23T05:21:02.682Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:21:02.682Z] [LOG]    Deduction components: 1
[2025-10-23T05:21:02.682Z] [LOG] Creating components for record 83d74487-328f-4661-9bfa-93eb5c662eff: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:21:02.683Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10263.605204083335
}
[2025-10-23T05:21:02.916Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:21:03.116Z] [LOG] Created payroll_record_component: eb6b3116-823a-40a9-ad00-174962268847 for Base Salary
[2025-10-23T05:21:03.117Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 31199.695000000003
}
[2025-10-23T05:21:03.324Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:21:03.549Z] [LOG] Created payroll_record_component: 73c2b7e3-60e2-46f0-9de8-cee5a89fee3a for Attendance Shortfall (Info)
[2025-10-23T05:21:04.029Z] [LOG] ✅ Financial balances updated successfully for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:04.030Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:21:04.030Z] [LOG] 
======================================================================
[2025-10-23T05:21:04.030Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sumaiya null
[2025-10-23T05:21:04.031Z] [LOG] ======================================================================
[2025-10-23T05:21:04.031Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T05:21:04.031Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10263.61
[2025-10-23T05:21:04.032Z] [LOG]    Attendance Shortfall: Rs.31199.70
[2025-10-23T05:21:04.032Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:04.033Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:04.033Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:21:04.033Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:04.033Z] [LOG]    GROSS SALARY: Rs.10263.61
[2025-10-23T05:21:04.034Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:04.034Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:21:04.034Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:21:04.035Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:21:04.035Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:21:04.035Z] [LOG]       - Attendance Shortfall (Info): Rs.31199.70
[2025-10-23T05:21:04.036Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:04.036Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:04.036Z] [LOG]    NET SALARY: Rs.10263.61
[2025-10-23T05:21:04.036Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:21:04.037Z] [LOG] ======================================================================

[2025-10-23T05:21:04.037Z] [LOG] ✅ Sumaiya null: Calculation completed successfully
[2025-10-23T05:21:04.037Z] [LOG] 📊 Progress: 19/34 (55.9%)
[2025-10-23T05:21:04.038Z] [LOG] 
🧮 Processing: Ammaar Ilham (EMP000023)
[2025-10-23T05:21:04.038Z] [LOG] 📋 Record ID: 8b376bed-030d-46b7-884f-556e03d3e70a
[2025-10-23T05:21:04.038Z] [LOG] 
======================================================================
[2025-10-23T05:21:04.039Z] [LOG] 🧮 CALCULATING PAYROLL: Ammaar Ilham (EMP000023)
[2025-10-23T05:21:04.040Z] [LOG] ======================================================================
[2025-10-23T05:21:04.990Z] [LOG] 🔍 Component filtering for employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-23T05:21:04.991Z] [LOG]    Total components: 13
[2025-10-23T05:21:04.991Z] [LOG]    Applicable components: 13
[2025-10-23T05:21:04.991Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:21:06.395Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:21:06.395Z] [LOG] 🔄 Processing financial records for employee 0143de00-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:21:06.670Z] [LOG] 📊 Found 0 active loans for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:06.926Z] [LOG] 📊 Found 0 active advances for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:07.148Z] [LOG] 📊 Found 0 approved bonuses for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:07.149Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:21:07.149Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:21:07.366Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:21:07.366Z] [LOG]    Employee ID: 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:07.366Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:21:07.366Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:21:07.366Z] [LOG]    Base Salary (Full Month): Rs.70000.00
[2025-10-23T05:21:07.566Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:21:07.566Z] [LOG]       Daily Salary: Rs.2800.00
[2025-10-23T05:21:07.566Z] [LOG]       Weekday Hourly Rate: Rs.329.41
[2025-10-23T05:21:07.567Z] [LOG]       Saturday Hourly Rate: Rs.622.22
[2025-10-23T05:21:07.567Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:21:07.567Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:21:07.567Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:21:08.269Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:21:08.270Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:21:08.511Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:21:08.512Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:21:08.512Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:21:08.512Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:21:08.513Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:21:08.513Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:21:08.513Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:21:08.514Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:21:08.749Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:21:08.750Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:21:08.750Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:21:08.751Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:21:09.009Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:21:09.010Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:21:09.010Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:21:09.011Z] [LOG]       Current Time: 10:51:09
[2025-10-23T05:21:09.011Z] [LOG]       Expected Hours (scheduled → now): 2.35h
[2025-10-23T05:21:09.011Z] [LOG]       Actual Hours (check-in → now): 2.35h
[2025-10-23T05:21:09.012Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:21:09.012Z] [LOG]       Weekday: 121.35h
[2025-10-23T05:21:09.012Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:21:09.013Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:09.013Z] [LOG]       Total Expected: 134.85h
[2025-10-23T05:21:09.013Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:21:09.014Z] [LOG]       Weekday: 27.85h (includes 2.35h live)
[2025-10-23T05:21:09.014Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:21:09.014Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:09.015Z] [LOG]       Total Actual: 32.35h
[2025-10-23T05:21:09.015Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:21:09.015Z] [LOG]       Weekday: 121.35h × Rs.329.41 = Rs.39974.73
[2025-10-23T05:21:09.016Z] [LOG]       Saturday: 13.50h × Rs.622.22 = Rs.8399.97
[2025-10-23T05:21:09.016Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:09.016Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:09.017Z] [LOG]       Total Expected Earned: Rs.48374.70
[2025-10-23T05:21:09.017Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:21:09.017Z] [LOG]       Weekday: 27.85h × Rs.329.41 = Rs.9174.89
[2025-10-23T05:21:09.018Z] [LOG]       Saturday: 4.50h × Rs.622.22 = Rs.2799.99
[2025-10-23T05:21:09.018Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:09.018Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:09.018Z] [LOG]       Total Actual Earned: Rs.11974.88
[2025-10-23T05:21:09.019Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:21:09.020Z] [LOG]       Calculated At: Oct 23, 2025, 10:51:09
[2025-10-23T05:21:09.020Z] [LOG]       Expected Earned (until NOW): Rs.48374.70
[2025-10-23T05:21:09.021Z] [LOG]       Actual Earned (until NOW): Rs.11974.88
[2025-10-23T05:21:09.021Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:09.022Z] [LOG]       Attendance Deduction: Rs.36399.82
[2025-10-23T05:21:09.022Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:21:09.023Z] [LOG]       📉 Shortfall: 102.50 hours (75.25% of expected)
[2025-10-23T05:21:09.023Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:21:09.024Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:21:09.024Z] [LOG]    Base Salary (Full): Rs.70000.00
[2025-10-23T05:21:09.025Z] [LOG]    Actual Earned Base: Rs.11974.88
[2025-10-23T05:21:09.025Z] [LOG]    Attendance Shortfall: Rs.36399.82
[2025-10-23T05:21:09.026Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:21:09.026Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:21:09.026Z] [LOG]    Gross Salary: 11974.882848525
[2025-10-23T05:21:09.026Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:21:09.026Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:21:09.027Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.027Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:21:09.027Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.027Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:21:09.028Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.028Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:21:09.028Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.029Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:21:09.029Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.030Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:21:09.030Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.031Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:21:09.031Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.032Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:21:09.032Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.032Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:21:09.032Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.033Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:21:09.033Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.033Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:21:09.034Z] [LOG]    EPF/ETF calculated on: Rs.11974.88
[2025-10-23T05:21:09.034Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:21:09.034Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:21:09.034Z] [LOG] 💰 GROSS CALCULATION for Ammaar Ilham:
[2025-10-23T05:21:09.035Z] [LOG]    Base Salary: 70000
[2025-10-23T05:21:09.035Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:21:09.036Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:21:09.036Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.036Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:21:09.036Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.036Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:21:09.036Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:09.309Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:21:09.309Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:09.309Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:21:09.310Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:21:09.310Z] [LOG]    Actual Earned Base: Rs.11974.88
[2025-10-23T05:21:09.310Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:21:09.311Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:21:09.311Z] [LOG]    = Gross Salary: Rs.11974.88
[2025-10-23T05:21:09.311Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:21:09.311Z] [LOG]    Attendance Shortfall (Info): Rs.36399.82
[2025-10-23T05:21:09.312Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:21:09.312Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:09.312Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:21:09.312Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:21:09.312Z] [LOG]    Gross Salary: Rs.11974.88
[2025-10-23T05:21:09.313Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:21:09.313Z] [LOG]    = NET SALARY: Rs.11974.88
[2025-10-23T05:21:09.313Z] [LOG] 
💾 Database Update:
[2025-10-23T05:21:09.313Z] [LOG]    Total Earnings: Rs.11974.88 (Base: 11974.88 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:21:09.313Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:21:09.548Z] [LOG] 
📝 Components to save:
[2025-10-23T05:21:09.548Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:21:09.549Z] [LOG]    Deduction components: 1
[2025-10-23T05:21:09.549Z] [LOG] Creating components for record 8b376bed-030d-46b7-884f-556e03d3e70a: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:21:09.550Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 11974.882848525
}
[2025-10-23T05:21:09.807Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:21:10.029Z] [LOG] Created payroll_record_component: 1d574fa9-fac8-4b82-ab1f-7909a653afa2 for Base Salary
[2025-10-23T05:21:10.029Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 36399.81500000001
}
[2025-10-23T05:21:10.269Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:21:10.509Z] [LOG] Created payroll_record_component: c7304d66-09fd-462c-b03e-9174c36cf0e4 for Attendance Shortfall (Info)
[2025-10-23T05:21:11.127Z] [LOG] ✅ Financial balances updated successfully for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:11.127Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:21:11.127Z] [LOG] 
======================================================================
[2025-10-23T05:21:11.128Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ammaar Ilham
[2025-10-23T05:21:11.128Z] [LOG] ======================================================================
[2025-10-23T05:21:11.129Z] [LOG]    Base Salary (Full): Rs.70000.00
[2025-10-23T05:21:11.129Z] [LOG]    Actual Earned Base (Attendance-based): Rs.11974.88
[2025-10-23T05:21:11.129Z] [LOG]    Attendance Shortfall: Rs.36399.82
[2025-10-23T05:21:11.129Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:11.130Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:11.130Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:21:11.131Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:11.131Z] [LOG]    GROSS SALARY: Rs.11974.88
[2025-10-23T05:21:11.131Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:11.131Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:21:11.131Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:21:11.131Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:21:11.132Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:21:11.132Z] [LOG]       - Attendance Shortfall (Info): Rs.36399.82
[2025-10-23T05:21:11.132Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:11.133Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:11.133Z] [LOG]    NET SALARY: Rs.11974.88
[2025-10-23T05:21:11.133Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:21:11.134Z] [LOG] ======================================================================

[2025-10-23T05:21:11.134Z] [LOG] ✅ Ammaar Ilham: Calculation completed successfully
[2025-10-23T05:21:11.134Z] [LOG] 📊 Progress: 20/34 (58.8%)
[2025-10-23T05:21:11.134Z] [LOG] 
🧮 Processing: Ratheeshanan null (EMP000047)
[2025-10-23T05:21:11.135Z] [LOG] 📋 Record ID: 8e6623b4-d4dc-4127-b1bc-78cc7297689b
[2025-10-23T05:21:11.135Z] [LOG] 
======================================================================
[2025-10-23T05:21:11.135Z] [LOG] 🧮 CALCULATING PAYROLL: Ratheeshanan null (EMP000047)
[2025-10-23T05:21:11.136Z] [LOG] ======================================================================
[2025-10-23T05:21:11.953Z] [LOG] 🔍 Component filtering for employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-23T05:21:11.954Z] [LOG]    Total components: 13
[2025-10-23T05:21:11.954Z] [LOG]    Applicable components: 13
[2025-10-23T05:21:11.954Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:21:13.398Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:21:13.398Z] [LOG] 🔄 Processing financial records for employee 01444966-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:21:13.644Z] [LOG] 📊 Found 0 active loans for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:13.871Z] [LOG] 📊 Found 0 active advances for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:14.117Z] [LOG] 📊 Found 0 approved bonuses for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:14.117Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:21:14.118Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:21:14.350Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:21:14.350Z] [LOG]    Employee ID: 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:14.351Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:21:14.351Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:21:14.351Z] [LOG]    Base Salary (Full Month): Rs.25000.00
[2025-10-23T05:21:14.605Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:21:14.606Z] [LOG]       Daily Salary: Rs.1000.00
[2025-10-23T05:21:14.607Z] [LOG]       Weekday Hourly Rate: Rs.117.65
[2025-10-23T05:21:14.607Z] [LOG]       Saturday Hourly Rate: Rs.222.22
[2025-10-23T05:21:14.607Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:21:14.608Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:21:14.608Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:21:15.404Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:21:15.404Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:21:15.630Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:21:15.630Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:21:15.630Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:21:15.631Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:21:15.631Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:21:15.631Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:21:15.632Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:21:15.632Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:21:15.872Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:21:15.872Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:21:15.872Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:21:15.873Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:21:16.111Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:21:16.112Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:21:16.112Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:21:16.113Z] [LOG]       Current Time: 10:51:16
[2025-10-23T05:21:16.113Z] [LOG]       Expected Hours (scheduled → now): 2.35h
[2025-10-23T05:21:16.114Z] [LOG]       Actual Hours (check-in → now): 2.35h
[2025-10-23T05:21:16.114Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:21:16.114Z] [LOG]       Weekday: 121.35h
[2025-10-23T05:21:16.114Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:21:16.115Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:16.115Z] [LOG]       Total Expected: 134.85h
[2025-10-23T05:21:16.115Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:21:16.115Z] [LOG]       Weekday: 27.85h (includes 2.35h live)
[2025-10-23T05:21:16.116Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:21:16.116Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:16.116Z] [LOG]       Total Actual: 32.35h
[2025-10-23T05:21:16.117Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:21:16.117Z] [LOG]       Weekday: 121.35h × Rs.117.65 = Rs.14277.35
[2025-10-23T05:21:16.117Z] [LOG]       Saturday: 13.50h × Rs.222.22 = Rs.2999.97
[2025-10-23T05:21:16.118Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:16.118Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:16.118Z] [LOG]       Total Expected Earned: Rs.17277.32
[2025-10-23T05:21:16.118Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:21:16.119Z] [LOG]       Weekday: 27.85h × Rs.117.65 = Rs.3277.08
[2025-10-23T05:21:16.119Z] [LOG]       Saturday: 4.50h × Rs.222.22 = Rs.999.99
[2025-10-23T05:21:16.119Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:16.119Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:16.120Z] [LOG]       Total Actual Earned: Rs.4277.07
[2025-10-23T05:21:16.120Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:21:16.121Z] [LOG]       Calculated At: Oct 23, 2025, 10:51:16
[2025-10-23T05:21:16.121Z] [LOG]       Expected Earned (until NOW): Rs.17277.32
[2025-10-23T05:21:16.121Z] [LOG]       Actual Earned (until NOW): Rs.4277.07
[2025-10-23T05:21:16.121Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:16.122Z] [LOG]       Attendance Deduction: Rs.13000.26
[2025-10-23T05:21:16.123Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:21:16.123Z] [LOG]       📉 Shortfall: 102.50 hours (75.24% of expected)
[2025-10-23T05:21:16.124Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:21:16.124Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:21:16.125Z] [LOG]    Base Salary (Full): Rs.25000.00
[2025-10-23T05:21:16.125Z] [LOG]    Actual Earned Base: Rs.4277.07
[2025-10-23T05:21:16.125Z] [LOG]    Attendance Shortfall: Rs.13000.26
[2025-10-23T05:21:16.126Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:21:16.126Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:21:16.127Z] [LOG]    Gross Salary: 4277.069016430555
[2025-10-23T05:21:16.127Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:21:16.127Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:21:16.128Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.128Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:21:16.128Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.128Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:21:16.129Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.129Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:21:16.129Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.130Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:21:16.130Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.130Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:21:16.131Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.131Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:21:16.131Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.131Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:21:16.132Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.132Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:21:16.132Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.133Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:21:16.133Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.133Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:21:16.134Z] [LOG]    EPF/ETF calculated on: Rs.4277.07
[2025-10-23T05:21:16.134Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:21:16.134Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:21:16.134Z] [LOG] 💰 GROSS CALCULATION for Ratheeshanan null:
[2025-10-23T05:21:16.135Z] [LOG]    Base Salary: 25000
[2025-10-23T05:21:16.135Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:21:16.135Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:21:16.135Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.136Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:21:16.136Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.137Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:21:16.137Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:16.381Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:21:16.381Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:16.381Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:21:16.382Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:21:16.382Z] [LOG]    Actual Earned Base: Rs.4277.07
[2025-10-23T05:21:16.382Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:21:16.383Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:21:16.383Z] [LOG]    = Gross Salary: Rs.4277.07
[2025-10-23T05:21:16.383Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:21:16.384Z] [LOG]    Attendance Shortfall (Info): Rs.13000.26
[2025-10-23T05:21:16.384Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:21:16.384Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:16.385Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:21:16.385Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:21:16.385Z] [LOG]    Gross Salary: Rs.4277.07
[2025-10-23T05:21:16.386Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:21:16.386Z] [LOG]    = NET SALARY: Rs.4277.07
[2025-10-23T05:21:16.386Z] [LOG] 
💾 Database Update:
[2025-10-23T05:21:16.387Z] [LOG]    Total Earnings: Rs.4277.07 (Base: 4277.07 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:21:16.387Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:21:16.669Z] [LOG] 
📝 Components to save:
[2025-10-23T05:21:16.669Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:21:16.670Z] [LOG]    Deduction components: 1
[2025-10-23T05:21:16.670Z] [LOG] Creating components for record 8e6623b4-d4dc-4127-b1bc-78cc7297689b: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:21:16.670Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 4277.069016430555
}
[2025-10-23T05:21:16.908Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:21:17.149Z] [LOG] Created payroll_record_component: 663dd8c5-60f5-4876-905c-d5047fb2fcd3 for Base Salary
[2025-10-23T05:21:17.149Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 13000.255000000001
}
[2025-10-23T05:21:17.391Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:21:17.607Z] [LOG] Created payroll_record_component: a01b843f-3289-4ec3-95ff-5281df3b794f for Attendance Shortfall (Info)
[2025-10-23T05:21:18.030Z] [LOG] ✅ Financial balances updated successfully for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:18.030Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:21:18.030Z] [LOG] 
======================================================================
[2025-10-23T05:21:18.031Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ratheeshanan null
[2025-10-23T05:21:18.031Z] [LOG] ======================================================================
[2025-10-23T05:21:18.031Z] [LOG]    Base Salary (Full): Rs.25000.00
[2025-10-23T05:21:18.031Z] [LOG]    Actual Earned Base (Attendance-based): Rs.4277.07
[2025-10-23T05:21:18.032Z] [LOG]    Attendance Shortfall: Rs.13000.26
[2025-10-23T05:21:18.032Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:18.032Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:18.032Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:21:18.033Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:18.033Z] [LOG]    GROSS SALARY: Rs.4277.07
[2025-10-23T05:21:18.033Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:18.033Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:21:18.034Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:21:18.034Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:21:18.034Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:21:18.035Z] [LOG]       - Attendance Shortfall (Info): Rs.13000.26
[2025-10-23T05:21:18.035Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:18.035Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:18.036Z] [LOG]    NET SALARY: Rs.4277.07
[2025-10-23T05:21:18.036Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:21:18.036Z] [LOG] ======================================================================

[2025-10-23T05:21:18.036Z] [LOG] ✅ Ratheeshanan null: Calculation completed successfully
[2025-10-23T05:21:18.037Z] [LOG] 📊 Progress: 21/34 (61.8%)
[2025-10-23T05:21:18.037Z] [LOG] 
🧮 Processing: Chamodi null (EMP000032)
[2025-10-23T05:21:18.037Z] [LOG] 📋 Record ID: 8fb3762c-a216-419a-99f8-5b768723e68d
[2025-10-23T05:21:18.038Z] [LOG] 
======================================================================
[2025-10-23T05:21:18.038Z] [LOG] 🧮 CALCULATING PAYROLL: Chamodi null (EMP000032)
[2025-10-23T05:21:18.038Z] [LOG] ======================================================================
[2025-10-23T05:21:18.994Z] [LOG] 🔍 Component filtering for employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-23T05:21:18.994Z] [LOG]    Total components: 13
[2025-10-23T05:21:18.995Z] [LOG]    Applicable components: 13
[2025-10-23T05:21:18.995Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:21:20.350Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:21:20.350Z] [LOG] 🔄 Processing financial records for employee 0143f302-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:21:20.612Z] [LOG] 📊 Found 0 active loans for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:20.809Z] [LOG] 📊 Found 0 active advances for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:21.018Z] [LOG] 📊 Found 0 approved bonuses for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:21.019Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:21:21.019Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:21:21.446Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:21:21.446Z] [LOG]    Employee ID: 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:21.447Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:21:21.447Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:21:21.447Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:21:21.654Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:21:21.654Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:21:21.654Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:21:21.655Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:21:21.655Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:21:21.655Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:21:21.656Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:21:22.350Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:21:22.351Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:21:22.597Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:21:22.598Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:21:22.598Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:21:22.598Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:21:22.598Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:21:22.598Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:21:22.598Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:21:22.598Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:21:22.838Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:21:22.838Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:21:22.838Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:21:22.838Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:21:23.069Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:21:23.069Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:21:23.070Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:21:23.070Z] [LOG]       Current Time: 10:51:23
[2025-10-23T05:21:23.071Z] [LOG]       Expected Hours (scheduled → now): 2.36h
[2025-10-23T05:21:23.071Z] [LOG]       Actual Hours (check-in → now): 2.36h
[2025-10-23T05:21:23.071Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:21:23.072Z] [LOG]       Weekday: 121.36h
[2025-10-23T05:21:23.072Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:21:23.072Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:23.073Z] [LOG]       Total Expected: 134.86h
[2025-10-23T05:21:23.073Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:21:23.073Z] [LOG]       Weekday: 27.86h (includes 2.36h live)
[2025-10-23T05:21:23.074Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:21:23.074Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:23.074Z] [LOG]       Total Actual: 32.36h
[2025-10-23T05:21:23.075Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:21:23.075Z] [LOG]       Weekday: 121.36h × Rs.235.29 = Rs.28553.95
[2025-10-23T05:21:23.075Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:21:23.076Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:23.076Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:23.076Z] [LOG]       Total Expected Earned: Rs.34553.89
[2025-10-23T05:21:23.077Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:21:23.077Z] [LOG]       Weekday: 27.86h × Rs.235.29 = Rs.6554.33
[2025-10-23T05:21:23.077Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:21:23.077Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:23.078Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:23.078Z] [LOG]       Total Actual Earned: Rs.8554.31
[2025-10-23T05:21:23.079Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:21:23.079Z] [LOG]       Calculated At: Oct 23, 2025, 10:51:23
[2025-10-23T05:21:23.079Z] [LOG]       Expected Earned (until NOW): Rs.34553.89
[2025-10-23T05:21:23.080Z] [LOG]       Actual Earned (until NOW): Rs.8554.31
[2025-10-23T05:21:23.080Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:23.080Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:21:23.081Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:21:23.081Z] [LOG]       📉 Shortfall: 102.50 hours (75.24% of expected)
[2025-10-23T05:21:23.081Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:21:23.082Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:21:23.082Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:21:23.082Z] [LOG]    Actual Earned Base: Rs.8554.31
[2025-10-23T05:21:23.083Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:21:23.083Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:21:23.083Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:21:23.084Z] [LOG]    Gross Salary: 8554.314251391666
[2025-10-23T05:21:23.084Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:21:23.085Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:21:23.085Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.086Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:21:23.086Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.086Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:21:23.087Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.087Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:21:23.087Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.087Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:21:23.088Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.088Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:21:23.088Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.089Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:21:23.089Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.089Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:21:23.090Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.090Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:21:23.090Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.090Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:21:23.091Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.091Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:21:23.091Z] [LOG]    EPF/ETF calculated on: Rs.8554.31
[2025-10-23T05:21:23.091Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:21:23.092Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:21:23.092Z] [LOG] 💰 GROSS CALCULATION for Chamodi null:
[2025-10-23T05:21:23.092Z] [LOG]    Base Salary: 50000
[2025-10-23T05:21:23.092Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:21:23.093Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:21:23.093Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.093Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:21:23.093Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.094Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:21:23.094Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:23.308Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:21:23.309Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:23.309Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:21:23.309Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:21:23.310Z] [LOG]    Actual Earned Base: Rs.8554.31
[2025-10-23T05:21:23.310Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:21:23.310Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:21:23.311Z] [LOG]    = Gross Salary: Rs.8554.31
[2025-10-23T05:21:23.311Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:21:23.311Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:21:23.312Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:21:23.312Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:23.312Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:21:23.312Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:21:23.313Z] [LOG]    Gross Salary: Rs.8554.31
[2025-10-23T05:21:23.313Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:21:23.313Z] [LOG]    = NET SALARY: Rs.8554.31
[2025-10-23T05:21:23.314Z] [LOG] 
💾 Database Update:
[2025-10-23T05:21:23.314Z] [LOG]    Total Earnings: Rs.8554.31 (Base: 8554.31 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:21:23.315Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:21:23.551Z] [LOG] 
📝 Components to save:
[2025-10-23T05:21:23.551Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:21:23.551Z] [LOG]    Deduction components: 1
[2025-10-23T05:21:23.552Z] [LOG] Creating components for record 8fb3762c-a216-419a-99f8-5b768723e68d: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:21:23.552Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8554.314251391666
}
[2025-10-23T05:21:23.793Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:21:24.029Z] [LOG] Created payroll_record_component: ff964dfc-c6e3-4fba-8b7d-1d15bc8204e5 for Base Salary
[2025-10-23T05:21:24.029Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:21:24.277Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:21:24.508Z] [LOG] Created payroll_record_component: cf75a412-a5b9-40ed-adb6-c310bb3328a9 for Attendance Shortfall (Info)
[2025-10-23T05:21:24.994Z] [LOG] ✅ Financial balances updated successfully for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:24.994Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:21:24.995Z] [LOG] 
======================================================================
[2025-10-23T05:21:24.995Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Chamodi null
[2025-10-23T05:21:24.995Z] [LOG] ======================================================================
[2025-10-23T05:21:24.996Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:21:24.996Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8554.31
[2025-10-23T05:21:24.996Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:21:24.997Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:24.997Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:24.997Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:21:24.998Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:24.998Z] [LOG]    GROSS SALARY: Rs.8554.31
[2025-10-23T05:21:24.998Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:24.999Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:21:24.999Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:21:24.999Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:21:24.999Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:21:25.000Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:21:25.000Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:25.000Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:25.001Z] [LOG]    NET SALARY: Rs.8554.31
[2025-10-23T05:21:25.001Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:21:25.001Z] [LOG] ======================================================================

[2025-10-23T05:21:25.002Z] [LOG] ✅ Chamodi null: Calculation completed successfully
[2025-10-23T05:21:25.002Z] [LOG] 📊 Progress: 22/34 (64.7%)
[2025-10-23T05:21:25.002Z] [LOG] 
🧮 Processing: R. D.A Kaushalya null (EMP000044)
[2025-10-23T05:21:25.003Z] [LOG] 📋 Record ID: 9cbc0305-a5b4-4bca-ac83-82d93196b253
[2025-10-23T05:21:25.003Z] [LOG] 
======================================================================
[2025-10-23T05:21:25.003Z] [LOG] 🧮 CALCULATING PAYROLL: R. D.A Kaushalya null (EMP000044)
[2025-10-23T05:21:25.004Z] [LOG] ======================================================================
[2025-10-23T05:21:25.948Z] [LOG] 🔍 Component filtering for employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-23T05:21:25.949Z] [LOG]    Total components: 13
[2025-10-23T05:21:25.949Z] [LOG]    Applicable components: 13
[2025-10-23T05:21:25.949Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:21:27.309Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:21:27.309Z] [LOG] 🔄 Processing financial records for employee 01443963-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:21:27.559Z] [LOG] 📊 Found 0 active loans for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:27.791Z] [LOG] 📊 Found 0 active advances for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:28.030Z] [LOG] 📊 Found 0 approved bonuses for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:28.031Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:21:28.031Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:21:28.270Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:21:28.270Z] [LOG]    Employee ID: 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:28.271Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:21:28.271Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:21:28.271Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:21:28.510Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:21:28.510Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:21:28.511Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:21:28.511Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:21:28.511Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:21:28.511Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:21:28.512Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:21:29.230Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:21:29.231Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:21:29.470Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:21:29.471Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:21:29.471Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:21:29.471Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:21:29.472Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:21:29.472Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:21:29.472Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:21:29.473Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:21:29.714Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:21:29.715Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:21:29.715Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:21:29.715Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:21:29.968Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:21:29.968Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:21:29.968Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:21:29.969Z] [LOG]       Current Time: 10:51:29
[2025-10-23T05:21:29.970Z] [LOG]       Expected Hours (scheduled → now): 2.36h
[2025-10-23T05:21:29.970Z] [LOG]       Actual Hours (check-in → now): 2.36h
[2025-10-23T05:21:29.970Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:21:29.971Z] [LOG]       Weekday: 121.36h
[2025-10-23T05:21:29.971Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:21:29.971Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:29.971Z] [LOG]       Total Expected: 134.86h
[2025-10-23T05:21:29.972Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:21:29.972Z] [LOG]       Weekday: 27.86h (includes 2.36h live)
[2025-10-23T05:21:29.972Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:21:29.973Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:29.973Z] [LOG]       Total Actual: 32.36h
[2025-10-23T05:21:29.973Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:21:29.974Z] [LOG]       Weekday: 121.36h × Rs.235.29 = Rs.28554.40
[2025-10-23T05:21:29.974Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:21:29.974Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:29.975Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:29.975Z] [LOG]       Total Expected Earned: Rs.34554.34
[2025-10-23T05:21:29.975Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:21:29.976Z] [LOG]       Weekday: 27.86h × Rs.235.29 = Rs.6554.79
[2025-10-23T05:21:29.976Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:21:29.976Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:29.977Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:29.977Z] [LOG]       Total Actual Earned: Rs.8554.77
[2025-10-23T05:21:29.978Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:21:29.978Z] [LOG]       Calculated At: Oct 23, 2025, 10:51:29
[2025-10-23T05:21:29.978Z] [LOG]       Expected Earned (until NOW): Rs.34554.34
[2025-10-23T05:21:29.979Z] [LOG]       Actual Earned (until NOW): Rs.8554.77
[2025-10-23T05:21:29.979Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:29.979Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:21:29.980Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:21:29.980Z] [LOG]       📉 Shortfall: 102.50 hours (75.24% of expected)
[2025-10-23T05:21:29.980Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:21:29.980Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:21:29.981Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:21:29.981Z] [LOG]    Actual Earned Base: Rs.8554.77
[2025-10-23T05:21:29.981Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:21:29.982Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:21:29.982Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:21:29.983Z] [LOG]    Gross Salary: 8554.765158533333
[2025-10-23T05:21:29.983Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:21:29.984Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:21:29.984Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.984Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:21:29.985Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.985Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:21:29.985Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.986Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:21:29.986Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.986Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:21:29.986Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.987Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:21:29.987Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.987Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:21:29.987Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.988Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:21:29.988Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.988Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:21:29.988Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.989Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:21:29.990Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.990Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:21:29.990Z] [LOG]    EPF/ETF calculated on: Rs.8554.77
[2025-10-23T05:21:29.990Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:21:29.990Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:21:29.991Z] [LOG] 💰 GROSS CALCULATION for R. D.A Kaushalya null:
[2025-10-23T05:21:29.991Z] [LOG]    Base Salary: 50000
[2025-10-23T05:21:29.991Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:21:29.992Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:21:29.992Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.992Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:21:29.992Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:29.992Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:21:29.993Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:30.270Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:21:30.270Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:30.270Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:21:30.271Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:21:30.271Z] [LOG]    Actual Earned Base: Rs.8554.77
[2025-10-23T05:21:30.271Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:21:30.271Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:21:30.272Z] [LOG]    = Gross Salary: Rs.8554.77
[2025-10-23T05:21:30.272Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:21:30.272Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:21:30.273Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:21:30.273Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:30.274Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:21:30.274Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:21:30.274Z] [LOG]    Gross Salary: Rs.8554.77
[2025-10-23T05:21:30.275Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:21:30.275Z] [LOG]    = NET SALARY: Rs.8554.77
[2025-10-23T05:21:30.275Z] [LOG] 
💾 Database Update:
[2025-10-23T05:21:30.276Z] [LOG]    Total Earnings: Rs.8554.77 (Base: 8554.77 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:21:30.276Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:21:30.477Z] [LOG] 
📝 Components to save:
[2025-10-23T05:21:30.477Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:21:30.477Z] [LOG]    Deduction components: 1
[2025-10-23T05:21:30.478Z] [LOG] Creating components for record 9cbc0305-a5b4-4bca-ac83-82d93196b253: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:21:30.478Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8554.765158533333
}
[2025-10-23T05:21:30.670Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:21:30.908Z] [LOG] Created payroll_record_component: 6d1a9259-a9c6-4e35-ac57-4311625fbd5c for Base Salary
[2025-10-23T05:21:30.909Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T05:21:31.152Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:21:31.390Z] [LOG] Created payroll_record_component: 93acb58e-31cd-4837-b21c-11ef483f7305 for Attendance Shortfall (Info)
[2025-10-23T05:21:31.869Z] [LOG] ✅ Financial balances updated successfully for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:31.869Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:21:31.870Z] [LOG] 
======================================================================
[2025-10-23T05:21:31.870Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: R. D.A Kaushalya null
[2025-10-23T05:21:31.870Z] [LOG] ======================================================================
[2025-10-23T05:21:31.870Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:21:31.870Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8554.77
[2025-10-23T05:21:31.871Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:21:31.871Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:31.871Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:31.871Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:21:31.872Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:31.872Z] [LOG]    GROSS SALARY: Rs.8554.77
[2025-10-23T05:21:31.872Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:31.873Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:21:31.873Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:21:31.874Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:21:31.874Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:21:31.874Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:21:31.874Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:31.875Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:31.875Z] [LOG]    NET SALARY: Rs.8554.77
[2025-10-23T05:21:31.875Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:21:31.875Z] [LOG] ======================================================================

[2025-10-23T05:21:31.876Z] [LOG] ✅ R. D.A Kaushalya null: Calculation completed successfully
[2025-10-23T05:21:31.876Z] [LOG] 📊 Progress: 23/34 (67.6%)
[2025-10-23T05:21:31.877Z] [LOG] 
🧮 Processing: Ruvindu Hewabandu null (EMP000027)
[2025-10-23T05:21:31.877Z] [LOG] 📋 Record ID: a2a28b1a-48d4-412b-a642-d7ca5c2420b6
[2025-10-23T05:21:31.877Z] [LOG] 
======================================================================
[2025-10-23T05:21:31.877Z] [LOG] 🧮 CALCULATING PAYROLL: Ruvindu Hewabandu null (EMP000027)
[2025-10-23T05:21:31.878Z] [LOG] ======================================================================
[2025-10-23T05:21:33.023Z] [LOG] 🔍 Component filtering for employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-23T05:21:33.024Z] [LOG]    Total components: 13
[2025-10-23T05:21:33.024Z] [LOG]    Applicable components: 13
[2025-10-23T05:21:33.024Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:21:34.437Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:21:34.437Z] [LOG] 🔄 Processing financial records for employee 0143e915-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:21:34.679Z] [LOG] 📊 Found 0 active loans for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:34.910Z] [LOG] 📊 Found 0 active advances for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:35.160Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:35.161Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:21:35.161Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:21:35.407Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:21:35.407Z] [LOG]    Employee ID: 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:35.408Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:21:35.408Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:21:35.409Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-23T05:21:35.795Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:21:35.795Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-23T05:21:35.796Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T05:21:35.796Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-23T05:21:35.796Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:21:35.796Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:21:35.797Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:21:36.401Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:21:36.401Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:21:36.605Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:21:36.605Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:21:36.605Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:21:36.606Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:21:36.606Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:21:36.606Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:21:36.607Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:21:36.607Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:21:36.798Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:21:36.798Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:21:36.798Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:21:36.799Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:21:37.069Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:21:37.069Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:21:37.070Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:21:37.070Z] [LOG]       Current Time: 10:51:37
[2025-10-23T05:21:37.071Z] [LOG]       Expected Hours (scheduled → now): 2.36h
[2025-10-23T05:21:37.071Z] [LOG]       Actual Hours (check-in → now): 2.36h
[2025-10-23T05:21:37.071Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:21:37.071Z] [LOG]       Weekday: 121.36h
[2025-10-23T05:21:37.072Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:21:37.072Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:37.072Z] [LOG]       Total Expected: 134.86h
[2025-10-23T05:21:37.072Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:21:37.073Z] [LOG]       Weekday: 27.86h (includes 2.36h live)
[2025-10-23T05:21:37.073Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:21:37.073Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:37.074Z] [LOG]       Total Actual: 32.36h
[2025-10-23T05:21:37.074Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:21:37.074Z] [LOG]       Weekday: 121.36h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:37.075Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:37.075Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:37.075Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:37.075Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-23T05:21:37.075Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:21:37.076Z] [LOG]       Weekday: 27.86h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:37.076Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:37.076Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:37.077Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:37.077Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-23T05:21:37.078Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:21:37.078Z] [LOG]       Calculated At: Oct 23, 2025, 10:51:37
[2025-10-23T05:21:37.078Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-23T05:21:37.079Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-23T05:21:37.079Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:37.079Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-23T05:21:37.079Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:21:37.080Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-23T05:21:37.080Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:21:37.080Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:21:37.081Z] [LOG]    Base Salary (Full): Rs.NaN
[2025-10-23T05:21:37.081Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:21:37.081Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:21:37.081Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:21:37.082Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:21:37.082Z] [LOG]    Gross Salary: 0
[2025-10-23T05:21:37.082Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:21:37.082Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:21:37.083Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.083Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:21:37.084Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.085Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:21:37.085Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.085Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:21:37.085Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.086Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:21:37.086Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.086Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:21:37.086Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.087Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:21:37.087Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.087Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:21:37.088Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.088Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:21:37.088Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.089Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:21:37.089Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.089Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:21:37.089Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-23T05:21:37.090Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:21:37.090Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:21:37.090Z] [LOG] 💰 GROSS CALCULATION for Ruvindu Hewabandu null:
[2025-10-23T05:21:37.090Z] [LOG]    Base Salary: 0
[2025-10-23T05:21:37.090Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:21:37.090Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:21:37.090Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.090Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:21:37.091Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.091Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:21:37.091Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:37.317Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:21:37.318Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:37.318Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:21:37.318Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:21:37.319Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:21:37.319Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:21:37.319Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:21:37.320Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-23T05:21:37.320Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:21:37.320Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:21:37.321Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:37.321Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:21:37.321Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:21:37.322Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-23T05:21:37.322Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:21:37.322Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-23T05:21:37.323Z] [LOG] 
💾 Database Update:
[2025-10-23T05:21:37.323Z] [LOG]    Total Earnings: Rs.0.00 (Base: 0.00 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:21:37.324Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:21:37.558Z] [LOG] 
📝 Components to save:
[2025-10-23T05:21:37.559Z] [LOG]    Gross/Earnings components: 0
[2025-10-23T05:21:37.559Z] [LOG]    Deduction components: 0
[2025-10-23T05:21:37.560Z] [LOG] Creating components for record a2a28b1a-48d4-412b-a642-d7ca5c2420b6: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-23T05:21:37.990Z] [LOG] ✅ Financial balances updated successfully for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:37.991Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:21:37.991Z] [LOG] 
======================================================================
[2025-10-23T05:21:37.991Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ruvindu Hewabandu null
[2025-10-23T05:21:37.991Z] [LOG] ======================================================================
[2025-10-23T05:21:37.992Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T05:21:37.992Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-23T05:21:37.992Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:21:37.992Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:37.993Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:37.993Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:21:37.993Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:37.993Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-23T05:21:37.994Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:37.994Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:21:37.994Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:21:37.995Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:21:37.995Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:21:37.995Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-23T05:21:37.995Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:37.996Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:37.996Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-23T05:21:37.996Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:21:37.996Z] [LOG] ======================================================================

[2025-10-23T05:21:37.997Z] [LOG] ✅ Ruvindu Hewabandu null: Calculation completed successfully
[2025-10-23T05:21:37.997Z] [LOG] 📊 Progress: 24/34 (70.6%)
[2025-10-23T05:21:37.998Z] [LOG] 
🧮 Processing: Uthpala null (EMP000006)
[2025-10-23T05:21:37.998Z] [LOG] 📋 Record ID: b0a2e34a-a686-43d4-b1ac-cb6a541009c1
[2025-10-23T05:21:37.998Z] [LOG] 
======================================================================
[2025-10-23T05:21:37.998Z] [LOG] 🧮 CALCULATING PAYROLL: Uthpala null (EMP000006)
[2025-10-23T05:21:37.999Z] [LOG] ======================================================================
[2025-10-23T05:21:39.106Z] [LOG] 🔍 Component filtering for employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-23T05:21:39.106Z] [LOG]    Total components: 13
[2025-10-23T05:21:39.107Z] [LOG]    Applicable components: 13
[2025-10-23T05:21:39.107Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T05:21:41.909Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:21:41.909Z] [LOG] 🔄 Processing financial records for employee 0143a539-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:21:42.104Z] [LOG] 📊 Found 0 active loans for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:42.351Z] [LOG] 📊 Found 0 active advances for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:42.594Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:42.595Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:21:42.595Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:21:42.845Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:21:42.846Z] [LOG]    Employee ID: 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:42.846Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:21:42.846Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:21:42.847Z] [LOG]    Base Salary (Full Month): Rs.100000.00
[2025-10-23T05:21:43.070Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:21:43.070Z] [LOG]       Daily Salary: Rs.4000.00
[2025-10-23T05:21:43.071Z] [LOG]       Weekday Hourly Rate: Rs.500.00
[2025-10-23T05:21:43.071Z] [LOG]       Saturday Hourly Rate: Rs.888.89
[2025-10-23T05:21:43.071Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:21:43.071Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:21:43.071Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:21:43.830Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:21:43.831Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:21:44.205Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:21:44.205Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:21:44.205Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:21:44.205Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:21:44.206Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:21:44.206Z] [LOG]          2. 2025-10-15 (Weekday): 7.50h
[2025-10-23T05:21:44.206Z] [LOG]          3. 2025-10-16 (Weekday): 7.50h
[2025-10-23T05:21:44.206Z] [LOG]          4. 2025-10-22 (Weekday): 7.50h
[2025-10-23T05:21:44.436Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:21:44.436Z] [LOG]          Weekday: 22.50h
[2025-10-23T05:21:44.436Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:21:44.436Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:21:44.669Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:21:44.669Z] [LOG]       Scheduled Start: 09:30:00
[2025-10-23T05:21:44.669Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:21:44.669Z] [LOG]       Current Time: 10:51:44
[2025-10-23T05:21:44.670Z] [LOG]       Expected Hours (scheduled → now): 1.36h
[2025-10-23T05:21:44.670Z] [LOG]       Actual Hours (check-in → now): 2.36h
[2025-10-23T05:21:44.670Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:21:44.670Z] [LOG]       Weekday: 113.36h
[2025-10-23T05:21:44.670Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:21:44.670Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:44.670Z] [LOG]       Total Expected: 126.86h
[2025-10-23T05:21:44.670Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:21:44.670Z] [LOG]       Weekday: 24.86h (includes 2.36h live)
[2025-10-23T05:21:44.671Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:21:44.671Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:44.671Z] [LOG]       Total Actual: 29.36h
[2025-10-23T05:21:44.671Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:21:44.671Z] [LOG]       Weekday: 113.36h × Rs.500.00 = Rs.56681.20
[2025-10-23T05:21:44.671Z] [LOG]       Saturday: 13.50h × Rs.888.89 = Rs.12000.01
[2025-10-23T05:21:44.671Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:44.671Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:44.671Z] [LOG]       Total Expected Earned: Rs.68681.22
[2025-10-23T05:21:44.672Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:21:44.672Z] [LOG]       Weekday: 24.86h × Rs.500.00 = Rs.12431.20
[2025-10-23T05:21:44.672Z] [LOG]       Saturday: 4.50h × Rs.888.89 = Rs.4000.01
[2025-10-23T05:21:44.672Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:44.672Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:44.672Z] [LOG]       Total Actual Earned: Rs.16431.21
[2025-10-23T05:21:44.673Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:21:44.673Z] [LOG]       Calculated At: Oct 23, 2025, 10:51:44
[2025-10-23T05:21:44.673Z] [LOG]       Expected Earned (until NOW): Rs.68681.22
[2025-10-23T05:21:44.673Z] [LOG]       Actual Earned (until NOW): Rs.16431.21
[2025-10-23T05:21:44.674Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:44.674Z] [LOG]       Attendance Deduction: Rs.52250.01
[2025-10-23T05:21:44.674Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:21:44.674Z] [LOG]       📉 Shortfall: 97.50 hours (76.08% of expected)
[2025-10-23T05:21:44.674Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:21:44.674Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:21:44.674Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T05:21:44.675Z] [LOG]    Actual Earned Base: Rs.16431.21
[2025-10-23T05:21:44.675Z] [LOG]    Attendance Shortfall: Rs.52250.01
[2025-10-23T05:21:44.675Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:21:44.675Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:21:44.675Z] [LOG]    Gross Salary: 16431.20902777778
[2025-10-23T05:21:44.675Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:21:44.675Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:21:44.676Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.676Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:21:44.676Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.676Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:21:44.676Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.676Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:21:44.676Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.676Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:21:44.676Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.677Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:21:44.677Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.677Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:21:44.677Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.677Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:21:44.677Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.677Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:21:44.677Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.677Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:21:44.678Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.678Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:21:44.678Z] [LOG]    EPF/ETF calculated on: Rs.16431.21
[2025-10-23T05:21:44.678Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:21:44.678Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:21:44.678Z] [LOG] 💰 GROSS CALCULATION for Uthpala null:
[2025-10-23T05:21:44.678Z] [LOG]    Base Salary: 100000
[2025-10-23T05:21:44.679Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:21:44.679Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:21:44.679Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.679Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:21:44.679Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.679Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:21:44.679Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:44.869Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:21:44.870Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:44.870Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:21:44.870Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:21:44.870Z] [LOG]    Actual Earned Base: Rs.16431.21
[2025-10-23T05:21:44.870Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:21:44.870Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:21:44.870Z] [LOG]    = Gross Salary: Rs.16431.21
[2025-10-23T05:21:44.870Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:21:44.870Z] [LOG]    Attendance Shortfall (Info): Rs.52250.01
[2025-10-23T05:21:44.870Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:21:44.871Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:44.871Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:21:44.871Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:21:44.871Z] [LOG]    Gross Salary: Rs.16431.21
[2025-10-23T05:21:44.871Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:21:44.871Z] [LOG]    = NET SALARY: Rs.16431.21
[2025-10-23T05:21:44.871Z] [LOG] 
💾 Database Update:
[2025-10-23T05:21:44.872Z] [LOG]    Total Earnings: Rs.16431.21 (Base: 16431.21 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:21:44.872Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:21:45.068Z] [LOG] 
📝 Components to save:
[2025-10-23T05:21:45.068Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:21:45.069Z] [LOG]    Deduction components: 1
[2025-10-23T05:21:45.069Z] [LOG] Creating components for record b0a2e34a-a686-43d4-b1ac-cb6a541009c1: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:21:45.069Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 16431.20902777778
}
[2025-10-23T05:21:45.260Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:21:45.469Z] [LOG] Created payroll_record_component: 2846849d-cf00-4aaa-bbf1-5026232f97a3 for Base Salary
[2025-10-23T05:21:45.469Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 52250.01000000001
}
[2025-10-23T05:21:45.665Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:21:45.863Z] [LOG] Created payroll_record_component: 48fcf874-4c34-4e01-8d8f-6f470386898f for Attendance Shortfall (Info)
[2025-10-23T05:21:46.268Z] [LOG] ✅ Financial balances updated successfully for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:46.269Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:21:46.269Z] [LOG] 
======================================================================
[2025-10-23T05:21:46.270Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Uthpala null
[2025-10-23T05:21:46.270Z] [LOG] ======================================================================
[2025-10-23T05:21:46.270Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T05:21:46.270Z] [LOG]    Actual Earned Base (Attendance-based): Rs.16431.21
[2025-10-23T05:21:46.271Z] [LOG]    Attendance Shortfall: Rs.52250.01
[2025-10-23T05:21:46.271Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:46.271Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:46.272Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:21:46.272Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:46.272Z] [LOG]    GROSS SALARY: Rs.16431.21
[2025-10-23T05:21:46.273Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:46.273Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:21:46.273Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:21:46.274Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:21:46.274Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:21:46.274Z] [LOG]       - Attendance Shortfall (Info): Rs.52250.01
[2025-10-23T05:21:46.275Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:46.275Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:46.275Z] [LOG]    NET SALARY: Rs.16431.21
[2025-10-23T05:21:46.275Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:21:46.276Z] [LOG] ======================================================================

[2025-10-23T05:21:46.276Z] [LOG] ✅ Uthpala null: Calculation completed successfully
[2025-10-23T05:21:46.277Z] [LOG] 📊 Progress: 25/34 (73.5%)
[2025-10-23T05:21:46.277Z] [LOG] 
🧮 Processing: Hari null (EMP000017)
[2025-10-23T05:21:46.277Z] [LOG] 📋 Record ID: c3938f0e-e2d6-4b92-ae37-c55a3b89df7a
[2025-10-23T05:21:46.278Z] [LOG] 
======================================================================
[2025-10-23T05:21:46.278Z] [LOG] 🧮 CALCULATING PAYROLL: Hari null (EMP000017)
[2025-10-23T05:21:46.278Z] [LOG] ======================================================================
[2025-10-23T05:21:47.149Z] [LOG] 🔍 Component filtering for employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-23T05:21:47.150Z] [LOG]    Total components: 13
[2025-10-23T05:21:47.150Z] [LOG]    Applicable components: 13
[2025-10-23T05:21:47.150Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:21:48.597Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:21:48.598Z] [LOG] 🔄 Processing financial records for employee 0143bc58-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:21:48.830Z] [LOG] 📊 Found 0 active loans for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:49.069Z] [LOG] 📊 Found 0 active advances for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:49.313Z] [LOG] 📊 Found 0 approved bonuses for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:49.314Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:21:49.314Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:21:49.549Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:21:49.550Z] [LOG]    Employee ID: 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:49.550Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:21:49.550Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:21:49.550Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:21:49.790Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:21:49.791Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:21:49.791Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:21:49.791Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:21:49.792Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:21:49.792Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:21:49.792Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:21:50.510Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:21:50.511Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:21:50.752Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:21:50.753Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:21:50.753Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:21:50.753Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:21:50.753Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:21:50.754Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:21:50.754Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:21:50.754Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:21:50.990Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:21:50.991Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:21:50.991Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:21:50.991Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:21:51.229Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:21:51.229Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:21:51.229Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:21:51.230Z] [LOG]       Current Time: 10:51:51
[2025-10-23T05:21:51.230Z] [LOG]       Expected Hours (scheduled → now): 2.36h
[2025-10-23T05:21:51.231Z] [LOG]       Actual Hours (check-in → now): 2.36h
[2025-10-23T05:21:51.231Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:21:51.231Z] [LOG]       Weekday: 121.36h
[2025-10-23T05:21:51.232Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:21:51.232Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:51.232Z] [LOG]       Total Expected: 134.86h
[2025-10-23T05:21:51.232Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:21:51.233Z] [LOG]       Weekday: 27.86h (includes 2.36h live)
[2025-10-23T05:21:51.233Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:21:51.233Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:51.233Z] [LOG]       Total Actual: 32.36h
[2025-10-23T05:21:51.234Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:21:51.234Z] [LOG]       Weekday: 121.36h × Rs.235.29 = Rs.28555.79
[2025-10-23T05:21:51.234Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:21:51.235Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:51.235Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:51.235Z] [LOG]       Total Expected Earned: Rs.34555.73
[2025-10-23T05:21:51.236Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:21:51.236Z] [LOG]       Weekday: 27.86h × Rs.235.29 = Rs.6556.17
[2025-10-23T05:21:51.236Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:21:51.236Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:51.236Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:51.237Z] [LOG]       Total Actual Earned: Rs.8556.15
[2025-10-23T05:21:51.237Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:21:51.238Z] [LOG]       Calculated At: Oct 23, 2025, 10:51:51
[2025-10-23T05:21:51.239Z] [LOG]       Expected Earned (until NOW): Rs.34555.73
[2025-10-23T05:21:51.239Z] [LOG]       Actual Earned (until NOW): Rs.8556.15
[2025-10-23T05:21:51.240Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:51.240Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:21:51.241Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:21:51.241Z] [LOG]       📉 Shortfall: 102.50 hours (75.24% of expected)
[2025-10-23T05:21:51.241Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:21:51.241Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:21:51.242Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:21:51.242Z] [LOG]    Actual Earned Base: Rs.8556.15
[2025-10-23T05:21:51.242Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:21:51.243Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:21:51.243Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:21:51.243Z] [LOG]    Gross Salary: 8556.154742058334
[2025-10-23T05:21:51.243Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:21:51.244Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:21:51.244Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.244Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:21:51.245Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.245Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:21:51.245Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.246Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:21:51.246Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.247Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:21:51.247Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.247Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:21:51.248Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.248Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:21:51.248Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.249Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:21:51.249Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.249Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:21:51.250Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.250Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:21:51.250Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.250Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:21:51.251Z] [LOG]    EPF/ETF calculated on: Rs.8556.15
[2025-10-23T05:21:51.251Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:21:51.251Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:21:51.252Z] [LOG] 💰 GROSS CALCULATION for Hari null:
[2025-10-23T05:21:51.252Z] [LOG]    Base Salary: 50000
[2025-10-23T05:21:51.252Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:21:51.252Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:21:51.252Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.253Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:21:51.253Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.253Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:21:51.253Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:51.469Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:21:51.470Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:51.470Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:21:51.471Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:21:51.471Z] [LOG]    Actual Earned Base: Rs.8556.15
[2025-10-23T05:21:51.471Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:21:51.472Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:21:51.472Z] [LOG]    = Gross Salary: Rs.8556.15
[2025-10-23T05:21:51.472Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:21:51.473Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:21:51.473Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:21:51.474Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:51.474Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:21:51.474Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:21:51.475Z] [LOG]    Gross Salary: Rs.8556.15
[2025-10-23T05:21:51.475Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:21:51.475Z] [LOG]    = NET SALARY: Rs.8556.15
[2025-10-23T05:21:51.476Z] [LOG] 
💾 Database Update:
[2025-10-23T05:21:51.476Z] [LOG]    Total Earnings: Rs.8556.15 (Base: 8556.15 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:21:51.476Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:21:51.727Z] [LOG] 
📝 Components to save:
[2025-10-23T05:21:51.727Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:21:51.728Z] [LOG]    Deduction components: 1
[2025-10-23T05:21:51.728Z] [LOG] Creating components for record c3938f0e-e2d6-4b92-ae37-c55a3b89df7a: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:21:51.729Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8556.154742058334
}
[2025-10-23T05:21:51.949Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:21:52.140Z] [LOG] Created payroll_record_component: 6d144c05-6358-419e-97bc-df9f3e475668 for Base Salary
[2025-10-23T05:21:52.140Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T05:21:52.333Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:21:52.541Z] [LOG] Created payroll_record_component: 17d1c8cd-caca-4f44-a860-9e851012f71a for Attendance Shortfall (Info)
[2025-10-23T05:21:52.993Z] [LOG] ✅ Financial balances updated successfully for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:52.993Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:21:52.993Z] [LOG] 
======================================================================
[2025-10-23T05:21:52.994Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Hari null
[2025-10-23T05:21:52.994Z] [LOG] ======================================================================
[2025-10-23T05:21:52.994Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:21:52.995Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8556.15
[2025-10-23T05:21:52.995Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:21:52.995Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:52.995Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:52.996Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:21:52.996Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:52.996Z] [LOG]    GROSS SALARY: Rs.8556.15
[2025-10-23T05:21:52.997Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:52.997Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:21:52.997Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:21:52.998Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:21:52.998Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:21:52.998Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:21:52.998Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:52.999Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:52.999Z] [LOG]    NET SALARY: Rs.8556.15
[2025-10-23T05:21:52.999Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:21:53.000Z] [LOG] ======================================================================

[2025-10-23T05:21:53.000Z] [LOG] ✅ Hari null: Calculation completed successfully
[2025-10-23T05:21:53.001Z] [LOG] 📊 Progress: 26/34 (76.5%)
[2025-10-23T05:21:53.001Z] [LOG] 
🧮 Processing: Safna Nawas null (EMP000021)
[2025-10-23T05:21:53.001Z] [LOG] 📋 Record ID: c463d745-d389-47e1-855d-a2567e81411f
[2025-10-23T05:21:53.002Z] [LOG] 
======================================================================
[2025-10-23T05:21:53.002Z] [LOG] 🧮 CALCULATING PAYROLL: Safna Nawas null (EMP000021)
[2025-10-23T05:21:53.002Z] [LOG] ======================================================================
[2025-10-23T05:21:53.871Z] [LOG] 🔍 Component filtering for employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-23T05:21:53.872Z] [LOG]    Total components: 13
[2025-10-23T05:21:53.872Z] [LOG]    Applicable components: 13
[2025-10-23T05:21:53.872Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:21:55.228Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:21:55.229Z] [LOG] 🔄 Processing financial records for employee 0143c977-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:21:55.446Z] [LOG] 📊 Found 0 active loans for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:55.718Z] [LOG] 📊 Found 0 active advances for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:55.952Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:55.953Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:21:55.953Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:21:56.193Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:21:56.193Z] [LOG]    Employee ID: 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:56.194Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:21:56.194Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:21:56.194Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:21:56.430Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:21:56.430Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:21:56.431Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:21:56.431Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:21:56.431Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:21:56.431Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:21:56.432Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:21:57.054Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:21:57.055Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:21:57.309Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:21:57.310Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:21:57.310Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:21:57.310Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:21:57.310Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:21:57.311Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:21:57.311Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:21:57.311Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:21:57.550Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:21:57.551Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:21:57.551Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:21:57.552Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:21:57.790Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:21:57.790Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:21:57.791Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:21:57.792Z] [LOG]       Current Time: 10:51:57
[2025-10-23T05:21:57.792Z] [LOG]       Expected Hours (scheduled → now): 2.37h
[2025-10-23T05:21:57.792Z] [LOG]       Actual Hours (check-in → now): 2.37h
[2025-10-23T05:21:57.793Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:21:57.793Z] [LOG]       Weekday: 121.37h
[2025-10-23T05:21:57.793Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:21:57.794Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:57.794Z] [LOG]       Total Expected: 134.87h
[2025-10-23T05:21:57.794Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:21:57.795Z] [LOG]       Weekday: 27.87h (includes 2.37h live)
[2025-10-23T05:21:57.795Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:21:57.795Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:21:57.796Z] [LOG]       Total Actual: 32.37h
[2025-10-23T05:21:57.796Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:21:57.796Z] [LOG]       Weekday: 121.37h × Rs.235.29 = Rs.28556.22
[2025-10-23T05:21:57.797Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:21:57.797Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:57.797Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:57.798Z] [LOG]       Total Expected Earned: Rs.34556.16
[2025-10-23T05:21:57.798Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:21:57.799Z] [LOG]       Weekday: 27.87h × Rs.235.29 = Rs.6556.60
[2025-10-23T05:21:57.799Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:21:57.799Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:21:57.799Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:57.800Z] [LOG]       Total Actual Earned: Rs.8556.58
[2025-10-23T05:21:57.801Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:21:57.801Z] [LOG]       Calculated At: Oct 23, 2025, 10:51:57
[2025-10-23T05:21:57.802Z] [LOG]       Expected Earned (until NOW): Rs.34556.16
[2025-10-23T05:21:57.802Z] [LOG]       Actual Earned (until NOW): Rs.8556.58
[2025-10-23T05:21:57.802Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:21:57.803Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:21:57.803Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:21:57.803Z] [LOG]       📉 Shortfall: 102.50 hours (75.24% of expected)
[2025-10-23T05:21:57.804Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:21:57.804Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:21:57.805Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:21:57.806Z] [LOG]    Actual Earned Base: Rs.8556.58
[2025-10-23T05:21:57.806Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:21:57.806Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:21:57.807Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:21:57.807Z] [LOG]    Gross Salary: 8556.583558083334
[2025-10-23T05:21:57.807Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:21:57.807Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:21:57.807Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.807Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:21:57.808Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.808Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:21:57.808Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.808Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:21:57.808Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.809Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:21:57.809Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.809Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:21:57.810Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.810Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:21:57.810Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.811Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:21:57.811Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.812Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:21:57.812Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.813Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:21:57.813Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.814Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:21:57.814Z] [LOG]    EPF/ETF calculated on: Rs.8556.58
[2025-10-23T05:21:57.814Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:21:57.815Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:21:57.815Z] [LOG] 💰 GROSS CALCULATION for Safna Nawas null:
[2025-10-23T05:21:57.815Z] [LOG]    Base Salary: 50000
[2025-10-23T05:21:57.816Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:21:57.816Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:21:57.816Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.817Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:21:57.817Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:57.817Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:21:57.817Z] [LOG]    Fixed amount: 0
[2025-10-23T05:21:58.029Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:21:58.030Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:58.030Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:21:58.031Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:21:58.031Z] [LOG]    Actual Earned Base: Rs.8556.58
[2025-10-23T05:21:58.031Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:21:58.031Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:21:58.032Z] [LOG]    = Gross Salary: Rs.8556.58
[2025-10-23T05:21:58.032Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:21:58.032Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:21:58.033Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:21:58.033Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:58.033Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:21:58.034Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:21:58.034Z] [LOG]    Gross Salary: Rs.8556.58
[2025-10-23T05:21:58.034Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:21:58.034Z] [LOG]    = NET SALARY: Rs.8556.58
[2025-10-23T05:21:58.035Z] [LOG] 
💾 Database Update:
[2025-10-23T05:21:58.035Z] [LOG]    Total Earnings: Rs.8556.58 (Base: 8556.58 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:21:58.036Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:21:58.301Z] [LOG] 
📝 Components to save:
[2025-10-23T05:21:58.302Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:21:58.302Z] [LOG]    Deduction components: 1
[2025-10-23T05:21:58.302Z] [LOG] Creating components for record c463d745-d389-47e1-855d-a2567e81411f: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:21:58.303Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8556.583558083334
}
[2025-10-23T05:21:58.532Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:21:58.750Z] [LOG] Created payroll_record_component: 0abf36f4-2941-4bc4-a975-6ed6870269d3 for Base Salary
[2025-10-23T05:21:58.750Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T05:21:58.990Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:21:59.229Z] [LOG] Created payroll_record_component: 78ad2b78-e25b-4708-8b59-8769a94437b8 for Attendance Shortfall (Info)
[2025-10-23T05:21:59.713Z] [LOG] ✅ Financial balances updated successfully for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T05:21:59.714Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:21:59.714Z] [LOG] 
======================================================================
[2025-10-23T05:21:59.715Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Safna Nawas null
[2025-10-23T05:21:59.715Z] [LOG] ======================================================================
[2025-10-23T05:21:59.715Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:21:59.716Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8556.58
[2025-10-23T05:21:59.716Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:21:59.716Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:59.716Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:21:59.717Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:21:59.717Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:59.717Z] [LOG]    GROSS SALARY: Rs.8556.58
[2025-10-23T05:21:59.718Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:59.718Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:21:59.718Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:21:59.719Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:21:59.719Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:21:59.719Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:21:59.720Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:21:59.720Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:21:59.720Z] [LOG]    NET SALARY: Rs.8556.58
[2025-10-23T05:21:59.721Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:21:59.721Z] [LOG] ======================================================================

[2025-10-23T05:21:59.721Z] [LOG] ✅ Safna Nawas null: Calculation completed successfully
[2025-10-23T05:21:59.722Z] [LOG] 📊 Progress: 27/34 (79.4%)
[2025-10-23T05:21:59.722Z] [LOG] 
🧮 Processing: Sujevan Selvaratnam null (EMP000026)
[2025-10-23T05:21:59.723Z] [LOG] 📋 Record ID: c5ff96fe-5811-4461-878c-ebce10584326
[2025-10-23T05:21:59.723Z] [LOG] 
======================================================================
[2025-10-23T05:21:59.723Z] [LOG] 🧮 CALCULATING PAYROLL: Sujevan Selvaratnam null (EMP000026)
[2025-10-23T05:21:59.723Z] [LOG] ======================================================================
[2025-10-23T05:22:00.672Z] [LOG] 🔍 Component filtering for employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-23T05:22:00.673Z] [LOG]    Total components: 13
[2025-10-23T05:22:00.673Z] [LOG]    Applicable components: 13
[2025-10-23T05:22:00.673Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:22:01.995Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:22:01.995Z] [LOG] 🔄 Processing financial records for employee 0143e6c3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:22:02.429Z] [LOG] 📊 Found 0 active loans for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:02.624Z] [LOG] 📊 Found 0 active advances for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:02.830Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:02.830Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:22:02.831Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:22:03.115Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:22:03.116Z] [LOG]    Employee ID: 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:03.116Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:22:03.117Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:22:03.117Z] [LOG]    Base Salary (Full Month): Rs.1.00
[2025-10-23T05:22:03.400Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:22:03.401Z] [LOG]       Daily Salary: Rs.0.04
[2025-10-23T05:22:03.401Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T05:22:03.402Z] [LOG]       Saturday Hourly Rate: Rs.0.01
[2025-10-23T05:22:03.402Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:22:03.402Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:22:03.403Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:22:04.117Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:22:04.117Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:22:04.312Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:22:04.312Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:22:04.313Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:22:04.313Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:22:04.313Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:22:04.313Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:22:04.314Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:22:04.314Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:22:04.508Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:22:04.509Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:22:04.509Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:22:04.509Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:22:04.733Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:22:04.733Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:22:04.734Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:22:04.735Z] [LOG]       Current Time: 10:52:04
[2025-10-23T05:22:04.735Z] [LOG]       Expected Hours (scheduled → now): 2.37h
[2025-10-23T05:22:04.735Z] [LOG]       Actual Hours (check-in → now): 2.37h
[2025-10-23T05:22:04.736Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:22:04.736Z] [LOG]       Weekday: 121.37h
[2025-10-23T05:22:04.736Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:22:04.736Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:04.737Z] [LOG]       Total Expected: 134.87h
[2025-10-23T05:22:04.737Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:22:04.737Z] [LOG]       Weekday: 27.87h (includes 2.37h live)
[2025-10-23T05:22:04.738Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:22:04.738Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:04.738Z] [LOG]       Total Actual: 32.37h
[2025-10-23T05:22:04.738Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:22:04.739Z] [LOG]       Weekday: 121.37h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:04.739Z] [LOG]       Saturday: 13.50h × Rs.0.01 = Rs.0.14
[2025-10-23T05:22:04.740Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:04.740Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:04.740Z] [LOG]       Total Expected Earned: Rs.0.14
[2025-10-23T05:22:04.741Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:22:04.741Z] [LOG]       Weekday: 27.87h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:04.741Z] [LOG]       Saturday: 4.50h × Rs.0.01 = Rs.0.04
[2025-10-23T05:22:04.741Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:04.742Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:04.742Z] [LOG]       Total Actual Earned: Rs.0.04
[2025-10-23T05:22:04.743Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:22:04.743Z] [LOG]       Calculated At: Oct 23, 2025, 10:52:04
[2025-10-23T05:22:04.743Z] [LOG]       Expected Earned (until NOW): Rs.0.14
[2025-10-23T05:22:04.744Z] [LOG]       Actual Earned (until NOW): Rs.0.04
[2025-10-23T05:22:04.744Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:04.744Z] [LOG]       Attendance Deduction: Rs.0.09
[2025-10-23T05:22:04.745Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:22:04.745Z] [LOG]       📉 Shortfall: 102.50 hours (66.67% of expected)
[2025-10-23T05:22:04.745Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:22:04.746Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:22:04.746Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T05:22:04.746Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T05:22:04.747Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T05:22:04.747Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:22:04.748Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:22:04.749Z] [LOG]    Gross Salary: 0.045
[2025-10-23T05:22:04.749Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:22:04.749Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:22:04.750Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.750Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:22:04.750Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.750Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:22:04.750Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.751Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:22:04.751Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.751Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:22:04.751Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.752Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:22:04.752Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.752Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:22:04.752Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.753Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:22:04.753Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.754Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:22:04.754Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.754Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:22:04.754Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.755Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:22:04.755Z] [LOG]    EPF/ETF calculated on: Rs.0.04
[2025-10-23T05:22:04.756Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:22:04.756Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:22:04.756Z] [LOG] 💰 GROSS CALCULATION for Sujevan Selvaratnam null:
[2025-10-23T05:22:04.756Z] [LOG]    Base Salary: 1
[2025-10-23T05:22:04.757Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:22:04.757Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:22:04.757Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.757Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:22:04.758Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.758Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:22:04.758Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:04.952Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:22:04.953Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:04.953Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:22:04.954Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:22:04.954Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T05:22:04.954Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:22:04.955Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:22:04.955Z] [LOG]    = Gross Salary: Rs.0.04
[2025-10-23T05:22:04.955Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:22:04.955Z] [LOG]    Attendance Shortfall (Info): Rs.0.09
[2025-10-23T05:22:04.956Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:22:04.956Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:04.956Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:22:04.957Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:22:04.957Z] [LOG]    Gross Salary: Rs.0.04
[2025-10-23T05:22:04.957Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:22:04.957Z] [LOG]    = NET SALARY: Rs.0.04
[2025-10-23T05:22:04.957Z] [LOG] 
💾 Database Update:
[2025-10-23T05:22:04.958Z] [LOG]    Total Earnings: Rs.0.04 (Base: 0.04 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:22:04.958Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:22:05.206Z] [LOG] 
📝 Components to save:
[2025-10-23T05:22:05.206Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:22:05.207Z] [LOG]    Deduction components: 1
[2025-10-23T05:22:05.207Z] [LOG] Creating components for record c5ff96fe-5811-4461-878c-ebce10584326: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:22:05.207Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 0.045
}
[2025-10-23T05:22:05.420Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:22:05.629Z] [LOG] Created payroll_record_component: d7e9cc67-594e-430f-96e4-137649eb9daf for Base Salary
[2025-10-23T05:22:05.630Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 0.09000000000000001
}
[2025-10-23T05:22:05.878Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:22:06.108Z] [LOG] Created payroll_record_component: ce05bd26-4049-4da5-8d23-866af79f31f5 for Attendance Shortfall (Info)
[2025-10-23T05:22:06.588Z] [LOG] ✅ Financial balances updated successfully for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:06.589Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:22:06.589Z] [LOG] 
======================================================================
[2025-10-23T05:22:06.590Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sujevan Selvaratnam null
[2025-10-23T05:22:06.590Z] [LOG] ======================================================================
[2025-10-23T05:22:06.591Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T05:22:06.591Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.04
[2025-10-23T05:22:06.591Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T05:22:06.591Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:06.592Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:06.592Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:22:06.592Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:06.593Z] [LOG]    GROSS SALARY: Rs.0.04
[2025-10-23T05:22:06.593Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:06.593Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:22:06.593Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:22:06.594Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:22:06.594Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:22:06.594Z] [LOG]       - Attendance Shortfall (Info): Rs.0.09
[2025-10-23T05:22:06.595Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:06.595Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:06.595Z] [LOG]    NET SALARY: Rs.0.04
[2025-10-23T05:22:06.596Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:22:06.596Z] [LOG] ======================================================================

[2025-10-23T05:22:06.596Z] [LOG] ✅ Sujevan Selvaratnam null: Calculation completed successfully
[2025-10-23T05:22:06.597Z] [LOG] 📊 Progress: 28/34 (82.4%)
[2025-10-23T05:22:06.597Z] [LOG] 
🧮 Processing: Franklin null (EMP000018)
[2025-10-23T05:22:06.597Z] [LOG] 📋 Record ID: cf23b373-c96b-440f-811c-41fb04c7acea
[2025-10-23T05:22:06.597Z] [LOG] 
======================================================================
[2025-10-23T05:22:06.598Z] [LOG] 🧮 CALCULATING PAYROLL: Franklin null (EMP000018)
[2025-10-23T05:22:06.598Z] [LOG] ======================================================================
[2025-10-23T05:22:07.397Z] [LOG] 🔍 Component filtering for employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-23T05:22:07.398Z] [LOG]    Total components: 13
[2025-10-23T05:22:07.398Z] [LOG]    Applicable components: 13
[2025-10-23T05:22:07.398Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T05:22:08.961Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:22:08.962Z] [LOG] 🔄 Processing financial records for employee 0143c037-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:22:09.157Z] [LOG] 📊 Found 0 active loans for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:09.350Z] [LOG] 📊 Found 0 active advances for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:09.549Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:09.550Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:22:09.551Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:22:09.797Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:22:09.798Z] [LOG]    Employee ID: 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:09.798Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:22:09.798Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:22:09.799Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:22:10.029Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:22:10.030Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:22:10.030Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:22:10.030Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:22:10.030Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:22:10.030Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:22:10.031Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:22:10.766Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:22:10.766Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:22:10.990Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:22:10.990Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:22:10.990Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:22:10.990Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:22:10.991Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:22:10.991Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:22:10.991Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:22:10.991Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:22:11.229Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:22:11.230Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:22:11.230Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:22:11.230Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:22:11.469Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:22:11.469Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:22:11.469Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:22:11.470Z] [LOG]       Current Time: 10:52:11
[2025-10-23T05:22:11.470Z] [LOG]       Expected Hours (scheduled → now): 2.37h
[2025-10-23T05:22:11.470Z] [LOG]       Actual Hours (check-in → now): 2.37h
[2025-10-23T05:22:11.471Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:22:11.471Z] [LOG]       Weekday: 121.37h
[2025-10-23T05:22:11.471Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:22:11.471Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:11.471Z] [LOG]       Total Expected: 134.87h
[2025-10-23T05:22:11.471Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:22:11.472Z] [LOG]       Weekday: 27.87h (includes 2.37h live)
[2025-10-23T05:22:11.472Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:22:11.473Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:11.473Z] [LOG]       Total Actual: 32.37h
[2025-10-23T05:22:11.473Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:22:11.473Z] [LOG]       Weekday: 121.37h × Rs.235.29 = Rs.28557.11
[2025-10-23T05:22:11.473Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:22:11.473Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:11.474Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:11.474Z] [LOG]       Total Expected Earned: Rs.34557.05
[2025-10-23T05:22:11.474Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:22:11.474Z] [LOG]       Weekday: 27.87h × Rs.235.29 = Rs.6557.50
[2025-10-23T05:22:11.474Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:22:11.474Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:11.474Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:11.474Z] [LOG]       Total Actual Earned: Rs.8557.48
[2025-10-23T05:22:11.475Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:22:11.475Z] [LOG]       Calculated At: Oct 23, 2025, 10:52:11
[2025-10-23T05:22:11.476Z] [LOG]       Expected Earned (until NOW): Rs.34557.05
[2025-10-23T05:22:11.476Z] [LOG]       Actual Earned (until NOW): Rs.8557.48
[2025-10-23T05:22:11.476Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:11.476Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:22:11.476Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:22:11.477Z] [LOG]       📉 Shortfall: 102.50 hours (75.24% of expected)
[2025-10-23T05:22:11.477Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:22:11.477Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:22:11.477Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:22:11.477Z] [LOG]    Actual Earned Base: Rs.8557.48
[2025-10-23T05:22:11.477Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:22:11.477Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:22:11.478Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:22:11.478Z] [LOG]    Gross Salary: 8557.477594725
[2025-10-23T05:22:11.478Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:22:11.478Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:22:11.478Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.479Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:22:11.479Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.479Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:22:11.479Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.480Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:22:11.480Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.480Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:22:11.480Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.481Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:22:11.481Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.482Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:22:11.482Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.483Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:22:11.483Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.484Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:22:11.484Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.484Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:22:11.485Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.485Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:22:11.485Z] [LOG]    EPF/ETF calculated on: Rs.8557.48
[2025-10-23T05:22:11.485Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:22:11.485Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:22:11.485Z] [LOG] 💰 GROSS CALCULATION for Franklin null:
[2025-10-23T05:22:11.486Z] [LOG]    Base Salary: 50000
[2025-10-23T05:22:11.486Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:22:11.486Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:22:11.487Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.487Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:22:11.487Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.487Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:22:11.488Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:11.716Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:22:11.716Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:11.716Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:22:11.716Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:22:11.716Z] [LOG]    Actual Earned Base: Rs.8557.48
[2025-10-23T05:22:11.717Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:22:11.717Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:22:11.717Z] [LOG]    = Gross Salary: Rs.8557.48
[2025-10-23T05:22:11.717Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:22:11.717Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:22:11.717Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:22:11.717Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:11.717Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:22:11.717Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:22:11.718Z] [LOG]    Gross Salary: Rs.8557.48
[2025-10-23T05:22:11.718Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:22:11.718Z] [LOG]    = NET SALARY: Rs.8557.48
[2025-10-23T05:22:11.718Z] [LOG] 
💾 Database Update:
[2025-10-23T05:22:11.718Z] [LOG]    Total Earnings: Rs.8557.48 (Base: 8557.48 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:22:11.718Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:22:11.950Z] [LOG] 
📝 Components to save:
[2025-10-23T05:22:11.951Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:22:11.951Z] [LOG]    Deduction components: 1
[2025-10-23T05:22:11.951Z] [LOG] Creating components for record cf23b373-c96b-440f-811c-41fb04c7acea: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:22:11.951Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8557.477594725
}
[2025-10-23T05:22:12.199Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:22:12.428Z] [LOG] Created payroll_record_component: 5a7ce629-5982-4b65-a32f-504f40d2f1be for Base Salary
[2025-10-23T05:22:12.429Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:22:12.676Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:22:12.916Z] [LOG] Created payroll_record_component: 4133bd24-1ac8-4920-b492-9d026aaa93a0 for Attendance Shortfall (Info)
[2025-10-23T05:22:13.388Z] [LOG] ✅ Financial balances updated successfully for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:13.389Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:22:13.389Z] [LOG] 
======================================================================
[2025-10-23T05:22:13.390Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Franklin null
[2025-10-23T05:22:13.390Z] [LOG] ======================================================================
[2025-10-23T05:22:13.390Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:22:13.390Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8557.48
[2025-10-23T05:22:13.390Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:22:13.390Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:13.390Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:13.391Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:22:13.391Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:13.391Z] [LOG]    GROSS SALARY: Rs.8557.48
[2025-10-23T05:22:13.391Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:13.391Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:22:13.391Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:22:13.391Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:22:13.391Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:22:13.392Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:22:13.392Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:13.392Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:13.392Z] [LOG]    NET SALARY: Rs.8557.48
[2025-10-23T05:22:13.392Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:22:13.392Z] [LOG] ======================================================================

[2025-10-23T05:22:13.392Z] [LOG] ✅ Franklin null: Calculation completed successfully
[2025-10-23T05:22:13.393Z] [LOG] 📊 Progress: 29/34 (85.3%)
[2025-10-23T05:22:13.393Z] [LOG] 
🧮 Processing: Maryam null (EMP000035)
[2025-10-23T05:22:13.393Z] [LOG] 📋 Record ID: d26df2d2-920b-4449-9eab-9a8b19079330
[2025-10-23T05:22:13.393Z] [LOG] 
======================================================================
[2025-10-23T05:22:13.393Z] [LOG] 🧮 CALCULATING PAYROLL: Maryam null (EMP000035)
[2025-10-23T05:22:13.394Z] [LOG] ======================================================================
[2025-10-23T05:22:14.351Z] [LOG] 🔍 Component filtering for employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-23T05:22:14.351Z] [LOG]    Total components: 13
[2025-10-23T05:22:14.352Z] [LOG]    Applicable components: 13
[2025-10-23T05:22:14.352Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T05:22:15.709Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:22:15.709Z] [LOG] 🔄 Processing financial records for employee 01440221-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:22:15.958Z] [LOG] 📊 Found 0 active loans for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:16.158Z] [LOG] 📊 Found 0 active advances for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:16.352Z] [LOG] 📊 Found 0 approved bonuses for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:16.352Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:22:16.353Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:22:16.596Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:22:16.597Z] [LOG]    Employee ID: 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:16.597Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:22:16.597Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:22:16.598Z] [LOG]    Base Salary (Full Month): Rs.40000.00
[2025-10-23T05:22:16.799Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:22:16.800Z] [LOG]       Daily Salary: Rs.1600.00
[2025-10-23T05:22:16.800Z] [LOG]       Weekday Hourly Rate: Rs.188.24
[2025-10-23T05:22:16.801Z] [LOG]       Saturday Hourly Rate: Rs.355.56
[2025-10-23T05:22:16.801Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:22:16.801Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:22:16.801Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:22:17.793Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:22:17.793Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:22:18.029Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:22:18.030Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:22:18.030Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:22:18.030Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:22:18.030Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:22:18.031Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:22:18.031Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:22:18.031Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:22:18.269Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:22:18.269Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:22:18.269Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:22:18.270Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:22:18.513Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:22:18.514Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:22:18.514Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:22:18.515Z] [LOG]       Current Time: 10:52:18
[2025-10-23T05:22:18.515Z] [LOG]       Expected Hours (scheduled → now): 2.37h
[2025-10-23T05:22:18.515Z] [LOG]       Actual Hours (check-in → now): 2.37h
[2025-10-23T05:22:18.515Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:22:18.516Z] [LOG]       Weekday: 121.37h
[2025-10-23T05:22:18.516Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:22:18.516Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:18.516Z] [LOG]       Total Expected: 134.87h
[2025-10-23T05:22:18.517Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:22:18.517Z] [LOG]       Weekday: 27.87h (includes 2.37h live)
[2025-10-23T05:22:18.517Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:22:18.517Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:18.518Z] [LOG]       Total Actual: 32.37h
[2025-10-23T05:22:18.518Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:22:18.518Z] [LOG]       Weekday: 121.37h × Rs.188.24 = Rs.22847.03
[2025-10-23T05:22:18.519Z] [LOG]       Saturday: 13.50h × Rs.355.56 = Rs.4800.06
[2025-10-23T05:22:18.519Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:18.519Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:18.519Z] [LOG]       Total Expected Earned: Rs.27647.09
[2025-10-23T05:22:18.520Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:22:18.520Z] [LOG]       Weekday: 27.87h × Rs.188.24 = Rs.5246.59
[2025-10-23T05:22:18.520Z] [LOG]       Saturday: 4.50h × Rs.355.56 = Rs.1600.02
[2025-10-23T05:22:18.521Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:18.521Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:18.521Z] [LOG]       Total Actual Earned: Rs.6846.61
[2025-10-23T05:22:18.522Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:22:18.522Z] [LOG]       Calculated At: Oct 23, 2025, 10:52:18
[2025-10-23T05:22:18.522Z] [LOG]       Expected Earned (until NOW): Rs.27647.09
[2025-10-23T05:22:18.523Z] [LOG]       Actual Earned (until NOW): Rs.6846.61
[2025-10-23T05:22:18.523Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:18.523Z] [LOG]       Attendance Deduction: Rs.20800.48
[2025-10-23T05:22:18.523Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:22:18.523Z] [LOG]       📉 Shortfall: 102.50 hours (75.24% of expected)
[2025-10-23T05:22:18.524Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:22:18.524Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:22:18.524Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T05:22:18.524Z] [LOG]    Actual Earned Base: Rs.6846.61
[2025-10-23T05:22:18.524Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T05:22:18.524Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:22:18.525Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:22:18.525Z] [LOG]    Gross Salary: 6846.6093575333325
[2025-10-23T05:22:18.525Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:22:18.526Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:22:18.526Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.527Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:22:18.527Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.528Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:22:18.528Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.528Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:22:18.529Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.529Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:22:18.529Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.529Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:22:18.529Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.530Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:22:18.530Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.530Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:22:18.530Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.531Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:22:18.531Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.531Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:22:18.532Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.532Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:22:18.532Z] [LOG]    EPF/ETF calculated on: Rs.6846.61
[2025-10-23T05:22:18.532Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:22:18.532Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:22:18.533Z] [LOG] 💰 GROSS CALCULATION for Maryam null:
[2025-10-23T05:22:18.533Z] [LOG]    Base Salary: 40000
[2025-10-23T05:22:18.533Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:22:18.534Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:22:18.534Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.534Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:22:18.534Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.534Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:22:18.535Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:18.748Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:22:18.748Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:18.749Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:22:18.749Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:22:18.749Z] [LOG]    Actual Earned Base: Rs.6846.61
[2025-10-23T05:22:18.750Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:22:18.750Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:22:18.750Z] [LOG]    = Gross Salary: Rs.6846.61
[2025-10-23T05:22:18.751Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:22:18.751Z] [LOG]    Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T05:22:18.751Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:22:18.751Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:18.752Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:22:18.752Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:22:18.752Z] [LOG]    Gross Salary: Rs.6846.61
[2025-10-23T05:22:18.753Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:22:18.753Z] [LOG]    = NET SALARY: Rs.6846.61
[2025-10-23T05:22:18.753Z] [LOG] 
💾 Database Update:
[2025-10-23T05:22:18.754Z] [LOG]    Total Earnings: Rs.6846.61 (Base: 6846.61 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:22:18.754Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:22:18.952Z] [LOG] 
📝 Components to save:
[2025-10-23T05:22:18.953Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:22:18.953Z] [LOG]    Deduction components: 1
[2025-10-23T05:22:18.953Z] [LOG] Creating components for record d26df2d2-920b-4449-9eab-9a8b19079330: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:22:18.954Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 6846.6093575333325
}
[2025-10-23T05:22:19.159Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:22:19.388Z] [LOG] Created payroll_record_component: 32b7e484-c133-406f-9aac-3100c84874a9 for Base Salary
[2025-10-23T05:22:19.389Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 20800.480000000003
}
[2025-10-23T05:22:19.640Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:22:19.870Z] [LOG] Created payroll_record_component: aadd52f0-a3fc-4226-b3ee-3cd828c4f694 for Attendance Shortfall (Info)
[2025-10-23T05:22:20.350Z] [LOG] ✅ Financial balances updated successfully for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:20.351Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:22:20.351Z] [LOG] 
======================================================================
[2025-10-23T05:22:20.351Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Maryam null
[2025-10-23T05:22:20.351Z] [LOG] ======================================================================
[2025-10-23T05:22:20.351Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T05:22:20.352Z] [LOG]    Actual Earned Base (Attendance-based): Rs.6846.61
[2025-10-23T05:22:20.352Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T05:22:20.352Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:20.353Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:20.353Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:22:20.353Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:20.354Z] [LOG]    GROSS SALARY: Rs.6846.61
[2025-10-23T05:22:20.354Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:20.354Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:22:20.354Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:22:20.355Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:22:20.355Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:22:20.355Z] [LOG]       - Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T05:22:20.356Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:20.356Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:20.357Z] [LOG]    NET SALARY: Rs.6846.61
[2025-10-23T05:22:20.357Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:22:20.357Z] [LOG] ======================================================================

[2025-10-23T05:22:20.357Z] [LOG] ✅ Maryam null: Calculation completed successfully
[2025-10-23T05:22:20.357Z] [LOG] 📊 Progress: 30/34 (88.2%)
[2025-10-23T05:22:20.357Z] [LOG] 
🧮 Processing: Saru null (EMP000022)
[2025-10-23T05:22:20.358Z] [LOG] 📋 Record ID: d6a74cc1-031a-43bd-828d-fc82dfc9ade0
[2025-10-23T05:22:20.358Z] [LOG] 
======================================================================
[2025-10-23T05:22:20.358Z] [LOG] 🧮 CALCULATING PAYROLL: Saru null (EMP000022)
[2025-10-23T05:22:20.358Z] [LOG] ======================================================================
[2025-10-23T05:22:21.193Z] [LOG] 🔍 Component filtering for employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-23T05:22:21.194Z] [LOG]    Total components: 13
[2025-10-23T05:22:21.194Z] [LOG]    Applicable components: 13
[2025-10-23T05:22:21.194Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:22:22.598Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:22:22.598Z] [LOG] 🔄 Processing financial records for employee 0143cc7e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:22:22.830Z] [LOG] 📊 Found 0 active loans for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:23.098Z] [LOG] 📊 Found 0 active advances for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:23.299Z] [LOG] 📊 Found 0 approved bonuses for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:23.300Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:22:23.300Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:22:23.492Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:22:23.493Z] [LOG]    Employee ID: 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:23.493Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:22:23.493Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:22:23.493Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:22:23.693Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:22:23.694Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:22:23.694Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:22:23.694Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:22:23.695Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:22:23.695Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:22:23.695Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:22:24.590Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:22:24.590Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:22:24.835Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:22:24.836Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:22:24.836Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:22:24.836Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:22:24.837Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:22:24.837Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:22:24.837Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:22:24.837Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:22:25.068Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:22:25.068Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:22:25.068Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:22:25.069Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:22:25.327Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:22:25.328Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:22:25.328Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:22:25.329Z] [LOG]       Current Time: 10:52:25
[2025-10-23T05:22:25.329Z] [LOG]       Expected Hours (scheduled → now): 2.37h
[2025-10-23T05:22:25.329Z] [LOG]       Actual Hours (check-in → now): 2.37h
[2025-10-23T05:22:25.330Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:22:25.330Z] [LOG]       Weekday: 121.37h
[2025-10-23T05:22:25.330Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:22:25.331Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:25.331Z] [LOG]       Total Expected: 134.87h
[2025-10-23T05:22:25.331Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:22:25.332Z] [LOG]       Weekday: 27.87h (includes 2.37h live)
[2025-10-23T05:22:25.332Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:22:25.333Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:25.333Z] [LOG]       Total Actual: 32.37h
[2025-10-23T05:22:25.333Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:22:25.334Z] [LOG]       Weekday: 121.37h × Rs.235.29 = Rs.28558.02
[2025-10-23T05:22:25.334Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:22:25.334Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:25.334Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:25.335Z] [LOG]       Total Expected Earned: Rs.34557.96
[2025-10-23T05:22:25.335Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:22:25.336Z] [LOG]       Weekday: 27.87h × Rs.235.29 = Rs.6558.40
[2025-10-23T05:22:25.336Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:22:25.336Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:25.336Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:25.337Z] [LOG]       Total Actual Earned: Rs.8558.38
[2025-10-23T05:22:25.337Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:22:25.338Z] [LOG]       Calculated At: Oct 23, 2025, 10:52:25
[2025-10-23T05:22:25.338Z] [LOG]       Expected Earned (until NOW): Rs.34557.96
[2025-10-23T05:22:25.338Z] [LOG]       Actual Earned (until NOW): Rs.8558.38
[2025-10-23T05:22:25.338Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:25.338Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:22:25.338Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:22:25.338Z] [LOG]       📉 Shortfall: 102.50 hours (75.23% of expected)
[2025-10-23T05:22:25.338Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:22:25.338Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:22:25.339Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:22:25.339Z] [LOG]    Actual Earned Base: Rs.8558.38
[2025-10-23T05:22:25.339Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:22:25.340Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:22:25.340Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:22:25.340Z] [LOG]    Gross Salary: 8558.383330508334
[2025-10-23T05:22:25.341Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:22:25.341Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:22:25.341Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.341Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:22:25.342Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.342Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:22:25.342Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.342Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:22:25.343Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.343Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:22:25.344Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.344Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:22:25.344Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.344Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:22:25.345Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.345Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:22:25.345Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.345Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:22:25.346Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.346Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:22:25.346Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.346Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:22:25.347Z] [LOG]    EPF/ETF calculated on: Rs.8558.38
[2025-10-23T05:22:25.347Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:22:25.347Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:22:25.348Z] [LOG] 💰 GROSS CALCULATION for Saru null:
[2025-10-23T05:22:25.348Z] [LOG]    Base Salary: 50000
[2025-10-23T05:22:25.348Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:22:25.349Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:22:25.349Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.349Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:22:25.349Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.350Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:22:25.350Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:25.768Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:22:25.769Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:25.769Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:22:25.769Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:22:25.769Z] [LOG]    Actual Earned Base: Rs.8558.38
[2025-10-23T05:22:25.770Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:22:25.770Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:22:25.770Z] [LOG]    = Gross Salary: Rs.8558.38
[2025-10-23T05:22:25.770Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:22:25.771Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:22:25.771Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:22:25.771Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:25.772Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:22:25.772Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:22:25.772Z] [LOG]    Gross Salary: Rs.8558.38
[2025-10-23T05:22:25.772Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:22:25.773Z] [LOG]    = NET SALARY: Rs.8558.38
[2025-10-23T05:22:25.773Z] [LOG] 
💾 Database Update:
[2025-10-23T05:22:25.773Z] [LOG]    Total Earnings: Rs.8558.38 (Base: 8558.38 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:22:25.773Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:22:25.963Z] [LOG] 
📝 Components to save:
[2025-10-23T05:22:25.963Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:22:25.964Z] [LOG]    Deduction components: 1
[2025-10-23T05:22:25.964Z] [LOG] Creating components for record d6a74cc1-031a-43bd-828d-fc82dfc9ade0: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:22:25.964Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8558.383330508334
}
[2025-10-23T05:22:26.189Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:22:26.433Z] [LOG] Created payroll_record_component: 016e0762-b396-4224-93d8-ac48eb3d2bfd for Base Salary
[2025-10-23T05:22:26.433Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T05:22:26.672Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:22:26.910Z] [LOG] Created payroll_record_component: 7fd995a5-494c-4db3-8c9e-ad6cd1b6cdf8 for Attendance Shortfall (Info)
[2025-10-23T05:22:27.392Z] [LOG] ✅ Financial balances updated successfully for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:27.393Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:22:27.393Z] [LOG] 
======================================================================
[2025-10-23T05:22:27.393Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Saru null
[2025-10-23T05:22:27.393Z] [LOG] ======================================================================
[2025-10-23T05:22:27.393Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:22:27.394Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8558.38
[2025-10-23T05:22:27.394Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:22:27.394Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:27.394Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:27.394Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:22:27.394Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:27.394Z] [LOG]    GROSS SALARY: Rs.8558.38
[2025-10-23T05:22:27.395Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:27.395Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:22:27.395Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:22:27.395Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:22:27.395Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:22:27.395Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:22:27.395Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:27.395Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:27.396Z] [LOG]    NET SALARY: Rs.8558.38
[2025-10-23T05:22:27.396Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:22:27.396Z] [LOG] ======================================================================

[2025-10-23T05:22:27.396Z] [LOG] ✅ Saru null: Calculation completed successfully
[2025-10-23T05:22:27.396Z] [LOG] 📊 Progress: 31/34 (91.2%)
[2025-10-23T05:22:27.397Z] [LOG] 
🧮 Processing: Ishara null (EMP000011)
[2025-10-23T05:22:27.397Z] [LOG] 📋 Record ID: dd9d252a-ea95-4b48-9707-868988025be0
[2025-10-23T05:22:27.397Z] [LOG] 
======================================================================
[2025-10-23T05:22:27.397Z] [LOG] 🧮 CALCULATING PAYROLL: Ishara null (EMP000011)
[2025-10-23T05:22:27.397Z] [LOG] ======================================================================
[2025-10-23T05:22:28.297Z] [LOG] 🔍 Component filtering for employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-23T05:22:28.298Z] [LOG]    Total components: 13
[2025-10-23T05:22:28.298Z] [LOG]    Applicable components: 13
[2025-10-23T05:22:28.298Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T05:22:30.269Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:22:30.270Z] [LOG] 🔄 Processing financial records for employee 0143ac0c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:22:30.467Z] [LOG] 📊 Found 0 active loans for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:30.666Z] [LOG] 📊 Found 0 active advances for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:30.913Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:30.914Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:22:30.914Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:22:31.149Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:22:31.149Z] [LOG]    Employee ID: 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:31.149Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:22:31.149Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:22:31.149Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:22:31.398Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:22:31.398Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:22:31.398Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:22:31.398Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:22:31.398Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:22:31.398Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:22:31.398Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:22:32.111Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:22:32.111Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:22:32.350Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:22:32.351Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:22:32.351Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:22:32.352Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:22:32.352Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:22:32.352Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:22:32.353Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:22:32.353Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:22:32.618Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:22:32.618Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:22:32.618Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:22:32.619Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:22:32.829Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:22:32.830Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:22:32.830Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:22:32.830Z] [LOG]       Current Time: 10:52:32
[2025-10-23T05:22:32.830Z] [LOG]       Expected Hours (scheduled → now): 2.38h
[2025-10-23T05:22:32.830Z] [LOG]       Actual Hours (check-in → now): 2.38h
[2025-10-23T05:22:32.831Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:22:32.831Z] [LOG]       Weekday: 121.38h
[2025-10-23T05:22:32.831Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:22:32.831Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:32.831Z] [LOG]       Total Expected: 134.88h
[2025-10-23T05:22:32.832Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:22:32.832Z] [LOG]       Weekday: 27.88h (includes 2.38h live)
[2025-10-23T05:22:32.832Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:22:32.833Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:32.833Z] [LOG]       Total Actual: 32.38h
[2025-10-23T05:22:32.833Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:22:32.833Z] [LOG]       Weekday: 121.38h × Rs.235.29 = Rs.28558.51
[2025-10-23T05:22:32.834Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:22:32.834Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:32.834Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:32.834Z] [LOG]       Total Expected Earned: Rs.34558.45
[2025-10-23T05:22:32.834Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:22:32.835Z] [LOG]       Weekday: 27.88h × Rs.235.29 = Rs.6558.89
[2025-10-23T05:22:32.835Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:22:32.835Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:32.835Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:32.835Z] [LOG]       Total Actual Earned: Rs.8558.87
[2025-10-23T05:22:32.836Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:22:32.836Z] [LOG]       Calculated At: Oct 23, 2025, 10:52:32
[2025-10-23T05:22:32.836Z] [LOG]       Expected Earned (until NOW): Rs.34558.45
[2025-10-23T05:22:32.836Z] [LOG]       Actual Earned (until NOW): Rs.8558.87
[2025-10-23T05:22:32.836Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:32.837Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:22:32.837Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:22:32.837Z] [LOG]       📉 Shortfall: 102.50 hours (75.23% of expected)
[2025-10-23T05:22:32.837Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:22:32.837Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:22:32.838Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:22:32.838Z] [LOG]    Actual Earned Base: Rs.8558.87
[2025-10-23T05:22:32.838Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:22:32.838Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:22:32.839Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:22:32.839Z] [LOG]    Gross Salary: 8558.873648724999
[2025-10-23T05:22:32.840Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:22:32.840Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:22:32.840Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.841Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:22:32.841Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.841Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:22:32.841Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.841Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:22:32.841Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.842Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:22:32.842Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.842Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:22:32.842Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.842Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:22:32.842Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.842Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:22:32.842Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.842Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:22:32.843Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.843Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:22:32.843Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.843Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:22:32.843Z] [LOG]    EPF/ETF calculated on: Rs.8558.87
[2025-10-23T05:22:32.844Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:22:32.844Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:22:32.844Z] [LOG] 💰 GROSS CALCULATION for Ishara null:
[2025-10-23T05:22:32.844Z] [LOG]    Base Salary: 50000
[2025-10-23T05:22:32.845Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:22:32.845Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:22:32.845Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.846Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:22:32.847Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:32.847Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:22:32.848Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:33.096Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:22:33.096Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:33.097Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:22:33.097Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:22:33.097Z] [LOG]    Actual Earned Base: Rs.8558.87
[2025-10-23T05:22:33.097Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:22:33.097Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:22:33.097Z] [LOG]    = Gross Salary: Rs.8558.87
[2025-10-23T05:22:33.097Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:22:33.097Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:22:33.097Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:22:33.098Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:33.098Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:22:33.098Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:22:33.098Z] [LOG]    Gross Salary: Rs.8558.87
[2025-10-23T05:22:33.098Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:22:33.098Z] [LOG]    = NET SALARY: Rs.8558.87
[2025-10-23T05:22:33.098Z] [LOG] 
💾 Database Update:
[2025-10-23T05:22:33.098Z] [LOG]    Total Earnings: Rs.8558.87 (Base: 8558.87 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:22:33.099Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:22:33.392Z] [LOG] 
📝 Components to save:
[2025-10-23T05:22:33.392Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:22:33.392Z] [LOG]    Deduction components: 1
[2025-10-23T05:22:33.393Z] [LOG] Creating components for record dd9d252a-ea95-4b48-9707-868988025be0: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:22:33.394Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8558.873648724999
}
[2025-10-23T05:22:33.593Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:22:33.793Z] [LOG] Created payroll_record_component: 2ce76957-6539-4231-b777-f40d760b7d99 for Base Salary
[2025-10-23T05:22:33.794Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T05:22:33.993Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:22:34.206Z] [LOG] Created payroll_record_component: f09110a2-44ec-45f9-aa65-3c91f79166ba for Attendance Shortfall (Info)
[2025-10-23T05:22:34.627Z] [LOG] ✅ Financial balances updated successfully for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:34.627Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:22:34.627Z] [LOG] 
======================================================================
[2025-10-23T05:22:34.628Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ishara null
[2025-10-23T05:22:34.628Z] [LOG] ======================================================================
[2025-10-23T05:22:34.628Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:22:34.629Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8558.87
[2025-10-23T05:22:34.629Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:22:34.629Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:34.630Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:34.630Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:22:34.631Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:34.631Z] [LOG]    GROSS SALARY: Rs.8558.87
[2025-10-23T05:22:34.631Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:34.631Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:22:34.632Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:22:34.632Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:22:34.632Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:22:34.633Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:22:34.633Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:34.633Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:34.634Z] [LOG]    NET SALARY: Rs.8558.87
[2025-10-23T05:22:34.634Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:22:34.634Z] [LOG] ======================================================================

[2025-10-23T05:22:34.634Z] [LOG] ✅ Ishara null: Calculation completed successfully
[2025-10-23T05:22:34.635Z] [LOG] 📊 Progress: 32/34 (94.1%)
[2025-10-23T05:22:34.635Z] [LOG] 
🧮 Processing: Jessie null (EMP000013)
[2025-10-23T05:22:34.635Z] [LOG] 📋 Record ID: e156603d-470a-4733-a328-5950dd35e081
[2025-10-23T05:22:34.636Z] [LOG] 
======================================================================
[2025-10-23T05:22:34.636Z] [LOG] 🧮 CALCULATING PAYROLL: Jessie null (EMP000013)
[2025-10-23T05:22:34.636Z] [LOG] ======================================================================
[2025-10-23T05:22:35.459Z] [LOG] 🔍 Component filtering for employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-23T05:22:35.459Z] [LOG]    Total components: 13
[2025-10-23T05:22:35.459Z] [LOG]    Applicable components: 13
[2025-10-23T05:22:35.460Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:22:36.621Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:22:36.622Z] [LOG] 🔄 Processing financial records for employee 0143ae6e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:22:36.819Z] [LOG] 📊 Found 0 active loans for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:37.073Z] [LOG] 📊 Found 0 active advances for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:37.291Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:37.292Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:22:37.292Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:22:37.488Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:22:37.489Z] [LOG]    Employee ID: 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:37.489Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:22:37.490Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:22:37.490Z] [LOG]    Base Salary (Full Month): Rs.60000.00
[2025-10-23T05:22:37.683Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:22:37.683Z] [LOG]       Daily Salary: Rs.2400.00
[2025-10-23T05:22:37.683Z] [LOG]       Weekday Hourly Rate: Rs.282.35
[2025-10-23T05:22:37.683Z] [LOG]       Saturday Hourly Rate: Rs.533.33
[2025-10-23T05:22:37.683Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:22:37.684Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:22:37.684Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:22:38.270Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:22:38.270Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:22:38.517Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:22:38.518Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:22:38.518Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:22:38.518Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:22:38.519Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:22:38.519Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:22:38.519Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:22:38.519Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:22:38.711Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:22:38.711Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:22:38.711Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:22:38.712Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:22:38.909Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:22:38.909Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:22:38.909Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:22:38.910Z] [LOG]       Current Time: 10:52:38
[2025-10-23T05:22:38.910Z] [LOG]       Expected Hours (scheduled → now): 2.38h
[2025-10-23T05:22:38.910Z] [LOG]       Actual Hours (check-in → now): 2.38h
[2025-10-23T05:22:38.911Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:22:38.911Z] [LOG]       Weekday: 121.38h
[2025-10-23T05:22:38.911Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:22:38.911Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:38.911Z] [LOG]       Total Expected: 134.88h
[2025-10-23T05:22:38.912Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:22:38.912Z] [LOG]       Weekday: 27.88h (includes 2.38h live)
[2025-10-23T05:22:38.912Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:22:38.912Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:38.913Z] [LOG]       Total Actual: 32.38h
[2025-10-23T05:22:38.913Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:22:38.913Z] [LOG]       Weekday: 121.38h × Rs.282.35 = Rs.34270.93
[2025-10-23T05:22:38.913Z] [LOG]       Saturday: 13.50h × Rs.533.33 = Rs.7199.96
[2025-10-23T05:22:38.913Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:38.914Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:38.914Z] [LOG]       Total Expected Earned: Rs.41470.88
[2025-10-23T05:22:38.914Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:22:38.915Z] [LOG]       Weekday: 27.88h × Rs.282.35 = Rs.7871.20
[2025-10-23T05:22:38.915Z] [LOG]       Saturday: 4.50h × Rs.533.33 = Rs.2399.99
[2025-10-23T05:22:38.915Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:38.915Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:38.915Z] [LOG]       Total Actual Earned: Rs.10271.19
[2025-10-23T05:22:38.916Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:22:38.916Z] [LOG]       Calculated At: Oct 23, 2025, 10:52:38
[2025-10-23T05:22:38.916Z] [LOG]       Expected Earned (until NOW): Rs.41470.88
[2025-10-23T05:22:38.916Z] [LOG]       Actual Earned (until NOW): Rs.10271.19
[2025-10-23T05:22:38.916Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:38.917Z] [LOG]       Attendance Deduction: Rs.31199.69
[2025-10-23T05:22:38.917Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:22:38.917Z] [LOG]       📉 Shortfall: 102.50 hours (75.23% of expected)
[2025-10-23T05:22:38.917Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:22:38.917Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:22:38.917Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T05:22:38.918Z] [LOG]    Actual Earned Base: Rs.10271.19
[2025-10-23T05:22:38.918Z] [LOG]    Attendance Shortfall: Rs.31199.69
[2025-10-23T05:22:38.918Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:22:38.918Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:22:38.919Z] [LOG]    Gross Salary: 10271.189987819445
[2025-10-23T05:22:38.919Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:22:38.919Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:22:38.919Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.919Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:22:38.919Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.920Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:22:38.920Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.920Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:22:38.920Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.920Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:22:38.921Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.921Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:22:38.921Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.921Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:22:38.922Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.924Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:22:38.924Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.924Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:22:38.926Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.927Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:22:38.927Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.928Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:22:38.928Z] [LOG]    EPF/ETF calculated on: Rs.10271.19
[2025-10-23T05:22:38.928Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:22:38.929Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:22:38.930Z] [LOG] 💰 GROSS CALCULATION for Jessie null:
[2025-10-23T05:22:38.932Z] [LOG]    Base Salary: 60000
[2025-10-23T05:22:38.933Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:22:38.934Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:22:38.935Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.935Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:22:38.936Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:38.936Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:22:38.936Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:39.138Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:22:39.138Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:39.138Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:22:39.138Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:22:39.138Z] [LOG]    Actual Earned Base: Rs.10271.19
[2025-10-23T05:22:39.138Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:22:39.139Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:22:39.139Z] [LOG]    = Gross Salary: Rs.10271.19
[2025-10-23T05:22:39.139Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:22:39.140Z] [LOG]    Attendance Shortfall (Info): Rs.31199.69
[2025-10-23T05:22:39.140Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:22:39.140Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:39.140Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:22:39.140Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:22:39.140Z] [LOG]    Gross Salary: Rs.10271.19
[2025-10-23T05:22:39.141Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:22:39.141Z] [LOG]    = NET SALARY: Rs.10271.19
[2025-10-23T05:22:39.141Z] [LOG] 
💾 Database Update:
[2025-10-23T05:22:39.141Z] [LOG]    Total Earnings: Rs.10271.19 (Base: 10271.19 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:22:39.141Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:22:39.338Z] [LOG] 
📝 Components to save:
[2025-10-23T05:22:39.339Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:22:39.339Z] [LOG]    Deduction components: 1
[2025-10-23T05:22:39.340Z] [LOG] Creating components for record e156603d-470a-4733-a328-5950dd35e081: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:22:39.340Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10271.189987819445
}
[2025-10-23T05:22:39.533Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:22:39.730Z] [LOG] Created payroll_record_component: 5e2d5f76-ef36-4745-bb46-d07687809278 for Base Salary
[2025-10-23T05:22:39.731Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 31199.695
}
[2025-10-23T05:22:39.916Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:22:40.107Z] [LOG] Created payroll_record_component: 5f4954d8-aa20-4f44-abbd-638e3c85847b for Attendance Shortfall (Info)
[2025-10-23T05:22:40.594Z] [LOG] ✅ Financial balances updated successfully for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:40.595Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:22:40.595Z] [LOG] 
======================================================================
[2025-10-23T05:22:40.595Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Jessie null
[2025-10-23T05:22:40.595Z] [LOG] ======================================================================
[2025-10-23T05:22:40.596Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T05:22:40.596Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10271.19
[2025-10-23T05:22:40.596Z] [LOG]    Attendance Shortfall: Rs.31199.69
[2025-10-23T05:22:40.597Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:40.597Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:40.597Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:22:40.597Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:40.597Z] [LOG]    GROSS SALARY: Rs.10271.19
[2025-10-23T05:22:40.597Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:40.597Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:22:40.597Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:22:40.598Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:22:40.598Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:22:40.598Z] [LOG]       - Attendance Shortfall (Info): Rs.31199.69
[2025-10-23T05:22:40.598Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:40.598Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:40.598Z] [LOG]    NET SALARY: Rs.10271.19
[2025-10-23T05:22:40.598Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:22:40.598Z] [LOG] ======================================================================

[2025-10-23T05:22:40.598Z] [LOG] ✅ Jessie null: Calculation completed successfully
[2025-10-23T05:22:40.599Z] [LOG] 📊 Progress: 33/34 (97.1%)
[2025-10-23T05:22:40.599Z] [LOG] 
🧮 Processing: Chemil null (EMP000040)
[2025-10-23T05:22:40.599Z] [LOG] 📋 Record ID: f9101d5e-dfa8-4e60-9ab7-3888743d24b3
[2025-10-23T05:22:40.599Z] [LOG] 
======================================================================
[2025-10-23T05:22:40.599Z] [LOG] 🧮 CALCULATING PAYROLL: Chemil null (EMP000040)
[2025-10-23T05:22:40.599Z] [LOG] ======================================================================
[2025-10-23T05:22:41.550Z] [LOG] 🔍 Component filtering for employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-23T05:22:41.550Z] [LOG]    Total components: 13
[2025-10-23T05:22:41.550Z] [LOG]    Applicable components: 13
[2025-10-23T05:22:41.550Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:22:42.890Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:22:42.890Z] [LOG] 🔄 Processing financial records for employee 01442599-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:22:43.150Z] [LOG] 📊 Found 0 active loans for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:43.364Z] [LOG] 📊 Found 0 active advances for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:43.602Z] [LOG] 📊 Found 0 approved bonuses for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:43.603Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:22:43.603Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:22:44.011Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:22:44.012Z] [LOG]    Employee ID: 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:44.012Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:22:44.012Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:22:44.013Z] [LOG]    Base Salary (Full Month): Rs.250000.00
[2025-10-23T05:22:44.209Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:22:44.210Z] [LOG]       Daily Salary: Rs.10000.00
[2025-10-23T05:22:44.210Z] [LOG]       Weekday Hourly Rate: Rs.1176.47
[2025-10-23T05:22:44.210Z] [LOG]       Saturday Hourly Rate: Rs.2222.22
[2025-10-23T05:22:44.210Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:22:44.210Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:22:44.210Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:22:44.797Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:22:44.797Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:22:44.990Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:22:44.991Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:22:44.991Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:22:44.992Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:22:44.992Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:22:44.993Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:22:44.993Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:22:44.993Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:22:45.186Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:22:45.186Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:22:45.186Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:22:45.186Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:22:45.393Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:22:45.393Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:22:45.393Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:22:45.394Z] [LOG]       Current Time: 10:52:45
[2025-10-23T05:22:45.395Z] [LOG]       Expected Hours (scheduled → now): 2.38h
[2025-10-23T05:22:45.395Z] [LOG]       Actual Hours (check-in → now): 2.38h
[2025-10-23T05:22:45.395Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:22:45.395Z] [LOG]       Weekday: 121.38h
[2025-10-23T05:22:45.396Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:22:45.396Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:45.397Z] [LOG]       Total Expected: 134.88h
[2025-10-23T05:22:45.397Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:22:45.397Z] [LOG]       Weekday: 27.88h (includes 2.38h live)
[2025-10-23T05:22:45.398Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:22:45.398Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:22:45.398Z] [LOG]       Total Actual: 32.38h
[2025-10-23T05:22:45.398Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:22:45.399Z] [LOG]       Weekday: 121.38h × Rs.1176.47 = Rs.142799.08
[2025-10-23T05:22:45.399Z] [LOG]       Saturday: 13.50h × Rs.2222.22 = Rs.29999.97
[2025-10-23T05:22:45.399Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:45.400Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:45.400Z] [LOG]       Total Expected Earned: Rs.172799.05
[2025-10-23T05:22:45.400Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:22:45.401Z] [LOG]       Weekday: 27.88h × Rs.1176.47 = Rs.32799.13
[2025-10-23T05:22:45.401Z] [LOG]       Saturday: 4.50h × Rs.2222.22 = Rs.9999.99
[2025-10-23T05:22:45.401Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:22:45.401Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:45.402Z] [LOG]       Total Actual Earned: Rs.42799.12
[2025-10-23T05:22:45.402Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:22:45.403Z] [LOG]       Calculated At: Oct 23, 2025, 10:52:45
[2025-10-23T05:22:45.403Z] [LOG]       Expected Earned (until NOW): Rs.172799.05
[2025-10-23T05:22:45.403Z] [LOG]       Actual Earned (until NOW): Rs.42799.12
[2025-10-23T05:22:45.403Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:22:45.403Z] [LOG]       Attendance Deduction: Rs.129999.93
[2025-10-23T05:22:45.403Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:22:45.404Z] [LOG]       📉 Shortfall: 102.50 hours (75.23% of expected)
[2025-10-23T05:22:45.404Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:22:45.404Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:22:45.405Z] [LOG]    Base Salary (Full): Rs.250000.00
[2025-10-23T05:22:45.405Z] [LOG]    Actual Earned Base: Rs.42799.12
[2025-10-23T05:22:45.406Z] [LOG]    Attendance Shortfall: Rs.129999.93
[2025-10-23T05:22:45.406Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:22:45.407Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:22:45.407Z] [LOG]    Gross Salary: 42799.121639641664
[2025-10-23T05:22:45.408Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:22:45.408Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:22:45.409Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.409Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:22:45.409Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.410Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:22:45.410Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.411Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:22:45.411Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.411Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:22:45.412Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.412Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:22:45.412Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.412Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:22:45.413Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.413Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:22:45.413Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.414Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:22:45.414Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.414Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:22:45.415Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.415Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:22:45.415Z] [LOG]    EPF/ETF calculated on: Rs.42799.12
[2025-10-23T05:22:45.415Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:22:45.416Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:22:45.416Z] [LOG] 💰 GROSS CALCULATION for Chemil null:
[2025-10-23T05:22:45.416Z] [LOG]    Base Salary: 250000
[2025-10-23T05:22:45.417Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:22:45.417Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:22:45.417Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.418Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:22:45.418Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.419Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:22:45.419Z] [LOG]    Fixed amount: 0
[2025-10-23T05:22:45.627Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:22:45.628Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:45.628Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:22:45.628Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:22:45.629Z] [LOG]    Actual Earned Base: Rs.42799.12
[2025-10-23T05:22:45.629Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:22:45.629Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:22:45.630Z] [LOG]    = Gross Salary: Rs.42799.12
[2025-10-23T05:22:45.630Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:22:45.630Z] [LOG]    Attendance Shortfall (Info): Rs.129999.93
[2025-10-23T05:22:45.630Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:22:45.631Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:45.631Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:22:45.631Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:22:45.631Z] [LOG]    Gross Salary: Rs.42799.12
[2025-10-23T05:22:45.631Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:22:45.632Z] [LOG]    = NET SALARY: Rs.42799.12
[2025-10-23T05:22:45.632Z] [LOG] 
💾 Database Update:
[2025-10-23T05:22:45.632Z] [LOG]    Total Earnings: Rs.42799.12 (Base: 42799.12 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:22:45.632Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:22:45.899Z] [LOG] 
📝 Components to save:
[2025-10-23T05:22:45.900Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:22:45.900Z] [LOG]    Deduction components: 1
[2025-10-23T05:22:45.900Z] [LOG] Creating components for record f9101d5e-dfa8-4e60-9ab7-3888743d24b3: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:22:45.901Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 42799.121639641664
}
[2025-10-23T05:22:46.111Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:22:46.349Z] [LOG] Created payroll_record_component: e30e2ab3-e5ed-4d16-aea7-c1f5c8070d4c for Base Salary
[2025-10-23T05:22:46.350Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 129999.92500000002
}
[2025-10-23T05:22:46.549Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:22:46.750Z] [LOG] Created payroll_record_component: 0f25be2f-3330-4b1b-b488-3045c9498346 for Attendance Shortfall (Info)
[2025-10-23T05:22:47.229Z] [LOG] ✅ Financial balances updated successfully for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T05:22:47.230Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:22:47.230Z] [LOG] 
======================================================================
[2025-10-23T05:22:47.230Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Chemil null
[2025-10-23T05:22:47.231Z] [LOG] ======================================================================
[2025-10-23T05:22:47.231Z] [LOG]    Base Salary (Full): Rs.250000.00
[2025-10-23T05:22:47.231Z] [LOG]    Actual Earned Base (Attendance-based): Rs.42799.12
[2025-10-23T05:22:47.231Z] [LOG]    Attendance Shortfall: Rs.129999.93
[2025-10-23T05:22:47.232Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:47.232Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:22:47.232Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:22:47.232Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:47.233Z] [LOG]    GROSS SALARY: Rs.42799.12
[2025-10-23T05:22:47.233Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:47.233Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:22:47.234Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:22:47.234Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:22:47.234Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:22:47.234Z] [LOG]       - Attendance Shortfall (Info): Rs.129999.93
[2025-10-23T05:22:47.234Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:22:47.235Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:22:47.235Z] [LOG]    NET SALARY: Rs.42799.12
[2025-10-23T05:22:47.235Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:22:47.235Z] [LOG] ======================================================================

[2025-10-23T05:22:47.236Z] [LOG] ✅ Chemil null: Calculation completed successfully
[2025-10-23T05:22:47.236Z] [LOG] 📊 Progress: 34/34 (100.0%)
[2025-10-23T05:22:47.236Z] [LOG] 
============================================================
[2025-10-23T05:22:47.237Z] [LOG] 📈 Processing Summary: 34 successful, 0 failed
[2025-10-23T05:22:49.069Z] [LOG] 🎉 Payroll calculation completed successfully!
[2025-10-23T05:22:49.069Z] [LOG] 📊 Final Summary: 34 processed, 0 errors
[2025-10-23T05:22:49.070Z] [INFO] ================================================================================
[2025-10-23T05:22:49.070Z] [INFO] ⏰ Completed at: 2025-10-23T05:22:49.070Z
[2025-10-23T05:22:49.070Z] [INFO] 📊 Total log entries: 5977