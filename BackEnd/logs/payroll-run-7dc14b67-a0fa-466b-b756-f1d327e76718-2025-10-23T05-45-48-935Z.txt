[2025-10-23T05:45:48.935Z] [INFO] 🚀 Payroll calculation logging started for run: 7dc14b67-a0fa-466b-b756-f1d327e76718
[2025-10-23T05:45:48.935Z] [INFO] 📁 Log file: E:\smart_attendance_system\BackEnd\logs\payroll-run-7dc14b67-a0fa-466b-b756-f1d327e76718-2025-10-23T05-45-48-935Z.txt
[2025-10-23T05:45:48.935Z] [INFO] ⏰ Started at: 2025-10-23T05:45:48.935Z
[2025-10-23T05:45:48.936Z] [INFO] ================================================================================
[2025-10-23T05:45:48.936Z] [LOG] 🚀 Starting payroll calculation for run: 7dc14b67-a0fa-466b-b756-f1d327e76718
[2025-10-23T05:45:48.936Z] [LOG] 👤 Client ID: it-signature, User ID: 059304ea-24a5-4d78-a290-cf09b9e53c4c
[2025-10-23T05:45:49.647Z] [LOG] ✅ Payroll run verified: October (MONTHLY_2025_10_REGULAR)
[2025-10-23T05:45:50.092Z] [LOG] 📊 Status updated to 'calculating'
[2025-10-23T05:45:50.813Z] [LOG] 👥 Processing 34 employee records:
[2025-10-23T05:45:50.813Z] [LOG] ============================================================
[2025-10-23T05:45:50.813Z] [LOG] 
🧮 Processing: Ishara null (EMP000011)
[2025-10-23T05:45:50.814Z] [LOG] 📋 Record ID: 017c2fc7-6db6-49a0-a679-0736dfe8d474
[2025-10-23T05:45:50.815Z] [LOG] 
======================================================================
[2025-10-23T05:45:50.816Z] [LOG] 🧮 CALCULATING PAYROLL: Ishara null (EMP000011)
[2025-10-23T05:45:50.816Z] [LOG] ======================================================================
[2025-10-23T05:45:52.765Z] [LOG] 🔍 Component filtering for employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-23T05:45:52.765Z] [LOG]    Total components: 13
[2025-10-23T05:45:52.765Z] [LOG]    Applicable components: 13
[2025-10-23T05:45:52.766Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T05:45:55.877Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:45:55.878Z] [LOG] 🔄 Processing financial records for employee 0143ac0c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:45:56.375Z] [LOG] 📊 Found 0 active loans for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T05:45:56.873Z] [LOG] 📊 Found 0 active advances for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T05:45:57.331Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T05:45:57.333Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:45:57.333Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:45:57.733Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:45:57.734Z] [LOG]    Employee ID: 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T05:45:57.734Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:45:57.734Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:45:57.734Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:45:58.231Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:45:58.231Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:45:58.231Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:45:58.231Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:45:58.232Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:45:58.232Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:45:58.232Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:45:59.454Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:45:59.455Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:45:59.921Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:45:59.921Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:45:59.922Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:45:59.922Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:45:59.922Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:45:59.923Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:45:59.923Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:45:59.924Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:46:00.417Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:46:00.417Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:46:00.418Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:46:00.418Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:46:01.037Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:46:01.038Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:46:01.038Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:46:01.039Z] [LOG]       Current Time: 11:16:01
[2025-10-23T05:46:01.040Z] [LOG]       Expected Hours (scheduled → now): 2.77h
[2025-10-23T05:46:01.040Z] [LOG]       Actual Hours (check-in → now): 2.77h
[2025-10-23T05:46:01.040Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:46:01.041Z] [LOG]       Weekday: 121.77h
[2025-10-23T05:46:01.041Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:46:01.042Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:01.042Z] [LOG]       Total Expected: 135.27h
[2025-10-23T05:46:01.042Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:46:01.043Z] [LOG]       Weekday: 28.27h (includes 2.77h live)
[2025-10-23T05:46:01.043Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:46:01.043Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:01.044Z] [LOG]       Total Actual: 32.77h
[2025-10-23T05:46:01.044Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:46:01.044Z] [LOG]       Weekday: 121.77h × Rs.235.29 = Rs.28650.55
[2025-10-23T05:46:01.045Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:46:01.045Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:01.045Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:01.045Z] [LOG]       Total Expected Earned: Rs.34650.49
[2025-10-23T05:46:01.046Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:46:01.046Z] [LOG]       Weekday: 28.27h × Rs.235.29 = Rs.6650.93
[2025-10-23T05:46:01.046Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:46:01.046Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:01.046Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:01.047Z] [LOG]       Total Actual Earned: Rs.8650.91
[2025-10-23T05:46:01.047Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:46:01.047Z] [LOG]       Calculated At: Oct 23, 2025, 11:16:01
[2025-10-23T05:46:01.047Z] [LOG]       Expected Earned (until NOW): Rs.34650.49
[2025-10-23T05:46:01.048Z] [LOG]       Actual Earned (until NOW): Rs.8650.91
[2025-10-23T05:46:01.048Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:01.048Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:46:01.048Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:46:01.048Z] [LOG]       📉 Shortfall: 102.50 hours (75.03% of expected)
[2025-10-23T05:46:01.049Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:46:01.049Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:46:01.049Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:46:01.049Z] [LOG]    Actual Earned Base: Rs.8650.91
[2025-10-23T05:46:01.049Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:46:01.049Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:46:01.050Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:46:01.050Z] [LOG]    Gross Salary: 8650.911776591667
[2025-10-23T05:46:01.051Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:46:01.051Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:46:01.051Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.052Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:46:01.052Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.052Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:46:01.052Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.052Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:46:01.053Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.053Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:46:01.053Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.053Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:46:01.053Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.053Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:46:01.053Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.053Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:46:01.053Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.053Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:46:01.054Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.054Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:46:01.054Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.054Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:46:01.054Z] [LOG]    EPF/ETF calculated on: Rs.8650.91
[2025-10-23T05:46:01.054Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:46:01.054Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:46:01.054Z] [LOG] 💰 GROSS CALCULATION for Ishara null:
[2025-10-23T05:46:01.055Z] [LOG]    Base Salary: 50000
[2025-10-23T05:46:01.055Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:46:01.055Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:46:01.055Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.055Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:46:01.055Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.055Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:46:01.055Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:01.697Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:46:01.697Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:01.697Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:46:01.698Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:46:01.698Z] [LOG]    Actual Earned Base: Rs.8650.91
[2025-10-23T05:46:01.698Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:46:01.698Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:46:01.699Z] [LOG]    = Gross Salary: Rs.8650.91
[2025-10-23T05:46:01.699Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:46:01.699Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:46:01.699Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:46:01.700Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:01.700Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:46:01.700Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:46:01.701Z] [LOG]    Gross Salary: Rs.8650.91
[2025-10-23T05:46:01.701Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:46:01.701Z] [LOG]    = NET SALARY: Rs.8650.91
[2025-10-23T05:46:01.701Z] [LOG] 
💾 Database Update:
[2025-10-23T05:46:01.702Z] [LOG]    Total Earnings: Rs.8650.91 (Base: 8650.91 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:46:01.702Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:46:02.200Z] [LOG] 
📝 Components to save:
[2025-10-23T05:46:02.200Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:46:02.200Z] [LOG]    Deduction components: 1
[2025-10-23T05:46:02.201Z] [LOG] Creating components for record 017c2fc7-6db6-49a0-a679-0736dfe8d474: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:46:02.201Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8650.911776591667
}
[2025-10-23T05:46:02.692Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:46:03.162Z] [LOG] Created payroll_record_component: b8ccd7e3-6297-42e5-b214-8dba781794e4 for Base Salary
[2025-10-23T05:46:03.162Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:46:03.408Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:46:03.638Z] [LOG] Created payroll_record_component: 89c6dbee-6cb4-4e38-a9e5-ae8cbf76bc52 for Attendance Shortfall (Info)
[2025-10-23T05:46:04.038Z] [LOG] ✅ Financial balances updated successfully for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:04.039Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:46:04.039Z] [LOG] 
======================================================================
[2025-10-23T05:46:04.039Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ishara null
[2025-10-23T05:46:04.040Z] [LOG] ======================================================================
[2025-10-23T05:46:04.040Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:46:04.040Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8650.91
[2025-10-23T05:46:04.041Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:46:04.041Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:04.041Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:04.042Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:46:04.042Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:04.043Z] [LOG]    GROSS SALARY: Rs.8650.91
[2025-10-23T05:46:04.043Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:04.043Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:46:04.044Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:46:04.044Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:46:04.045Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:46:04.045Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:46:04.045Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:04.046Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:04.046Z] [LOG]    NET SALARY: Rs.8650.91
[2025-10-23T05:46:04.046Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:46:04.046Z] [LOG] ======================================================================

[2025-10-23T05:46:04.047Z] [LOG] ✅ Ishara null: Calculation completed successfully
[2025-10-23T05:46:04.047Z] [LOG] 📊 Progress: 1/34 (2.9%)
[2025-10-23T05:46:04.047Z] [LOG] 
🧮 Processing: Chamodi null (EMP000032)
[2025-10-23T05:46:04.048Z] [LOG] 📋 Record ID: 110a0ccd-65e1-4cf4-8c4d-c93fcdef2a93
[2025-10-23T05:46:04.048Z] [LOG] 
======================================================================
[2025-10-23T05:46:04.048Z] [LOG] 🧮 CALCULATING PAYROLL: Chamodi null (EMP000032)
[2025-10-23T05:46:04.048Z] [LOG] ======================================================================
[2025-10-23T05:46:05.006Z] [LOG] 🔍 Component filtering for employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-23T05:46:05.006Z] [LOG]    Total components: 13
[2025-10-23T05:46:05.007Z] [LOG]    Applicable components: 13
[2025-10-23T05:46:05.007Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:46:06.439Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:46:06.439Z] [LOG] 🔄 Processing financial records for employee 0143f302-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:46:06.689Z] [LOG] 📊 Found 0 active loans for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:06.929Z] [LOG] 📊 Found 0 active advances for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:07.168Z] [LOG] 📊 Found 0 approved bonuses for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:07.168Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:46:07.168Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:46:07.398Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:46:07.399Z] [LOG]    Employee ID: 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:07.399Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:46:07.400Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:46:07.400Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:46:07.639Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:46:07.640Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:46:07.640Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:46:07.640Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:46:07.640Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:46:07.641Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:46:07.641Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:46:08.374Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:46:08.375Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:46:08.596Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:46:08.596Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:46:08.597Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:46:08.597Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:46:08.597Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:46:08.598Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:46:08.598Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:46:08.598Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:46:08.856Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:46:08.857Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:46:08.857Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:46:08.857Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:46:09.087Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:46:09.087Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:46:09.088Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:46:09.089Z] [LOG]       Current Time: 11:16:09
[2025-10-23T05:46:09.089Z] [LOG]       Expected Hours (scheduled → now): 2.77h
[2025-10-23T05:46:09.089Z] [LOG]       Actual Hours (check-in → now): 2.77h
[2025-10-23T05:46:09.090Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:46:09.090Z] [LOG]       Weekday: 121.77h
[2025-10-23T05:46:09.091Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:46:09.091Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:09.091Z] [LOG]       Total Expected: 135.27h
[2025-10-23T05:46:09.092Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:46:09.092Z] [LOG]       Weekday: 28.27h (includes 2.77h live)
[2025-10-23T05:46:09.092Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:46:09.093Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:09.093Z] [LOG]       Total Actual: 32.77h
[2025-10-23T05:46:09.094Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:46:09.094Z] [LOG]       Weekday: 121.77h × Rs.235.29 = Rs.28651.07
[2025-10-23T05:46:09.094Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:46:09.095Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:09.095Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:09.095Z] [LOG]       Total Expected Earned: Rs.34651.01
[2025-10-23T05:46:09.096Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:46:09.096Z] [LOG]       Weekday: 28.27h × Rs.235.29 = Rs.6651.46
[2025-10-23T05:46:09.096Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:46:09.096Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:09.097Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:09.097Z] [LOG]       Total Actual Earned: Rs.8651.44
[2025-10-23T05:46:09.097Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:46:09.098Z] [LOG]       Calculated At: Oct 23, 2025, 11:16:09
[2025-10-23T05:46:09.098Z] [LOG]       Expected Earned (until NOW): Rs.34651.01
[2025-10-23T05:46:09.098Z] [LOG]       Actual Earned (until NOW): Rs.8651.44
[2025-10-23T05:46:09.098Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:09.099Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:46:09.099Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:46:09.099Z] [LOG]       📉 Shortfall: 102.50 hours (75.03% of expected)
[2025-10-23T05:46:09.099Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:46:09.099Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:46:09.099Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:46:09.099Z] [LOG]    Actual Earned Base: Rs.8651.44
[2025-10-23T05:46:09.100Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:46:09.100Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:46:09.100Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:46:09.100Z] [LOG]    Gross Salary: 8651.437911175
[2025-10-23T05:46:09.100Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:46:09.100Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:46:09.100Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.100Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:46:09.101Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.101Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:46:09.101Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.101Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:46:09.101Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.101Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:46:09.101Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.101Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:46:09.101Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.101Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:46:09.102Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.102Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:46:09.102Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.102Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:46:09.102Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.103Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:46:09.103Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.103Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:46:09.104Z] [LOG]    EPF/ETF calculated on: Rs.8651.44
[2025-10-23T05:46:09.104Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:46:09.104Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:46:09.104Z] [LOG] 💰 GROSS CALCULATION for Chamodi null:
[2025-10-23T05:46:09.104Z] [LOG]    Base Salary: 50000
[2025-10-23T05:46:09.104Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:46:09.104Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:46:09.104Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.104Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:46:09.104Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.105Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:46:09.105Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:09.330Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:46:09.331Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:09.332Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:46:09.332Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:46:09.332Z] [LOG]    Actual Earned Base: Rs.8651.44
[2025-10-23T05:46:09.332Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:46:09.332Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:46:09.333Z] [LOG]    = Gross Salary: Rs.8651.44
[2025-10-23T05:46:09.333Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:46:09.333Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:46:09.333Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:46:09.333Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:09.334Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:46:09.334Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:46:09.334Z] [LOG]    Gross Salary: Rs.8651.44
[2025-10-23T05:46:09.334Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:46:09.334Z] [LOG]    = NET SALARY: Rs.8651.44
[2025-10-23T05:46:09.334Z] [LOG] 
💾 Database Update:
[2025-10-23T05:46:09.335Z] [LOG]    Total Earnings: Rs.8651.44 (Base: 8651.44 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:46:09.335Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:46:09.570Z] [LOG] 
📝 Components to save:
[2025-10-23T05:46:09.570Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:46:09.571Z] [LOG]    Deduction components: 1
[2025-10-23T05:46:09.572Z] [LOG] Creating components for record 110a0ccd-65e1-4cf4-8c4d-c93fcdef2a93: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:46:09.575Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8651.437911175
}
[2025-10-23T05:46:09.817Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:46:10.048Z] [LOG] Created payroll_record_component: 0b3c378a-f265-4e52-bf5d-5400105214f2 for Base Salary
[2025-10-23T05:46:10.048Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:46:10.306Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:46:10.529Z] [LOG] Created payroll_record_component: 3974a430-f284-4477-b28d-57810d9e9b64 for Attendance Shortfall (Info)
[2025-10-23T05:46:10.960Z] [LOG] ✅ Financial balances updated successfully for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:10.961Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:46:10.961Z] [LOG] 
======================================================================
[2025-10-23T05:46:10.961Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Chamodi null
[2025-10-23T05:46:10.962Z] [LOG] ======================================================================
[2025-10-23T05:46:10.962Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:46:10.962Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8651.44
[2025-10-23T05:46:10.963Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:46:10.963Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:10.964Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:10.964Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:46:10.964Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:10.964Z] [LOG]    GROSS SALARY: Rs.8651.44
[2025-10-23T05:46:10.965Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:10.965Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:46:10.965Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:46:10.965Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:46:10.965Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:46:10.965Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:46:10.966Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:10.966Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:10.966Z] [LOG]    NET SALARY: Rs.8651.44
[2025-10-23T05:46:10.966Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:46:10.966Z] [LOG] ======================================================================

[2025-10-23T05:46:10.967Z] [LOG] ✅ Chamodi null: Calculation completed successfully
[2025-10-23T05:46:10.967Z] [LOG] 📊 Progress: 2/34 (5.9%)
[2025-10-23T05:46:10.967Z] [LOG] 
🧮 Processing: Office Team null (EMP000041)
[2025-10-23T05:46:10.967Z] [LOG] 📋 Record ID: 1147b7aa-a2ca-4b94-9a3e-9990555c2622
[2025-10-23T05:46:10.967Z] [LOG] 
======================================================================
[2025-10-23T05:46:10.968Z] [LOG] 🧮 CALCULATING PAYROLL: Office Team null (EMP000041)
[2025-10-23T05:46:10.968Z] [LOG] ======================================================================
[2025-10-23T05:46:11.960Z] [LOG] 🔍 Component filtering for employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-23T05:46:11.960Z] [LOG]    Total components: 13
[2025-10-23T05:46:11.961Z] [LOG]    Applicable components: 13
[2025-10-23T05:46:11.961Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:46:13.643Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:46:13.644Z] [LOG] 🔄 Processing financial records for employee 01442b21-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:46:13.881Z] [LOG] 📊 Found 0 active loans for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:14.127Z] [LOG] 📊 Found 0 active advances for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:14.370Z] [LOG] 📊 Found 0 approved bonuses for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:14.370Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:46:14.371Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:46:14.612Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:46:14.613Z] [LOG]    Employee ID: 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:14.613Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:46:14.613Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:46:14.613Z] [LOG]    Base Salary (Full Month): Rs.1.00
[2025-10-23T05:46:14.835Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:46:14.835Z] [LOG]       Daily Salary: Rs.0.04
[2025-10-23T05:46:14.836Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T05:46:14.836Z] [LOG]       Saturday Hourly Rate: Rs.0.01
[2025-10-23T05:46:14.836Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:46:14.837Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:46:14.837Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:46:15.801Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:46:15.802Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:46:16.055Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:46:16.056Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:46:16.056Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:46:16.056Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:46:16.057Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:46:16.057Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:46:16.057Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:46:16.058Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:46:16.280Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:46:16.281Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:46:16.281Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:46:16.283Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:46:16.526Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:46:16.527Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:46:16.527Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:46:16.528Z] [LOG]       Current Time: 11:16:16
[2025-10-23T05:46:16.528Z] [LOG]       Expected Hours (scheduled → now): 2.77h
[2025-10-23T05:46:16.529Z] [LOG]       Actual Hours (check-in → now): 2.77h
[2025-10-23T05:46:16.529Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:46:16.529Z] [LOG]       Weekday: 121.77h
[2025-10-23T05:46:16.530Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:46:16.530Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:16.530Z] [LOG]       Total Expected: 135.27h
[2025-10-23T05:46:16.530Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:46:16.531Z] [LOG]       Weekday: 28.27h (includes 2.77h live)
[2025-10-23T05:46:16.531Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:46:16.531Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:16.532Z] [LOG]       Total Actual: 32.77h
[2025-10-23T05:46:16.532Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:46:16.532Z] [LOG]       Weekday: 121.77h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:16.533Z] [LOG]       Saturday: 13.50h × Rs.0.01 = Rs.0.14
[2025-10-23T05:46:16.533Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:16.534Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:16.534Z] [LOG]       Total Expected Earned: Rs.0.14
[2025-10-23T05:46:16.534Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:46:16.535Z] [LOG]       Weekday: 28.27h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:16.535Z] [LOG]       Saturday: 4.50h × Rs.0.01 = Rs.0.04
[2025-10-23T05:46:16.535Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:16.535Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:16.536Z] [LOG]       Total Actual Earned: Rs.0.04
[2025-10-23T05:46:16.537Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:46:16.537Z] [LOG]       Calculated At: Oct 23, 2025, 11:16:16
[2025-10-23T05:46:16.537Z] [LOG]       Expected Earned (until NOW): Rs.0.14
[2025-10-23T05:46:16.538Z] [LOG]       Actual Earned (until NOW): Rs.0.04
[2025-10-23T05:46:16.538Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:16.538Z] [LOG]       Attendance Deduction: Rs.0.09
[2025-10-23T05:46:16.539Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:46:16.539Z] [LOG]       📉 Shortfall: 102.50 hours (66.67% of expected)
[2025-10-23T05:46:16.539Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:46:16.540Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:46:16.540Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T05:46:16.540Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T05:46:16.541Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T05:46:16.541Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:46:16.541Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:46:16.542Z] [LOG]    Gross Salary: 0.045
[2025-10-23T05:46:16.542Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:46:16.542Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:46:16.543Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.543Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:46:16.543Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.544Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:46:16.544Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.544Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:46:16.545Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.545Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:46:16.546Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.546Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:46:16.547Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.548Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:46:16.548Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.549Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:46:16.549Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.549Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:46:16.550Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.550Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:46:16.550Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.551Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:46:16.551Z] [LOG]    EPF/ETF calculated on: Rs.0.04
[2025-10-23T05:46:16.552Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:46:16.552Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:46:16.552Z] [LOG] 💰 GROSS CALCULATION for Office Team null:
[2025-10-23T05:46:16.553Z] [LOG]    Base Salary: 1
[2025-10-23T05:46:16.553Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:46:16.553Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:46:16.553Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.554Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:46:16.554Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.554Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:46:16.555Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:16.761Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:46:16.761Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:16.762Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:46:16.762Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:46:16.763Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T05:46:16.763Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:46:16.763Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:46:16.764Z] [LOG]    = Gross Salary: Rs.0.04
[2025-10-23T05:46:16.764Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:46:16.765Z] [LOG]    Attendance Shortfall (Info): Rs.0.09
[2025-10-23T05:46:16.765Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:46:16.765Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:16.765Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:46:16.766Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:46:16.766Z] [LOG]    Gross Salary: Rs.0.04
[2025-10-23T05:46:16.766Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:46:16.767Z] [LOG]    = NET SALARY: Rs.0.04
[2025-10-23T05:46:16.767Z] [LOG] 
💾 Database Update:
[2025-10-23T05:46:16.767Z] [LOG]    Total Earnings: Rs.0.04 (Base: 0.04 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:46:16.768Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:46:17.027Z] [LOG] 
📝 Components to save:
[2025-10-23T05:46:17.028Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:46:17.028Z] [LOG]    Deduction components: 1
[2025-10-23T05:46:17.029Z] [LOG] Creating components for record 1147b7aa-a2ca-4b94-9a3e-9990555c2622: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:46:17.030Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 0.045
}
[2025-10-23T05:46:17.238Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:46:17.481Z] [LOG] Created payroll_record_component: ef8a4ba0-d114-453b-aea3-589b92949774 for Base Salary
[2025-10-23T05:46:17.481Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 0.09000000000000001
}
[2025-10-23T05:46:17.736Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:46:17.964Z] [LOG] Created payroll_record_component: e6c62877-5861-45e4-8d2e-4c5a5c888a9d for Attendance Shortfall (Info)
[2025-10-23T05:46:18.447Z] [LOG] ✅ Financial balances updated successfully for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:18.447Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:46:18.448Z] [LOG] 
======================================================================
[2025-10-23T05:46:18.448Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Office Team null
[2025-10-23T05:46:18.448Z] [LOG] ======================================================================
[2025-10-23T05:46:18.449Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T05:46:18.449Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.04
[2025-10-23T05:46:18.449Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T05:46:18.450Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:18.450Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:18.450Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:46:18.451Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:18.451Z] [LOG]    GROSS SALARY: Rs.0.04
[2025-10-23T05:46:18.451Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:18.452Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:46:18.452Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:46:18.452Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:46:18.453Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:46:18.453Z] [LOG]       - Attendance Shortfall (Info): Rs.0.09
[2025-10-23T05:46:18.453Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:18.453Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:18.454Z] [LOG]    NET SALARY: Rs.0.04
[2025-10-23T05:46:18.454Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:46:18.454Z] [LOG] ======================================================================

[2025-10-23T05:46:18.455Z] [LOG] ✅ Office Team null: Calculation completed successfully
[2025-10-23T05:46:18.455Z] [LOG] 📊 Progress: 3/34 (8.8%)
[2025-10-23T05:46:18.455Z] [LOG] 
🧮 Processing: Dharshika null (EMP000009)
[2025-10-23T05:46:18.456Z] [LOG] 📋 Record ID: 1e7d80cd-3bf8-4d16-a506-d2e3df55afc3
[2025-10-23T05:46:18.456Z] [LOG] 
======================================================================
[2025-10-23T05:46:18.456Z] [LOG] 🧮 CALCULATING PAYROLL: Dharshika null (EMP000009)
[2025-10-23T05:46:18.457Z] [LOG] ======================================================================
[2025-10-23T05:46:19.504Z] [LOG] 🔍 Component filtering for employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-23T05:46:19.505Z] [LOG]    Total components: 13
[2025-10-23T05:46:19.505Z] [LOG]    Applicable components: 13
[2025-10-23T05:46:19.505Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:46:21.037Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:46:21.037Z] [LOG] 🔄 Processing financial records for employee 0143a994-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:46:21.239Z] [LOG] 📊 Found 0 active loans for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:21.487Z] [LOG] 📊 Found 0 active advances for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:21.726Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:21.726Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:46:21.727Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:46:21.993Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:46:21.994Z] [LOG]    Employee ID: 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:21.994Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:46:21.995Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:46:21.995Z] [LOG]    Base Salary (Full Month): Rs.100000.00
[2025-10-23T05:46:22.287Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:46:22.288Z] [LOG]       Daily Salary: Rs.4000.00
[2025-10-23T05:46:22.288Z] [LOG]       Weekday Hourly Rate: Rs.470.59
[2025-10-23T05:46:22.289Z] [LOG]       Saturday Hourly Rate: Rs.888.89
[2025-10-23T05:46:22.289Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:46:22.289Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:46:22.289Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:46:23.013Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:46:23.013Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:46:23.259Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:46:23.259Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:46:23.260Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:46:23.260Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:46:23.260Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:46:23.260Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:46:23.261Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:46:23.261Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:46:23.478Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:46:23.479Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:46:23.480Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:46:23.480Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:46:23.748Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:46:23.748Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:46:23.748Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:46:23.749Z] [LOG]       Current Time: 11:16:23
[2025-10-23T05:46:23.750Z] [LOG]       Expected Hours (scheduled → now): 2.77h
[2025-10-23T05:46:23.750Z] [LOG]       Actual Hours (check-in → now): 2.77h
[2025-10-23T05:46:23.751Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:46:23.751Z] [LOG]       Weekday: 121.77h
[2025-10-23T05:46:23.751Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:46:23.752Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:23.752Z] [LOG]       Total Expected: 135.27h
[2025-10-23T05:46:23.752Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:46:23.753Z] [LOG]       Weekday: 28.27h (includes 2.77h live)
[2025-10-23T05:46:23.753Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:46:23.754Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:23.754Z] [LOG]       Total Actual: 32.77h
[2025-10-23T05:46:23.754Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:46:23.755Z] [LOG]       Weekday: 121.77h × Rs.470.59 = Rs.57305.28
[2025-10-23T05:46:23.755Z] [LOG]       Saturday: 13.50h × Rs.888.89 = Rs.12000.01
[2025-10-23T05:46:23.755Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:23.756Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:23.756Z] [LOG]       Total Expected Earned: Rs.69305.29
[2025-10-23T05:46:23.756Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:46:23.757Z] [LOG]       Weekday: 28.27h × Rs.470.59 = Rs.13305.11
[2025-10-23T05:46:23.757Z] [LOG]       Saturday: 4.50h × Rs.888.89 = Rs.4000.01
[2025-10-23T05:46:23.757Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:23.758Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:23.758Z] [LOG]       Total Actual Earned: Rs.17305.12
[2025-10-23T05:46:23.759Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:46:23.760Z] [LOG]       Calculated At: Oct 23, 2025, 11:16:23
[2025-10-23T05:46:23.760Z] [LOG]       Expected Earned (until NOW): Rs.69305.29
[2025-10-23T05:46:23.761Z] [LOG]       Actual Earned (until NOW): Rs.17305.12
[2025-10-23T05:46:23.761Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:23.761Z] [LOG]       Attendance Deduction: Rs.52000.18
[2025-10-23T05:46:23.762Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:46:23.763Z] [LOG]       📉 Shortfall: 102.50 hours (75.03% of expected)
[2025-10-23T05:46:23.763Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:46:23.764Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:46:23.765Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T05:46:23.765Z] [LOG]    Actual Earned Base: Rs.17305.12
[2025-10-23T05:46:23.765Z] [LOG]    Attendance Shortfall: Rs.52000.18
[2025-10-23T05:46:23.766Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:46:23.766Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:46:23.766Z] [LOG]    Gross Salary: 17305.11999203333
[2025-10-23T05:46:23.767Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:46:23.767Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:46:23.767Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.768Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:46:23.768Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.768Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:46:23.769Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.769Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:46:23.770Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.770Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:46:23.771Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.772Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:46:23.772Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.772Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:46:23.773Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.773Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:46:23.773Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.774Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:46:23.774Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.775Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:46:23.775Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.775Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:46:23.775Z] [LOG]    EPF/ETF calculated on: Rs.17305.12
[2025-10-23T05:46:23.775Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:46:23.776Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:46:23.776Z] [LOG] 💰 GROSS CALCULATION for Dharshika null:
[2025-10-23T05:46:23.776Z] [LOG]    Base Salary: 100000
[2025-10-23T05:46:23.777Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:46:23.777Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:46:23.777Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.778Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:46:23.778Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:23.778Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:46:23.779Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:24.042Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:46:24.043Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:24.043Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:46:24.044Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:46:24.044Z] [LOG]    Actual Earned Base: Rs.17305.12
[2025-10-23T05:46:24.044Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:46:24.045Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:46:24.045Z] [LOG]    = Gross Salary: Rs.17305.12
[2025-10-23T05:46:24.045Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:46:24.046Z] [LOG]    Attendance Shortfall (Info): Rs.52000.18
[2025-10-23T05:46:24.046Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:46:24.047Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:24.047Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:46:24.047Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:46:24.048Z] [LOG]    Gross Salary: Rs.17305.12
[2025-10-23T05:46:24.048Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:46:24.048Z] [LOG]    = NET SALARY: Rs.17305.12
[2025-10-23T05:46:24.049Z] [LOG] 
💾 Database Update:
[2025-10-23T05:46:24.049Z] [LOG]    Total Earnings: Rs.17305.12 (Base: 17305.12 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:46:24.049Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:46:24.284Z] [LOG] 
📝 Components to save:
[2025-10-23T05:46:24.284Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:46:24.285Z] [LOG]    Deduction components: 1
[2025-10-23T05:46:24.285Z] [LOG] Creating components for record 1e7d80cd-3bf8-4d16-a506-d2e3df55afc3: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:46:24.286Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 17305.11999203333
}
[2025-10-23T05:46:24.482Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:46:24.674Z] [LOG] Created payroll_record_component: 52620dd2-8ed8-4597-bfce-294c467f8360 for Base Salary
[2025-10-23T05:46:24.675Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 52000.175
}
[2025-10-23T05:46:24.970Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:46:25.194Z] [LOG] Created payroll_record_component: e9d47208-ead6-4bb2-9f0e-cc5956ad5d61 for Attendance Shortfall (Info)
[2025-10-23T05:46:25.647Z] [LOG] ✅ Financial balances updated successfully for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:25.647Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:46:25.648Z] [LOG] 
======================================================================
[2025-10-23T05:46:25.648Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Dharshika null
[2025-10-23T05:46:25.649Z] [LOG] ======================================================================
[2025-10-23T05:46:25.649Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T05:46:25.649Z] [LOG]    Actual Earned Base (Attendance-based): Rs.17305.12
[2025-10-23T05:46:25.650Z] [LOG]    Attendance Shortfall: Rs.52000.18
[2025-10-23T05:46:25.650Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:25.650Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:25.651Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:46:25.651Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:25.651Z] [LOG]    GROSS SALARY: Rs.17305.12
[2025-10-23T05:46:25.652Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:25.652Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:46:25.652Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:46:25.653Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:46:25.653Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:46:25.654Z] [LOG]       - Attendance Shortfall (Info): Rs.52000.18
[2025-10-23T05:46:25.654Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:25.654Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:25.655Z] [LOG]    NET SALARY: Rs.17305.12
[2025-10-23T05:46:25.655Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:46:25.655Z] [LOG] ======================================================================

[2025-10-23T05:46:25.656Z] [LOG] ✅ Dharshika null: Calculation completed successfully
[2025-10-23T05:46:25.656Z] [LOG] 📊 Progress: 4/34 (11.8%)
[2025-10-23T05:46:25.656Z] [LOG] 
🧮 Processing: Ruvindu Hewabandu null (EMP000027)
[2025-10-23T05:46:25.657Z] [LOG] 📋 Record ID: 2383e518-d576-413f-9cf9-3f766c51c43b
[2025-10-23T05:46:25.657Z] [LOG] 
======================================================================
[2025-10-23T05:46:25.658Z] [LOG] 🧮 CALCULATING PAYROLL: Ruvindu Hewabandu null (EMP000027)
[2025-10-23T05:46:25.658Z] [LOG] ======================================================================
[2025-10-23T05:46:26.558Z] [LOG] 🔍 Component filtering for employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-23T05:46:26.558Z] [LOG]    Total components: 13
[2025-10-23T05:46:26.559Z] [LOG]    Applicable components: 13
[2025-10-23T05:46:26.559Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:46:27.926Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:46:27.927Z] [LOG] 🔄 Processing financial records for employee 0143e915-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:46:28.358Z] [LOG] 📊 Found 0 active loans for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:28.557Z] [LOG] 📊 Found 0 active advances for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:28.761Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:28.762Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:46:28.763Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:46:29.013Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:46:29.014Z] [LOG]    Employee ID: 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:29.014Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:46:29.015Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:46:29.015Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-23T05:46:29.247Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:46:29.248Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-23T05:46:29.248Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T05:46:29.249Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-23T05:46:29.249Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:46:29.249Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:46:29.250Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:46:29.961Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:46:29.962Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:46:30.185Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:46:30.186Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:46:30.186Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:46:30.186Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:46:30.187Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:46:30.187Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:46:30.187Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:46:30.188Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:46:30.389Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:46:30.390Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:46:30.390Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:46:30.391Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:46:30.602Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:46:30.602Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:46:30.602Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:46:30.603Z] [LOG]       Current Time: 11:16:30
[2025-10-23T05:46:30.604Z] [LOG]       Expected Hours (scheduled → now): 2.78h
[2025-10-23T05:46:30.604Z] [LOG]       Actual Hours (check-in → now): 2.78h
[2025-10-23T05:46:30.604Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:46:30.605Z] [LOG]       Weekday: 121.78h
[2025-10-23T05:46:30.605Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:46:30.605Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:30.606Z] [LOG]       Total Expected: 135.28h
[2025-10-23T05:46:30.606Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:46:30.606Z] [LOG]       Weekday: 28.28h (includes 2.78h live)
[2025-10-23T05:46:30.607Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:46:30.607Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:30.608Z] [LOG]       Total Actual: 32.78h
[2025-10-23T05:46:30.608Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:46:30.608Z] [LOG]       Weekday: 121.78h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:30.609Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:30.609Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:30.610Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:30.610Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-23T05:46:30.610Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:46:30.610Z] [LOG]       Weekday: 28.28h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:30.611Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:30.611Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:30.611Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:30.612Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-23T05:46:30.613Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:46:30.614Z] [LOG]       Calculated At: Oct 23, 2025, 11:16:30
[2025-10-23T05:46:30.614Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-23T05:46:30.614Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-23T05:46:30.614Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:30.615Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-23T05:46:30.615Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:46:30.616Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-23T05:46:30.616Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:46:30.616Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:46:30.617Z] [LOG]    Base Salary (Full): Rs.NaN
[2025-10-23T05:46:30.617Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:46:30.618Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:46:30.619Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:46:30.619Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:46:30.620Z] [LOG]    Gross Salary: 0
[2025-10-23T05:46:30.620Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:46:30.620Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:46:30.620Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.621Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:46:30.621Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.621Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:46:30.622Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.622Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:46:30.622Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.623Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:46:30.623Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.623Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:46:30.624Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.624Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:46:30.624Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.624Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:46:30.625Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.625Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:46:30.625Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.626Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:46:30.626Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.627Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:46:30.627Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-23T05:46:30.627Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:46:30.628Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:46:30.628Z] [LOG] 💰 GROSS CALCULATION for Ruvindu Hewabandu null:
[2025-10-23T05:46:30.628Z] [LOG]    Base Salary: 0
[2025-10-23T05:46:30.629Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:46:30.629Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:46:30.629Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.630Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:46:30.630Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.630Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:46:30.630Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:30.836Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:46:30.837Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:30.837Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:46:30.837Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:46:30.837Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:46:30.838Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:46:30.838Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:46:30.838Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-23T05:46:30.839Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:46:30.839Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:46:30.839Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:30.840Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:46:30.840Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:46:30.840Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-23T05:46:30.841Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:46:30.841Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-23T05:46:30.841Z] [LOG] 
💾 Database Update:
[2025-10-23T05:46:30.842Z] [LOG]    Total Earnings: Rs.0.00 (Base: 0.00 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:46:30.842Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:46:31.090Z] [LOG] 
📝 Components to save:
[2025-10-23T05:46:31.091Z] [LOG]    Gross/Earnings components: 0
[2025-10-23T05:46:31.091Z] [LOG]    Deduction components: 0
[2025-10-23T05:46:31.091Z] [LOG] Creating components for record 2383e518-d576-413f-9cf9-3f766c51c43b: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-23T05:46:31.564Z] [LOG] ✅ Financial balances updated successfully for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:31.564Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:46:31.564Z] [LOG] 
======================================================================
[2025-10-23T05:46:31.565Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ruvindu Hewabandu null
[2025-10-23T05:46:31.565Z] [LOG] ======================================================================
[2025-10-23T05:46:31.565Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T05:46:31.566Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-23T05:46:31.566Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:46:31.566Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:31.567Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:31.567Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:46:31.567Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:31.567Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-23T05:46:31.568Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:31.568Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:46:31.568Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:46:31.568Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:46:31.569Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:46:31.569Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-23T05:46:31.569Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:31.570Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:31.570Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-23T05:46:31.570Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:46:31.570Z] [LOG] ======================================================================

[2025-10-23T05:46:31.571Z] [LOG] ✅ Ruvindu Hewabandu null: Calculation completed successfully
[2025-10-23T05:46:31.571Z] [LOG] 📊 Progress: 5/34 (14.7%)
[2025-10-23T05:46:31.571Z] [LOG] 
🧮 Processing: Prasanthan null (EMP000001)
[2025-10-23T05:46:31.572Z] [LOG] 📋 Record ID: 36b0c1bf-2e29-48c1-b236-493b39d26b95
[2025-10-23T05:46:31.572Z] [LOG] 
======================================================================
[2025-10-23T05:46:31.572Z] [LOG] 🧮 CALCULATING PAYROLL: Prasanthan null (EMP000001)
[2025-10-23T05:46:31.573Z] [LOG] ======================================================================
[2025-10-23T05:46:32.525Z] [LOG] 🔍 Component filtering for employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-23T05:46:32.526Z] [LOG]    Total components: 13
[2025-10-23T05:46:32.526Z] [LOG]    Applicable components: 13
[2025-10-23T05:46:32.526Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:46:34.122Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:46:34.122Z] [LOG] 🔄 Processing financial records for employee 014397c7-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:46:34.321Z] [LOG] 📊 Found 0 active loans for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:34.556Z] [LOG] 📊 Found 0 active advances for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:34.774Z] [LOG] 📊 Found 0 approved bonuses for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:34.774Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:46:34.775Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:46:35.022Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:46:35.022Z] [LOG]    Employee ID: 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:35.023Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:46:35.023Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:46:35.023Z] [LOG]    Base Salary (Full Month): Rs.150000.00
[2025-10-23T05:46:35.265Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:46:35.265Z] [LOG]       Daily Salary: Rs.6000.00
[2025-10-23T05:46:35.266Z] [LOG]       Weekday Hourly Rate: Rs.705.88
[2025-10-23T05:46:35.266Z] [LOG]       Saturday Hourly Rate: Rs.1333.33
[2025-10-23T05:46:35.266Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:46:35.266Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:46:35.267Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:46:35.966Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:46:35.967Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:46:36.188Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:46:36.188Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:46:36.189Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:46:36.189Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:46:36.189Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:46:36.189Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:46:36.189Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:46:36.190Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:46:36.444Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:46:36.444Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:46:36.445Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:46:36.445Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:46:36.688Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:46:36.688Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:46:36.688Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:46:36.689Z] [LOG]       Current Time: 11:16:36
[2025-10-23T05:46:36.690Z] [LOG]       Expected Hours (scheduled → now): 2.78h
[2025-10-23T05:46:36.690Z] [LOG]       Actual Hours (check-in → now): 2.78h
[2025-10-23T05:46:36.690Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:46:36.691Z] [LOG]       Weekday: 121.78h
[2025-10-23T05:46:36.691Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:46:36.691Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:36.692Z] [LOG]       Total Expected: 135.28h
[2025-10-23T05:46:36.692Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:46:36.692Z] [LOG]       Weekday: 28.28h (includes 2.78h live)
[2025-10-23T05:46:36.693Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:46:36.693Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:36.693Z] [LOG]       Total Actual: 32.78h
[2025-10-23T05:46:36.693Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:46:36.694Z] [LOG]       Weekday: 121.78h × Rs.705.88 = Rs.85959.85
[2025-10-23T05:46:36.694Z] [LOG]       Saturday: 13.50h × Rs.1333.33 = Rs.17999.95
[2025-10-23T05:46:36.694Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:36.695Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:36.695Z] [LOG]       Total Expected Earned: Rs.103959.80
[2025-10-23T05:46:36.695Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:46:36.696Z] [LOG]       Weekday: 28.28h × Rs.705.88 = Rs.19960.07
[2025-10-23T05:46:36.696Z] [LOG]       Saturday: 4.50h × Rs.1333.33 = Rs.5999.98
[2025-10-23T05:46:36.696Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:36.696Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:36.697Z] [LOG]       Total Actual Earned: Rs.25960.05
[2025-10-23T05:46:36.697Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:46:36.697Z] [LOG]       Calculated At: Oct 23, 2025, 11:16:36
[2025-10-23T05:46:36.698Z] [LOG]       Expected Earned (until NOW): Rs.103959.80
[2025-10-23T05:46:36.698Z] [LOG]       Actual Earned (until NOW): Rs.25960.05
[2025-10-23T05:46:36.698Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:36.698Z] [LOG]       Attendance Deduction: Rs.77999.75
[2025-10-23T05:46:36.698Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:46:36.698Z] [LOG]       📉 Shortfall: 102.50 hours (75.03% of expected)
[2025-10-23T05:46:36.699Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:46:36.699Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:46:36.700Z] [LOG]    Base Salary (Full): Rs.150000.00
[2025-10-23T05:46:36.700Z] [LOG]    Actual Earned Base: Rs.25960.05
[2025-10-23T05:46:36.700Z] [LOG]    Attendance Shortfall: Rs.77999.75
[2025-10-23T05:46:36.700Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:46:36.701Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:46:36.701Z] [LOG]    Gross Salary: 25960.053368177778
[2025-10-23T05:46:36.702Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:46:36.702Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:46:36.703Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.703Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:46:36.703Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.704Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:46:36.704Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.704Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:46:36.704Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.705Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:46:36.705Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.705Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:46:36.706Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.706Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:46:36.706Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.707Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:46:36.707Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.707Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:46:36.707Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.708Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:46:36.708Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.708Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:46:36.709Z] [LOG]    EPF/ETF calculated on: Rs.25960.05
[2025-10-23T05:46:36.709Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:46:36.709Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:46:36.709Z] [LOG] 💰 GROSS CALCULATION for Prasanthan null:
[2025-10-23T05:46:36.710Z] [LOG]    Base Salary: 150000
[2025-10-23T05:46:36.710Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:46:36.710Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:46:36.710Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.711Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:46:36.711Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.711Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:46:36.711Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:36.940Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:46:36.941Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:36.941Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:46:36.941Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:46:36.941Z] [LOG]    Actual Earned Base: Rs.25960.05
[2025-10-23T05:46:36.941Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:46:36.941Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:46:36.942Z] [LOG]    = Gross Salary: Rs.25960.05
[2025-10-23T05:46:36.942Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:46:36.942Z] [LOG]    Attendance Shortfall (Info): Rs.77999.75
[2025-10-23T05:46:36.942Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:46:36.942Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:36.943Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:46:36.943Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:46:36.943Z] [LOG]    Gross Salary: Rs.25960.05
[2025-10-23T05:46:36.944Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:46:36.944Z] [LOG]    = NET SALARY: Rs.25960.05
[2025-10-23T05:46:36.944Z] [LOG] 
💾 Database Update:
[2025-10-23T05:46:36.944Z] [LOG]    Total Earnings: Rs.25960.05 (Base: 25960.05 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:46:36.945Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:46:37.165Z] [LOG] 
📝 Components to save:
[2025-10-23T05:46:37.165Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:46:37.165Z] [LOG]    Deduction components: 1
[2025-10-23T05:46:37.166Z] [LOG] Creating components for record 36b0c1bf-2e29-48c1-b236-493b39d26b95: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:46:37.166Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 25960.053368177778
}
[2025-10-23T05:46:37.413Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:46:37.605Z] [LOG] Created payroll_record_component: a9b2f8b9-14d0-49d3-bf77-766053d17980 for Base Salary
[2025-10-23T05:46:37.606Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 77999.75
}
[2025-10-23T05:46:37.841Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:46:38.130Z] [LOG] Created payroll_record_component: 993209f5-bd17-43bd-bdbd-51741e41be68 for Attendance Shortfall (Info)
[2025-10-23T05:46:38.616Z] [LOG] ✅ Financial balances updated successfully for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:38.617Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:46:38.617Z] [LOG] 
======================================================================
[2025-10-23T05:46:38.617Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Prasanthan null
[2025-10-23T05:46:38.618Z] [LOG] ======================================================================
[2025-10-23T05:46:38.618Z] [LOG]    Base Salary (Full): Rs.150000.00
[2025-10-23T05:46:38.618Z] [LOG]    Actual Earned Base (Attendance-based): Rs.25960.05
[2025-10-23T05:46:38.619Z] [LOG]    Attendance Shortfall: Rs.77999.75
[2025-10-23T05:46:38.619Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:38.619Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:38.620Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:46:38.620Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:38.620Z] [LOG]    GROSS SALARY: Rs.25960.05
[2025-10-23T05:46:38.621Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:38.621Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:46:38.621Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:46:38.622Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:46:38.622Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:46:38.622Z] [LOG]       - Attendance Shortfall (Info): Rs.77999.75
[2025-10-23T05:46:38.622Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:38.623Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:38.623Z] [LOG]    NET SALARY: Rs.25960.05
[2025-10-23T05:46:38.623Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:46:38.624Z] [LOG] ======================================================================

[2025-10-23T05:46:38.624Z] [LOG] ✅ Prasanthan null: Calculation completed successfully
[2025-10-23T05:46:38.624Z] [LOG] 📊 Progress: 6/34 (17.6%)
[2025-10-23T05:46:38.625Z] [LOG] 
🧮 Processing: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-23T05:46:38.625Z] [LOG] 📋 Record ID: 37a717f6-fc24-4a86-9572-c78403d6c464
[2025-10-23T05:46:38.625Z] [LOG] 
======================================================================
[2025-10-23T05:46:38.626Z] [LOG] 🧮 CALCULATING PAYROLL: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-23T05:46:38.626Z] [LOG] ======================================================================
[2025-10-23T05:46:39.568Z] [LOG] 🔍 Component filtering for employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-23T05:46:39.568Z] [LOG]    Total components: 13
[2025-10-23T05:46:39.568Z] [LOG]    Applicable components: 13
[2025-10-23T05:46:39.569Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:46:41.006Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:46:41.007Z] [LOG] 🔄 Processing financial records for employee 0144461e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:46:41.264Z] [LOG] 📊 Found 0 active loans for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:41.485Z] [LOG] 📊 Found 0 active advances for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:41.684Z] [LOG] 📊 Found 0 approved bonuses for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:41.685Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:46:41.686Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:46:41.892Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:46:41.893Z] [LOG]    Employee ID: 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:41.893Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:46:41.894Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:46:41.894Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:46:42.097Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:46:42.097Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:46:42.098Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:46:42.098Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:46:42.098Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:46:42.098Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:46:42.099Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:46:42.897Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:46:42.898Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:46:43.398Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:46:43.399Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:46:43.399Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:46:43.400Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:46:43.400Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:46:43.401Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:46:43.401Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:46:43.401Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:46:43.637Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:46:43.637Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:46:43.638Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:46:43.638Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:46:43.853Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:46:43.854Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:46:43.854Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:46:43.855Z] [LOG]       Current Time: 11:16:43
[2025-10-23T05:46:43.855Z] [LOG]       Expected Hours (scheduled → now): 2.78h
[2025-10-23T05:46:43.856Z] [LOG]       Actual Hours (check-in → now): 2.78h
[2025-10-23T05:46:43.856Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:46:43.856Z] [LOG]       Weekday: 121.78h
[2025-10-23T05:46:43.857Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:46:43.857Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:43.857Z] [LOG]       Total Expected: 135.28h
[2025-10-23T05:46:43.858Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:46:43.858Z] [LOG]       Weekday: 28.28h (includes 2.78h live)
[2025-10-23T05:46:43.858Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:46:43.859Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:43.859Z] [LOG]       Total Actual: 32.78h
[2025-10-23T05:46:43.859Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:46:43.859Z] [LOG]       Weekday: 121.78h × Rs.235.29 = Rs.28653.35
[2025-10-23T05:46:43.860Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:46:43.860Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:43.860Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:43.861Z] [LOG]       Total Expected Earned: Rs.34653.29
[2025-10-23T05:46:43.861Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:46:43.861Z] [LOG]       Weekday: 28.28h × Rs.235.29 = Rs.6653.73
[2025-10-23T05:46:43.862Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:46:43.862Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:43.863Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:43.863Z] [LOG]       Total Actual Earned: Rs.8653.71
[2025-10-23T05:46:43.864Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:46:43.864Z] [LOG]       Calculated At: Oct 23, 2025, 11:16:43
[2025-10-23T05:46:43.865Z] [LOG]       Expected Earned (until NOW): Rs.34653.29
[2025-10-23T05:46:43.865Z] [LOG]       Actual Earned (until NOW): Rs.8653.71
[2025-10-23T05:46:43.865Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:43.866Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:46:43.866Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:46:43.866Z] [LOG]       📉 Shortfall: 102.50 hours (75.03% of expected)
[2025-10-23T05:46:43.867Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:46:43.867Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:46:43.868Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:46:43.868Z] [LOG]    Actual Earned Base: Rs.8653.71
[2025-10-23T05:46:43.868Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:46:43.869Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:46:43.869Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:46:43.870Z] [LOG]    Gross Salary: 8653.710158991667
[2025-10-23T05:46:43.870Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:46:43.870Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:46:43.871Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.871Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:46:43.871Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.871Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:46:43.872Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.872Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:46:43.872Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.873Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:46:43.873Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.873Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:46:43.874Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.874Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:46:43.875Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.875Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:46:43.875Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.875Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:46:43.876Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.876Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:46:43.876Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.877Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:46:43.877Z] [LOG]    EPF/ETF calculated on: Rs.8653.71
[2025-10-23T05:46:43.877Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:46:43.878Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:46:43.878Z] [LOG] 💰 GROSS CALCULATION for Ashen Nirmal Wadugodapitiya null:
[2025-10-23T05:46:43.878Z] [LOG]    Base Salary: 50000
[2025-10-23T05:46:43.878Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:46:43.879Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:46:43.879Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.879Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:46:43.879Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:43.880Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:46:43.880Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:44.097Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:46:44.097Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:44.098Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:46:44.100Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:46:44.100Z] [LOG]    Actual Earned Base: Rs.8653.71
[2025-10-23T05:46:44.101Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:46:44.101Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:46:44.101Z] [LOG]    = Gross Salary: Rs.8653.71
[2025-10-23T05:46:44.102Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:46:44.102Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:46:44.103Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:46:44.104Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:44.104Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:46:44.104Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:46:44.105Z] [LOG]    Gross Salary: Rs.8653.71
[2025-10-23T05:46:44.105Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:46:44.105Z] [LOG]    = NET SALARY: Rs.8653.71
[2025-10-23T05:46:44.105Z] [LOG] 
💾 Database Update:
[2025-10-23T05:46:44.106Z] [LOG]    Total Earnings: Rs.8653.71 (Base: 8653.71 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:46:44.106Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:46:44.297Z] [LOG] 
📝 Components to save:
[2025-10-23T05:46:44.298Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:46:44.298Z] [LOG]    Deduction components: 1
[2025-10-23T05:46:44.299Z] [LOG] Creating components for record 37a717f6-fc24-4a86-9572-c78403d6c464: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:46:44.299Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8653.710158991667
}
[2025-10-23T05:46:44.492Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:46:44.683Z] [LOG] Created payroll_record_component: 8d8fc961-addb-464b-8781-69112cd7acc3 for Base Salary
[2025-10-23T05:46:44.684Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T05:46:44.895Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:46:45.088Z] [LOG] Created payroll_record_component: a3809545-007f-429a-b925-8349b4d5a5c3 for Attendance Shortfall (Info)
[2025-10-23T05:46:45.491Z] [LOG] ✅ Financial balances updated successfully for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:45.491Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:46:45.492Z] [LOG] 
======================================================================
[2025-10-23T05:46:45.492Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ashen Nirmal Wadugodapitiya null
[2025-10-23T05:46:45.492Z] [LOG] ======================================================================
[2025-10-23T05:46:45.492Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:46:45.493Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8653.71
[2025-10-23T05:46:45.493Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:46:45.493Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:45.493Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:45.494Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:46:45.494Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:45.494Z] [LOG]    GROSS SALARY: Rs.8653.71
[2025-10-23T05:46:45.495Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:45.495Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:46:45.496Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:46:45.496Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:46:45.496Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:46:45.497Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:46:45.497Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:45.497Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:45.498Z] [LOG]    NET SALARY: Rs.8653.71
[2025-10-23T05:46:45.498Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:46:45.498Z] [LOG] ======================================================================

[2025-10-23T05:46:45.498Z] [LOG] ✅ Ashen Nirmal Wadugodapitiya null: Calculation completed successfully
[2025-10-23T05:46:45.499Z] [LOG] 📊 Progress: 7/34 (20.6%)
[2025-10-23T05:46:45.499Z] [LOG] 
🧮 Processing: Anoj null (EMP000014)
[2025-10-23T05:46:45.499Z] [LOG] 📋 Record ID: 384872d5-f9d5-4107-8c3c-5aa9a9bf1bbe
[2025-10-23T05:46:45.499Z] [LOG] 
======================================================================
[2025-10-23T05:46:45.500Z] [LOG] 🧮 CALCULATING PAYROLL: Anoj null (EMP000014)
[2025-10-23T05:46:45.500Z] [LOG] ======================================================================
[2025-10-23T05:46:46.386Z] [LOG] 🔍 Component filtering for employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-23T05:46:46.386Z] [LOG]    Total components: 13
[2025-10-23T05:46:46.387Z] [LOG]    Applicable components: 13
[2025-10-23T05:46:46.387Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:46:47.808Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:46:47.809Z] [LOG] 🔄 Processing financial records for employee 0143afc6-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:46:48.055Z] [LOG] 📊 Found 0 active loans for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:48.302Z] [LOG] 📊 Found 0 active advances for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:48.525Z] [LOG] 📊 Found 0 approved bonuses for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:48.526Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:46:48.526Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:46:48.719Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:46:48.719Z] [LOG]    Employee ID: 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:48.719Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:46:48.719Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:46:48.720Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:46:48.937Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:46:48.938Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:46:48.938Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:46:48.938Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:46:48.939Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:46:48.939Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:46:48.939Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:46:49.567Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:46:49.568Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:46:49.804Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:46:49.804Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:46:49.805Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:46:49.805Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:46:49.805Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:46:49.805Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:46:49.805Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:46:49.806Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:46:50.044Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:46:50.045Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:46:50.045Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:46:50.045Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:46:50.302Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:46:50.303Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:46:50.303Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:46:50.304Z] [LOG]       Current Time: 11:16:50
[2025-10-23T05:46:50.305Z] [LOG]       Expected Hours (scheduled → now): 2.78h
[2025-10-23T05:46:50.305Z] [LOG]       Actual Hours (check-in → now): 2.78h
[2025-10-23T05:46:50.305Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:46:50.305Z] [LOG]       Weekday: 121.78h
[2025-10-23T05:46:50.306Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:46:50.306Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:50.306Z] [LOG]       Total Expected: 135.28h
[2025-10-23T05:46:50.307Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:46:50.307Z] [LOG]       Weekday: 28.28h (includes 2.78h live)
[2025-10-23T05:46:50.307Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:46:50.308Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:50.308Z] [LOG]       Total Actual: 32.78h
[2025-10-23T05:46:50.308Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:46:50.308Z] [LOG]       Weekday: 121.78h × Rs.235.29 = Rs.28653.77
[2025-10-23T05:46:50.309Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:46:50.309Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:50.309Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:50.310Z] [LOG]       Total Expected Earned: Rs.34653.71
[2025-10-23T05:46:50.310Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:46:50.310Z] [LOG]       Weekday: 28.28h × Rs.235.29 = Rs.6654.15
[2025-10-23T05:46:50.310Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:46:50.310Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:50.310Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:50.311Z] [LOG]       Total Actual Earned: Rs.8654.13
[2025-10-23T05:46:50.311Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:46:50.312Z] [LOG]       Calculated At: Oct 23, 2025, 11:16:50
[2025-10-23T05:46:50.313Z] [LOG]       Expected Earned (until NOW): Rs.34653.71
[2025-10-23T05:46:50.313Z] [LOG]       Actual Earned (until NOW): Rs.8654.13
[2025-10-23T05:46:50.313Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:50.314Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:46:50.315Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:46:50.315Z] [LOG]       📉 Shortfall: 102.50 hours (75.03% of expected)
[2025-10-23T05:46:50.315Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:46:50.315Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:46:50.316Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:46:50.316Z] [LOG]    Actual Earned Base: Rs.8654.13
[2025-10-23T05:46:50.317Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:46:50.317Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:46:50.318Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:46:50.318Z] [LOG]    Gross Salary: 8654.131654883333
[2025-10-23T05:46:50.318Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:46:50.318Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:46:50.319Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.319Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:46:50.319Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.319Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:46:50.319Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.320Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:46:50.320Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.320Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:46:50.321Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.321Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:46:50.321Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.322Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:46:50.322Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.322Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:46:50.322Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.323Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:46:50.323Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.323Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:46:50.323Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.324Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:46:50.324Z] [LOG]    EPF/ETF calculated on: Rs.8654.13
[2025-10-23T05:46:50.324Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:46:50.324Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:46:50.324Z] [LOG] 💰 GROSS CALCULATION for Anoj null:
[2025-10-23T05:46:50.325Z] [LOG]    Base Salary: 50000
[2025-10-23T05:46:50.325Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:46:50.325Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:46:50.325Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.325Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:46:50.325Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.325Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:46:50.326Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:50.524Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:46:50.524Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:50.524Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:46:50.525Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:46:50.525Z] [LOG]    Actual Earned Base: Rs.8654.13
[2025-10-23T05:46:50.525Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:46:50.525Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:46:50.525Z] [LOG]    = Gross Salary: Rs.8654.13
[2025-10-23T05:46:50.526Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:46:50.526Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:46:50.527Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:46:50.527Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:50.527Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:46:50.527Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:46:50.527Z] [LOG]    Gross Salary: Rs.8654.13
[2025-10-23T05:46:50.527Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:46:50.528Z] [LOG]    = NET SALARY: Rs.8654.13
[2025-10-23T05:46:50.528Z] [LOG] 
💾 Database Update:
[2025-10-23T05:46:50.528Z] [LOG]    Total Earnings: Rs.8654.13 (Base: 8654.13 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:46:50.528Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:46:50.765Z] [LOG] 
📝 Components to save:
[2025-10-23T05:46:50.765Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:46:50.766Z] [LOG]    Deduction components: 1
[2025-10-23T05:46:50.766Z] [LOG] Creating components for record 384872d5-f9d5-4107-8c3c-5aa9a9bf1bbe: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:46:50.766Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8654.131654883333
}
[2025-10-23T05:46:51.010Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:46:51.224Z] [LOG] Created payroll_record_component: 8a8582ff-17d8-4cc0-b02d-9a9f431f9b7c for Base Salary
[2025-10-23T05:46:51.224Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:46:51.420Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:46:51.647Z] [LOG] Created payroll_record_component: 372c1a94-1125-465a-8b14-ae9ed28e9aeb for Attendance Shortfall (Info)
[2025-10-23T05:46:52.130Z] [LOG] ✅ Financial balances updated successfully for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:52.130Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:46:52.130Z] [LOG] 
======================================================================
[2025-10-23T05:46:52.131Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Anoj null
[2025-10-23T05:46:52.131Z] [LOG] ======================================================================
[2025-10-23T05:46:52.131Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:46:52.131Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8654.13
[2025-10-23T05:46:52.131Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:46:52.131Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:52.131Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:52.131Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:46:52.131Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:52.131Z] [LOG]    GROSS SALARY: Rs.8654.13
[2025-10-23T05:46:52.132Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:52.132Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:46:52.132Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:46:52.132Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:46:52.132Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:46:52.132Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:46:52.132Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:52.132Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:52.132Z] [LOG]    NET SALARY: Rs.8654.13
[2025-10-23T05:46:52.132Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:46:52.133Z] [LOG] ======================================================================

[2025-10-23T05:46:52.133Z] [LOG] ✅ Anoj null: Calculation completed successfully
[2025-10-23T05:46:52.133Z] [LOG] 📊 Progress: 8/34 (23.5%)
[2025-10-23T05:46:52.133Z] [LOG] 
🧮 Processing: Piyumi null (EMP000025)
[2025-10-23T05:46:52.133Z] [LOG] 📋 Record ID: 4b055e49-0116-4d44-9334-8fc590a2b10d
[2025-10-23T05:46:52.133Z] [LOG] 
======================================================================
[2025-10-23T05:46:52.133Z] [LOG] 🧮 CALCULATING PAYROLL: Piyumi null (EMP000025)
[2025-10-23T05:46:52.134Z] [LOG] ======================================================================
[2025-10-23T05:46:53.097Z] [LOG] 🔍 Component filtering for employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-23T05:46:53.098Z] [LOG]    Total components: 13
[2025-10-23T05:46:53.098Z] [LOG]    Applicable components: 13
[2025-10-23T05:46:53.098Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:46:54.454Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:46:54.454Z] [LOG] 🔄 Processing financial records for employee 0143e565-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:46:54.686Z] [LOG] 📊 Found 0 active loans for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:54.932Z] [LOG] 📊 Found 0 active advances for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:55.175Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:55.175Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:46:55.175Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:46:55.406Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:46:55.406Z] [LOG]    Employee ID: 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:55.407Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:46:55.407Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:46:55.407Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:46:55.654Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:46:55.655Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:46:55.655Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:46:55.655Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:46:55.656Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:46:55.656Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:46:55.656Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:46:56.365Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:46:56.365Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:46:56.564Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:46:56.564Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:46:56.564Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:46:56.564Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:46:56.564Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:46:56.565Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:46:56.565Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:46:56.565Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:46:56.765Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:46:56.766Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:46:56.766Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:46:56.766Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:46:56.957Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:46:56.958Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:46:56.958Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:46:56.959Z] [LOG]       Current Time: 11:16:56
[2025-10-23T05:46:56.959Z] [LOG]       Expected Hours (scheduled → now): 2.78h
[2025-10-23T05:46:56.960Z] [LOG]       Actual Hours (check-in → now): 2.78h
[2025-10-23T05:46:56.960Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:46:56.960Z] [LOG]       Weekday: 121.78h
[2025-10-23T05:46:56.961Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:46:56.961Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:56.961Z] [LOG]       Total Expected: 135.28h
[2025-10-23T05:46:56.962Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:46:56.962Z] [LOG]       Weekday: 28.28h (includes 2.78h live)
[2025-10-23T05:46:56.962Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:46:56.962Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:46:56.963Z] [LOG]       Total Actual: 32.78h
[2025-10-23T05:46:56.963Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:46:56.964Z] [LOG]       Weekday: 121.78h × Rs.235.29 = Rs.28654.20
[2025-10-23T05:46:56.964Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:46:56.964Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:56.965Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:56.965Z] [LOG]       Total Expected Earned: Rs.34654.14
[2025-10-23T05:46:56.965Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:46:56.965Z] [LOG]       Weekday: 28.28h × Rs.235.29 = Rs.6654.59
[2025-10-23T05:46:56.965Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:46:56.966Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:46:56.966Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:56.966Z] [LOG]       Total Actual Earned: Rs.8654.57
[2025-10-23T05:46:56.967Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:46:56.967Z] [LOG]       Calculated At: Oct 23, 2025, 11:16:56
[2025-10-23T05:46:56.968Z] [LOG]       Expected Earned (until NOW): Rs.34654.14
[2025-10-23T05:46:56.968Z] [LOG]       Actual Earned (until NOW): Rs.8654.57
[2025-10-23T05:46:56.968Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:46:56.968Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:46:56.968Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:46:56.969Z] [LOG]       📉 Shortfall: 102.50 hours (75.03% of expected)
[2025-10-23T05:46:56.969Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:46:56.969Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:46:56.971Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:46:56.972Z] [LOG]    Actual Earned Base: Rs.8654.57
[2025-10-23T05:46:56.972Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:46:56.972Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:46:56.973Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:46:56.973Z] [LOG]    Gross Salary: 8654.566614591666
[2025-10-23T05:46:56.973Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:46:56.973Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:46:56.973Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.973Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:46:56.974Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.974Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:46:56.974Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.975Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:46:56.975Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.975Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:46:56.975Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.975Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:46:56.976Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.976Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:46:56.976Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.977Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:46:56.977Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.977Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:46:56.977Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.978Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:46:56.978Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.978Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:46:56.978Z] [LOG]    EPF/ETF calculated on: Rs.8654.57
[2025-10-23T05:46:56.979Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:46:56.980Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:46:56.980Z] [LOG] 💰 GROSS CALCULATION for Piyumi null:
[2025-10-23T05:46:56.981Z] [LOG]    Base Salary: 50000
[2025-10-23T05:46:56.981Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:46:56.981Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:46:56.981Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.981Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:46:56.981Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:56.982Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:46:56.982Z] [LOG]    Fixed amount: 0
[2025-10-23T05:46:57.253Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:46:57.254Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:57.254Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:46:57.254Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:46:57.255Z] [LOG]    Actual Earned Base: Rs.8654.57
[2025-10-23T05:46:57.255Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:46:57.255Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:46:57.255Z] [LOG]    = Gross Salary: Rs.8654.57
[2025-10-23T05:46:57.256Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:46:57.256Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:46:57.256Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:46:57.256Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:57.257Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:46:57.257Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:46:57.257Z] [LOG]    Gross Salary: Rs.8654.57
[2025-10-23T05:46:57.258Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:46:57.258Z] [LOG]    = NET SALARY: Rs.8654.57
[2025-10-23T05:46:57.258Z] [LOG] 
💾 Database Update:
[2025-10-23T05:46:57.258Z] [LOG]    Total Earnings: Rs.8654.57 (Base: 8654.57 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:46:57.259Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:46:57.493Z] [LOG] 
📝 Components to save:
[2025-10-23T05:46:57.493Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:46:57.494Z] [LOG]    Deduction components: 1
[2025-10-23T05:46:57.494Z] [LOG] Creating components for record 4b055e49-0116-4d44-9334-8fc590a2b10d: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:46:57.494Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8654.566614591666
}
[2025-10-23T05:46:57.724Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:46:57.969Z] [LOG] Created payroll_record_component: 29992ed9-ee16-46ee-969f-5b125d2ea7c2 for Base Salary
[2025-10-23T05:46:57.970Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T05:46:58.211Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:46:58.454Z] [LOG] Created payroll_record_component: a0f2e59f-fbdb-41f5-a3ee-c50837aabc27 for Attendance Shortfall (Info)
[2025-10-23T05:46:58.926Z] [LOG] ✅ Financial balances updated successfully for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T05:46:58.926Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:46:58.927Z] [LOG] 
======================================================================
[2025-10-23T05:46:58.927Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Piyumi null
[2025-10-23T05:46:58.927Z] [LOG] ======================================================================
[2025-10-23T05:46:58.928Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:46:58.928Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8654.57
[2025-10-23T05:46:58.928Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:46:58.929Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:58.929Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:46:58.930Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:46:58.930Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:58.930Z] [LOG]    GROSS SALARY: Rs.8654.57
[2025-10-23T05:46:58.930Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:58.931Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:46:58.931Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:46:58.931Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:46:58.931Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:46:58.931Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:46:58.931Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:46:58.931Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:46:58.932Z] [LOG]    NET SALARY: Rs.8654.57
[2025-10-23T05:46:58.932Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:46:58.932Z] [LOG] ======================================================================

[2025-10-23T05:46:58.932Z] [LOG] ✅ Piyumi null: Calculation completed successfully
[2025-10-23T05:46:58.932Z] [LOG] 📊 Progress: 9/34 (26.5%)
[2025-10-23T05:46:58.933Z] [LOG] 
🧮 Processing: Kaushal Thambi (EMP465256103)
[2025-10-23T05:46:58.933Z] [LOG] 📋 Record ID: 536c1663-c600-4022-9da8-ee4f33cf96fc
[2025-10-23T05:46:58.933Z] [LOG] 
======================================================================
[2025-10-23T05:46:58.933Z] [LOG] 🧮 CALCULATING PAYROLL: Kaushal Thambi (EMP465256103)
[2025-10-23T05:46:58.934Z] [LOG] ======================================================================
[2025-10-23T05:46:59.826Z] [LOG] 🔍 Component filtering for employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-23T05:46:59.826Z] [LOG]    Total components: 13
[2025-10-23T05:46:59.827Z] [LOG]    Applicable components: 13
[2025-10-23T05:46:59.827Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T05:47:01.088Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:47:01.088Z] [LOG] 🔄 Processing financial records for employee 9e8125c4-ce58-411a-b617-9f75d481c613 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:47:01.280Z] [LOG] 📊 Found 0 active loans for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T05:47:01.495Z] [LOG] 📊 Found 0 active advances for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T05:47:01.728Z] [LOG] 📊 Found 0 approved bonuses for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T05:47:01.728Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:47:01.729Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:47:01.964Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:47:01.965Z] [LOG]    Employee ID: 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T05:47:01.965Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:47:01.965Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:47:01.966Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:47:02.212Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:47:02.212Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:47:02.212Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:47:02.213Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:47:02.213Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:47:02.213Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:47:02.214Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:47:02.925Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:47:02.926Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:47:03.164Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:47:03.165Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:47:03.165Z] [LOG]       Total completed sessions found: 2
[2025-10-23T05:47:03.165Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:47:03.165Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:47:03.166Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:47:03.411Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:47:03.412Z] [LOG]          Weekday: 8.50h
[2025-10-23T05:47:03.412Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:47:03.413Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:47:03.663Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:47:03.664Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:47:03.664Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:47:03.664Z] [LOG]       Current Time: 11:17:03
[2025-10-23T05:47:03.665Z] [LOG]       Expected Hours (scheduled → now): 2.78h
[2025-10-23T05:47:03.665Z] [LOG]       Actual Hours (check-in → now): 2.78h
[2025-10-23T05:47:03.665Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:47:03.665Z] [LOG]       Weekday: 121.78h
[2025-10-23T05:47:03.666Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:47:03.666Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:03.666Z] [LOG]       Total Expected: 135.28h
[2025-10-23T05:47:03.667Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:47:03.667Z] [LOG]       Weekday: 11.28h (includes 2.78h live)
[2025-10-23T05:47:03.667Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:47:03.667Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:03.668Z] [LOG]       Total Actual: 15.78h
[2025-10-23T05:47:03.668Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:47:03.668Z] [LOG]       Weekday: 121.78h × Rs.235.29 = Rs.28654.64
[2025-10-23T05:47:03.668Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:47:03.669Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:03.669Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:03.669Z] [LOG]       Total Expected Earned: Rs.34654.58
[2025-10-23T05:47:03.670Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:47:03.670Z] [LOG]       Weekday: 11.28h × Rs.235.29 = Rs.2655.09
[2025-10-23T05:47:03.670Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:47:03.670Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:03.671Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:03.671Z] [LOG]       Total Actual Earned: Rs.4655.07
[2025-10-23T05:47:03.672Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:47:03.672Z] [LOG]       Calculated At: Oct 23, 2025, 11:17:03
[2025-10-23T05:47:03.672Z] [LOG]       Expected Earned (until NOW): Rs.34654.58
[2025-10-23T05:47:03.673Z] [LOG]       Actual Earned (until NOW): Rs.4655.07
[2025-10-23T05:47:03.673Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:03.673Z] [LOG]       Attendance Deduction: Rs.29999.50
[2025-10-23T05:47:03.674Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:47:03.674Z] [LOG]       📉 Shortfall: 119.50 hours (86.57% of expected)
[2025-10-23T05:47:03.674Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:47:03.674Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:47:03.675Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:47:03.675Z] [LOG]    Actual Earned Base: Rs.4655.07
[2025-10-23T05:47:03.676Z] [LOG]    Attendance Shortfall: Rs.29999.50
[2025-10-23T05:47:03.676Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:47:03.677Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:47:03.677Z] [LOG]    Gross Salary: 4655.074907575
[2025-10-23T05:47:03.677Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:47:03.677Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:47:03.678Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.679Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:47:03.680Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.680Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:47:03.681Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.681Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:47:03.681Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.681Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:47:03.681Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.681Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:47:03.682Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.682Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:47:03.682Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.682Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:47:03.682Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.683Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:47:03.683Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.683Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:47:03.683Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.684Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:47:03.685Z] [LOG]    EPF/ETF calculated on: Rs.4655.07
[2025-10-23T05:47:03.685Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:47:03.686Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:47:03.686Z] [LOG] 💰 GROSS CALCULATION for Kaushal Thambi:
[2025-10-23T05:47:03.687Z] [LOG]    Base Salary: 50000
[2025-10-23T05:47:03.687Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:47:03.687Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:47:03.688Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.688Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:47:03.688Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:03.688Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:47:03.689Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:04.090Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:47:04.091Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:04.091Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:47:04.091Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:47:04.092Z] [LOG]    Actual Earned Base: Rs.4655.07
[2025-10-23T05:47:04.092Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:47:04.092Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:47:04.092Z] [LOG]    = Gross Salary: Rs.4655.07
[2025-10-23T05:47:04.093Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:47:04.093Z] [LOG]    Attendance Shortfall (Info): Rs.29999.50
[2025-10-23T05:47:04.093Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:47:04.094Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:04.094Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:47:04.094Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:47:04.094Z] [LOG]    Gross Salary: Rs.4655.07
[2025-10-23T05:47:04.095Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:47:04.095Z] [LOG]    = NET SALARY: Rs.4655.07
[2025-10-23T05:47:04.095Z] [LOG] 
💾 Database Update:
[2025-10-23T05:47:04.096Z] [LOG]    Total Earnings: Rs.4655.07 (Base: 4655.07 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:47:04.096Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:47:04.291Z] [LOG] 
📝 Components to save:
[2025-10-23T05:47:04.292Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:47:04.292Z] [LOG]    Deduction components: 1
[2025-10-23T05:47:04.292Z] [LOG] Creating components for record 536c1663-c600-4022-9da8-ee4f33cf96fc: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:47:04.293Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 4655.074907575
}
[2025-10-23T05:47:04.536Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:47:04.765Z] [LOG] Created payroll_record_component: 4af406cc-1a7a-45d3-a8c0-c327632d16e8 for Base Salary
[2025-10-23T05:47:04.766Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 29999.504999999997
}
[2025-10-23T05:47:05.004Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:47:05.244Z] [LOG] Created payroll_record_component: efba3001-f8b1-40db-b5ad-23075e2e50d9 for Attendance Shortfall (Info)
[2025-10-23T05:47:05.728Z] [LOG] ✅ Financial balances updated successfully for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T05:47:05.729Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:47:05.730Z] [LOG] 
======================================================================
[2025-10-23T05:47:05.730Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Kaushal Thambi
[2025-10-23T05:47:05.730Z] [LOG] ======================================================================
[2025-10-23T05:47:05.730Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:47:05.731Z] [LOG]    Actual Earned Base (Attendance-based): Rs.4655.07
[2025-10-23T05:47:05.731Z] [LOG]    Attendance Shortfall: Rs.29999.50
[2025-10-23T05:47:05.731Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:05.731Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:05.731Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:47:05.732Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:05.732Z] [LOG]    GROSS SALARY: Rs.4655.07
[2025-10-23T05:47:05.732Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:05.732Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:47:05.732Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:47:05.733Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:47:05.733Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:47:05.733Z] [LOG]       - Attendance Shortfall (Info): Rs.29999.50
[2025-10-23T05:47:05.734Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:05.734Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:05.734Z] [LOG]    NET SALARY: Rs.4655.07
[2025-10-23T05:47:05.734Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:47:05.734Z] [LOG] ======================================================================

[2025-10-23T05:47:05.735Z] [LOG] ✅ Kaushal Thambi: Calculation completed successfully
[2025-10-23T05:47:05.735Z] [LOG] 📊 Progress: 10/34 (29.4%)
[2025-10-23T05:47:05.735Z] [LOG] 
🧮 Processing: R. D.A Kaushalya null (EMP000044)
[2025-10-23T05:47:05.736Z] [LOG] 📋 Record ID: 57546b69-609b-480a-90c6-f7fc0ba80363
[2025-10-23T05:47:05.736Z] [LOG] 
======================================================================
[2025-10-23T05:47:05.736Z] [LOG] 🧮 CALCULATING PAYROLL: R. D.A Kaushalya null (EMP000044)
[2025-10-23T05:47:05.736Z] [LOG] ======================================================================
[2025-10-23T05:47:06.847Z] [LOG] 🔍 Component filtering for employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-23T05:47:06.847Z] [LOG]    Total components: 13
[2025-10-23T05:47:06.848Z] [LOG]    Applicable components: 13
[2025-10-23T05:47:06.848Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:47:08.285Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:47:08.286Z] [LOG] 🔄 Processing financial records for employee 01443963-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:47:08.537Z] [LOG] 📊 Found 0 active loans for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:08.780Z] [LOG] 📊 Found 0 active advances for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:08.997Z] [LOG] 📊 Found 0 approved bonuses for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:08.997Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:47:08.998Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:47:09.246Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:47:09.247Z] [LOG]    Employee ID: 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:09.247Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:47:09.247Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:47:09.247Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:47:09.498Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:47:09.499Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:47:09.499Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:47:09.499Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:47:09.500Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:47:09.500Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:47:09.500Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:47:10.181Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:47:10.182Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:47:10.397Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:47:10.397Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:47:10.398Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:47:10.398Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:47:10.398Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:47:10.398Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:47:10.398Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:47:10.398Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:47:10.640Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:47:10.640Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:47:10.641Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:47:10.641Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:47:10.835Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:47:10.835Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:47:10.835Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:47:10.836Z] [LOG]       Current Time: 11:17:10
[2025-10-23T05:47:10.836Z] [LOG]       Expected Hours (scheduled → now): 2.79h
[2025-10-23T05:47:10.836Z] [LOG]       Actual Hours (check-in → now): 2.79h
[2025-10-23T05:47:10.836Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:47:10.837Z] [LOG]       Weekday: 121.79h
[2025-10-23T05:47:10.837Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:47:10.837Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:10.837Z] [LOG]       Total Expected: 135.29h
[2025-10-23T05:47:10.838Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:47:10.838Z] [LOG]       Weekday: 28.29h (includes 2.79h live)
[2025-10-23T05:47:10.838Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:47:10.838Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:10.838Z] [LOG]       Total Actual: 32.79h
[2025-10-23T05:47:10.839Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:47:10.839Z] [LOG]       Weekday: 121.79h × Rs.235.29 = Rs.28655.11
[2025-10-23T05:47:10.839Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:47:10.839Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:10.840Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:10.840Z] [LOG]       Total Expected Earned: Rs.34655.05
[2025-10-23T05:47:10.840Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:47:10.840Z] [LOG]       Weekday: 28.29h × Rs.235.29 = Rs.6655.49
[2025-10-23T05:47:10.841Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:47:10.841Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:10.841Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:10.841Z] [LOG]       Total Actual Earned: Rs.8655.47
[2025-10-23T05:47:10.842Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:47:10.842Z] [LOG]       Calculated At: Oct 23, 2025, 11:17:10
[2025-10-23T05:47:10.842Z] [LOG]       Expected Earned (until NOW): Rs.34655.05
[2025-10-23T05:47:10.843Z] [LOG]       Actual Earned (until NOW): Rs.8655.47
[2025-10-23T05:47:10.843Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:10.843Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:47:10.843Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:47:10.843Z] [LOG]       📉 Shortfall: 102.50 hours (75.02% of expected)
[2025-10-23T05:47:10.844Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:47:10.844Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:47:10.844Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:47:10.844Z] [LOG]    Actual Earned Base: Rs.8655.47
[2025-10-23T05:47:10.845Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:47:10.845Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:47:10.845Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:47:10.846Z] [LOG]    Gross Salary: 8655.473657541666
[2025-10-23T05:47:10.846Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:47:10.847Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:47:10.847Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.847Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:47:10.848Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.848Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:47:10.848Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.848Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:47:10.848Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.848Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:47:10.849Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.849Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:47:10.849Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.849Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:47:10.849Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.849Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:47:10.850Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.850Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:47:10.851Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.851Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:47:10.851Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.851Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:47:10.851Z] [LOG]    EPF/ETF calculated on: Rs.8655.47
[2025-10-23T05:47:10.851Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:47:10.852Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:47:10.852Z] [LOG] 💰 GROSS CALCULATION for R. D.A Kaushalya null:
[2025-10-23T05:47:10.852Z] [LOG]    Base Salary: 50000
[2025-10-23T05:47:10.852Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:47:10.852Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:47:10.853Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.853Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:47:10.853Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:10.853Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:47:10.854Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:11.057Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:47:11.058Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:11.058Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:47:11.058Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:47:11.058Z] [LOG]    Actual Earned Base: Rs.8655.47
[2025-10-23T05:47:11.059Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:47:11.059Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:47:11.059Z] [LOG]    = Gross Salary: Rs.8655.47
[2025-10-23T05:47:11.059Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:47:11.060Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:47:11.060Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:47:11.060Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:11.060Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:47:11.060Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:47:11.061Z] [LOG]    Gross Salary: Rs.8655.47
[2025-10-23T05:47:11.061Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:47:11.061Z] [LOG]    = NET SALARY: Rs.8655.47
[2025-10-23T05:47:11.061Z] [LOG] 
💾 Database Update:
[2025-10-23T05:47:11.061Z] [LOG]    Total Earnings: Rs.8655.47 (Base: 8655.47 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:47:11.062Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:47:11.283Z] [LOG] 
📝 Components to save:
[2025-10-23T05:47:11.284Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:47:11.284Z] [LOG]    Deduction components: 1
[2025-10-23T05:47:11.285Z] [LOG] Creating components for record 57546b69-609b-480a-90c6-f7fc0ba80363: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:47:11.285Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8655.473657541666
}
[2025-10-23T05:47:11.486Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:47:11.735Z] [LOG] Created payroll_record_component: d7045c53-6e2a-4266-b105-e94ee258d011 for Base Salary
[2025-10-23T05:47:11.735Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:47:11.940Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:47:12.132Z] [LOG] Created payroll_record_component: a870f136-5774-4316-9764-1e342d682b2c for Attendance Shortfall (Info)
[2025-10-23T05:47:12.606Z] [LOG] ✅ Financial balances updated successfully for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:12.607Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:47:12.607Z] [LOG] 
======================================================================
[2025-10-23T05:47:12.607Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: R. D.A Kaushalya null
[2025-10-23T05:47:12.607Z] [LOG] ======================================================================
[2025-10-23T05:47:12.608Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:47:12.608Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8655.47
[2025-10-23T05:47:12.608Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:47:12.608Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:12.608Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:12.608Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:47:12.609Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:12.609Z] [LOG]    GROSS SALARY: Rs.8655.47
[2025-10-23T05:47:12.609Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:12.609Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:47:12.609Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:47:12.609Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:47:12.610Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:47:12.610Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:47:12.610Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:12.610Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:12.610Z] [LOG]    NET SALARY: Rs.8655.47
[2025-10-23T05:47:12.610Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:47:12.611Z] [LOG] ======================================================================

[2025-10-23T05:47:12.611Z] [LOG] ✅ R. D.A Kaushalya null: Calculation completed successfully
[2025-10-23T05:47:12.611Z] [LOG] 📊 Progress: 11/34 (32.4%)
[2025-10-23T05:47:12.611Z] [LOG] 
🧮 Processing: Hari null (EMP000017)
[2025-10-23T05:47:12.612Z] [LOG] 📋 Record ID: 5cf2136a-685e-4ae2-8f72-a0636cd5cfbb
[2025-10-23T05:47:12.612Z] [LOG] 
======================================================================
[2025-10-23T05:47:12.612Z] [LOG] 🧮 CALCULATING PAYROLL: Hari null (EMP000017)
[2025-10-23T05:47:12.612Z] [LOG] ======================================================================
[2025-10-23T05:47:13.566Z] [LOG] 🔍 Component filtering for employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-23T05:47:13.566Z] [LOG]    Total components: 13
[2025-10-23T05:47:13.566Z] [LOG]    Applicable components: 13
[2025-10-23T05:47:13.567Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:47:14.932Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:47:14.932Z] [LOG] 🔄 Processing financial records for employee 0143bc58-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:47:15.138Z] [LOG] 📊 Found 0 active loans for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:15.438Z] [LOG] 📊 Found 0 active advances for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:15.639Z] [LOG] 📊 Found 0 approved bonuses for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:15.640Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:47:15.640Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:47:15.837Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:47:15.838Z] [LOG]    Employee ID: 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:15.838Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:47:15.838Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:47:15.839Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:47:16.032Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:47:16.032Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:47:16.032Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:47:16.032Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:47:16.033Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:47:16.033Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:47:16.033Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:47:16.938Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:47:16.939Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:47:17.181Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:47:17.181Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:47:17.181Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:47:17.182Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:47:17.182Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:47:17.182Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:47:17.183Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:47:17.183Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:47:17.405Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:47:17.405Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:47:17.405Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:47:17.405Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:47:17.646Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:47:17.647Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:47:17.647Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:47:17.648Z] [LOG]       Current Time: 11:17:17
[2025-10-23T05:47:17.649Z] [LOG]       Expected Hours (scheduled → now): 2.79h
[2025-10-23T05:47:17.649Z] [LOG]       Actual Hours (check-in → now): 2.79h
[2025-10-23T05:47:17.649Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:47:17.649Z] [LOG]       Weekday: 121.79h
[2025-10-23T05:47:17.650Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:47:17.650Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:17.650Z] [LOG]       Total Expected: 135.29h
[2025-10-23T05:47:17.651Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:47:17.651Z] [LOG]       Weekday: 28.29h (includes 2.79h live)
[2025-10-23T05:47:17.651Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:47:17.652Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:17.652Z] [LOG]       Total Actual: 32.79h
[2025-10-23T05:47:17.652Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:47:17.652Z] [LOG]       Weekday: 121.79h × Rs.235.29 = Rs.28655.55
[2025-10-23T05:47:17.653Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:47:17.653Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:17.653Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:17.653Z] [LOG]       Total Expected Earned: Rs.34655.49
[2025-10-23T05:47:17.654Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:47:17.654Z] [LOG]       Weekday: 28.29h × Rs.235.29 = Rs.6655.94
[2025-10-23T05:47:17.654Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:47:17.655Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:17.655Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:17.655Z] [LOG]       Total Actual Earned: Rs.8655.92
[2025-10-23T05:47:17.656Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:47:17.656Z] [LOG]       Calculated At: Oct 23, 2025, 11:17:17
[2025-10-23T05:47:17.656Z] [LOG]       Expected Earned (until NOW): Rs.34655.49
[2025-10-23T05:47:17.657Z] [LOG]       Actual Earned (until NOW): Rs.8655.92
[2025-10-23T05:47:17.657Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:17.657Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:47:17.658Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:47:17.658Z] [LOG]       📉 Shortfall: 102.50 hours (75.02% of expected)
[2025-10-23T05:47:17.659Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:47:17.659Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:47:17.659Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:47:17.660Z] [LOG]    Actual Earned Base: Rs.8655.92
[2025-10-23T05:47:17.660Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:47:17.660Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:47:17.661Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:47:17.661Z] [LOG]    Gross Salary: 8655.91881315
[2025-10-23T05:47:17.662Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:47:17.662Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:47:17.662Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.663Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:47:17.664Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.664Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:47:17.664Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.664Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:47:17.665Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.665Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:47:17.665Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.666Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:47:17.666Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.666Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:47:17.667Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.667Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:47:17.667Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.668Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:47:17.668Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.668Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:47:17.669Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.670Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:47:17.670Z] [LOG]    EPF/ETF calculated on: Rs.8655.92
[2025-10-23T05:47:17.671Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:47:17.671Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:47:17.672Z] [LOG] 💰 GROSS CALCULATION for Hari null:
[2025-10-23T05:47:17.672Z] [LOG]    Base Salary: 50000
[2025-10-23T05:47:17.673Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:47:17.673Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:47:17.673Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.674Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:47:17.674Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.674Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:47:17.675Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:17.899Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:47:17.900Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:17.900Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:47:17.901Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:47:17.901Z] [LOG]    Actual Earned Base: Rs.8655.92
[2025-10-23T05:47:17.901Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:47:17.901Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:47:17.902Z] [LOG]    = Gross Salary: Rs.8655.92
[2025-10-23T05:47:17.902Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:47:17.903Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:47:17.903Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:47:17.903Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:17.904Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:47:17.904Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:47:17.904Z] [LOG]    Gross Salary: Rs.8655.92
[2025-10-23T05:47:17.905Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:47:17.905Z] [LOG]    = NET SALARY: Rs.8655.92
[2025-10-23T05:47:17.905Z] [LOG] 
💾 Database Update:
[2025-10-23T05:47:17.906Z] [LOG]    Total Earnings: Rs.8655.92 (Base: 8655.92 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:47:17.906Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:47:18.127Z] [LOG] 
📝 Components to save:
[2025-10-23T05:47:18.128Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:47:18.128Z] [LOG]    Deduction components: 1
[2025-10-23T05:47:18.128Z] [LOG] Creating components for record 5cf2136a-685e-4ae2-8f72-a0636cd5cfbb: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:47:18.129Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8655.91881315
}
[2025-10-23T05:47:18.367Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:47:18.605Z] [LOG] Created payroll_record_component: 144f5741-e0f0-4e1e-b343-cbba321d73ab for Base Salary
[2025-10-23T05:47:18.606Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T05:47:18.857Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:47:19.092Z] [LOG] Created payroll_record_component: 4854f29e-ee3b-4139-9b77-77840605b533 for Attendance Shortfall (Info)
[2025-10-23T05:47:19.569Z] [LOG] ✅ Financial balances updated successfully for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:19.570Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:47:19.570Z] [LOG] 
======================================================================
[2025-10-23T05:47:19.570Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Hari null
[2025-10-23T05:47:19.571Z] [LOG] ======================================================================
[2025-10-23T05:47:19.571Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:47:19.571Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8655.92
[2025-10-23T05:47:19.572Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:47:19.572Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:19.572Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:19.573Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:47:19.573Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:19.573Z] [LOG]    GROSS SALARY: Rs.8655.92
[2025-10-23T05:47:19.574Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:19.574Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:47:19.574Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:47:19.575Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:47:19.575Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:47:19.575Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:47:19.576Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:19.576Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:19.576Z] [LOG]    NET SALARY: Rs.8655.92
[2025-10-23T05:47:19.577Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:47:19.577Z] [LOG] ======================================================================

[2025-10-23T05:47:19.577Z] [LOG] ✅ Hari null: Calculation completed successfully
[2025-10-23T05:47:19.578Z] [LOG] 📊 Progress: 12/34 (35.3%)
[2025-10-23T05:47:19.578Z] [LOG] 
🧮 Processing: Maryam null (EMP000035)
[2025-10-23T05:47:19.583Z] [LOG] 📋 Record ID: 5e805dfb-7ff1-4f35-bda6-e9192e92f42c
[2025-10-23T05:47:19.585Z] [LOG] 
======================================================================
[2025-10-23T05:47:19.585Z] [LOG] 🧮 CALCULATING PAYROLL: Maryam null (EMP000035)
[2025-10-23T05:47:19.585Z] [LOG] ======================================================================
[2025-10-23T05:47:20.489Z] [LOG] 🔍 Component filtering for employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-23T05:47:20.490Z] [LOG]    Total components: 13
[2025-10-23T05:47:20.490Z] [LOG]    Applicable components: 13
[2025-10-23T05:47:20.491Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T05:47:21.809Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:47:21.809Z] [LOG] 🔄 Processing financial records for employee 01440221-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:47:22.046Z] [LOG] 📊 Found 0 active loans for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:22.298Z] [LOG] 📊 Found 0 active advances for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:22.537Z] [LOG] 📊 Found 0 approved bonuses for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:22.538Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:47:22.539Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:47:22.768Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:47:22.768Z] [LOG]    Employee ID: 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:22.769Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:47:22.769Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:47:22.769Z] [LOG]    Base Salary (Full Month): Rs.40000.00
[2025-10-23T05:47:23.010Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:47:23.010Z] [LOG]       Daily Salary: Rs.1600.00
[2025-10-23T05:47:23.011Z] [LOG]       Weekday Hourly Rate: Rs.188.24
[2025-10-23T05:47:23.011Z] [LOG]       Saturday Hourly Rate: Rs.355.56
[2025-10-23T05:47:23.011Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:47:23.011Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:47:23.012Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:47:23.686Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:47:23.687Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:47:23.894Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:47:23.894Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:47:23.895Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:47:23.895Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:47:23.895Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:47:23.896Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:47:23.896Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:47:23.896Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:47:24.141Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:47:24.141Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:47:24.142Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:47:24.142Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:47:24.378Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:47:24.379Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:47:24.379Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:47:24.380Z] [LOG]       Current Time: 11:17:24
[2025-10-23T05:47:24.380Z] [LOG]       Expected Hours (scheduled → now): 2.79h
[2025-10-23T05:47:24.381Z] [LOG]       Actual Hours (check-in → now): 2.79h
[2025-10-23T05:47:24.381Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:47:24.382Z] [LOG]       Weekday: 121.79h
[2025-10-23T05:47:24.382Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:47:24.382Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:24.382Z] [LOG]       Total Expected: 135.29h
[2025-10-23T05:47:24.383Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:47:24.383Z] [LOG]       Weekday: 28.29h (includes 2.79h live)
[2025-10-23T05:47:24.383Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:47:24.383Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:24.384Z] [LOG]       Total Actual: 32.79h
[2025-10-23T05:47:24.384Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:47:24.384Z] [LOG]       Weekday: 121.79h × Rs.188.24 = Rs.22925.77
[2025-10-23T05:47:24.385Z] [LOG]       Saturday: 13.50h × Rs.355.56 = Rs.4800.06
[2025-10-23T05:47:24.385Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:24.385Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:24.386Z] [LOG]       Total Expected Earned: Rs.27725.83
[2025-10-23T05:47:24.386Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:47:24.386Z] [LOG]       Weekday: 28.29h × Rs.188.24 = Rs.5325.33
[2025-10-23T05:47:24.387Z] [LOG]       Saturday: 4.50h × Rs.355.56 = Rs.1600.02
[2025-10-23T05:47:24.387Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:24.387Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:24.387Z] [LOG]       Total Actual Earned: Rs.6925.35
[2025-10-23T05:47:24.389Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:47:24.389Z] [LOG]       Calculated At: Oct 23, 2025, 11:17:24
[2025-10-23T05:47:24.389Z] [LOG]       Expected Earned (until NOW): Rs.27725.83
[2025-10-23T05:47:24.389Z] [LOG]       Actual Earned (until NOW): Rs.6925.35
[2025-10-23T05:47:24.390Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:24.390Z] [LOG]       Attendance Deduction: Rs.20800.48
[2025-10-23T05:47:24.390Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:47:24.391Z] [LOG]       📉 Shortfall: 102.50 hours (75.02% of expected)
[2025-10-23T05:47:24.391Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:47:24.391Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:47:24.392Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T05:47:24.392Z] [LOG]    Actual Earned Base: Rs.6925.35
[2025-10-23T05:47:24.392Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T05:47:24.393Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:47:24.393Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:47:24.394Z] [LOG]    Gross Salary: 6925.3493652
[2025-10-23T05:47:24.395Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:47:24.395Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:47:24.395Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.396Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:47:24.396Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.397Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:47:24.397Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.397Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:47:24.398Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.398Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:47:24.398Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.398Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:47:24.398Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.399Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:47:24.399Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.399Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:47:24.399Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.399Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:47:24.400Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.401Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:47:24.402Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.402Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:47:24.403Z] [LOG]    EPF/ETF calculated on: Rs.6925.35
[2025-10-23T05:47:24.403Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:47:24.403Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:47:24.404Z] [LOG] 💰 GROSS CALCULATION for Maryam null:
[2025-10-23T05:47:24.405Z] [LOG]    Base Salary: 40000
[2025-10-23T05:47:24.405Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:47:24.405Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:47:24.406Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.406Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:47:24.406Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.406Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:47:24.406Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:24.697Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:47:24.698Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:24.698Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:47:24.699Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:47:24.699Z] [LOG]    Actual Earned Base: Rs.6925.35
[2025-10-23T05:47:24.700Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:47:24.700Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:47:24.700Z] [LOG]    = Gross Salary: Rs.6925.35
[2025-10-23T05:47:24.701Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:47:24.701Z] [LOG]    Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T05:47:24.701Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:47:24.702Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:24.702Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:47:24.702Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:47:24.702Z] [LOG]    Gross Salary: Rs.6925.35
[2025-10-23T05:47:24.703Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:47:24.703Z] [LOG]    = NET SALARY: Rs.6925.35
[2025-10-23T05:47:24.704Z] [LOG] 
💾 Database Update:
[2025-10-23T05:47:24.704Z] [LOG]    Total Earnings: Rs.6925.35 (Base: 6925.35 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:47:24.705Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:47:24.935Z] [LOG] 
📝 Components to save:
[2025-10-23T05:47:24.935Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:47:24.936Z] [LOG]    Deduction components: 1
[2025-10-23T05:47:24.936Z] [LOG] Creating components for record 5e805dfb-7ff1-4f35-bda6-e9192e92f42c: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:47:24.937Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 6925.3493652
}
[2025-10-23T05:47:25.176Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:47:25.411Z] [LOG] Created payroll_record_component: 08600f23-00da-4de9-b957-0b5cd65f8b79 for Base Salary
[2025-10-23T05:47:25.412Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 20800.480000000003
}
[2025-10-23T05:47:25.646Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:47:25.885Z] [LOG] Created payroll_record_component: 09c3c7b0-779b-436d-9320-a5508ed3c7ec for Attendance Shortfall (Info)
[2025-10-23T05:47:26.369Z] [LOG] ✅ Financial balances updated successfully for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:26.369Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:47:26.369Z] [LOG] 
======================================================================
[2025-10-23T05:47:26.370Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Maryam null
[2025-10-23T05:47:26.370Z] [LOG] ======================================================================
[2025-10-23T05:47:26.370Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T05:47:26.371Z] [LOG]    Actual Earned Base (Attendance-based): Rs.6925.35
[2025-10-23T05:47:26.371Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T05:47:26.371Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:26.371Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:26.372Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:47:26.372Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:26.372Z] [LOG]    GROSS SALARY: Rs.6925.35
[2025-10-23T05:47:26.373Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:26.373Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:47:26.373Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:47:26.374Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:47:26.374Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:47:26.374Z] [LOG]       - Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T05:47:26.374Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:26.375Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:26.375Z] [LOG]    NET SALARY: Rs.6925.35
[2025-10-23T05:47:26.376Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:47:26.376Z] [LOG] ======================================================================

[2025-10-23T05:47:26.376Z] [LOG] ✅ Maryam null: Calculation completed successfully
[2025-10-23T05:47:26.376Z] [LOG] 📊 Progress: 13/34 (38.2%)
[2025-10-23T05:47:26.377Z] [LOG] 
🧮 Processing: Uthpala null (EMP000006)
[2025-10-23T05:47:26.377Z] [LOG] 📋 Record ID: 6b155450-ff7a-4772-9b33-4cf0869a00d9
[2025-10-23T05:47:26.377Z] [LOG] 
======================================================================
[2025-10-23T05:47:26.378Z] [LOG] 🧮 CALCULATING PAYROLL: Uthpala null (EMP000006)
[2025-10-23T05:47:26.378Z] [LOG] ======================================================================
[2025-10-23T05:47:27.255Z] [LOG] 🔍 Component filtering for employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-23T05:47:27.255Z] [LOG]    Total components: 13
[2025-10-23T05:47:27.255Z] [LOG]    Applicable components: 13
[2025-10-23T05:47:27.256Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T05:47:30.213Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:47:30.214Z] [LOG] 🔄 Processing financial records for employee 0143a539-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:47:30.452Z] [LOG] 📊 Found 0 active loans for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:30.715Z] [LOG] 📊 Found 0 active advances for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:30.983Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:30.983Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:47:30.984Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:47:31.235Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:47:31.235Z] [LOG]    Employee ID: 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:31.236Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:47:31.236Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:47:31.236Z] [LOG]    Base Salary (Full Month): Rs.100000.00
[2025-10-23T05:47:31.488Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:47:31.489Z] [LOG]       Daily Salary: Rs.4000.00
[2025-10-23T05:47:31.489Z] [LOG]       Weekday Hourly Rate: Rs.500.00
[2025-10-23T05:47:31.489Z] [LOG]       Saturday Hourly Rate: Rs.888.89
[2025-10-23T05:47:31.489Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:47:31.490Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:47:31.490Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:47:32.132Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:47:32.133Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:47:32.368Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:47:32.368Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:47:32.369Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:47:32.369Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:47:32.369Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:47:32.369Z] [LOG]          2. 2025-10-15 (Weekday): 7.50h
[2025-10-23T05:47:32.369Z] [LOG]          3. 2025-10-16 (Weekday): 7.50h
[2025-10-23T05:47:32.370Z] [LOG]          4. 2025-10-22 (Weekday): 7.50h
[2025-10-23T05:47:32.612Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:47:32.613Z] [LOG]          Weekday: 22.50h
[2025-10-23T05:47:32.613Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:47:32.613Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:47:32.854Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:47:32.855Z] [LOG]       Scheduled Start: 09:30:00
[2025-10-23T05:47:32.855Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:47:32.856Z] [LOG]       Current Time: 11:17:32
[2025-10-23T05:47:32.856Z] [LOG]       Expected Hours (scheduled → now): 1.79h
[2025-10-23T05:47:32.856Z] [LOG]       Actual Hours (check-in → now): 2.79h
[2025-10-23T05:47:32.857Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:47:32.857Z] [LOG]       Weekday: 113.79h
[2025-10-23T05:47:32.857Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:47:32.858Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:32.858Z] [LOG]       Total Expected: 127.29h
[2025-10-23T05:47:32.858Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:47:32.858Z] [LOG]       Weekday: 25.29h (includes 2.79h live)
[2025-10-23T05:47:32.858Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:47:32.859Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:32.859Z] [LOG]       Total Actual: 29.79h
[2025-10-23T05:47:32.859Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:47:32.860Z] [LOG]       Weekday: 113.79h × Rs.500.00 = Rs.56896.23
[2025-10-23T05:47:32.860Z] [LOG]       Saturday: 13.50h × Rs.888.89 = Rs.12000.01
[2025-10-23T05:47:32.860Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:32.860Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:32.861Z] [LOG]       Total Expected Earned: Rs.68896.24
[2025-10-23T05:47:32.861Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:47:32.862Z] [LOG]       Weekday: 25.29h × Rs.500.00 = Rs.12646.23
[2025-10-23T05:47:32.862Z] [LOG]       Saturday: 4.50h × Rs.888.89 = Rs.4000.01
[2025-10-23T05:47:32.862Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:32.863Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:32.863Z] [LOG]       Total Actual Earned: Rs.16646.23
[2025-10-23T05:47:32.864Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:47:32.865Z] [LOG]       Calculated At: Oct 23, 2025, 11:17:32
[2025-10-23T05:47:32.865Z] [LOG]       Expected Earned (until NOW): Rs.68896.24
[2025-10-23T05:47:32.865Z] [LOG]       Actual Earned (until NOW): Rs.16646.23
[2025-10-23T05:47:32.865Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:32.866Z] [LOG]       Attendance Deduction: Rs.52250.01
[2025-10-23T05:47:32.866Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:47:32.866Z] [LOG]       📉 Shortfall: 97.50 hours (75.84% of expected)
[2025-10-23T05:47:32.867Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:47:32.867Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:47:32.867Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T05:47:32.868Z] [LOG]    Actual Earned Base: Rs.16646.23
[2025-10-23T05:47:32.868Z] [LOG]    Attendance Shortfall: Rs.52250.01
[2025-10-23T05:47:32.868Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:47:32.869Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:47:32.869Z] [LOG]    Gross Salary: 16646.234722222223
[2025-10-23T05:47:32.869Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:47:32.870Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:47:32.870Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.870Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:47:32.870Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.871Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:47:32.871Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.871Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:47:32.871Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.872Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:47:32.872Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.872Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:47:32.873Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.873Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:47:32.873Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.874Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:47:32.874Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.875Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:47:32.875Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.875Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:47:32.876Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.876Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:47:32.876Z] [LOG]    EPF/ETF calculated on: Rs.16646.23
[2025-10-23T05:47:32.877Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:47:32.877Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:47:32.877Z] [LOG] 💰 GROSS CALCULATION for Uthpala null:
[2025-10-23T05:47:32.878Z] [LOG]    Base Salary: 100000
[2025-10-23T05:47:32.878Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:47:32.878Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:47:32.878Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.879Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:47:32.879Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:32.880Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:47:32.880Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:33.284Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:47:33.285Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:33.285Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:47:33.285Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:47:33.285Z] [LOG]    Actual Earned Base: Rs.16646.23
[2025-10-23T05:47:33.286Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:47:33.286Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:47:33.286Z] [LOG]    = Gross Salary: Rs.16646.23
[2025-10-23T05:47:33.286Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:47:33.287Z] [LOG]    Attendance Shortfall (Info): Rs.52250.01
[2025-10-23T05:47:33.287Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:47:33.287Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:33.288Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:47:33.288Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:47:33.288Z] [LOG]    Gross Salary: Rs.16646.23
[2025-10-23T05:47:33.289Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:47:33.289Z] [LOG]    = NET SALARY: Rs.16646.23
[2025-10-23T05:47:33.289Z] [LOG] 
💾 Database Update:
[2025-10-23T05:47:33.289Z] [LOG]    Total Earnings: Rs.16646.23 (Base: 16646.23 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:47:33.290Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:47:33.503Z] [LOG] 
📝 Components to save:
[2025-10-23T05:47:33.503Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:47:33.504Z] [LOG]    Deduction components: 1
[2025-10-23T05:47:33.504Z] [LOG] Creating components for record 6b155450-ff7a-4772-9b33-4cf0869a00d9: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:47:33.504Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 16646.234722222223
}
[2025-10-23T05:47:33.728Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:47:33.965Z] [LOG] Created payroll_record_component: 8cd537ca-5627-4720-bcb1-5f9683494366 for Base Salary
[2025-10-23T05:47:33.965Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 52250.01
}
[2025-10-23T05:47:34.208Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:47:34.445Z] [LOG] Created payroll_record_component: 741f61e4-00bd-4ab5-b54d-298b7077c6a7 for Attendance Shortfall (Info)
[2025-10-23T05:47:34.937Z] [LOG] ✅ Financial balances updated successfully for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:34.937Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:47:34.938Z] [LOG] 
======================================================================
[2025-10-23T05:47:34.938Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Uthpala null
[2025-10-23T05:47:34.938Z] [LOG] ======================================================================
[2025-10-23T05:47:34.939Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T05:47:34.939Z] [LOG]    Actual Earned Base (Attendance-based): Rs.16646.23
[2025-10-23T05:47:34.939Z] [LOG]    Attendance Shortfall: Rs.52250.01
[2025-10-23T05:47:34.940Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:34.940Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:34.940Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:47:34.940Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:34.940Z] [LOG]    GROSS SALARY: Rs.16646.23
[2025-10-23T05:47:34.941Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:34.941Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:47:34.941Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:47:34.941Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:47:34.942Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:47:34.942Z] [LOG]       - Attendance Shortfall (Info): Rs.52250.01
[2025-10-23T05:47:34.943Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:34.943Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:34.943Z] [LOG]    NET SALARY: Rs.16646.23
[2025-10-23T05:47:34.944Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:47:34.944Z] [LOG] ======================================================================

[2025-10-23T05:47:34.944Z] [LOG] ✅ Uthpala null: Calculation completed successfully
[2025-10-23T05:47:34.945Z] [LOG] 📊 Progress: 14/34 (41.2%)
[2025-10-23T05:47:34.945Z] [LOG] 
🧮 Processing: P.D.P Dilini Madushani null (EMP000043)
[2025-10-23T05:47:34.946Z] [LOG] 📋 Record ID: 7cdd2076-89da-43cd-ac05-c69161eee435
[2025-10-23T05:47:34.946Z] [LOG] 
======================================================================
[2025-10-23T05:47:34.947Z] [LOG] 🧮 CALCULATING PAYROLL: P.D.P Dilini Madushani null (EMP000043)
[2025-10-23T05:47:34.947Z] [LOG] ======================================================================
[2025-10-23T05:47:35.898Z] [LOG] 🔍 Component filtering for employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-23T05:47:35.898Z] [LOG]    Total components: 13
[2025-10-23T05:47:35.898Z] [LOG]    Applicable components: 13
[2025-10-23T05:47:35.899Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:47:37.326Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:47:37.327Z] [LOG] 🔄 Processing financial records for employee 014435dc-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:47:37.582Z] [LOG] 📊 Found 0 active loans for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:37.807Z] [LOG] 📊 Found 0 active advances for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:38.065Z] [LOG] 📊 Found 0 approved bonuses for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:38.065Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:47:38.066Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:47:38.452Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:47:38.452Z] [LOG]    Employee ID: 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:38.452Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:47:38.453Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:47:38.453Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:47:38.662Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:47:38.662Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:47:38.663Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:47:38.663Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:47:38.663Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:47:38.664Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:47:38.664Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:47:39.409Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:47:39.409Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:47:39.646Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:47:39.646Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:47:39.647Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:47:39.647Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:47:39.647Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:47:39.648Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:47:39.648Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:47:39.649Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:47:39.886Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:47:39.886Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:47:39.887Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:47:39.887Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:47:40.126Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:47:40.126Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:47:40.126Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:47:40.127Z] [LOG]       Current Time: 11:17:40
[2025-10-23T05:47:40.128Z] [LOG]       Expected Hours (scheduled → now): 2.79h
[2025-10-23T05:47:40.128Z] [LOG]       Actual Hours (check-in → now): 2.79h
[2025-10-23T05:47:40.128Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:47:40.128Z] [LOG]       Weekday: 121.79h
[2025-10-23T05:47:40.129Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:47:40.129Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:40.129Z] [LOG]       Total Expected: 135.29h
[2025-10-23T05:47:40.129Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:47:40.130Z] [LOG]       Weekday: 28.29h (includes 2.79h live)
[2025-10-23T05:47:40.130Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:47:40.131Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:40.131Z] [LOG]       Total Actual: 32.79h
[2025-10-23T05:47:40.131Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:47:40.132Z] [LOG]       Weekday: 121.79h × Rs.235.29 = Rs.28657.02
[2025-10-23T05:47:40.132Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:47:40.133Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:40.133Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:40.133Z] [LOG]       Total Expected Earned: Rs.34656.96
[2025-10-23T05:47:40.134Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:47:40.134Z] [LOG]       Weekday: 28.29h × Rs.235.29 = Rs.6657.41
[2025-10-23T05:47:40.134Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:47:40.134Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:40.135Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:40.135Z] [LOG]       Total Actual Earned: Rs.8657.39
[2025-10-23T05:47:40.136Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:47:40.136Z] [LOG]       Calculated At: Oct 23, 2025, 11:17:40
[2025-10-23T05:47:40.136Z] [LOG]       Expected Earned (until NOW): Rs.34656.96
[2025-10-23T05:47:40.137Z] [LOG]       Actual Earned (until NOW): Rs.8657.39
[2025-10-23T05:47:40.137Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:40.137Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:47:40.138Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:47:40.138Z] [LOG]       📉 Shortfall: 102.50 hours (75.02% of expected)
[2025-10-23T05:47:40.138Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:47:40.139Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:47:40.139Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:47:40.139Z] [LOG]    Actual Earned Base: Rs.8657.39
[2025-10-23T05:47:40.140Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:47:40.140Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:47:40.141Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:47:40.141Z] [LOG]    Gross Salary: 8657.388068483333
[2025-10-23T05:47:40.141Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:47:40.142Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:47:40.142Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.142Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:47:40.142Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.142Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:47:40.143Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.143Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:47:40.143Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.143Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:47:40.144Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.144Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:47:40.144Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.144Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:47:40.145Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.145Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:47:40.145Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.146Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:47:40.146Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.146Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:47:40.146Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.147Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:47:40.147Z] [LOG]    EPF/ETF calculated on: Rs.8657.39
[2025-10-23T05:47:40.148Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:47:40.148Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:47:40.148Z] [LOG] 💰 GROSS CALCULATION for P.D.P Dilini Madushani null:
[2025-10-23T05:47:40.148Z] [LOG]    Base Salary: 50000
[2025-10-23T05:47:40.148Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:47:40.149Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:47:40.149Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.149Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:47:40.150Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.150Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:47:40.150Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:40.367Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:47:40.368Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:40.368Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:47:40.368Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:47:40.368Z] [LOG]    Actual Earned Base: Rs.8657.39
[2025-10-23T05:47:40.369Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:47:40.369Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:47:40.369Z] [LOG]    = Gross Salary: Rs.8657.39
[2025-10-23T05:47:40.370Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:47:40.370Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:47:40.370Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:47:40.370Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:40.371Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:47:40.371Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:47:40.371Z] [LOG]    Gross Salary: Rs.8657.39
[2025-10-23T05:47:40.372Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:47:40.372Z] [LOG]    = NET SALARY: Rs.8657.39
[2025-10-23T05:47:40.372Z] [LOG] 
💾 Database Update:
[2025-10-23T05:47:40.372Z] [LOG]    Total Earnings: Rs.8657.39 (Base: 8657.39 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:47:40.373Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:47:40.606Z] [LOG] 
📝 Components to save:
[2025-10-23T05:47:40.607Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:47:40.607Z] [LOG]    Deduction components: 1
[2025-10-23T05:47:40.607Z] [LOG] Creating components for record 7cdd2076-89da-43cd-ac05-c69161eee435: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:47:40.608Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8657.388068483333
}
[2025-10-23T05:47:40.852Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:47:41.092Z] [LOG] Created payroll_record_component: 32dcfdae-d397-40ed-8478-5fa5b9023477 for Base Salary
[2025-10-23T05:47:41.093Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:47:41.341Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:47:41.579Z] [LOG] Created payroll_record_component: cced9d6a-8e3f-40bf-8b7d-a8bf46424b63 for Attendance Shortfall (Info)
[2025-10-23T05:47:41.979Z] [LOG] ✅ Financial balances updated successfully for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:41.979Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:47:41.980Z] [LOG] 
======================================================================
[2025-10-23T05:47:41.980Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: P.D.P Dilini Madushani null
[2025-10-23T05:47:41.981Z] [LOG] ======================================================================
[2025-10-23T05:47:41.981Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:47:41.981Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8657.39
[2025-10-23T05:47:41.982Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:47:41.982Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:41.982Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:41.983Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:47:41.983Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:41.983Z] [LOG]    GROSS SALARY: Rs.8657.39
[2025-10-23T05:47:41.983Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:41.984Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:47:41.984Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:47:41.984Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:47:41.984Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:47:41.985Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:47:41.985Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:41.985Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:41.985Z] [LOG]    NET SALARY: Rs.8657.39
[2025-10-23T05:47:41.986Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:47:41.986Z] [LOG] ======================================================================

[2025-10-23T05:47:41.986Z] [LOG] ✅ P.D.P Dilini Madushani null: Calculation completed successfully
[2025-10-23T05:47:41.987Z] [LOG] 📊 Progress: 15/34 (44.1%)
[2025-10-23T05:47:41.987Z] [LOG] 
🧮 Processing: Rasanga null (EMP000028)
[2025-10-23T05:47:41.987Z] [LOG] 📋 Record ID: 86433ac8-a08a-4aeb-a831-e07b2f55eb7e
[2025-10-23T05:47:41.987Z] [LOG] 
======================================================================
[2025-10-23T05:47:41.988Z] [LOG] 🧮 CALCULATING PAYROLL: Rasanga null (EMP000028)
[2025-10-23T05:47:41.988Z] [LOG] ======================================================================
[2025-10-23T05:47:42.855Z] [LOG] 🔍 Component filtering for employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-23T05:47:42.855Z] [LOG]    Total components: 13
[2025-10-23T05:47:42.855Z] [LOG]    Applicable components: 13
[2025-10-23T05:47:42.856Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T05:47:44.710Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:47:44.711Z] [LOG] 🔄 Processing financial records for employee 0143eaec-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:47:44.932Z] [LOG] 📊 Found 0 active loans for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:45.139Z] [LOG] 📊 Found 0 active advances for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:45.386Z] [LOG] 📊 Found 0 approved bonuses for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:45.386Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:47:45.387Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:47:45.655Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:47:45.655Z] [LOG]    Employee ID: 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:45.656Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:47:45.656Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:47:45.656Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:47:45.865Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:47:45.866Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:47:45.866Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:47:45.866Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:47:45.867Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:47:45.867Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:47:45.867Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:47:46.703Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:47:46.704Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:47:46.908Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:47:46.908Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:47:46.909Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:47:46.909Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:47:46.909Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:47:46.909Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:47:46.909Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:47:46.910Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:47:47.166Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:47:47.166Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:47:47.167Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:47:47.167Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:47:47.406Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:47:47.407Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:47:47.407Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:47:47.408Z] [LOG]       Current Time: 11:17:47
[2025-10-23T05:47:47.409Z] [LOG]       Expected Hours (scheduled → now): 2.80h
[2025-10-23T05:47:47.409Z] [LOG]       Actual Hours (check-in → now): 2.80h
[2025-10-23T05:47:47.409Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:47:47.410Z] [LOG]       Weekday: 121.80h
[2025-10-23T05:47:47.410Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:47:47.411Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:47.411Z] [LOG]       Total Expected: 135.30h
[2025-10-23T05:47:47.411Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:47:47.412Z] [LOG]       Weekday: 28.30h (includes 2.80h live)
[2025-10-23T05:47:47.412Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:47:47.412Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:47.413Z] [LOG]       Total Actual: 32.80h
[2025-10-23T05:47:47.413Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:47:47.413Z] [LOG]       Weekday: 121.80h × Rs.235.29 = Rs.28657.50
[2025-10-23T05:47:47.414Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:47:47.414Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:47.414Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:47.415Z] [LOG]       Total Expected Earned: Rs.34657.44
[2025-10-23T05:47:47.415Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:47:47.415Z] [LOG]       Weekday: 28.30h × Rs.235.29 = Rs.6657.88
[2025-10-23T05:47:47.415Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:47:47.416Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:47.416Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:47.416Z] [LOG]       Total Actual Earned: Rs.8657.86
[2025-10-23T05:47:47.417Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:47:47.417Z] [LOG]       Calculated At: Oct 23, 2025, 11:17:47
[2025-10-23T05:47:47.418Z] [LOG]       Expected Earned (until NOW): Rs.34657.44
[2025-10-23T05:47:47.418Z] [LOG]       Actual Earned (until NOW): Rs.8657.86
[2025-10-23T05:47:47.418Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:47.418Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:47:47.418Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:47:47.418Z] [LOG]       📉 Shortfall: 102.50 hours (75.02% of expected)
[2025-10-23T05:47:47.419Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:47:47.419Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:47:47.419Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:47:47.420Z] [LOG]    Actual Earned Base: Rs.8657.86
[2025-10-23T05:47:47.420Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:47:47.421Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:47:47.421Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:47:47.422Z] [LOG]    Gross Salary: 8657.863877150001
[2025-10-23T05:47:47.422Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:47:47.423Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:47:47.423Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.423Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:47:47.423Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.424Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:47:47.424Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.424Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:47:47.425Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.425Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:47:47.425Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.425Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:47:47.426Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.426Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:47:47.427Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.427Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:47:47.427Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.428Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:47:47.428Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.428Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:47:47.428Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.429Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:47:47.429Z] [LOG]    EPF/ETF calculated on: Rs.8657.86
[2025-10-23T05:47:47.430Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:47:47.430Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:47:47.430Z] [LOG] 💰 GROSS CALCULATION for Rasanga null:
[2025-10-23T05:47:47.430Z] [LOG]    Base Salary: 50000
[2025-10-23T05:47:47.430Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:47:47.431Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:47:47.431Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.431Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:47:47.431Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.431Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:47:47.432Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:47.649Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:47:47.649Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:47.649Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:47:47.650Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:47:47.650Z] [LOG]    Actual Earned Base: Rs.8657.86
[2025-10-23T05:47:47.650Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:47:47.651Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:47:47.651Z] [LOG]    = Gross Salary: Rs.8657.86
[2025-10-23T05:47:47.651Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:47:47.652Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:47:47.652Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:47:47.653Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:47.653Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:47:47.653Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:47:47.654Z] [LOG]    Gross Salary: Rs.8657.86
[2025-10-23T05:47:47.654Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:47:47.654Z] [LOG]    = NET SALARY: Rs.8657.86
[2025-10-23T05:47:47.655Z] [LOG] 
💾 Database Update:
[2025-10-23T05:47:47.655Z] [LOG]    Total Earnings: Rs.8657.86 (Base: 8657.86 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:47:47.655Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:47:47.885Z] [LOG] 
📝 Components to save:
[2025-10-23T05:47:47.885Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:47:47.885Z] [LOG]    Deduction components: 1
[2025-10-23T05:47:47.886Z] [LOG] Creating components for record 86433ac8-a08a-4aeb-a831-e07b2f55eb7e: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:47:47.886Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8657.863877150001
}
[2025-10-23T05:47:48.135Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:47:48.365Z] [LOG] Created payroll_record_component: 55a09193-eec4-468d-8ffc-a90ce87dc14b for Base Salary
[2025-10-23T05:47:48.365Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T05:47:48.606Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:47:48.847Z] [LOG] Created payroll_record_component: 24e8040a-06ae-4842-9490-9724c2ee8336 for Attendance Shortfall (Info)
[2025-10-23T05:47:49.327Z] [LOG] ✅ Financial balances updated successfully for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:49.328Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:47:49.328Z] [LOG] 
======================================================================
[2025-10-23T05:47:49.329Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Rasanga null
[2025-10-23T05:47:49.329Z] [LOG] ======================================================================
[2025-10-23T05:47:49.329Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:47:49.329Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8657.86
[2025-10-23T05:47:49.330Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:47:49.330Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:49.330Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:49.331Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:47:49.331Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:49.331Z] [LOG]    GROSS SALARY: Rs.8657.86
[2025-10-23T05:47:49.331Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:49.332Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:47:49.332Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:47:49.332Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:47:49.332Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:47:49.333Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:47:49.333Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:49.333Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:49.333Z] [LOG]    NET SALARY: Rs.8657.86
[2025-10-23T05:47:49.334Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:47:49.335Z] [LOG] ======================================================================

[2025-10-23T05:47:49.335Z] [LOG] ✅ Rasanga null: Calculation completed successfully
[2025-10-23T05:47:49.335Z] [LOG] 📊 Progress: 16/34 (47.1%)
[2025-10-23T05:47:49.336Z] [LOG] 
🧮 Processing: Shandeep null (EMP000034)
[2025-10-23T05:47:49.336Z] [LOG] 📋 Record ID: 9b83d502-abc6-4f7b-8c1f-75769672cd78
[2025-10-23T05:47:49.336Z] [LOG] 
======================================================================
[2025-10-23T05:47:49.337Z] [LOG] 🧮 CALCULATING PAYROLL: Shandeep null (EMP000034)
[2025-10-23T05:47:49.337Z] [LOG] ======================================================================
[2025-10-23T05:47:50.214Z] [LOG] 🔍 Component filtering for employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-23T05:47:50.215Z] [LOG]    Total components: 13
[2025-10-23T05:47:50.215Z] [LOG]    Applicable components: 13
[2025-10-23T05:47:50.215Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:47:51.498Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:47:51.499Z] [LOG] 🔄 Processing financial records for employee 0143fc5a-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:47:51.748Z] [LOG] 📊 Found 0 active loans for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:51.967Z] [LOG] 📊 Found 0 active advances for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:52.174Z] [LOG] 📊 Found 0 approved bonuses for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:52.175Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:47:52.175Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:47:52.445Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:47:52.445Z] [LOG]    Employee ID: 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:52.445Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:47:52.445Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:47:52.446Z] [LOG]    Base Salary (Full Month): Rs.80000.00
[2025-10-23T05:47:52.855Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:47:52.856Z] [LOG]       Daily Salary: Rs.3200.00
[2025-10-23T05:47:52.856Z] [LOG]       Weekday Hourly Rate: Rs.376.47
[2025-10-23T05:47:52.856Z] [LOG]       Saturday Hourly Rate: Rs.711.11
[2025-10-23T05:47:52.856Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:47:52.857Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:47:52.857Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:47:53.584Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:47:53.584Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:47:53.797Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:47:53.798Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:47:53.798Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:47:53.798Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:47:53.798Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:47:53.798Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:47:53.799Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:47:53.799Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:47:54.048Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:47:54.049Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:47:54.049Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:47:54.050Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:47:54.287Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:47:54.287Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:47:54.288Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:47:54.288Z] [LOG]       Current Time: 11:17:54
[2025-10-23T05:47:54.289Z] [LOG]       Expected Hours (scheduled → now): 2.80h
[2025-10-23T05:47:54.289Z] [LOG]       Actual Hours (check-in → now): 2.80h
[2025-10-23T05:47:54.289Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:47:54.290Z] [LOG]       Weekday: 121.80h
[2025-10-23T05:47:54.290Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:47:54.290Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:54.290Z] [LOG]       Total Expected: 135.30h
[2025-10-23T05:47:54.291Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:47:54.291Z] [LOG]       Weekday: 28.30h (includes 2.80h live)
[2025-10-23T05:47:54.291Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:47:54.291Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:47:54.292Z] [LOG]       Total Actual: 32.80h
[2025-10-23T05:47:54.292Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:47:54.292Z] [LOG]       Weekday: 121.80h × Rs.376.47 = Rs.45853.45
[2025-10-23T05:47:54.293Z] [LOG]       Saturday: 13.50h × Rs.711.11 = Rs.9599.99
[2025-10-23T05:47:54.293Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:54.293Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:54.293Z] [LOG]       Total Expected Earned: Rs.55453.43
[2025-10-23T05:47:54.294Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:47:54.294Z] [LOG]       Weekday: 28.30h × Rs.376.47 = Rs.10653.50
[2025-10-23T05:47:54.294Z] [LOG]       Saturday: 4.50h × Rs.711.11 = Rs.3199.99
[2025-10-23T05:47:54.295Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:47:54.295Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:54.295Z] [LOG]       Total Actual Earned: Rs.13853.50
[2025-10-23T05:47:54.296Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:47:54.296Z] [LOG]       Calculated At: Oct 23, 2025, 11:17:54
[2025-10-23T05:47:54.296Z] [LOG]       Expected Earned (until NOW): Rs.55453.43
[2025-10-23T05:47:54.297Z] [LOG]       Actual Earned (until NOW): Rs.13853.50
[2025-10-23T05:47:54.297Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:47:54.297Z] [LOG]       Attendance Deduction: Rs.41599.94
[2025-10-23T05:47:54.297Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:47:54.297Z] [LOG]       📉 Shortfall: 102.50 hours (75.02% of expected)
[2025-10-23T05:47:54.297Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:47:54.297Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:47:54.297Z] [LOG]    Base Salary (Full): Rs.80000.00
[2025-10-23T05:47:54.298Z] [LOG]    Actual Earned Base: Rs.13853.50
[2025-10-23T05:47:54.298Z] [LOG]    Attendance Shortfall: Rs.41599.94
[2025-10-23T05:47:54.298Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:47:54.298Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:47:54.299Z] [LOG]    Gross Salary: 13853.498563025001
[2025-10-23T05:47:54.299Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:47:54.299Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:47:54.299Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.300Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:47:54.300Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.300Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:47:54.300Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.301Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:47:54.301Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.301Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:47:54.302Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.302Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:47:54.303Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.303Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:47:54.303Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.303Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:47:54.303Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.303Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:47:54.303Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.303Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:47:54.304Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.304Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:47:54.304Z] [LOG]    EPF/ETF calculated on: Rs.13853.50
[2025-10-23T05:47:54.304Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:47:54.304Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:47:54.304Z] [LOG] 💰 GROSS CALCULATION for Shandeep null:
[2025-10-23T05:47:54.304Z] [LOG]    Base Salary: 80000
[2025-10-23T05:47:54.304Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:47:54.305Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:47:54.305Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.305Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:47:54.305Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.305Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:47:54.305Z] [LOG]    Fixed amount: 0
[2025-10-23T05:47:54.529Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:47:54.530Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:54.530Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:47:54.530Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:47:54.531Z] [LOG]    Actual Earned Base: Rs.13853.50
[2025-10-23T05:47:54.531Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:47:54.531Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:47:54.531Z] [LOG]    = Gross Salary: Rs.13853.50
[2025-10-23T05:47:54.531Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:47:54.531Z] [LOG]    Attendance Shortfall (Info): Rs.41599.94
[2025-10-23T05:47:54.531Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:47:54.532Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:54.532Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:47:54.532Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:47:54.532Z] [LOG]    Gross Salary: Rs.13853.50
[2025-10-23T05:47:54.532Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:47:54.532Z] [LOG]    = NET SALARY: Rs.13853.50
[2025-10-23T05:47:54.532Z] [LOG] 
💾 Database Update:
[2025-10-23T05:47:54.532Z] [LOG]    Total Earnings: Rs.13853.50 (Base: 13853.50 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:47:54.532Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:47:54.735Z] [LOG] 
📝 Components to save:
[2025-10-23T05:47:54.735Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:47:54.735Z] [LOG]    Deduction components: 1
[2025-10-23T05:47:54.735Z] [LOG] Creating components for record 9b83d502-abc6-4f7b-8c1f-75769672cd78: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:47:54.736Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 13853.498563025001
}
[2025-10-23T05:47:54.935Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:47:55.166Z] [LOG] Created payroll_record_component: 71b43024-57b7-4dfe-aa58-efcf71b6233f for Base Salary
[2025-10-23T05:47:55.166Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 41599.935000000005
}
[2025-10-23T05:47:55.358Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:47:55.565Z] [LOG] Created payroll_record_component: f158fdf4-5fae-4e61-9ac8-063e376b723a for Attendance Shortfall (Info)
[2025-10-23T05:47:56.203Z] [LOG] ✅ Financial balances updated successfully for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:56.203Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:47:56.203Z] [LOG] 
======================================================================
[2025-10-23T05:47:56.203Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Shandeep null
[2025-10-23T05:47:56.203Z] [LOG] ======================================================================
[2025-10-23T05:47:56.204Z] [LOG]    Base Salary (Full): Rs.80000.00
[2025-10-23T05:47:56.204Z] [LOG]    Actual Earned Base (Attendance-based): Rs.13853.50
[2025-10-23T05:47:56.204Z] [LOG]    Attendance Shortfall: Rs.41599.94
[2025-10-23T05:47:56.204Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:56.204Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:47:56.205Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:47:56.205Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:56.205Z] [LOG]    GROSS SALARY: Rs.13853.50
[2025-10-23T05:47:56.205Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:56.205Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:47:56.206Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:47:56.206Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:47:56.206Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:47:56.206Z] [LOG]       - Attendance Shortfall (Info): Rs.41599.94
[2025-10-23T05:47:56.206Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:47:56.206Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:47:56.207Z] [LOG]    NET SALARY: Rs.13853.50
[2025-10-23T05:47:56.207Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:47:56.207Z] [LOG] ======================================================================

[2025-10-23T05:47:56.207Z] [LOG] ✅ Shandeep null: Calculation completed successfully
[2025-10-23T05:47:56.207Z] [LOG] 📊 Progress: 17/34 (50.0%)
[2025-10-23T05:47:56.208Z] [LOG] 
🧮 Processing: Sujevan Selvaratnam null (EMP000026)
[2025-10-23T05:47:56.208Z] [LOG] 📋 Record ID: 9cddb155-58da-4ac4-b9de-c9692393fc17
[2025-10-23T05:47:56.208Z] [LOG] 
======================================================================
[2025-10-23T05:47:56.208Z] [LOG] 🧮 CALCULATING PAYROLL: Sujevan Selvaratnam null (EMP000026)
[2025-10-23T05:47:56.209Z] [LOG] ======================================================================
[2025-10-23T05:47:57.335Z] [LOG] 🔍 Component filtering for employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-23T05:47:57.335Z] [LOG]    Total components: 13
[2025-10-23T05:47:57.336Z] [LOG]    Applicable components: 13
[2025-10-23T05:47:57.336Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:47:59.075Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:47:59.075Z] [LOG] 🔄 Processing financial records for employee 0143e6c3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:47:59.276Z] [LOG] 📊 Found 0 active loans for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:59.485Z] [LOG] 📊 Found 0 active advances for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:59.792Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:59.792Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:47:59.793Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:47:59.987Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:47:59.987Z] [LOG]    Employee ID: 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T05:47:59.987Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:47:59.988Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:47:59.988Z] [LOG]    Base Salary (Full Month): Rs.1.00
[2025-10-23T05:48:00.206Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:48:00.207Z] [LOG]       Daily Salary: Rs.0.04
[2025-10-23T05:48:00.207Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T05:48:00.207Z] [LOG]       Saturday Hourly Rate: Rs.0.01
[2025-10-23T05:48:00.207Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:48:00.208Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:48:00.208Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:48:01.099Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:48:01.100Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:48:01.311Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:48:01.311Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:48:01.311Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:48:01.311Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:48:01.312Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:48:01.312Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:48:01.312Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:48:01.312Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:48:01.502Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:48:01.502Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:48:01.503Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:48:01.503Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:48:01.725Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:48:01.725Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:48:01.725Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:48:01.726Z] [LOG]       Current Time: 11:18:01
[2025-10-23T05:48:01.726Z] [LOG]       Expected Hours (scheduled → now): 2.80h
[2025-10-23T05:48:01.727Z] [LOG]       Actual Hours (check-in → now): 2.80h
[2025-10-23T05:48:01.727Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:48:01.727Z] [LOG]       Weekday: 121.80h
[2025-10-23T05:48:01.728Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:48:01.728Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:01.728Z] [LOG]       Total Expected: 135.30h
[2025-10-23T05:48:01.728Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:48:01.729Z] [LOG]       Weekday: 28.30h (includes 2.80h live)
[2025-10-23T05:48:01.729Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:48:01.729Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:01.729Z] [LOG]       Total Actual: 32.80h
[2025-10-23T05:48:01.730Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:48:01.730Z] [LOG]       Weekday: 121.80h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:01.730Z] [LOG]       Saturday: 13.50h × Rs.0.01 = Rs.0.14
[2025-10-23T05:48:01.730Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:01.731Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:01.731Z] [LOG]       Total Expected Earned: Rs.0.14
[2025-10-23T05:48:01.731Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:48:01.731Z] [LOG]       Weekday: 28.30h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:01.732Z] [LOG]       Saturday: 4.50h × Rs.0.01 = Rs.0.04
[2025-10-23T05:48:01.732Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:01.732Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:01.733Z] [LOG]       Total Actual Earned: Rs.0.04
[2025-10-23T05:48:01.733Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:48:01.734Z] [LOG]       Calculated At: Oct 23, 2025, 11:18:01
[2025-10-23T05:48:01.734Z] [LOG]       Expected Earned (until NOW): Rs.0.14
[2025-10-23T05:48:01.734Z] [LOG]       Actual Earned (until NOW): Rs.0.04
[2025-10-23T05:48:01.734Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:01.735Z] [LOG]       Attendance Deduction: Rs.0.09
[2025-10-23T05:48:01.735Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:48:01.735Z] [LOG]       📉 Shortfall: 102.50 hours (66.67% of expected)
[2025-10-23T05:48:01.736Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:48:01.736Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:48:01.736Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T05:48:01.737Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T05:48:01.737Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T05:48:01.737Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:48:01.737Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:48:01.738Z] [LOG]    Gross Salary: 0.045
[2025-10-23T05:48:01.738Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:48:01.739Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:48:01.739Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.740Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:48:01.740Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.740Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:48:01.740Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.740Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:48:01.741Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.741Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:48:01.741Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.741Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:48:01.741Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.742Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:48:01.742Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.742Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:48:01.743Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.743Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:48:01.743Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.743Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:48:01.744Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.744Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:48:01.744Z] [LOG]    EPF/ETF calculated on: Rs.0.04
[2025-10-23T05:48:01.744Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:48:01.745Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:48:01.745Z] [LOG] 💰 GROSS CALCULATION for Sujevan Selvaratnam null:
[2025-10-23T05:48:01.745Z] [LOG]    Base Salary: 1
[2025-10-23T05:48:01.746Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:48:01.746Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:48:01.746Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.747Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:48:01.747Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.747Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:48:01.747Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:01.967Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:48:01.967Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:01.968Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:48:01.968Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:48:01.968Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T05:48:01.969Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:48:01.969Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:48:01.969Z] [LOG]    = Gross Salary: Rs.0.04
[2025-10-23T05:48:01.969Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:48:01.970Z] [LOG]    Attendance Shortfall (Info): Rs.0.09
[2025-10-23T05:48:01.970Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:48:01.970Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:01.971Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:48:01.971Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:48:01.971Z] [LOG]    Gross Salary: Rs.0.04
[2025-10-23T05:48:01.972Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:48:01.972Z] [LOG]    = NET SALARY: Rs.0.04
[2025-10-23T05:48:01.972Z] [LOG] 
💾 Database Update:
[2025-10-23T05:48:01.972Z] [LOG]    Total Earnings: Rs.0.04 (Base: 0.04 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:48:01.973Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:48:02.175Z] [LOG] 
📝 Components to save:
[2025-10-23T05:48:02.175Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:48:02.175Z] [LOG]    Deduction components: 1
[2025-10-23T05:48:02.176Z] [LOG] Creating components for record 9cddb155-58da-4ac4-b9de-c9692393fc17: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:48:02.176Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 0.045
}
[2025-10-23T05:48:02.452Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:48:02.684Z] [LOG] Created payroll_record_component: 641975a0-0a0d-4fed-8a4c-3e62dde6aeff for Base Salary
[2025-10-23T05:48:02.685Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 0.09000000000000001
}
[2025-10-23T05:48:02.928Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:48:03.165Z] [LOG] Created payroll_record_component: 5a5896fe-af32-459b-b82e-60048294b080 for Attendance Shortfall (Info)
[2025-10-23T05:48:03.645Z] [LOG] ✅ Financial balances updated successfully for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:03.646Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:48:03.646Z] [LOG] 
======================================================================
[2025-10-23T05:48:03.646Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sujevan Selvaratnam null
[2025-10-23T05:48:03.646Z] [LOG] ======================================================================
[2025-10-23T05:48:03.646Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T05:48:03.646Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.04
[2025-10-23T05:48:03.647Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T05:48:03.647Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:03.647Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:03.647Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:48:03.647Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:03.647Z] [LOG]    GROSS SALARY: Rs.0.04
[2025-10-23T05:48:03.647Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:03.647Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:48:03.647Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:48:03.648Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:48:03.648Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:48:03.648Z] [LOG]       - Attendance Shortfall (Info): Rs.0.09
[2025-10-23T05:48:03.648Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:03.648Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:03.648Z] [LOG]    NET SALARY: Rs.0.04
[2025-10-23T05:48:03.648Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:48:03.648Z] [LOG] ======================================================================

[2025-10-23T05:48:03.648Z] [LOG] ✅ Sujevan Selvaratnam null: Calculation completed successfully
[2025-10-23T05:48:03.648Z] [LOG] 📊 Progress: 18/34 (52.9%)
[2025-10-23T05:48:03.649Z] [LOG] 
🧮 Processing: Viruna Damsiha Cooray null (EMP000038)
[2025-10-23T05:48:03.649Z] [LOG] 📋 Record ID: 9dcfd086-8cda-496b-be17-736ef67be8aa
[2025-10-23T05:48:03.649Z] [LOG] 
======================================================================
[2025-10-23T05:48:03.649Z] [LOG] 🧮 CALCULATING PAYROLL: Viruna Damsiha Cooray null (EMP000038)
[2025-10-23T05:48:03.649Z] [LOG] ======================================================================
[2025-10-23T05:48:04.581Z] [LOG] 🔍 Component filtering for employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-23T05:48:04.582Z] [LOG]    Total components: 13
[2025-10-23T05:48:04.582Z] [LOG]    Applicable components: 13
[2025-10-23T05:48:04.582Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:48:05.975Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:48:05.975Z] [LOG] 🔄 Processing financial records for employee 01441633-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:48:06.214Z] [LOG] 📊 Found 0 active loans for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:06.453Z] [LOG] 📊 Found 0 active advances for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:06.687Z] [LOG] 📊 Found 0 approved bonuses for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:06.687Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:48:06.688Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:48:06.941Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:48:06.942Z] [LOG]    Employee ID: 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:06.942Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:48:06.942Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:48:06.943Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:48:07.182Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:48:07.183Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:48:07.183Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:48:07.183Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:48:07.184Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:48:07.184Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:48:07.184Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:48:07.886Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:48:07.886Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:48:08.130Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:48:08.130Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:48:08.131Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:48:08.131Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:48:08.131Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:48:08.131Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:48:08.132Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:48:08.132Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:48:08.390Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:48:08.391Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:48:08.391Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:48:08.391Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:48:08.608Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:48:08.609Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:48:08.609Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:48:08.610Z] [LOG]       Current Time: 11:18:08
[2025-10-23T05:48:08.610Z] [LOG]       Expected Hours (scheduled → now): 2.80h
[2025-10-23T05:48:08.610Z] [LOG]       Actual Hours (check-in → now): 2.80h
[2025-10-23T05:48:08.610Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:48:08.610Z] [LOG]       Weekday: 121.80h
[2025-10-23T05:48:08.611Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:48:08.611Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:08.611Z] [LOG]       Total Expected: 135.30h
[2025-10-23T05:48:08.611Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:48:08.611Z] [LOG]       Weekday: 28.30h (includes 2.80h live)
[2025-10-23T05:48:08.611Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:48:08.611Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:08.611Z] [LOG]       Total Actual: 32.80h
[2025-10-23T05:48:08.611Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:48:08.611Z] [LOG]       Weekday: 121.80h × Rs.235.29 = Rs.28658.88
[2025-10-23T05:48:08.612Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:48:08.612Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:08.612Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:08.612Z] [LOG]       Total Expected Earned: Rs.34658.82
[2025-10-23T05:48:08.612Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:48:08.613Z] [LOG]       Weekday: 28.30h × Rs.235.29 = Rs.6659.27
[2025-10-23T05:48:08.613Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:48:08.613Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:08.613Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:08.613Z] [LOG]       Total Actual Earned: Rs.8659.25
[2025-10-23T05:48:08.614Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:48:08.614Z] [LOG]       Calculated At: Oct 23, 2025, 11:18:08
[2025-10-23T05:48:08.614Z] [LOG]       Expected Earned (until NOW): Rs.34658.82
[2025-10-23T05:48:08.615Z] [LOG]       Actual Earned (until NOW): Rs.8659.25
[2025-10-23T05:48:08.615Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:08.615Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:48:08.615Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:48:08.615Z] [LOG]       📉 Shortfall: 102.50 hours (75.02% of expected)
[2025-10-23T05:48:08.615Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:48:08.615Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:48:08.615Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:48:08.616Z] [LOG]    Actual Earned Base: Rs.8659.25
[2025-10-23T05:48:08.616Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:48:08.616Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:48:08.616Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:48:08.616Z] [LOG]    Gross Salary: 8659.249604533334
[2025-10-23T05:48:08.616Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:48:08.616Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:48:08.616Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.617Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:48:08.617Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.617Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:48:08.617Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.618Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:48:08.618Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.618Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:48:08.618Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.618Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:48:08.618Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.619Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:48:08.619Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.619Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:48:08.619Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.619Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:48:08.620Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.620Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:48:08.620Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.620Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:48:08.620Z] [LOG]    EPF/ETF calculated on: Rs.8659.25
[2025-10-23T05:48:08.621Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:48:08.621Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:48:08.622Z] [LOG] 💰 GROSS CALCULATION for Viruna Damsiha Cooray null:
[2025-10-23T05:48:08.622Z] [LOG]    Base Salary: 50000
[2025-10-23T05:48:08.622Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:48:08.622Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:48:08.622Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.622Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:48:08.623Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.623Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:48:08.623Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:08.845Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:48:08.845Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:08.845Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:48:08.846Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:48:08.846Z] [LOG]    Actual Earned Base: Rs.8659.25
[2025-10-23T05:48:08.846Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:48:08.846Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:48:08.846Z] [LOG]    = Gross Salary: Rs.8659.25
[2025-10-23T05:48:08.847Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:48:08.847Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:48:08.847Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:48:08.847Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:08.847Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:48:08.847Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:48:08.847Z] [LOG]    Gross Salary: Rs.8659.25
[2025-10-23T05:48:08.847Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:48:08.847Z] [LOG]    = NET SALARY: Rs.8659.25
[2025-10-23T05:48:08.847Z] [LOG] 
💾 Database Update:
[2025-10-23T05:48:08.848Z] [LOG]    Total Earnings: Rs.8659.25 (Base: 8659.25 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:48:08.848Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:48:09.084Z] [LOG] 
📝 Components to save:
[2025-10-23T05:48:09.085Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:48:09.085Z] [LOG]    Deduction components: 1
[2025-10-23T05:48:09.085Z] [LOG] Creating components for record 9dcfd086-8cda-496b-be17-736ef67be8aa: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:48:09.085Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8659.249604533334
}
[2025-10-23T05:48:09.330Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:48:09.578Z] [LOG] Created payroll_record_component: b0e0a56f-6e8d-4622-802f-c7948a12285c for Base Salary
[2025-10-23T05:48:09.579Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:48:09.973Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:48:10.179Z] [LOG] Created payroll_record_component: a5a7af3d-6434-43c6-b649-337b72996bf0 for Attendance Shortfall (Info)
[2025-10-23T05:48:10.608Z] [LOG] ✅ Financial balances updated successfully for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:10.608Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:48:10.608Z] [LOG] 
======================================================================
[2025-10-23T05:48:10.609Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Viruna Damsiha Cooray null
[2025-10-23T05:48:10.609Z] [LOG] ======================================================================
[2025-10-23T05:48:10.609Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:48:10.610Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8659.25
[2025-10-23T05:48:10.610Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:48:10.610Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:10.610Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:10.610Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:48:10.611Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:10.611Z] [LOG]    GROSS SALARY: Rs.8659.25
[2025-10-23T05:48:10.611Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:10.611Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:48:10.612Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:48:10.612Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:48:10.612Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:48:10.613Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:48:10.613Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:10.613Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:10.614Z] [LOG]    NET SALARY: Rs.8659.25
[2025-10-23T05:48:10.614Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:48:10.614Z] [LOG] ======================================================================

[2025-10-23T05:48:10.614Z] [LOG] ✅ Viruna Damsiha Cooray null: Calculation completed successfully
[2025-10-23T05:48:10.614Z] [LOG] 📊 Progress: 19/34 (55.9%)
[2025-10-23T05:48:10.614Z] [LOG] 
🧮 Processing: Ratheeshanan null (EMP000047)
[2025-10-23T05:48:10.614Z] [LOG] 📋 Record ID: aa224e99-7eae-4b87-8698-e4ba22dffd02
[2025-10-23T05:48:10.614Z] [LOG] 
======================================================================
[2025-10-23T05:48:10.614Z] [LOG] 🧮 CALCULATING PAYROLL: Ratheeshanan null (EMP000047)
[2025-10-23T05:48:10.615Z] [LOG] ======================================================================
[2025-10-23T05:48:11.581Z] [LOG] 🔍 Component filtering for employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-23T05:48:11.581Z] [LOG]    Total components: 13
[2025-10-23T05:48:11.581Z] [LOG]    Applicable components: 13
[2025-10-23T05:48:11.582Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:48:12.947Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:48:12.948Z] [LOG] 🔄 Processing financial records for employee 01444966-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:48:13.166Z] [LOG] 📊 Found 0 active loans for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:13.408Z] [LOG] 📊 Found 0 active advances for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:13.654Z] [LOG] 📊 Found 0 approved bonuses for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:13.654Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:48:13.654Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:48:13.885Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:48:13.886Z] [LOG]    Employee ID: 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:13.886Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:48:13.886Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:48:13.886Z] [LOG]    Base Salary (Full Month): Rs.25000.00
[2025-10-23T05:48:14.137Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:48:14.137Z] [LOG]       Daily Salary: Rs.1000.00
[2025-10-23T05:48:14.138Z] [LOG]       Weekday Hourly Rate: Rs.117.65
[2025-10-23T05:48:14.138Z] [LOG]       Saturday Hourly Rate: Rs.222.22
[2025-10-23T05:48:14.138Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:48:14.138Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:48:14.138Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:48:14.861Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:48:14.861Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:48:15.097Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:48:15.097Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:48:15.097Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:48:15.098Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:48:15.098Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:48:15.098Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:48:15.099Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:48:15.099Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:48:15.348Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:48:15.348Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:48:15.348Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:48:15.349Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:48:15.566Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:48:15.567Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:48:15.567Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:48:15.568Z] [LOG]       Current Time: 11:18:15
[2025-10-23T05:48:15.568Z] [LOG]       Expected Hours (scheduled → now): 2.80h
[2025-10-23T05:48:15.568Z] [LOG]       Actual Hours (check-in → now): 2.80h
[2025-10-23T05:48:15.569Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:48:15.569Z] [LOG]       Weekday: 121.80h
[2025-10-23T05:48:15.569Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:48:15.570Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:15.570Z] [LOG]       Total Expected: 135.30h
[2025-10-23T05:48:15.570Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:48:15.570Z] [LOG]       Weekday: 28.30h (includes 2.80h live)
[2025-10-23T05:48:15.571Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:48:15.571Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:15.571Z] [LOG]       Total Actual: 32.80h
[2025-10-23T05:48:15.572Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:48:15.572Z] [LOG]       Weekday: 121.80h × Rs.117.65 = Rs.14330.28
[2025-10-23T05:48:15.572Z] [LOG]       Saturday: 13.50h × Rs.222.22 = Rs.2999.97
[2025-10-23T05:48:15.573Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:15.573Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:15.573Z] [LOG]       Total Expected Earned: Rs.17330.25
[2025-10-23T05:48:15.573Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:48:15.574Z] [LOG]       Weekday: 28.30h × Rs.117.65 = Rs.3330.00
[2025-10-23T05:48:15.574Z] [LOG]       Saturday: 4.50h × Rs.222.22 = Rs.999.99
[2025-10-23T05:48:15.574Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:15.574Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:15.575Z] [LOG]       Total Actual Earned: Rs.4329.99
[2025-10-23T05:48:15.575Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:48:15.576Z] [LOG]       Calculated At: Oct 23, 2025, 11:18:15
[2025-10-23T05:48:15.576Z] [LOG]       Expected Earned (until NOW): Rs.17330.25
[2025-10-23T05:48:15.576Z] [LOG]       Actual Earned (until NOW): Rs.4329.99
[2025-10-23T05:48:15.577Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:15.577Z] [LOG]       Attendance Deduction: Rs.13000.26
[2025-10-23T05:48:15.577Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:48:15.577Z] [LOG]       📉 Shortfall: 102.50 hours (75.01% of expected)
[2025-10-23T05:48:15.578Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:48:15.578Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:48:15.578Z] [LOG]    Base Salary (Full): Rs.25000.00
[2025-10-23T05:48:15.578Z] [LOG]    Actual Earned Base: Rs.4329.99
[2025-10-23T05:48:15.579Z] [LOG]    Attendance Shortfall: Rs.13000.26
[2025-10-23T05:48:15.579Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:48:15.580Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:48:15.580Z] [LOG]    Gross Salary: 4329.993705527778
[2025-10-23T05:48:15.580Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:48:15.581Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:48:15.581Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.582Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:48:15.582Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.583Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:48:15.583Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.583Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:48:15.583Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.584Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:48:15.584Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.584Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:48:15.584Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.584Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:48:15.584Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.584Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:48:15.584Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.585Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:48:15.585Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.585Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:48:15.585Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.585Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:48:15.586Z] [LOG]    EPF/ETF calculated on: Rs.4329.99
[2025-10-23T05:48:15.586Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:48:15.586Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:48:15.586Z] [LOG] 💰 GROSS CALCULATION for Ratheeshanan null:
[2025-10-23T05:48:15.587Z] [LOG]    Base Salary: 25000
[2025-10-23T05:48:15.587Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:48:15.587Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:48:15.587Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.587Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:48:15.587Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.588Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:48:15.588Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:15.806Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:48:15.806Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:15.807Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:48:15.807Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:48:15.807Z] [LOG]    Actual Earned Base: Rs.4329.99
[2025-10-23T05:48:15.807Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:48:15.808Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:48:15.808Z] [LOG]    = Gross Salary: Rs.4329.99
[2025-10-23T05:48:15.808Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:48:15.809Z] [LOG]    Attendance Shortfall (Info): Rs.13000.26
[2025-10-23T05:48:15.809Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:48:15.809Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:15.809Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:48:15.809Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:48:15.810Z] [LOG]    Gross Salary: Rs.4329.99
[2025-10-23T05:48:15.810Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:48:15.810Z] [LOG]    = NET SALARY: Rs.4329.99
[2025-10-23T05:48:15.810Z] [LOG] 
💾 Database Update:
[2025-10-23T05:48:15.810Z] [LOG]    Total Earnings: Rs.4329.99 (Base: 4329.99 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:48:15.811Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:48:16.005Z] [LOG] 
📝 Components to save:
[2025-10-23T05:48:16.005Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:48:16.006Z] [LOG]    Deduction components: 1
[2025-10-23T05:48:16.006Z] [LOG] Creating components for record aa224e99-7eae-4b87-8698-e4ba22dffd02: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:48:16.006Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 4329.993705527778
}
[2025-10-23T05:48:16.206Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:48:16.442Z] [LOG] Created payroll_record_component: 2f916613-8dcf-461c-a977-c15ff5e08b8c for Base Salary
[2025-10-23T05:48:16.444Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 13000.255000000001
}
[2025-10-23T05:48:16.693Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:48:16.975Z] [LOG] Created payroll_record_component: 61092cd8-e589-47bc-8504-f1a42e68abbe for Attendance Shortfall (Info)
[2025-10-23T05:48:17.690Z] [LOG] ✅ Financial balances updated successfully for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:17.690Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:48:17.691Z] [LOG] 
======================================================================
[2025-10-23T05:48:17.691Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ratheeshanan null
[2025-10-23T05:48:17.691Z] [LOG] ======================================================================
[2025-10-23T05:48:17.692Z] [LOG]    Base Salary (Full): Rs.25000.00
[2025-10-23T05:48:17.692Z] [LOG]    Actual Earned Base (Attendance-based): Rs.4329.99
[2025-10-23T05:48:17.692Z] [LOG]    Attendance Shortfall: Rs.13000.26
[2025-10-23T05:48:17.693Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:17.693Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:17.693Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:48:17.694Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:17.694Z] [LOG]    GROSS SALARY: Rs.4329.99
[2025-10-23T05:48:17.694Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:17.695Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:48:17.695Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:48:17.695Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:48:17.696Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:48:17.696Z] [LOG]       - Attendance Shortfall (Info): Rs.13000.26
[2025-10-23T05:48:17.697Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:17.697Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:17.698Z] [LOG]    NET SALARY: Rs.4329.99
[2025-10-23T05:48:17.698Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:48:17.698Z] [LOG] ======================================================================

[2025-10-23T05:48:17.699Z] [LOG] ✅ Ratheeshanan null: Calculation completed successfully
[2025-10-23T05:48:17.699Z] [LOG] 📊 Progress: 20/34 (58.8%)
[2025-10-23T05:48:17.699Z] [LOG] 
🧮 Processing: Faizan Faizan (EMP000003)
[2025-10-23T05:48:17.700Z] [LOG] 📋 Record ID: b38462a8-9a4f-4a33-9551-74e193edb7f3
[2025-10-23T05:48:17.700Z] [LOG] 
======================================================================
[2025-10-23T05:48:17.700Z] [LOG] 🧮 CALCULATING PAYROLL: Faizan Faizan (EMP000003)
[2025-10-23T05:48:17.701Z] [LOG] ======================================================================
[2025-10-23T05:48:18.777Z] [LOG] 🔍 Component filtering for employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-23T05:48:18.777Z] [LOG]    Total components: 13
[2025-10-23T05:48:18.777Z] [LOG]    Applicable components: 13
[2025-10-23T05:48:18.778Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T05:48:20.689Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:48:20.690Z] [LOG] 🔄 Processing financial records for employee 0143a057-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:48:20.938Z] [LOG] 📊 Found 0 active loans for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:21.181Z] [LOG] 📊 Found 0 active advances for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:21.414Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:21.414Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:48:21.414Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:48:21.650Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:48:21.651Z] [LOG]    Employee ID: 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:21.651Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:48:21.652Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:48:21.652Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:48:21.887Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:48:21.887Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:48:21.888Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:48:21.888Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:48:21.888Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:48:21.889Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:48:21.889Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:48:22.563Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:48:22.564Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:48:22.778Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:48:22.778Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:48:22.778Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:48:22.779Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:48:22.779Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:48:22.779Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:48:22.780Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:48:22.781Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:48:23.006Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:48:23.007Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:48:23.007Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:48:23.007Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:48:23.254Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:48:23.255Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:48:23.255Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:48:23.256Z] [LOG]       Current Time: 11:18:23
[2025-10-23T05:48:23.257Z] [LOG]       Expected Hours (scheduled → now): 2.81h
[2025-10-23T05:48:23.257Z] [LOG]       Actual Hours (check-in → now): 2.81h
[2025-10-23T05:48:23.257Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:48:23.258Z] [LOG]       Weekday: 121.81h
[2025-10-23T05:48:23.258Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:48:23.258Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:23.259Z] [LOG]       Total Expected: 135.31h
[2025-10-23T05:48:23.259Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:48:23.259Z] [LOG]       Weekday: 28.31h (includes 2.81h live)
[2025-10-23T05:48:23.260Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:48:23.260Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:23.260Z] [LOG]       Total Actual: 32.81h
[2025-10-23T05:48:23.260Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:48:23.261Z] [LOG]       Weekday: 121.81h × Rs.235.29 = Rs.28659.84
[2025-10-23T05:48:23.261Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:48:23.261Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:23.261Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:23.261Z] [LOG]       Total Expected Earned: Rs.34659.78
[2025-10-23T05:48:23.262Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:48:23.262Z] [LOG]       Weekday: 28.31h × Rs.235.29 = Rs.6660.23
[2025-10-23T05:48:23.262Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:48:23.262Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:23.263Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:23.263Z] [LOG]       Total Actual Earned: Rs.8660.21
[2025-10-23T05:48:23.264Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:48:23.264Z] [LOG]       Calculated At: Oct 23, 2025, 11:18:23
[2025-10-23T05:48:23.264Z] [LOG]       Expected Earned (until NOW): Rs.34659.78
[2025-10-23T05:48:23.264Z] [LOG]       Actual Earned (until NOW): Rs.8660.21
[2025-10-23T05:48:23.264Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:23.265Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:48:23.265Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:48:23.265Z] [LOG]       📉 Shortfall: 102.50 hours (75.01% of expected)
[2025-10-23T05:48:23.265Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:48:23.265Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:48:23.266Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:48:23.266Z] [LOG]    Actual Earned Base: Rs.8660.21
[2025-10-23T05:48:23.266Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:48:23.267Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:48:23.267Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:48:23.267Z] [LOG]    Gross Salary: 8660.206842683334
[2025-10-23T05:48:23.268Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:48:23.268Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:48:23.268Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.269Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:48:23.269Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.269Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:48:23.270Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.271Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:48:23.271Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.271Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:48:23.271Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.272Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:48:23.272Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.272Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:48:23.272Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.273Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:48:23.273Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.273Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:48:23.273Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.274Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:48:23.274Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.274Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:48:23.275Z] [LOG]    EPF/ETF calculated on: Rs.8660.21
[2025-10-23T05:48:23.275Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:48:23.275Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:48:23.276Z] [LOG] 💰 GROSS CALCULATION for Faizan Faizan:
[2025-10-23T05:48:23.276Z] [LOG]    Base Salary: 50000
[2025-10-23T05:48:23.276Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:48:23.276Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:48:23.277Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.277Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:48:23.277Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.278Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:48:23.278Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:23.487Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:48:23.488Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:23.488Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:48:23.488Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:48:23.488Z] [LOG]    Actual Earned Base: Rs.8660.21
[2025-10-23T05:48:23.489Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:48:23.489Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:48:23.489Z] [LOG]    = Gross Salary: Rs.8660.21
[2025-10-23T05:48:23.490Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:48:23.490Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:48:23.490Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:48:23.491Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:23.491Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:48:23.491Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:48:23.492Z] [LOG]    Gross Salary: Rs.8660.21
[2025-10-23T05:48:23.492Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:48:23.492Z] [LOG]    = NET SALARY: Rs.8660.21
[2025-10-23T05:48:23.492Z] [LOG] 
💾 Database Update:
[2025-10-23T05:48:23.493Z] [LOG]    Total Earnings: Rs.8660.21 (Base: 8660.21 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:48:23.493Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:48:23.736Z] [LOG] 
📝 Components to save:
[2025-10-23T05:48:23.736Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:48:23.736Z] [LOG]    Deduction components: 1
[2025-10-23T05:48:23.737Z] [LOG] Creating components for record b38462a8-9a4f-4a33-9551-74e193edb7f3: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:48:23.737Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8660.206842683334
}
[2025-10-23T05:48:23.968Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:48:24.208Z] [LOG] Created payroll_record_component: 9f139f13-fb95-4bbf-8cf7-44a101c039e2 for Base Salary
[2025-10-23T05:48:24.209Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:48:24.464Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:48:24.692Z] [LOG] Created payroll_record_component: 1eab6775-abbc-4578-b365-f2fce1091a39 for Attendance Shortfall (Info)
[2025-10-23T05:48:25.165Z] [LOG] ✅ Financial balances updated successfully for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:25.165Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:48:25.165Z] [LOG] 
======================================================================
[2025-10-23T05:48:25.166Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Faizan Faizan
[2025-10-23T05:48:25.166Z] [LOG] ======================================================================
[2025-10-23T05:48:25.166Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:48:25.167Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8660.21
[2025-10-23T05:48:25.167Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:48:25.167Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:25.168Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:25.168Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:48:25.168Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:25.169Z] [LOG]    GROSS SALARY: Rs.8660.21
[2025-10-23T05:48:25.169Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:25.169Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:48:25.169Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:48:25.170Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:48:25.170Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:48:25.170Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:48:25.170Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:25.171Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:25.171Z] [LOG]    NET SALARY: Rs.8660.21
[2025-10-23T05:48:25.171Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:48:25.172Z] [LOG] ======================================================================

[2025-10-23T05:48:25.172Z] [LOG] ✅ Faizan Faizan: Calculation completed successfully
[2025-10-23T05:48:25.172Z] [LOG] 📊 Progress: 21/34 (61.8%)
[2025-10-23T05:48:25.172Z] [LOG] 
🧮 Processing: Safna Nawas null (EMP000021)
[2025-10-23T05:48:25.173Z] [LOG] 📋 Record ID: b3a9fdff-0caa-4b38-98e0-a0cbfae2e6a7
[2025-10-23T05:48:25.173Z] [LOG] 
======================================================================
[2025-10-23T05:48:25.173Z] [LOG] 🧮 CALCULATING PAYROLL: Safna Nawas null (EMP000021)
[2025-10-23T05:48:25.173Z] [LOG] ======================================================================
[2025-10-23T05:48:26.134Z] [LOG] 🔍 Component filtering for employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-23T05:48:26.134Z] [LOG]    Total components: 13
[2025-10-23T05:48:26.135Z] [LOG]    Applicable components: 13
[2025-10-23T05:48:26.135Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:48:27.456Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:48:27.457Z] [LOG] 🔄 Processing financial records for employee 0143c977-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:48:27.652Z] [LOG] 📊 Found 0 active loans for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:27.903Z] [LOG] 📊 Found 0 active advances for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:28.133Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:28.134Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:48:28.134Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:48:28.374Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:48:28.374Z] [LOG]    Employee ID: 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:28.374Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:48:28.375Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:48:28.375Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:48:28.606Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:48:28.607Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:48:28.607Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:48:28.607Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:48:28.607Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:48:28.608Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:48:28.608Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:48:29.333Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:48:29.334Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:48:29.566Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:48:29.567Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:48:29.567Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:48:29.567Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:48:29.567Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:48:29.568Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:48:29.568Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:48:29.568Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:48:29.812Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:48:29.813Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:48:29.813Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:48:29.814Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:48:30.055Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:48:30.055Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:48:30.055Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:48:30.056Z] [LOG]       Current Time: 11:18:30
[2025-10-23T05:48:30.057Z] [LOG]       Expected Hours (scheduled → now): 2.81h
[2025-10-23T05:48:30.057Z] [LOG]       Actual Hours (check-in → now): 2.81h
[2025-10-23T05:48:30.057Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:48:30.058Z] [LOG]       Weekday: 121.81h
[2025-10-23T05:48:30.058Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:48:30.059Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:30.059Z] [LOG]       Total Expected: 135.31h
[2025-10-23T05:48:30.059Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:48:30.060Z] [LOG]       Weekday: 28.31h (includes 2.81h live)
[2025-10-23T05:48:30.060Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:48:30.061Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:30.061Z] [LOG]       Total Actual: 32.81h
[2025-10-23T05:48:30.061Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:48:30.061Z] [LOG]       Weekday: 121.81h × Rs.235.29 = Rs.28660.29
[2025-10-23T05:48:30.062Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:48:30.062Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:30.062Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:30.063Z] [LOG]       Total Expected Earned: Rs.34660.23
[2025-10-23T05:48:30.063Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:48:30.064Z] [LOG]       Weekday: 28.31h × Rs.235.29 = Rs.6660.67
[2025-10-23T05:48:30.064Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:48:30.064Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:30.064Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:30.065Z] [LOG]       Total Actual Earned: Rs.8660.65
[2025-10-23T05:48:30.065Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:48:30.066Z] [LOG]       Calculated At: Oct 23, 2025, 11:18:30
[2025-10-23T05:48:30.066Z] [LOG]       Expected Earned (until NOW): Rs.34660.23
[2025-10-23T05:48:30.066Z] [LOG]       Actual Earned (until NOW): Rs.8660.65
[2025-10-23T05:48:30.067Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:30.067Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:48:30.067Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:48:30.068Z] [LOG]       📉 Shortfall: 102.50 hours (75.01% of expected)
[2025-10-23T05:48:30.068Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:48:30.068Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:48:30.069Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:48:30.069Z] [LOG]    Actual Earned Base: Rs.8660.65
[2025-10-23T05:48:30.069Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:48:30.070Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:48:30.070Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:48:30.071Z] [LOG]    Gross Salary: 8660.651344708333
[2025-10-23T05:48:30.071Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:48:30.071Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:48:30.072Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.072Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:48:30.072Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.072Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:48:30.073Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.073Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:48:30.073Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.074Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:48:30.074Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.074Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:48:30.075Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.075Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:48:30.075Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.075Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:48:30.076Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.076Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:48:30.076Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.077Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:48:30.077Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.077Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:48:30.078Z] [LOG]    EPF/ETF calculated on: Rs.8660.65
[2025-10-23T05:48:30.078Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:48:30.078Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:48:30.078Z] [LOG] 💰 GROSS CALCULATION for Safna Nawas null:
[2025-10-23T05:48:30.079Z] [LOG]    Base Salary: 50000
[2025-10-23T05:48:30.079Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:48:30.079Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:48:30.080Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.080Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:48:30.080Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.081Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:48:30.081Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:30.392Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:48:30.393Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:30.393Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:48:30.393Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:48:30.394Z] [LOG]    Actual Earned Base: Rs.8660.65
[2025-10-23T05:48:30.394Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:48:30.394Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:48:30.395Z] [LOG]    = Gross Salary: Rs.8660.65
[2025-10-23T05:48:30.395Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:48:30.395Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:48:30.396Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:48:30.396Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:30.396Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:48:30.397Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:48:30.397Z] [LOG]    Gross Salary: Rs.8660.65
[2025-10-23T05:48:30.397Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:48:30.398Z] [LOG]    = NET SALARY: Rs.8660.65
[2025-10-23T05:48:30.398Z] [LOG] 
💾 Database Update:
[2025-10-23T05:48:30.398Z] [LOG]    Total Earnings: Rs.8660.65 (Base: 8660.65 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:48:30.399Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:48:30.606Z] [LOG] 
📝 Components to save:
[2025-10-23T05:48:30.606Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:48:30.606Z] [LOG]    Deduction components: 1
[2025-10-23T05:48:30.607Z] [LOG] Creating components for record b3a9fdff-0caa-4b38-98e0-a0cbfae2e6a7: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:48:30.607Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8660.651344708333
}
[2025-10-23T05:48:30.938Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:48:31.165Z] [LOG] Created payroll_record_component: 4d749b11-b2b2-4c02-905b-782ce62004bc for Base Salary
[2025-10-23T05:48:31.165Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:48:31.422Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:48:31.647Z] [LOG] Created payroll_record_component: 03c3114e-ac16-4030-9ee4-a3dfa341ae6e for Attendance Shortfall (Info)
[2025-10-23T05:48:32.055Z] [LOG] ✅ Financial balances updated successfully for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:32.055Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:48:32.056Z] [LOG] 
======================================================================
[2025-10-23T05:48:32.056Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Safna Nawas null
[2025-10-23T05:48:32.056Z] [LOG] ======================================================================
[2025-10-23T05:48:32.057Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:48:32.057Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8660.65
[2025-10-23T05:48:32.057Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:48:32.058Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:32.058Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:32.058Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:48:32.059Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:32.059Z] [LOG]    GROSS SALARY: Rs.8660.65
[2025-10-23T05:48:32.059Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:32.060Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:48:32.060Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:48:32.060Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:48:32.060Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:48:32.061Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:48:32.061Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:32.061Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:32.062Z] [LOG]    NET SALARY: Rs.8660.65
[2025-10-23T05:48:32.062Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:48:32.062Z] [LOG] ======================================================================

[2025-10-23T05:48:32.063Z] [LOG] ✅ Safna Nawas null: Calculation completed successfully
[2025-10-23T05:48:32.063Z] [LOG] 📊 Progress: 22/34 (64.7%)
[2025-10-23T05:48:32.063Z] [LOG] 
🧮 Processing: Ammaar Ilham (EMP000023)
[2025-10-23T05:48:32.064Z] [LOG] 📋 Record ID: cade9343-ea50-43ad-b0dc-c94ad255eec7
[2025-10-23T05:48:32.064Z] [LOG] 
======================================================================
[2025-10-23T05:48:32.064Z] [LOG] 🧮 CALCULATING PAYROLL: Ammaar Ilham (EMP000023)
[2025-10-23T05:48:32.065Z] [LOG] ======================================================================
[2025-10-23T05:48:33.042Z] [LOG] 🔍 Component filtering for employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-23T05:48:33.043Z] [LOG]    Total components: 13
[2025-10-23T05:48:33.043Z] [LOG]    Applicable components: 13
[2025-10-23T05:48:33.043Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:48:34.768Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:48:34.769Z] [LOG] 🔄 Processing financial records for employee 0143de00-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:48:35.015Z] [LOG] 📊 Found 0 active loans for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:35.248Z] [LOG] 📊 Found 0 active advances for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:35.507Z] [LOG] 📊 Found 0 approved bonuses for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:35.507Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:48:35.508Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:48:35.731Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:48:35.731Z] [LOG]    Employee ID: 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:35.732Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:48:35.732Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:48:35.733Z] [LOG]    Base Salary (Full Month): Rs.70000.00
[2025-10-23T05:48:35.974Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:48:35.974Z] [LOG]       Daily Salary: Rs.2800.00
[2025-10-23T05:48:35.975Z] [LOG]       Weekday Hourly Rate: Rs.329.41
[2025-10-23T05:48:35.975Z] [LOG]       Saturday Hourly Rate: Rs.622.22
[2025-10-23T05:48:35.975Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:48:35.976Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:48:35.976Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:48:36.697Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:48:36.697Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:48:36.941Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:48:36.941Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:48:36.941Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:48:36.941Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:48:36.942Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:48:36.942Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:48:36.942Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:48:36.942Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:48:37.165Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:48:37.166Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:48:37.166Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:48:37.166Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:48:37.406Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:48:37.407Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:48:37.407Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:48:37.408Z] [LOG]       Current Time: 11:18:37
[2025-10-23T05:48:37.408Z] [LOG]       Expected Hours (scheduled → now): 2.81h
[2025-10-23T05:48:37.408Z] [LOG]       Actual Hours (check-in → now): 2.81h
[2025-10-23T05:48:37.409Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:48:37.409Z] [LOG]       Weekday: 121.81h
[2025-10-23T05:48:37.410Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:48:37.410Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:37.410Z] [LOG]       Total Expected: 135.31h
[2025-10-23T05:48:37.411Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:48:37.411Z] [LOG]       Weekday: 28.31h (includes 2.81h live)
[2025-10-23T05:48:37.411Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:48:37.411Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:37.412Z] [LOG]       Total Actual: 32.81h
[2025-10-23T05:48:37.412Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:48:37.412Z] [LOG]       Weekday: 121.81h × Rs.329.41 = Rs.40125.56
[2025-10-23T05:48:37.413Z] [LOG]       Saturday: 13.50h × Rs.622.22 = Rs.8399.97
[2025-10-23T05:48:37.414Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:37.414Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:37.415Z] [LOG]       Total Expected Earned: Rs.48525.53
[2025-10-23T05:48:37.415Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:48:37.415Z] [LOG]       Weekday: 28.31h × Rs.329.41 = Rs.9325.73
[2025-10-23T05:48:37.416Z] [LOG]       Saturday: 4.50h × Rs.622.22 = Rs.2799.99
[2025-10-23T05:48:37.416Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:37.416Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:37.417Z] [LOG]       Total Actual Earned: Rs.12125.72
[2025-10-23T05:48:37.418Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:48:37.418Z] [LOG]       Calculated At: Oct 23, 2025, 11:18:37
[2025-10-23T05:48:37.418Z] [LOG]       Expected Earned (until NOW): Rs.48525.53
[2025-10-23T05:48:37.419Z] [LOG]       Actual Earned (until NOW): Rs.12125.72
[2025-10-23T05:48:37.419Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:37.419Z] [LOG]       Attendance Deduction: Rs.36399.82
[2025-10-23T05:48:37.420Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:48:37.420Z] [LOG]       📉 Shortfall: 102.50 hours (75.01% of expected)
[2025-10-23T05:48:37.420Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:48:37.421Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:48:37.421Z] [LOG]    Base Salary (Full): Rs.70000.00
[2025-10-23T05:48:37.421Z] [LOG]    Actual Earned Base: Rs.12125.72
[2025-10-23T05:48:37.422Z] [LOG]    Attendance Shortfall: Rs.36399.82
[2025-10-23T05:48:37.422Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:48:37.423Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:48:37.423Z] [LOG]    Gross Salary: 12125.715752905557
[2025-10-23T05:48:37.423Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:48:37.424Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:48:37.424Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.424Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:48:37.425Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.425Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:48:37.425Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.425Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:48:37.426Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.426Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:48:37.426Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.427Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:48:37.427Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.427Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:48:37.427Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.428Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:48:37.428Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.428Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:48:37.429Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.429Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:48:37.429Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.430Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:48:37.430Z] [LOG]    EPF/ETF calculated on: Rs.12125.72
[2025-10-23T05:48:37.430Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:48:37.430Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:48:37.430Z] [LOG] 💰 GROSS CALCULATION for Ammaar Ilham:
[2025-10-23T05:48:37.430Z] [LOG]    Base Salary: 70000
[2025-10-23T05:48:37.431Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:48:37.431Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:48:37.431Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.431Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:48:37.431Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.431Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:48:37.431Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:37.656Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:48:37.656Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:37.656Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:48:37.657Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:48:37.657Z] [LOG]    Actual Earned Base: Rs.12125.72
[2025-10-23T05:48:37.657Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:48:37.657Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:48:37.658Z] [LOG]    = Gross Salary: Rs.12125.72
[2025-10-23T05:48:37.658Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:48:37.658Z] [LOG]    Attendance Shortfall (Info): Rs.36399.82
[2025-10-23T05:48:37.659Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:48:37.659Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:37.659Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:48:37.659Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:48:37.660Z] [LOG]    Gross Salary: Rs.12125.72
[2025-10-23T05:48:37.660Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:48:37.660Z] [LOG]    = NET SALARY: Rs.12125.72
[2025-10-23T05:48:37.661Z] [LOG] 
💾 Database Update:
[2025-10-23T05:48:37.661Z] [LOG]    Total Earnings: Rs.12125.72 (Base: 12125.72 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:48:37.661Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:48:37.890Z] [LOG] 
📝 Components to save:
[2025-10-23T05:48:37.891Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:48:37.891Z] [LOG]    Deduction components: 1
[2025-10-23T05:48:37.891Z] [LOG] Creating components for record cade9343-ea50-43ad-b0dc-c94ad255eec7: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:48:37.892Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 12125.715752905557
}
[2025-10-23T05:48:38.168Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:48:38.614Z] [LOG] Created payroll_record_component: 1b04eee6-cce7-461f-925c-1020de62d48a for Base Salary
[2025-10-23T05:48:38.614Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 36399.815
}
[2025-10-23T05:48:38.859Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:48:39.112Z] [LOG] Created payroll_record_component: 3a1e8f8f-631d-4e18-8f2f-e26ae7bca4ac for Attendance Shortfall (Info)
[2025-10-23T05:48:39.727Z] [LOG] ✅ Financial balances updated successfully for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:39.728Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:48:39.728Z] [LOG] 
======================================================================
[2025-10-23T05:48:39.728Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ammaar Ilham
[2025-10-23T05:48:39.729Z] [LOG] ======================================================================
[2025-10-23T05:48:39.729Z] [LOG]    Base Salary (Full): Rs.70000.00
[2025-10-23T05:48:39.729Z] [LOG]    Actual Earned Base (Attendance-based): Rs.12125.72
[2025-10-23T05:48:39.730Z] [LOG]    Attendance Shortfall: Rs.36399.82
[2025-10-23T05:48:39.730Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:39.730Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:39.731Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:48:39.731Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:39.731Z] [LOG]    GROSS SALARY: Rs.12125.72
[2025-10-23T05:48:39.731Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:39.732Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:48:39.732Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:48:39.732Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:48:39.732Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:48:39.733Z] [LOG]       - Attendance Shortfall (Info): Rs.36399.82
[2025-10-23T05:48:39.733Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:39.733Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:39.733Z] [LOG]    NET SALARY: Rs.12125.72
[2025-10-23T05:48:39.734Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:48:39.734Z] [LOG] ======================================================================

[2025-10-23T05:48:39.734Z] [LOG] ✅ Ammaar Ilham: Calculation completed successfully
[2025-10-23T05:48:39.735Z] [LOG] 📊 Progress: 23/34 (67.6%)
[2025-10-23T05:48:39.735Z] [LOG] 
🧮 Processing: Saru null (EMP000022)
[2025-10-23T05:48:39.735Z] [LOG] 📋 Record ID: ceffd135-063d-4732-a871-1167aa11ae52
[2025-10-23T05:48:39.736Z] [LOG] 
======================================================================
[2025-10-23T05:48:39.736Z] [LOG] 🧮 CALCULATING PAYROLL: Saru null (EMP000022)
[2025-10-23T05:48:39.736Z] [LOG] ======================================================================
[2025-10-23T05:48:40.696Z] [LOG] 🔍 Component filtering for employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-23T05:48:40.697Z] [LOG]    Total components: 13
[2025-10-23T05:48:40.697Z] [LOG]    Applicable components: 13
[2025-10-23T05:48:40.697Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:48:42.163Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:48:42.163Z] [LOG] 🔄 Processing financial records for employee 0143cc7e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:48:42.413Z] [LOG] 📊 Found 0 active loans for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:42.631Z] [LOG] 📊 Found 0 active advances for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:42.843Z] [LOG] 📊 Found 0 approved bonuses for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:42.844Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:48:42.844Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:48:43.051Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:48:43.051Z] [LOG]    Employee ID: 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:43.051Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:48:43.052Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:48:43.052Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:48:43.284Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:48:43.285Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:48:43.285Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:48:43.285Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:48:43.286Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:48:43.286Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:48:43.286Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:48:43.975Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:48:43.976Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:48:44.218Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:48:44.219Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:48:44.219Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:48:44.219Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:48:44.220Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:48:44.220Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:48:44.220Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:48:44.221Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:48:44.469Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:48:44.470Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:48:44.470Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:48:44.471Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:48:44.686Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:48:44.687Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:48:44.688Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:48:44.689Z] [LOG]       Current Time: 11:18:44
[2025-10-23T05:48:44.689Z] [LOG]       Expected Hours (scheduled → now): 2.81h
[2025-10-23T05:48:44.689Z] [LOG]       Actual Hours (check-in → now): 2.81h
[2025-10-23T05:48:44.690Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:48:44.690Z] [LOG]       Weekday: 121.81h
[2025-10-23T05:48:44.690Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:48:44.691Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:44.691Z] [LOG]       Total Expected: 135.31h
[2025-10-23T05:48:44.691Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:48:44.692Z] [LOG]       Weekday: 28.31h (includes 2.81h live)
[2025-10-23T05:48:44.692Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:48:44.693Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:44.693Z] [LOG]       Total Actual: 32.81h
[2025-10-23T05:48:44.693Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:48:44.693Z] [LOG]       Weekday: 121.81h × Rs.235.29 = Rs.28661.24
[2025-10-23T05:48:44.694Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:48:44.694Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:44.694Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:44.695Z] [LOG]       Total Expected Earned: Rs.34661.18
[2025-10-23T05:48:44.695Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:48:44.695Z] [LOG]       Weekday: 28.31h × Rs.235.29 = Rs.6661.63
[2025-10-23T05:48:44.696Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:48:44.696Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:44.696Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:44.697Z] [LOG]       Total Actual Earned: Rs.8661.61
[2025-10-23T05:48:44.698Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:48:44.698Z] [LOG]       Calculated At: Oct 23, 2025, 11:18:44
[2025-10-23T05:48:44.698Z] [LOG]       Expected Earned (until NOW): Rs.34661.18
[2025-10-23T05:48:44.699Z] [LOG]       Actual Earned (until NOW): Rs.8661.61
[2025-10-23T05:48:44.699Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:44.699Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:48:44.699Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:48:44.700Z] [LOG]       📉 Shortfall: 102.50 hours (75.01% of expected)
[2025-10-23T05:48:44.700Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:48:44.700Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:48:44.701Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:48:44.701Z] [LOG]    Actual Earned Base: Rs.8661.61
[2025-10-23T05:48:44.702Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:48:44.702Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:48:44.703Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:48:44.703Z] [LOG]    Gross Salary: 8661.607602483333
[2025-10-23T05:48:44.703Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:48:44.704Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:48:44.704Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.704Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:48:44.704Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.705Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:48:44.705Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.705Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:48:44.706Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.706Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:48:44.706Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.707Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:48:44.707Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.707Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:48:44.708Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.708Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:48:44.708Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.709Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:48:44.709Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.710Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:48:44.710Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.710Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:48:44.711Z] [LOG]    EPF/ETF calculated on: Rs.8661.61
[2025-10-23T05:48:44.711Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:48:44.711Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:48:44.712Z] [LOG] 💰 GROSS CALCULATION for Saru null:
[2025-10-23T05:48:44.712Z] [LOG]    Base Salary: 50000
[2025-10-23T05:48:44.713Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:48:44.713Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:48:44.714Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.714Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:48:44.714Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.714Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:48:44.715Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:44.931Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:48:44.932Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:44.932Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:48:44.932Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:48:44.933Z] [LOG]    Actual Earned Base: Rs.8661.61
[2025-10-23T05:48:44.933Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:48:44.933Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:48:44.934Z] [LOG]    = Gross Salary: Rs.8661.61
[2025-10-23T05:48:44.934Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:48:44.934Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:48:44.934Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:48:44.935Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:44.935Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:48:44.935Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:48:44.936Z] [LOG]    Gross Salary: Rs.8661.61
[2025-10-23T05:48:44.936Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:48:44.936Z] [LOG]    = NET SALARY: Rs.8661.61
[2025-10-23T05:48:44.936Z] [LOG] 
💾 Database Update:
[2025-10-23T05:48:44.937Z] [LOG]    Total Earnings: Rs.8661.61 (Base: 8661.61 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:48:44.937Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:48:45.164Z] [LOG] 
📝 Components to save:
[2025-10-23T05:48:45.165Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:48:45.165Z] [LOG]    Deduction components: 1
[2025-10-23T05:48:45.165Z] [LOG] Creating components for record ceffd135-063d-4732-a871-1167aa11ae52: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:48:45.166Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8661.607602483333
}
[2025-10-23T05:48:45.378Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:48:45.580Z] [LOG] Created payroll_record_component: 77ac1968-b315-48eb-bb35-60507dbab769 for Base Salary
[2025-10-23T05:48:45.581Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T05:48:45.820Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:48:46.025Z] [LOG] Created payroll_record_component: 73f8a261-2d3b-4cda-b16f-8ae8dab7074a for Attendance Shortfall (Info)
[2025-10-23T05:48:46.448Z] [LOG] ✅ Financial balances updated successfully for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:46.448Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:48:46.449Z] [LOG] 
======================================================================
[2025-10-23T05:48:46.449Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Saru null
[2025-10-23T05:48:46.449Z] [LOG] ======================================================================
[2025-10-23T05:48:46.450Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:48:46.450Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8661.61
[2025-10-23T05:48:46.450Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:48:46.450Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:46.451Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:46.451Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:48:46.451Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:46.452Z] [LOG]    GROSS SALARY: Rs.8661.61
[2025-10-23T05:48:46.452Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:46.452Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:48:46.453Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:48:46.453Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:48:46.453Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:48:46.453Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:48:46.454Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:46.454Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:46.454Z] [LOG]    NET SALARY: Rs.8661.61
[2025-10-23T05:48:46.454Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:48:46.455Z] [LOG] ======================================================================

[2025-10-23T05:48:46.455Z] [LOG] ✅ Saru null: Calculation completed successfully
[2025-10-23T05:48:46.455Z] [LOG] 📊 Progress: 24/34 (70.6%)
[2025-10-23T05:48:46.456Z] [LOG] 
🧮 Processing: Sithira null (EMP000039)
[2025-10-23T05:48:46.456Z] [LOG] 📋 Record ID: cf466627-8f8b-4697-82b0-a723d7b42bf8
[2025-10-23T05:48:46.456Z] [LOG] 
======================================================================
[2025-10-23T05:48:46.457Z] [LOG] 🧮 CALCULATING PAYROLL: Sithira null (EMP000039)
[2025-10-23T05:48:46.457Z] [LOG] ======================================================================
[2025-10-23T05:48:47.577Z] [LOG] 🔍 Component filtering for employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-23T05:48:47.577Z] [LOG]    Total components: 13
[2025-10-23T05:48:47.577Z] [LOG]    Applicable components: 13
[2025-10-23T05:48:47.578Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T05:48:49.005Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:48:49.006Z] [LOG] 🔄 Processing financial records for employee 01441e19-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:48:49.249Z] [LOG] 📊 Found 0 active loans for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:49.490Z] [LOG] 📊 Found 0 active advances for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:49.734Z] [LOG] 📊 Found 0 approved bonuses for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:49.734Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:48:49.735Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:48:49.965Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:48:49.966Z] [LOG]    Employee ID: 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:49.966Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:48:49.966Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:48:49.967Z] [LOG]    Base Salary (Full Month): Rs.40000.00
[2025-10-23T05:48:50.208Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:48:50.209Z] [LOG]       Daily Salary: Rs.1600.00
[2025-10-23T05:48:50.209Z] [LOG]       Weekday Hourly Rate: Rs.188.24
[2025-10-23T05:48:50.209Z] [LOG]       Saturday Hourly Rate: Rs.355.56
[2025-10-23T05:48:50.210Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:48:50.210Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:48:50.210Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:48:50.847Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:48:50.847Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:48:51.071Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:48:51.072Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:48:51.072Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:48:51.072Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:48:51.073Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:48:51.073Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:48:51.074Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:48:51.074Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:48:51.290Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:48:51.290Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:48:51.291Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:48:51.291Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:48:51.488Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:48:51.488Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:48:51.488Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:48:51.489Z] [LOG]       Current Time: 11:18:51
[2025-10-23T05:48:51.490Z] [LOG]       Expected Hours (scheduled → now): 2.81h
[2025-10-23T05:48:51.490Z] [LOG]       Actual Hours (check-in → now): 2.81h
[2025-10-23T05:48:51.490Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:48:51.490Z] [LOG]       Weekday: 121.81h
[2025-10-23T05:48:51.491Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:48:51.491Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:51.491Z] [LOG]       Total Expected: 135.31h
[2025-10-23T05:48:51.491Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:48:51.492Z] [LOG]       Weekday: 28.31h (includes 2.81h live)
[2025-10-23T05:48:51.492Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:48:51.492Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:51.492Z] [LOG]       Total Actual: 32.81h
[2025-10-23T05:48:51.493Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:48:51.493Z] [LOG]       Weekday: 121.81h × Rs.188.24 = Rs.22930.32
[2025-10-23T05:48:51.493Z] [LOG]       Saturday: 13.50h × Rs.355.56 = Rs.4800.06
[2025-10-23T05:48:51.493Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:51.494Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:51.494Z] [LOG]       Total Expected Earned: Rs.27730.38
[2025-10-23T05:48:51.494Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:48:51.495Z] [LOG]       Weekday: 28.31h × Rs.188.24 = Rs.5329.88
[2025-10-23T05:48:51.495Z] [LOG]       Saturday: 4.50h × Rs.355.56 = Rs.1600.02
[2025-10-23T05:48:51.495Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:51.496Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:51.496Z] [LOG]       Total Actual Earned: Rs.6929.90
[2025-10-23T05:48:51.497Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:48:51.497Z] [LOG]       Calculated At: Oct 23, 2025, 11:18:51
[2025-10-23T05:48:51.498Z] [LOG]       Expected Earned (until NOW): Rs.27730.38
[2025-10-23T05:48:51.498Z] [LOG]       Actual Earned (until NOW): Rs.6929.90
[2025-10-23T05:48:51.498Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:51.499Z] [LOG]       Attendance Deduction: Rs.20800.48
[2025-10-23T05:48:51.499Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:48:51.499Z] [LOG]       📉 Shortfall: 102.50 hours (75.01% of expected)
[2025-10-23T05:48:51.500Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:48:51.500Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:48:51.500Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T05:48:51.501Z] [LOG]    Actual Earned Base: Rs.6929.90
[2025-10-23T05:48:51.501Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T05:48:51.501Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:48:51.502Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:48:51.502Z] [LOG]    Gross Salary: 6929.90425031111
[2025-10-23T05:48:51.503Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:48:51.503Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:48:51.503Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.503Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:48:51.503Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.504Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:48:51.504Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.504Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:48:51.504Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.504Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:48:51.505Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.505Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:48:51.505Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.505Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:48:51.506Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.506Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:48:51.506Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.506Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:48:51.507Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.507Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:48:51.507Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.508Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:48:51.508Z] [LOG]    EPF/ETF calculated on: Rs.6929.90
[2025-10-23T05:48:51.508Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:48:51.508Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:48:51.508Z] [LOG] 💰 GROSS CALCULATION for Sithira null:
[2025-10-23T05:48:51.509Z] [LOG]    Base Salary: 40000
[2025-10-23T05:48:51.509Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:48:51.509Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:48:51.509Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.509Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:48:51.509Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.510Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:48:51.510Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:51.744Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:48:51.745Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:51.745Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:48:51.745Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:48:51.745Z] [LOG]    Actual Earned Base: Rs.6929.90
[2025-10-23T05:48:51.746Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:48:51.746Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:48:51.746Z] [LOG]    = Gross Salary: Rs.6929.90
[2025-10-23T05:48:51.747Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:48:51.747Z] [LOG]    Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T05:48:51.747Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:48:51.747Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:51.748Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:48:51.748Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:48:51.748Z] [LOG]    Gross Salary: Rs.6929.90
[2025-10-23T05:48:51.749Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:48:51.749Z] [LOG]    = NET SALARY: Rs.6929.90
[2025-10-23T05:48:51.749Z] [LOG] 
💾 Database Update:
[2025-10-23T05:48:51.750Z] [LOG]    Total Earnings: Rs.6929.90 (Base: 6929.90 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:48:51.750Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:48:51.975Z] [LOG] 
📝 Components to save:
[2025-10-23T05:48:51.976Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:48:51.976Z] [LOG]    Deduction components: 1
[2025-10-23T05:48:51.976Z] [LOG] Creating components for record cf466627-8f8b-4697-82b0-a723d7b42bf8: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:48:51.977Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 6929.90425031111
}
[2025-10-23T05:48:52.214Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:48:52.450Z] [LOG] Created payroll_record_component: ed38fae1-6843-4b9a-81bd-f15ef1d7399f for Base Salary
[2025-10-23T05:48:52.451Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 20800.480000000003
}
[2025-10-23T05:48:52.685Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:48:52.890Z] [LOG] Created payroll_record_component: d23ce5e4-7777-4659-ac20-1d76a22e62c8 for Attendance Shortfall (Info)
[2025-10-23T05:48:53.326Z] [LOG] ✅ Financial balances updated successfully for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:53.327Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:48:53.327Z] [LOG] 
======================================================================
[2025-10-23T05:48:53.327Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sithira null
[2025-10-23T05:48:53.328Z] [LOG] ======================================================================
[2025-10-23T05:48:53.328Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T05:48:53.328Z] [LOG]    Actual Earned Base (Attendance-based): Rs.6929.90
[2025-10-23T05:48:53.329Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T05:48:53.329Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:53.329Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:53.330Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:48:53.330Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:53.331Z] [LOG]    GROSS SALARY: Rs.6929.90
[2025-10-23T05:48:53.331Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:53.331Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:48:53.332Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:48:53.332Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:48:53.332Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:48:53.332Z] [LOG]       - Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T05:48:53.333Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:53.333Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:48:53.333Z] [LOG]    NET SALARY: Rs.6929.90
[2025-10-23T05:48:53.334Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:48:53.334Z] [LOG] ======================================================================

[2025-10-23T05:48:53.334Z] [LOG] ✅ Sithira null: Calculation completed successfully
[2025-10-23T05:48:53.335Z] [LOG] 📊 Progress: 25/34 (73.5%)
[2025-10-23T05:48:53.335Z] [LOG] 
🧮 Processing: Waruni null (EMP000024)
[2025-10-23T05:48:53.335Z] [LOG] 📋 Record ID: d5c246f6-4ab4-4708-a95d-c0ec6cf39ec0
[2025-10-23T05:48:53.336Z] [LOG] 
======================================================================
[2025-10-23T05:48:53.336Z] [LOG] 🧮 CALCULATING PAYROLL: Waruni null (EMP000024)
[2025-10-23T05:48:53.337Z] [LOG] ======================================================================
[2025-10-23T05:48:54.215Z] [LOG] 🔍 Component filtering for employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-23T05:48:54.216Z] [LOG]    Total components: 13
[2025-10-23T05:48:54.216Z] [LOG]    Applicable components: 13
[2025-10-23T05:48:54.216Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:48:55.646Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:48:55.646Z] [LOG] 🔄 Processing financial records for employee 0143e40c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:48:55.897Z] [LOG] 📊 Found 0 active loans for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:56.139Z] [LOG] 📊 Found 0 active advances for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:56.367Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:56.368Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:48:56.368Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:48:56.574Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:48:56.574Z] [LOG]    Employee ID: 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T05:48:56.574Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:48:56.575Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:48:56.575Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:48:56.854Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:48:56.854Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:48:56.855Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:48:56.855Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:48:56.855Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:48:56.856Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:48:56.856Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:48:57.569Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:48:57.569Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:48:57.816Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:48:57.817Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:48:57.817Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:48:57.817Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:48:57.818Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:48:57.818Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:48:57.818Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:48:57.818Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:48:58.055Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:48:58.056Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:48:58.056Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:48:58.056Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:48:58.292Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:48:58.292Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:48:58.292Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:48:58.293Z] [LOG]       Current Time: 11:18:58
[2025-10-23T05:48:58.293Z] [LOG]       Expected Hours (scheduled → now): 2.82h
[2025-10-23T05:48:58.293Z] [LOG]       Actual Hours (check-in → now): 2.82h
[2025-10-23T05:48:58.294Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:48:58.294Z] [LOG]       Weekday: 121.82h
[2025-10-23T05:48:58.294Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:48:58.295Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:58.295Z] [LOG]       Total Expected: 135.32h
[2025-10-23T05:48:58.296Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:48:58.296Z] [LOG]       Weekday: 28.32h (includes 2.82h live)
[2025-10-23T05:48:58.296Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:48:58.297Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:48:58.297Z] [LOG]       Total Actual: 32.82h
[2025-10-23T05:48:58.297Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:48:58.298Z] [LOG]       Weekday: 121.82h × Rs.235.29 = Rs.28662.13
[2025-10-23T05:48:58.298Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:48:58.298Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:58.299Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:58.299Z] [LOG]       Total Expected Earned: Rs.34662.07
[2025-10-23T05:48:58.299Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:48:58.300Z] [LOG]       Weekday: 28.32h × Rs.235.29 = Rs.6662.52
[2025-10-23T05:48:58.300Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:48:58.300Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:48:58.300Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:58.301Z] [LOG]       Total Actual Earned: Rs.8662.50
[2025-10-23T05:48:58.302Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:48:58.302Z] [LOG]       Calculated At: Oct 23, 2025, 11:18:58
[2025-10-23T05:48:58.302Z] [LOG]       Expected Earned (until NOW): Rs.34662.07
[2025-10-23T05:48:58.302Z] [LOG]       Actual Earned (until NOW): Rs.8662.50
[2025-10-23T05:48:58.302Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:48:58.303Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T05:48:58.303Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:48:58.304Z] [LOG]       📉 Shortfall: 102.50 hours (75.01% of expected)
[2025-10-23T05:48:58.304Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:48:58.304Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:48:58.305Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:48:58.305Z] [LOG]    Actual Earned Base: Rs.8662.50
[2025-10-23T05:48:58.306Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:48:58.306Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:48:58.306Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:48:58.307Z] [LOG]    Gross Salary: 8662.496867966667
[2025-10-23T05:48:58.307Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:48:58.307Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:48:58.308Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.308Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:48:58.308Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.308Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:48:58.308Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.309Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:48:58.309Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.309Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:48:58.310Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.310Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:48:58.310Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.311Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:48:58.311Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.311Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:48:58.312Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.312Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:48:58.313Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.313Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:48:58.314Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.314Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:48:58.314Z] [LOG]    EPF/ETF calculated on: Rs.8662.50
[2025-10-23T05:48:58.314Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:48:58.314Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:48:58.314Z] [LOG] 💰 GROSS CALCULATION for Waruni null:
[2025-10-23T05:48:58.315Z] [LOG]    Base Salary: 50000
[2025-10-23T05:48:58.315Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:48:58.315Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:48:58.315Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.315Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:48:58.316Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.316Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:48:58.316Z] [LOG]    Fixed amount: 0
[2025-10-23T05:48:58.654Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:48:58.654Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:48:58.655Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:48:58.655Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:48:58.655Z] [LOG]    Actual Earned Base: Rs.8662.50
[2025-10-23T05:48:58.656Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:48:58.656Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:48:58.657Z] [LOG]    = Gross Salary: Rs.8662.50
[2025-10-23T05:48:58.657Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:48:58.657Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:48:58.658Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:48:58.658Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:48:58.658Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:48:58.658Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:48:58.659Z] [LOG]    Gross Salary: Rs.8662.50
[2025-10-23T05:48:58.659Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:48:58.659Z] [LOG]    = NET SALARY: Rs.8662.50
[2025-10-23T05:48:58.660Z] [LOG] 
💾 Database Update:
[2025-10-23T05:48:58.660Z] [LOG]    Total Earnings: Rs.8662.50 (Base: 8662.50 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:48:58.660Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:48:58.938Z] [LOG] 
📝 Components to save:
[2025-10-23T05:48:58.938Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:48:58.939Z] [LOG]    Deduction components: 1
[2025-10-23T05:48:58.939Z] [LOG] Creating components for record d5c246f6-4ab4-4708-a95d-c0ec6cf39ec0: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:48:58.940Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8662.496867966667
}
[2025-10-23T05:48:59.174Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:48:59.414Z] [LOG] Created payroll_record_component: 6ef87f7b-083b-4357-b567-1463d96f0e0e for Base Salary
[2025-10-23T05:48:59.414Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T05:48:59.666Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:48:59.896Z] [LOG] Created payroll_record_component: 8e48ed32-8e2b-4634-aa5b-8ad452dd9a33 for Attendance Shortfall (Info)
[2025-10-23T05:49:00.374Z] [LOG] ✅ Financial balances updated successfully for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:00.374Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:49:00.374Z] [LOG] 
======================================================================
[2025-10-23T05:49:00.375Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Waruni null
[2025-10-23T05:49:00.375Z] [LOG] ======================================================================
[2025-10-23T05:49:00.376Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:49:00.376Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8662.50
[2025-10-23T05:49:00.376Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T05:49:00.376Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:00.377Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:00.377Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:49:00.377Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:00.378Z] [LOG]    GROSS SALARY: Rs.8662.50
[2025-10-23T05:49:00.378Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:00.378Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:49:00.379Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:49:00.379Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:49:00.379Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:49:00.380Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T05:49:00.380Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:00.381Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:00.381Z] [LOG]    NET SALARY: Rs.8662.50
[2025-10-23T05:49:00.382Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:49:00.382Z] [LOG] ======================================================================

[2025-10-23T05:49:00.382Z] [LOG] ✅ Waruni null: Calculation completed successfully
[2025-10-23T05:49:00.383Z] [LOG] 📊 Progress: 26/34 (76.5%)
[2025-10-23T05:49:00.383Z] [LOG] 
🧮 Processing: Jessie null (EMP000013)
[2025-10-23T05:49:00.383Z] [LOG] 📋 Record ID: d73da62a-ab8f-4367-a849-dbc46dc91e97
[2025-10-23T05:49:00.384Z] [LOG] 
======================================================================
[2025-10-23T05:49:00.384Z] [LOG] 🧮 CALCULATING PAYROLL: Jessie null (EMP000013)
[2025-10-23T05:49:00.384Z] [LOG] ======================================================================
[2025-10-23T05:49:01.436Z] [LOG] 🔍 Component filtering for employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-23T05:49:01.437Z] [LOG]    Total components: 13
[2025-10-23T05:49:01.437Z] [LOG]    Applicable components: 13
[2025-10-23T05:49:01.437Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:49:02.845Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:49:02.845Z] [LOG] 🔄 Processing financial records for employee 0143ae6e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:49:03.050Z] [LOG] 📊 Found 0 active loans for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:03.251Z] [LOG] 📊 Found 0 active advances for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:03.486Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:03.486Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:49:03.487Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:49:03.735Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:49:03.735Z] [LOG]    Employee ID: 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:03.736Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:49:03.736Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:49:03.736Z] [LOG]    Base Salary (Full Month): Rs.60000.00
[2025-10-23T05:49:03.933Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:49:03.933Z] [LOG]       Daily Salary: Rs.2400.00
[2025-10-23T05:49:03.933Z] [LOG]       Weekday Hourly Rate: Rs.282.35
[2025-10-23T05:49:03.933Z] [LOG]       Saturday Hourly Rate: Rs.533.33
[2025-10-23T05:49:03.934Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:49:03.934Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:49:03.934Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:49:04.569Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:49:04.569Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:49:04.780Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:49:04.781Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:49:04.781Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:49:04.781Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:49:04.781Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:49:04.782Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:49:04.782Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:49:04.782Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:49:05.018Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:49:05.019Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:49:05.019Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:49:05.019Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:49:05.254Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:49:05.255Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:49:05.255Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:49:05.256Z] [LOG]       Current Time: 11:19:05
[2025-10-23T05:49:05.256Z] [LOG]       Expected Hours (scheduled → now): 2.82h
[2025-10-23T05:49:05.256Z] [LOG]       Actual Hours (check-in → now): 2.82h
[2025-10-23T05:49:05.257Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:49:05.257Z] [LOG]       Weekday: 121.82h
[2025-10-23T05:49:05.258Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:49:05.258Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:05.258Z] [LOG]       Total Expected: 135.32h
[2025-10-23T05:49:05.259Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:49:05.259Z] [LOG]       Weekday: 28.32h (includes 2.82h live)
[2025-10-23T05:49:05.259Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:49:05.260Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:05.260Z] [LOG]       Total Actual: 32.82h
[2025-10-23T05:49:05.260Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:49:05.261Z] [LOG]       Weekday: 121.82h × Rs.282.35 = Rs.34395.35
[2025-10-23T05:49:05.261Z] [LOG]       Saturday: 13.50h × Rs.533.33 = Rs.7199.96
[2025-10-23T05:49:05.261Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:05.262Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:05.262Z] [LOG]       Total Expected Earned: Rs.41595.30
[2025-10-23T05:49:05.262Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:49:05.263Z] [LOG]       Weekday: 28.32h × Rs.282.35 = Rs.7995.62
[2025-10-23T05:49:05.263Z] [LOG]       Saturday: 4.50h × Rs.533.33 = Rs.2399.99
[2025-10-23T05:49:05.263Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:05.264Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:05.264Z] [LOG]       Total Actual Earned: Rs.10395.61
[2025-10-23T05:49:05.265Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:49:05.266Z] [LOG]       Calculated At: Oct 23, 2025, 11:19:05
[2025-10-23T05:49:05.266Z] [LOG]       Expected Earned (until NOW): Rs.41595.30
[2025-10-23T05:49:05.266Z] [LOG]       Actual Earned (until NOW): Rs.10395.61
[2025-10-23T05:49:05.267Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:05.267Z] [LOG]       Attendance Deduction: Rs.31199.70
[2025-10-23T05:49:05.267Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:49:05.268Z] [LOG]       📉 Shortfall: 102.50 hours (75.01% of expected)
[2025-10-23T05:49:05.268Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:49:05.269Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:49:05.269Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T05:49:05.269Z] [LOG]    Actual Earned Base: Rs.10395.61
[2025-10-23T05:49:05.270Z] [LOG]    Attendance Shortfall: Rs.31199.70
[2025-10-23T05:49:05.270Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:49:05.270Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:49:05.270Z] [LOG]    Gross Salary: 10395.607907472224
[2025-10-23T05:49:05.271Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:49:05.271Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:49:05.271Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.272Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:49:05.272Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.272Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:49:05.273Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.273Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:49:05.273Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.273Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:49:05.274Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.274Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:49:05.274Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.274Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:49:05.275Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.275Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:49:05.275Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.276Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:49:05.276Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.276Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:49:05.276Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.277Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:49:05.277Z] [LOG]    EPF/ETF calculated on: Rs.10395.61
[2025-10-23T05:49:05.277Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:49:05.277Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:49:05.278Z] [LOG] 💰 GROSS CALCULATION for Jessie null:
[2025-10-23T05:49:05.278Z] [LOG]    Base Salary: 60000
[2025-10-23T05:49:05.278Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:49:05.279Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:49:05.279Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.279Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:49:05.280Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.280Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:49:05.280Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:05.683Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:49:05.683Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:05.683Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:49:05.684Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:49:05.684Z] [LOG]    Actual Earned Base: Rs.10395.61
[2025-10-23T05:49:05.684Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:49:05.684Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:49:05.685Z] [LOG]    = Gross Salary: Rs.10395.61
[2025-10-23T05:49:05.685Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:49:05.685Z] [LOG]    Attendance Shortfall (Info): Rs.31199.70
[2025-10-23T05:49:05.686Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:49:05.686Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:05.686Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:49:05.686Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:49:05.687Z] [LOG]    Gross Salary: Rs.10395.61
[2025-10-23T05:49:05.687Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:49:05.687Z] [LOG]    = NET SALARY: Rs.10395.61
[2025-10-23T05:49:05.687Z] [LOG] 
💾 Database Update:
[2025-10-23T05:49:05.688Z] [LOG]    Total Earnings: Rs.10395.61 (Base: 10395.61 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:49:05.688Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:49:05.887Z] [LOG] 
📝 Components to save:
[2025-10-23T05:49:05.888Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:49:05.888Z] [LOG]    Deduction components: 1
[2025-10-23T05:49:05.888Z] [LOG] Creating components for record d73da62a-ab8f-4367-a849-dbc46dc91e97: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:49:05.889Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10395.607907472224
}
[2025-10-23T05:49:06.131Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:49:06.365Z] [LOG] Created payroll_record_component: ca8ead53-0a4d-4bd9-b5f3-99689f6975d8 for Base Salary
[2025-10-23T05:49:06.365Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 31199.695000000007
}
[2025-10-23T05:49:06.605Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:49:06.857Z] [LOG] Created payroll_record_component: 13b7462e-e924-4d7c-b922-14098b32c02d for Attendance Shortfall (Info)
[2025-10-23T05:49:07.327Z] [LOG] ✅ Financial balances updated successfully for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:07.327Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:49:07.328Z] [LOG] 
======================================================================
[2025-10-23T05:49:07.328Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Jessie null
[2025-10-23T05:49:07.328Z] [LOG] ======================================================================
[2025-10-23T05:49:07.328Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T05:49:07.329Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10395.61
[2025-10-23T05:49:07.329Z] [LOG]    Attendance Shortfall: Rs.31199.70
[2025-10-23T05:49:07.329Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:07.329Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:07.329Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:49:07.330Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:07.330Z] [LOG]    GROSS SALARY: Rs.10395.61
[2025-10-23T05:49:07.330Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:07.331Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:49:07.331Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:49:07.331Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:49:07.331Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:49:07.332Z] [LOG]       - Attendance Shortfall (Info): Rs.31199.70
[2025-10-23T05:49:07.332Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:07.332Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:07.332Z] [LOG]    NET SALARY: Rs.10395.61
[2025-10-23T05:49:07.333Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:49:07.333Z] [LOG] ======================================================================

[2025-10-23T05:49:07.333Z] [LOG] ✅ Jessie null: Calculation completed successfully
[2025-10-23T05:49:07.334Z] [LOG] 📊 Progress: 27/34 (79.4%)
[2025-10-23T05:49:07.334Z] [LOG] 
🧮 Processing: Chemil null (EMP000040)
[2025-10-23T05:49:07.334Z] [LOG] 📋 Record ID: daecc0ac-9bed-4d5f-b6cb-1ac870d6b90b
[2025-10-23T05:49:07.335Z] [LOG] 
======================================================================
[2025-10-23T05:49:07.335Z] [LOG] 🧮 CALCULATING PAYROLL: Chemil null (EMP000040)
[2025-10-23T05:49:07.335Z] [LOG] ======================================================================
[2025-10-23T05:49:08.287Z] [LOG] 🔍 Component filtering for employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-23T05:49:08.288Z] [LOG]    Total components: 13
[2025-10-23T05:49:08.288Z] [LOG]    Applicable components: 13
[2025-10-23T05:49:08.288Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:49:09.730Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:49:09.730Z] [LOG] 🔄 Processing financial records for employee 01442599-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:49:09.997Z] [LOG] 📊 Found 0 active loans for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:10.301Z] [LOG] 📊 Found 0 active advances for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:10.532Z] [LOG] 📊 Found 0 approved bonuses for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:10.533Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:49:10.533Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:49:10.766Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:49:10.766Z] [LOG]    Employee ID: 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:10.766Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:49:10.767Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:49:10.767Z] [LOG]    Base Salary (Full Month): Rs.250000.00
[2025-10-23T05:49:11.014Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:49:11.014Z] [LOG]       Daily Salary: Rs.10000.00
[2025-10-23T05:49:11.015Z] [LOG]       Weekday Hourly Rate: Rs.1176.47
[2025-10-23T05:49:11.015Z] [LOG]       Saturday Hourly Rate: Rs.2222.22
[2025-10-23T05:49:11.015Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:49:11.016Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:49:11.016Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:49:11.733Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:49:11.734Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:49:11.990Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:49:11.990Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:49:11.991Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:49:11.991Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:49:11.991Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:49:11.992Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:49:11.992Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:49:11.992Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:49:12.205Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:49:12.205Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:49:12.206Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:49:12.206Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:49:12.410Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:49:12.410Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:49:12.411Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:49:12.412Z] [LOG]       Current Time: 11:19:12
[2025-10-23T05:49:12.412Z] [LOG]       Expected Hours (scheduled → now): 2.82h
[2025-10-23T05:49:12.412Z] [LOG]       Actual Hours (check-in → now): 2.82h
[2025-10-23T05:49:12.413Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:49:12.413Z] [LOG]       Weekday: 121.82h
[2025-10-23T05:49:12.413Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:49:12.414Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:12.414Z] [LOG]       Total Expected: 135.32h
[2025-10-23T05:49:12.414Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:49:12.414Z] [LOG]       Weekday: 28.32h (includes 2.82h live)
[2025-10-23T05:49:12.415Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:49:12.415Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:12.415Z] [LOG]       Total Actual: 32.82h
[2025-10-23T05:49:12.415Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:49:12.415Z] [LOG]       Weekday: 121.82h × Rs.1176.47 = Rs.143317.71
[2025-10-23T05:49:12.416Z] [LOG]       Saturday: 13.50h × Rs.2222.22 = Rs.29999.97
[2025-10-23T05:49:12.416Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:12.416Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:12.417Z] [LOG]       Total Expected Earned: Rs.173317.68
[2025-10-23T05:49:12.417Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:49:12.417Z] [LOG]       Weekday: 28.32h × Rs.1176.47 = Rs.33317.76
[2025-10-23T05:49:12.418Z] [LOG]       Saturday: 4.50h × Rs.2222.22 = Rs.9999.99
[2025-10-23T05:49:12.418Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:12.418Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:12.418Z] [LOG]       Total Actual Earned: Rs.43317.75
[2025-10-23T05:49:12.419Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:49:12.419Z] [LOG]       Calculated At: Oct 23, 2025, 11:19:12
[2025-10-23T05:49:12.420Z] [LOG]       Expected Earned (until NOW): Rs.173317.68
[2025-10-23T05:49:12.420Z] [LOG]       Actual Earned (until NOW): Rs.43317.75
[2025-10-23T05:49:12.420Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:12.421Z] [LOG]       Attendance Deduction: Rs.129999.92
[2025-10-23T05:49:12.421Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:49:12.421Z] [LOG]       📉 Shortfall: 102.50 hours (75.01% of expected)
[2025-10-23T05:49:12.421Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:49:12.422Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:49:12.422Z] [LOG]    Base Salary (Full): Rs.250000.00
[2025-10-23T05:49:12.422Z] [LOG]    Actual Earned Base: Rs.43317.75
[2025-10-23T05:49:12.423Z] [LOG]    Attendance Shortfall: Rs.129999.92
[2025-10-23T05:49:12.423Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:49:12.423Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:49:12.424Z] [LOG]    Gross Salary: 43317.75438686111
[2025-10-23T05:49:12.424Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:49:12.424Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:49:12.425Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.425Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:49:12.425Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.426Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:49:12.427Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.427Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:49:12.428Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.428Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:49:12.428Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.429Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:49:12.429Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.429Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:49:12.430Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.430Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:49:12.430Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.430Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:49:12.430Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.430Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:49:12.430Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.431Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:49:12.431Z] [LOG]    EPF/ETF calculated on: Rs.43317.75
[2025-10-23T05:49:12.431Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:49:12.431Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:49:12.432Z] [LOG] 💰 GROSS CALCULATION for Chemil null:
[2025-10-23T05:49:12.432Z] [LOG]    Base Salary: 250000
[2025-10-23T05:49:12.432Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:49:12.433Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:49:12.433Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.433Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:49:12.433Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.434Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:49:12.434Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:12.707Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:49:12.708Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:12.708Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:49:12.708Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:49:12.708Z] [LOG]    Actual Earned Base: Rs.43317.75
[2025-10-23T05:49:12.708Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:49:12.709Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:49:12.709Z] [LOG]    = Gross Salary: Rs.43317.75
[2025-10-23T05:49:12.709Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:49:12.709Z] [LOG]    Attendance Shortfall (Info): Rs.129999.92
[2025-10-23T05:49:12.710Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:49:12.710Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:12.710Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:49:12.710Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:49:12.711Z] [LOG]    Gross Salary: Rs.43317.75
[2025-10-23T05:49:12.711Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:49:12.711Z] [LOG]    = NET SALARY: Rs.43317.75
[2025-10-23T05:49:12.711Z] [LOG] 
💾 Database Update:
[2025-10-23T05:49:12.712Z] [LOG]    Total Earnings: Rs.43317.75 (Base: 43317.75 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:49:12.712Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:49:12.908Z] [LOG] 
📝 Components to save:
[2025-10-23T05:49:12.908Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:49:12.909Z] [LOG]    Deduction components: 1
[2025-10-23T05:49:12.909Z] [LOG] Creating components for record daecc0ac-9bed-4d5f-b6cb-1ac870d6b90b: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:49:12.909Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 43317.75438686111
}
[2025-10-23T05:49:13.108Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:49:13.303Z] [LOG] Created payroll_record_component: 66da139e-9902-4561-90ea-412170fb1507 for Base Salary
[2025-10-23T05:49:13.304Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 129999.92499999999
}
[2025-10-23T05:49:13.491Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:49:13.695Z] [LOG] Created payroll_record_component: 6bb194dd-02bf-4a11-b778-7bec7c1c4447 for Attendance Shortfall (Info)
[2025-10-23T05:49:14.079Z] [LOG] ✅ Financial balances updated successfully for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:14.080Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:49:14.080Z] [LOG] 
======================================================================
[2025-10-23T05:49:14.081Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Chemil null
[2025-10-23T05:49:14.081Z] [LOG] ======================================================================
[2025-10-23T05:49:14.081Z] [LOG]    Base Salary (Full): Rs.250000.00
[2025-10-23T05:49:14.082Z] [LOG]    Actual Earned Base (Attendance-based): Rs.43317.75
[2025-10-23T05:49:14.082Z] [LOG]    Attendance Shortfall: Rs.129999.92
[2025-10-23T05:49:14.082Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:14.083Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:14.083Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:49:14.083Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:14.083Z] [LOG]    GROSS SALARY: Rs.43317.75
[2025-10-23T05:49:14.084Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:14.084Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:49:14.084Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:49:14.084Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:49:14.085Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:49:14.085Z] [LOG]       - Attendance Shortfall (Info): Rs.129999.92
[2025-10-23T05:49:14.085Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:14.086Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:14.086Z] [LOG]    NET SALARY: Rs.43317.75
[2025-10-23T05:49:14.086Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:49:14.086Z] [LOG] ======================================================================

[2025-10-23T05:49:14.087Z] [LOG] ✅ Chemil null: Calculation completed successfully
[2025-10-23T05:49:14.087Z] [LOG] 📊 Progress: 28/34 (82.4%)
[2025-10-23T05:49:14.087Z] [LOG] 
🧮 Processing: Saruban null (EMP000007)
[2025-10-23T05:49:14.088Z] [LOG] 📋 Record ID: dce49899-19ca-4522-8176-3d5a9e4895d2
[2025-10-23T05:49:14.088Z] [LOG] 
======================================================================
[2025-10-23T05:49:14.088Z] [LOG] 🧮 CALCULATING PAYROLL: Saruban null (EMP000007)
[2025-10-23T05:49:14.089Z] [LOG] ======================================================================
[2025-10-23T05:49:14.941Z] [LOG] 🔍 Component filtering for employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-23T05:49:14.941Z] [LOG]    Total components: 13
[2025-10-23T05:49:14.942Z] [LOG]    Applicable components: 13
[2025-10-23T05:49:14.942Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:49:16.286Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:49:16.287Z] [LOG] 🔄 Processing financial records for employee 0143a6e3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:49:16.555Z] [LOG] 📊 Found 0 active loans for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:16.767Z] [LOG] 📊 Found 0 active advances for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:17.019Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:17.020Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:49:17.020Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:49:17.254Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:49:17.254Z] [LOG]    Employee ID: 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:17.254Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:49:17.254Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:49:17.255Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-23T05:49:17.489Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:49:17.489Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-23T05:49:17.490Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T05:49:17.490Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-23T05:49:17.490Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:49:17.490Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:49:17.491Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:49:18.207Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:49:18.207Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:49:18.448Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:49:18.448Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:49:18.448Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:49:18.449Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:49:18.449Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:49:18.449Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:49:18.449Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:49:18.450Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:49:18.685Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:49:18.686Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:49:18.686Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:49:18.686Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:49:18.895Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:49:18.895Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:49:18.895Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:49:18.896Z] [LOG]       Current Time: 11:19:18
[2025-10-23T05:49:18.896Z] [LOG]       Expected Hours (scheduled → now): 2.82h
[2025-10-23T05:49:18.897Z] [LOG]       Actual Hours (check-in → now): 2.82h
[2025-10-23T05:49:18.897Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:49:18.897Z] [LOG]       Weekday: 121.82h
[2025-10-23T05:49:18.897Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:49:18.897Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:18.898Z] [LOG]       Total Expected: 135.32h
[2025-10-23T05:49:18.898Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:49:18.898Z] [LOG]       Weekday: 28.32h (includes 2.82h live)
[2025-10-23T05:49:18.898Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:49:18.899Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:18.899Z] [LOG]       Total Actual: 32.82h
[2025-10-23T05:49:18.899Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:49:18.899Z] [LOG]       Weekday: 121.82h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:18.900Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:18.900Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:18.900Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:18.900Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-23T05:49:18.901Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:49:18.901Z] [LOG]       Weekday: 28.32h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:18.901Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:18.901Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:18.902Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:18.902Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-23T05:49:18.903Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:49:18.903Z] [LOG]       Calculated At: Oct 23, 2025, 11:19:18
[2025-10-23T05:49:18.903Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-23T05:49:18.904Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-23T05:49:18.904Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:18.904Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-23T05:49:18.904Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:49:18.905Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-23T05:49:18.905Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:49:18.905Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:49:18.906Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T05:49:18.906Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:49:18.906Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:49:18.907Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:49:18.907Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:49:18.908Z] [LOG]    Gross Salary: 0
[2025-10-23T05:49:18.908Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:49:18.909Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:49:18.909Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.909Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:49:18.909Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.910Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:49:18.910Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.910Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:49:18.911Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.911Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:49:18.911Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.911Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:49:18.912Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.912Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:49:18.912Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.912Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:49:18.913Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.913Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:49:18.913Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.913Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:49:18.913Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.914Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:49:18.914Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-23T05:49:18.914Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:49:18.914Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:49:18.914Z] [LOG] 💰 GROSS CALCULATION for Saruban null:
[2025-10-23T05:49:18.915Z] [LOG]    Base Salary: 0
[2025-10-23T05:49:18.915Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:49:18.915Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:49:18.915Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.916Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:49:18.916Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:18.916Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:49:18.916Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:19.171Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:49:19.172Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:19.172Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:49:19.172Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:49:19.173Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:49:19.173Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:49:19.173Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:49:19.173Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-23T05:49:19.174Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:49:19.174Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:49:19.174Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:19.175Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:49:19.175Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:49:19.176Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-23T05:49:19.176Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:49:19.176Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-23T05:49:19.177Z] [LOG] 
💾 Database Update:
[2025-10-23T05:49:19.177Z] [LOG]    Total Earnings: Rs.0.00 (Base: 0.00 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:49:19.177Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:49:19.406Z] [LOG] 
📝 Components to save:
[2025-10-23T05:49:19.406Z] [LOG]    Gross/Earnings components: 0
[2025-10-23T05:49:19.406Z] [LOG]    Deduction components: 0
[2025-10-23T05:49:19.407Z] [LOG] Creating components for record dce49899-19ca-4522-8176-3d5a9e4895d2: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-23T05:49:19.885Z] [LOG] ✅ Financial balances updated successfully for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:19.886Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:49:19.886Z] [LOG] 
======================================================================
[2025-10-23T05:49:19.887Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Saruban null
[2025-10-23T05:49:19.887Z] [LOG] ======================================================================
[2025-10-23T05:49:19.887Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T05:49:19.888Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-23T05:49:19.888Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:49:19.888Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:19.889Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:19.889Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:49:19.889Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:19.890Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-23T05:49:19.890Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:19.890Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:49:19.891Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:49:19.891Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:49:19.891Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:49:19.891Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-23T05:49:19.891Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:19.892Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:19.892Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-23T05:49:19.892Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:49:19.893Z] [LOG] ======================================================================

[2025-10-23T05:49:19.893Z] [LOG] ✅ Saruban null: Calculation completed successfully
[2025-10-23T05:49:19.893Z] [LOG] 📊 Progress: 29/34 (85.3%)
[2025-10-23T05:49:19.893Z] [LOG] 
🧮 Processing: Nimdiya Ranasinghe null (EMP000045)
[2025-10-23T05:49:19.894Z] [LOG] 📋 Record ID: e05c9113-3c10-48de-9336-cf3775bc29d8
[2025-10-23T05:49:19.894Z] [LOG] 
======================================================================
[2025-10-23T05:49:19.894Z] [LOG] 🧮 CALCULATING PAYROLL: Nimdiya Ranasinghe null (EMP000045)
[2025-10-23T05:49:19.894Z] [LOG] ======================================================================
[2025-10-23T05:49:20.818Z] [LOG] 🔍 Component filtering for employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-23T05:49:20.818Z] [LOG]    Total components: 13
[2025-10-23T05:49:20.819Z] [LOG]    Applicable components: 13
[2025-10-23T05:49:20.819Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T05:49:22.208Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:49:22.209Z] [LOG] 🔄 Processing financial records for employee 01444074-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:49:22.446Z] [LOG] 📊 Found 0 active loans for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:22.693Z] [LOG] 📊 Found 0 active advances for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:22.938Z] [LOG] 📊 Found 0 approved bonuses for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:22.939Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:49:22.939Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:49:23.165Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:49:23.165Z] [LOG]    Employee ID: 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:23.166Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:49:23.166Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:49:23.167Z] [LOG]    Base Salary (Full Month): Rs.35000.00
[2025-10-23T05:49:23.373Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:49:23.373Z] [LOG]       Daily Salary: Rs.1400.00
[2025-10-23T05:49:23.374Z] [LOG]       Weekday Hourly Rate: Rs.164.71
[2025-10-23T05:49:23.374Z] [LOG]       Saturday Hourly Rate: Rs.311.11
[2025-10-23T05:49:23.374Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:49:23.374Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:49:23.375Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:49:24.045Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:49:24.045Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:49:24.297Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:49:24.298Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:49:24.298Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:49:24.298Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:49:24.298Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:49:24.298Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:49:24.298Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:49:24.298Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:49:24.525Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:49:24.526Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:49:24.526Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:49:24.526Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:49:24.773Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:49:24.773Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:49:24.773Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:49:24.774Z] [LOG]       Current Time: 11:19:24
[2025-10-23T05:49:24.774Z] [LOG]       Expected Hours (scheduled → now): 2.82h
[2025-10-23T05:49:24.774Z] [LOG]       Actual Hours (check-in → now): 2.82h
[2025-10-23T05:49:24.775Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:49:24.775Z] [LOG]       Weekday: 121.82h
[2025-10-23T05:49:24.775Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:49:24.775Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:24.776Z] [LOG]       Total Expected: 135.32h
[2025-10-23T05:49:24.776Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:49:24.776Z] [LOG]       Weekday: 28.32h (includes 2.82h live)
[2025-10-23T05:49:24.777Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:49:24.777Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:24.777Z] [LOG]       Total Actual: 32.82h
[2025-10-23T05:49:24.777Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:49:24.778Z] [LOG]       Weekday: 121.82h × Rs.164.71 = Rs.20065.56
[2025-10-23T05:49:24.778Z] [LOG]       Saturday: 13.50h × Rs.311.11 = Rs.4199.99
[2025-10-23T05:49:24.778Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:24.778Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:24.779Z] [LOG]       Total Expected Earned: Rs.24265.54
[2025-10-23T05:49:24.779Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:49:24.779Z] [LOG]       Weekday: 28.32h × Rs.164.71 = Rs.4665.17
[2025-10-23T05:49:24.780Z] [LOG]       Saturday: 4.50h × Rs.311.11 = Rs.1400.00
[2025-10-23T05:49:24.780Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:24.780Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:24.780Z] [LOG]       Total Actual Earned: Rs.6065.17
[2025-10-23T05:49:24.781Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:49:24.781Z] [LOG]       Calculated At: Oct 23, 2025, 11:19:24
[2025-10-23T05:49:24.781Z] [LOG]       Expected Earned (until NOW): Rs.24265.54
[2025-10-23T05:49:24.781Z] [LOG]       Actual Earned (until NOW): Rs.6065.17
[2025-10-23T05:49:24.781Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:24.782Z] [LOG]       Attendance Deduction: Rs.18200.38
[2025-10-23T05:49:24.782Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:49:24.782Z] [LOG]       📉 Shortfall: 102.50 hours (75.01% of expected)
[2025-10-23T05:49:24.782Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:49:24.782Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:49:24.782Z] [LOG]    Base Salary (Full): Rs.35000.00
[2025-10-23T05:49:24.783Z] [LOG]    Actual Earned Base: Rs.6065.17
[2025-10-23T05:49:24.783Z] [LOG]    Attendance Shortfall: Rs.18200.38
[2025-10-23T05:49:24.783Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:49:24.783Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:49:24.784Z] [LOG]    Gross Salary: 6065.166600230556
[2025-10-23T05:49:24.784Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:49:24.784Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:49:24.785Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.785Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:49:24.785Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.786Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:49:24.786Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.786Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:49:24.787Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.787Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:49:24.787Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.787Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:49:24.788Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.788Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:49:24.788Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.788Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:49:24.789Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.789Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:49:24.789Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.789Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:49:24.790Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.790Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:49:24.790Z] [LOG]    EPF/ETF calculated on: Rs.6065.17
[2025-10-23T05:49:24.790Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:49:24.791Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:49:24.791Z] [LOG] 💰 GROSS CALCULATION for Nimdiya Ranasinghe null:
[2025-10-23T05:49:24.791Z] [LOG]    Base Salary: 35000
[2025-10-23T05:49:24.791Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:49:24.792Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:49:24.792Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.792Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:49:24.792Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:24.793Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:49:24.793Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:25.021Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:49:25.021Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:25.022Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:49:25.022Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:49:25.022Z] [LOG]    Actual Earned Base: Rs.6065.17
[2025-10-23T05:49:25.022Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:49:25.022Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:49:25.022Z] [LOG]    = Gross Salary: Rs.6065.17
[2025-10-23T05:49:25.022Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:49:25.022Z] [LOG]    Attendance Shortfall (Info): Rs.18200.38
[2025-10-23T05:49:25.022Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:49:25.023Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:25.023Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:49:25.023Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:49:25.023Z] [LOG]    Gross Salary: Rs.6065.17
[2025-10-23T05:49:25.023Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:49:25.023Z] [LOG]    = NET SALARY: Rs.6065.17
[2025-10-23T05:49:25.023Z] [LOG] 
💾 Database Update:
[2025-10-23T05:49:25.023Z] [LOG]    Total Earnings: Rs.6065.17 (Base: 6065.17 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:49:25.023Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:49:25.251Z] [LOG] 
📝 Components to save:
[2025-10-23T05:49:25.252Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:49:25.252Z] [LOG]    Deduction components: 1
[2025-10-23T05:49:25.252Z] [LOG] Creating components for record e05c9113-3c10-48de-9336-cf3775bc29d8: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:49:25.253Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 6065.166600230556
}
[2025-10-23T05:49:25.443Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:49:25.652Z] [LOG] Created payroll_record_component: 8a08e907-50f6-44ac-a1c5-f0f3b329553e for Base Salary
[2025-10-23T05:49:25.653Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 18200.375
}
[2025-10-23T05:49:25.891Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:49:26.148Z] [LOG] Created payroll_record_component: 23dc7add-ec10-4c35-989b-6578ace03475 for Attendance Shortfall (Info)
[2025-10-23T05:49:26.605Z] [LOG] ✅ Financial balances updated successfully for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:26.605Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:49:26.605Z] [LOG] 
======================================================================
[2025-10-23T05:49:26.605Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Nimdiya Ranasinghe null
[2025-10-23T05:49:26.606Z] [LOG] ======================================================================
[2025-10-23T05:49:26.606Z] [LOG]    Base Salary (Full): Rs.35000.00
[2025-10-23T05:49:26.606Z] [LOG]    Actual Earned Base (Attendance-based): Rs.6065.17
[2025-10-23T05:49:26.606Z] [LOG]    Attendance Shortfall: Rs.18200.38
[2025-10-23T05:49:26.607Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:26.607Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:26.607Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:49:26.608Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:26.608Z] [LOG]    GROSS SALARY: Rs.6065.17
[2025-10-23T05:49:26.608Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:26.609Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:49:26.609Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:49:26.609Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:49:26.609Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:49:26.610Z] [LOG]       - Attendance Shortfall (Info): Rs.18200.38
[2025-10-23T05:49:26.610Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:26.610Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:26.611Z] [LOG]    NET SALARY: Rs.6065.17
[2025-10-23T05:49:26.611Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:49:26.611Z] [LOG] ======================================================================

[2025-10-23T05:49:26.611Z] [LOG] ✅ Nimdiya Ranasinghe null: Calculation completed successfully
[2025-10-23T05:49:26.612Z] [LOG] 📊 Progress: 30/34 (88.2%)
[2025-10-23T05:49:26.612Z] [LOG] 
🧮 Processing: customer null (EMP000036)
[2025-10-23T05:49:26.612Z] [LOG] 📋 Record ID: e0f25dd8-9f6f-4880-985d-2d002baaf013
[2025-10-23T05:49:26.613Z] [LOG] 
======================================================================
[2025-10-23T05:49:26.613Z] [LOG] 🧮 CALCULATING PAYROLL: customer null (EMP000036)
[2025-10-23T05:49:26.613Z] [LOG] ======================================================================
[2025-10-23T05:49:27.568Z] [LOG] 🔍 Component filtering for employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-23T05:49:27.569Z] [LOG]    Total components: 13
[2025-10-23T05:49:27.569Z] [LOG]    Applicable components: 13
[2025-10-23T05:49:27.569Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T05:49:28.944Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:49:28.945Z] [LOG] 🔄 Processing financial records for employee 014409a2-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:49:29.174Z] [LOG] 📊 Found 0 active loans for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:29.431Z] [LOG] 📊 Found 0 active advances for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:29.655Z] [LOG] 📊 Found 0 approved bonuses for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:29.655Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:49:29.656Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:49:29.886Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:49:29.886Z] [LOG]    Employee ID: 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:29.887Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:49:29.887Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:49:29.887Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-23T05:49:30.138Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:49:30.138Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-23T05:49:30.138Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T05:49:30.139Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-23T05:49:30.139Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:49:30.139Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:49:30.140Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:49:31.063Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:49:31.064Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:49:31.256Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:49:31.257Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:49:31.257Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:49:31.257Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:49:31.258Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:49:31.258Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:49:31.258Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:49:31.258Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:49:31.488Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:49:31.489Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:49:31.489Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:49:31.489Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:49:31.733Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:49:31.734Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:49:31.734Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:49:31.735Z] [LOG]       Current Time: 11:19:31
[2025-10-23T05:49:31.735Z] [LOG]       Expected Hours (scheduled → now): 2.83h
[2025-10-23T05:49:31.735Z] [LOG]       Actual Hours (check-in → now): 2.83h
[2025-10-23T05:49:31.736Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:49:31.736Z] [LOG]       Weekday: 121.83h
[2025-10-23T05:49:31.736Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:49:31.737Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:31.737Z] [LOG]       Total Expected: 135.33h
[2025-10-23T05:49:31.737Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:49:31.737Z] [LOG]       Weekday: 28.33h (includes 2.83h live)
[2025-10-23T05:49:31.738Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:49:31.738Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:31.738Z] [LOG]       Total Actual: 32.83h
[2025-10-23T05:49:31.739Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:49:31.739Z] [LOG]       Weekday: 121.83h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:31.739Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:31.739Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:31.740Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:31.740Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-23T05:49:31.740Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:49:31.740Z] [LOG]       Weekday: 28.33h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:31.741Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:31.741Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:31.741Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:31.741Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-23T05:49:31.742Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:49:31.742Z] [LOG]       Calculated At: Oct 23, 2025, 11:19:31
[2025-10-23T05:49:31.743Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-23T05:49:31.743Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-23T05:49:31.743Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:31.743Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-23T05:49:31.743Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:49:31.744Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-23T05:49:31.744Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:49:31.744Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:49:31.744Z] [LOG]    Base Salary (Full): Rs.NaN
[2025-10-23T05:49:31.745Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:49:31.745Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:49:31.745Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:49:31.745Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:49:31.746Z] [LOG]    Gross Salary: 0
[2025-10-23T05:49:31.746Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:49:31.747Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:49:31.747Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.748Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:49:31.749Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.749Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:49:31.749Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.749Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:49:31.750Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.750Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:49:31.750Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.750Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:49:31.751Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.751Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:49:31.751Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.752Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:49:31.752Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.752Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:49:31.753Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.753Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:49:31.753Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.754Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:49:31.754Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-23T05:49:31.755Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:49:31.755Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:49:31.755Z] [LOG] 💰 GROSS CALCULATION for customer null:
[2025-10-23T05:49:31.755Z] [LOG]    Base Salary: 0
[2025-10-23T05:49:31.756Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:49:31.756Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:49:31.756Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.756Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:49:31.757Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.757Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:49:31.757Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:31.965Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:49:31.965Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:31.965Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:49:31.966Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:49:31.966Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T05:49:31.966Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:49:31.966Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:49:31.966Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-23T05:49:31.966Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:49:31.966Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:49:31.967Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:31.967Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:49:31.967Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:49:31.968Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-23T05:49:31.968Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:49:31.968Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-23T05:49:31.968Z] [LOG] 
💾 Database Update:
[2025-10-23T05:49:31.969Z] [LOG]    Total Earnings: Rs.0.00 (Base: 0.00 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:49:31.969Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:49:32.206Z] [LOG] 
📝 Components to save:
[2025-10-23T05:49:32.206Z] [LOG]    Gross/Earnings components: 0
[2025-10-23T05:49:32.206Z] [LOG]    Deduction components: 0
[2025-10-23T05:49:32.207Z] [LOG] Creating components for record e0f25dd8-9f6f-4880-985d-2d002baaf013: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-23T05:49:32.687Z] [LOG] ✅ Financial balances updated successfully for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:32.688Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:49:32.688Z] [LOG] 
======================================================================
[2025-10-23T05:49:32.688Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: customer null
[2025-10-23T05:49:32.688Z] [LOG] ======================================================================
[2025-10-23T05:49:32.688Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T05:49:32.688Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-23T05:49:32.688Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T05:49:32.688Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:32.689Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:32.689Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:49:32.689Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:32.689Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-23T05:49:32.689Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:32.689Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:49:32.689Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:49:32.689Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:49:32.690Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:49:32.690Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-23T05:49:32.690Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:32.690Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:32.690Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-23T05:49:32.691Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:49:32.691Z] [LOG] ======================================================================

[2025-10-23T05:49:32.691Z] [LOG] ✅ customer null: Calculation completed successfully
[2025-10-23T05:49:32.691Z] [LOG] 📊 Progress: 31/34 (91.2%)
[2025-10-23T05:49:32.691Z] [LOG] 
🧮 Processing: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-23T05:49:32.692Z] [LOG] 📋 Record ID: e6371ac5-28d8-404d-ac7c-d301555ae4fe
[2025-10-23T05:49:32.692Z] [LOG] 
======================================================================
[2025-10-23T05:49:32.692Z] [LOG] 🧮 CALCULATING PAYROLL: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-23T05:49:32.692Z] [LOG] ======================================================================
[2025-10-23T05:49:33.634Z] [LOG] 🔍 Component filtering for employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-23T05:49:33.635Z] [LOG]    Total components: 13
[2025-10-23T05:49:33.635Z] [LOG]    Applicable components: 13
[2025-10-23T05:49:33.635Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T05:49:35.575Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:49:35.575Z] [LOG] 🔄 Processing financial records for employee 0144315c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:49:35.828Z] [LOG] 📊 Found 0 active loans for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:36.054Z] [LOG] 📊 Found 0 active advances for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:36.287Z] [LOG] 📊 Found 0 approved bonuses for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:36.288Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:49:36.288Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:49:36.526Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:49:36.526Z] [LOG]    Employee ID: 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:36.527Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:49:36.527Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:49:36.527Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:49:36.771Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:49:36.771Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:49:36.771Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:49:36.771Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:49:36.772Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:49:36.772Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:49:36.772Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:49:37.487Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:49:37.488Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:49:37.727Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:49:37.728Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:49:37.728Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:49:37.728Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:49:37.729Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:49:37.729Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:49:37.729Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:49:37.729Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:49:37.966Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:49:37.966Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:49:37.966Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:49:37.966Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:49:38.209Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:49:38.209Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:49:38.209Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:49:38.210Z] [LOG]       Current Time: 11:19:38
[2025-10-23T05:49:38.210Z] [LOG]       Expected Hours (scheduled → now): 2.83h
[2025-10-23T05:49:38.211Z] [LOG]       Actual Hours (check-in → now): 2.83h
[2025-10-23T05:49:38.211Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:49:38.211Z] [LOG]       Weekday: 121.83h
[2025-10-23T05:49:38.211Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:49:38.212Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:38.212Z] [LOG]       Total Expected: 135.33h
[2025-10-23T05:49:38.212Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:49:38.212Z] [LOG]       Weekday: 28.33h (includes 2.83h live)
[2025-10-23T05:49:38.212Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:49:38.213Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:38.213Z] [LOG]       Total Actual: 32.83h
[2025-10-23T05:49:38.213Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:49:38.214Z] [LOG]       Weekday: 121.83h × Rs.235.29 = Rs.28664.74
[2025-10-23T05:49:38.214Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:49:38.214Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:38.214Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:38.214Z] [LOG]       Total Expected Earned: Rs.34664.68
[2025-10-23T05:49:38.214Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:49:38.215Z] [LOG]       Weekday: 28.33h × Rs.235.29 = Rs.6665.13
[2025-10-23T05:49:38.215Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:49:38.215Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:38.215Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:38.216Z] [LOG]       Total Actual Earned: Rs.8665.11
[2025-10-23T05:49:38.216Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:49:38.217Z] [LOG]       Calculated At: Oct 23, 2025, 11:19:38
[2025-10-23T05:49:38.217Z] [LOG]       Expected Earned (until NOW): Rs.34664.68
[2025-10-23T05:49:38.217Z] [LOG]       Actual Earned (until NOW): Rs.8665.11
[2025-10-23T05:49:38.218Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:38.218Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:49:38.218Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:49:38.218Z] [LOG]       📉 Shortfall: 102.50 hours (75.00% of expected)
[2025-10-23T05:49:38.219Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:49:38.219Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:49:38.219Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:49:38.220Z] [LOG]    Actual Earned Base: Rs.8665.11
[2025-10-23T05:49:38.220Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:49:38.220Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:49:38.221Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:49:38.221Z] [LOG]    Gross Salary: 8665.105776558334
[2025-10-23T05:49:38.221Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:49:38.221Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:49:38.222Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.222Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:49:38.222Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.223Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:49:38.223Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.224Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:49:38.224Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.224Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:49:38.224Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.224Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:49:38.225Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.225Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:49:38.225Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.225Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:49:38.225Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.225Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:49:38.225Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.226Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:49:38.226Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.226Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:49:38.226Z] [LOG]    EPF/ETF calculated on: Rs.8665.11
[2025-10-23T05:49:38.227Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:49:38.227Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:49:38.227Z] [LOG] 💰 GROSS CALCULATION for G.M Supathala Sadaru Madhushan null:
[2025-10-23T05:49:38.227Z] [LOG]    Base Salary: 50000
[2025-10-23T05:49:38.228Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:49:38.228Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:49:38.228Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.229Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:49:38.229Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.229Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:49:38.230Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:38.447Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:49:38.447Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:38.447Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:49:38.447Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:49:38.447Z] [LOG]    Actual Earned Base: Rs.8665.11
[2025-10-23T05:49:38.447Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:49:38.448Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:49:38.448Z] [LOG]    = Gross Salary: Rs.8665.11
[2025-10-23T05:49:38.448Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:49:38.448Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:49:38.448Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:49:38.448Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:38.448Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:49:38.448Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:49:38.449Z] [LOG]    Gross Salary: Rs.8665.11
[2025-10-23T05:49:38.449Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:49:38.449Z] [LOG]    = NET SALARY: Rs.8665.11
[2025-10-23T05:49:38.449Z] [LOG] 
💾 Database Update:
[2025-10-23T05:49:38.449Z] [LOG]    Total Earnings: Rs.8665.11 (Base: 8665.11 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:49:38.450Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:49:38.696Z] [LOG] 
📝 Components to save:
[2025-10-23T05:49:38.696Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:49:38.697Z] [LOG]    Deduction components: 1
[2025-10-23T05:49:38.697Z] [LOG] Creating components for record e6371ac5-28d8-404d-ac7c-d301555ae4fe: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:49:38.698Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8665.105776558334
}
[2025-10-23T05:49:38.963Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:49:39.347Z] [LOG] Created payroll_record_component: 36915303-2703-4a4e-a464-6b1e1d43045d for Base Salary
[2025-10-23T05:49:39.347Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:49:39.535Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:49:39.731Z] [LOG] Created payroll_record_component: 91363818-440e-4a05-b025-c7ffb3e719fc for Attendance Shortfall (Info)
[2025-10-23T05:49:40.205Z] [LOG] ✅ Financial balances updated successfully for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:40.205Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:49:40.206Z] [LOG] 
======================================================================
[2025-10-23T05:49:40.206Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: G.M Supathala Sadaru Madhushan null
[2025-10-23T05:49:40.206Z] [LOG] ======================================================================
[2025-10-23T05:49:40.206Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:49:40.206Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8665.11
[2025-10-23T05:49:40.206Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:49:40.207Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:40.207Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:40.207Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:49:40.207Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:40.207Z] [LOG]    GROSS SALARY: Rs.8665.11
[2025-10-23T05:49:40.207Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:40.208Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:49:40.208Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:49:40.208Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:49:40.208Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:49:40.208Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:49:40.208Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:40.209Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:40.209Z] [LOG]    NET SALARY: Rs.8665.11
[2025-10-23T05:49:40.209Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:49:40.209Z] [LOG] ======================================================================

[2025-10-23T05:49:40.209Z] [LOG] ✅ G.M Supathala Sadaru Madhushan null: Calculation completed successfully
[2025-10-23T05:49:40.210Z] [LOG] 📊 Progress: 32/34 (94.1%)
[2025-10-23T05:49:40.210Z] [LOG] 
🧮 Processing: Franklin null (EMP000018)
[2025-10-23T05:49:40.210Z] [LOG] 📋 Record ID: efa4858e-0185-4e8c-9481-a64581fe111d
[2025-10-23T05:49:40.210Z] [LOG] 
======================================================================
[2025-10-23T05:49:40.210Z] [LOG] 🧮 CALCULATING PAYROLL: Franklin null (EMP000018)
[2025-10-23T05:49:40.211Z] [LOG] ======================================================================
[2025-10-23T05:49:41.326Z] [LOG] 🔍 Component filtering for employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-23T05:49:41.327Z] [LOG]    Total components: 13
[2025-10-23T05:49:41.327Z] [LOG]    Applicable components: 13
[2025-10-23T05:49:41.327Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T05:49:42.656Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:49:42.657Z] [LOG] 🔄 Processing financial records for employee 0143c037-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:49:42.848Z] [LOG] 📊 Found 0 active loans for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:43.050Z] [LOG] 📊 Found 0 active advances for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:43.259Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:43.260Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:49:43.260Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:49:43.474Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:49:43.474Z] [LOG]    Employee ID: 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:43.474Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:49:43.474Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:49:43.474Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T05:49:43.686Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:49:43.686Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T05:49:43.686Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T05:49:43.687Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T05:49:43.687Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:49:43.687Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:49:43.687Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:49:44.376Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:49:44.376Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:49:44.579Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:49:44.579Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:49:44.580Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:49:44.580Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:49:44.580Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:49:44.580Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:49:44.580Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:49:44.581Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:49:44.770Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:49:44.771Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:49:44.771Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:49:44.771Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:49:44.982Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:49:44.982Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:49:44.983Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:49:44.984Z] [LOG]       Current Time: 11:19:44
[2025-10-23T05:49:44.984Z] [LOG]       Expected Hours (scheduled → now): 2.83h
[2025-10-23T05:49:44.984Z] [LOG]       Actual Hours (check-in → now): 2.83h
[2025-10-23T05:49:44.985Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:49:44.985Z] [LOG]       Weekday: 121.83h
[2025-10-23T05:49:44.986Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:49:44.986Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:44.986Z] [LOG]       Total Expected: 135.33h
[2025-10-23T05:49:44.986Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:49:44.987Z] [LOG]       Weekday: 28.33h (includes 2.83h live)
[2025-10-23T05:49:44.987Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:49:44.987Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:44.988Z] [LOG]       Total Actual: 32.83h
[2025-10-23T05:49:44.988Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:49:44.988Z] [LOG]       Weekday: 121.83h × Rs.235.29 = Rs.28665.18
[2025-10-23T05:49:44.988Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T05:49:44.989Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:44.989Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:44.989Z] [LOG]       Total Expected Earned: Rs.34665.12
[2025-10-23T05:49:44.989Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:49:44.990Z] [LOG]       Weekday: 28.33h × Rs.235.29 = Rs.6665.57
[2025-10-23T05:49:44.990Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T05:49:44.990Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:44.990Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:44.990Z] [LOG]       Total Actual Earned: Rs.8665.55
[2025-10-23T05:49:44.991Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:49:44.992Z] [LOG]       Calculated At: Oct 23, 2025, 11:19:44
[2025-10-23T05:49:44.992Z] [LOG]       Expected Earned (until NOW): Rs.34665.12
[2025-10-23T05:49:44.992Z] [LOG]       Actual Earned (until NOW): Rs.8665.55
[2025-10-23T05:49:44.992Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:44.993Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T05:49:44.993Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:49:44.993Z] [LOG]       📉 Shortfall: 102.50 hours (75.00% of expected)
[2025-10-23T05:49:44.994Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:49:44.994Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:49:44.994Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:49:44.995Z] [LOG]    Actual Earned Base: Rs.8665.55
[2025-10-23T05:49:44.995Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:49:44.996Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:49:44.996Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:49:44.997Z] [LOG]    Gross Salary: 8665.54844855
[2025-10-23T05:49:44.997Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:49:44.997Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:49:44.998Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:44.998Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:49:44.998Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:44.998Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:49:44.998Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:44.998Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:49:44.999Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:44.999Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:49:44.999Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:44.999Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:49:45.000Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:45.000Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:49:45.000Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:45.000Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:49:45.000Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:45.001Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:49:45.001Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:45.001Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:49:45.002Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:45.002Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:49:45.003Z] [LOG]    EPF/ETF calculated on: Rs.8665.55
[2025-10-23T05:49:45.003Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:49:45.003Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:49:45.003Z] [LOG] 💰 GROSS CALCULATION for Franklin null:
[2025-10-23T05:49:45.003Z] [LOG]    Base Salary: 50000
[2025-10-23T05:49:45.004Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:49:45.004Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:49:45.004Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:45.004Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:49:45.004Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:45.004Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:49:45.005Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:45.201Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:49:45.202Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:45.202Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:49:45.202Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:49:45.203Z] [LOG]    Actual Earned Base: Rs.8665.55
[2025-10-23T05:49:45.203Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:49:45.203Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:49:45.203Z] [LOG]    = Gross Salary: Rs.8665.55
[2025-10-23T05:49:45.204Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:49:45.204Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:49:45.204Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:49:45.205Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:45.205Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:49:45.205Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:49:45.206Z] [LOG]    Gross Salary: Rs.8665.55
[2025-10-23T05:49:45.206Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:49:45.206Z] [LOG]    = NET SALARY: Rs.8665.55
[2025-10-23T05:49:45.206Z] [LOG] 
💾 Database Update:
[2025-10-23T05:49:45.207Z] [LOG]    Total Earnings: Rs.8665.55 (Base: 8665.55 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:49:45.207Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:49:45.396Z] [LOG] 
📝 Components to save:
[2025-10-23T05:49:45.396Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:49:45.397Z] [LOG]    Deduction components: 1
[2025-10-23T05:49:45.397Z] [LOG] Creating components for record efa4858e-0185-4e8c-9481-a64581fe111d: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:49:45.397Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8665.54844855
}
[2025-10-23T05:49:45.590Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:49:45.809Z] [LOG] Created payroll_record_component: d1e6f589-6d9a-400f-89a6-7ee748f4e353 for Base Salary
[2025-10-23T05:49:45.810Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T05:49:46.006Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:49:46.195Z] [LOG] Created payroll_record_component: 75be2cba-754e-480c-b14d-9045c65a6348 for Attendance Shortfall (Info)
[2025-10-23T05:49:46.614Z] [LOG] ✅ Financial balances updated successfully for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:46.614Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:49:46.615Z] [LOG] 
======================================================================
[2025-10-23T05:49:46.615Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Franklin null
[2025-10-23T05:49:46.616Z] [LOG] ======================================================================
[2025-10-23T05:49:46.616Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T05:49:46.616Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8665.55
[2025-10-23T05:49:46.616Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T05:49:46.617Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:46.617Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:46.617Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:49:46.617Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:46.618Z] [LOG]    GROSS SALARY: Rs.8665.55
[2025-10-23T05:49:46.618Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:46.618Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:49:46.619Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:49:46.619Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:49:46.619Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:49:46.619Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T05:49:46.620Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:46.620Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:46.620Z] [LOG]    NET SALARY: Rs.8665.55
[2025-10-23T05:49:46.620Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:49:46.620Z] [LOG] ======================================================================

[2025-10-23T05:49:46.621Z] [LOG] ✅ Franklin null: Calculation completed successfully
[2025-10-23T05:49:46.621Z] [LOG] 📊 Progress: 33/34 (97.1%)
[2025-10-23T05:49:46.621Z] [LOG] 
🧮 Processing: Sumaiya null (EMP000016)
[2025-10-23T05:49:46.622Z] [LOG] 📋 Record ID: fd0e54af-5936-4270-a6ee-42efaab5cd44
[2025-10-23T05:49:46.622Z] [LOG] 
======================================================================
[2025-10-23T05:49:46.622Z] [LOG] 🧮 CALCULATING PAYROLL: Sumaiya null (EMP000016)
[2025-10-23T05:49:46.623Z] [LOG] ======================================================================
[2025-10-23T05:49:47.496Z] [LOG] 🔍 Component filtering for employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-23T05:49:47.497Z] [LOG]    Total components: 13
[2025-10-23T05:49:47.497Z] [LOG]    Applicable components: 13
[2025-10-23T05:49:47.497Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T05:49:49.088Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T05:49:49.088Z] [LOG] 🔄 Processing financial records for employee 0143b22f-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T05:49:49.327Z] [LOG] 📊 Found 0 active loans for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:49.575Z] [LOG] 📊 Found 0 active advances for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:49.839Z] [LOG] 📊 Found 0 approved bonuses for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:49.839Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T05:49:49.840Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T05:49:50.047Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T05:49:50.048Z] [LOG]    Employee ID: 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:50.048Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T05:49:50.048Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T05:49:50.049Z] [LOG]    Base Salary (Full Month): Rs.60000.00
[2025-10-23T05:49:50.298Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T05:49:50.298Z] [LOG]       Daily Salary: Rs.2400.00
[2025-10-23T05:49:50.298Z] [LOG]       Weekday Hourly Rate: Rs.282.35
[2025-10-23T05:49:50.299Z] [LOG]       Saturday Hourly Rate: Rs.533.33
[2025-10-23T05:49:50.299Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T05:49:50.299Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T05:49:50.300Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T05:49:51.014Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T05:49:51.014Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T05:49:51.248Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T05:49:51.249Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T05:49:51.249Z] [LOG]       Total completed sessions found: 4
[2025-10-23T05:49:51.250Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T05:49:51.250Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T05:49:51.250Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T05:49:51.251Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T05:49:51.251Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T05:49:51.487Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T05:49:51.487Z] [LOG]          Weekday: 25.50h
[2025-10-23T05:49:51.487Z] [LOG]          Saturday: 4.50h
[2025-10-23T05:49:51.488Z] [LOG]          Sunday: 0.00h
[2025-10-23T05:49:51.686Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T05:49:51.686Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T05:49:51.687Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T05:49:51.687Z] [LOG]       Current Time: 11:19:51
[2025-10-23T05:49:51.688Z] [LOG]       Expected Hours (scheduled → now): 2.83h
[2025-10-23T05:49:51.688Z] [LOG]       Actual Hours (check-in → now): 2.83h
[2025-10-23T05:49:51.688Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T05:49:51.689Z] [LOG]       Weekday: 121.83h
[2025-10-23T05:49:51.689Z] [LOG]       Saturday: 13.50h
[2025-10-23T05:49:51.689Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:51.689Z] [LOG]       Total Expected: 135.33h
[2025-10-23T05:49:51.690Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T05:49:51.690Z] [LOG]       Weekday: 28.33h (includes 2.83h live)
[2025-10-23T05:49:51.690Z] [LOG]       Saturday: 4.50h
[2025-10-23T05:49:51.690Z] [LOG]       Sunday: 0.00h
[2025-10-23T05:49:51.691Z] [LOG]       Total Actual: 32.83h
[2025-10-23T05:49:51.691Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T05:49:51.691Z] [LOG]       Weekday: 121.83h × Rs.282.35 = Rs.34398.99
[2025-10-23T05:49:51.691Z] [LOG]       Saturday: 13.50h × Rs.533.33 = Rs.7199.96
[2025-10-23T05:49:51.692Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:51.692Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:51.692Z] [LOG]       Total Expected Earned: Rs.41598.94
[2025-10-23T05:49:51.692Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T05:49:51.693Z] [LOG]       Weekday: 28.33h × Rs.282.35 = Rs.7999.26
[2025-10-23T05:49:51.693Z] [LOG]       Saturday: 4.50h × Rs.533.33 = Rs.2399.99
[2025-10-23T05:49:51.693Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T05:49:51.694Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:51.694Z] [LOG]       Total Actual Earned: Rs.10399.25
[2025-10-23T05:49:51.695Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T05:49:51.695Z] [LOG]       Calculated At: Oct 23, 2025, 11:19:51
[2025-10-23T05:49:51.695Z] [LOG]       Expected Earned (until NOW): Rs.41598.94
[2025-10-23T05:49:51.696Z] [LOG]       Actual Earned (until NOW): Rs.10399.25
[2025-10-23T05:49:51.696Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T05:49:51.697Z] [LOG]       Attendance Deduction: Rs.31199.69
[2025-10-23T05:49:51.698Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T05:49:51.698Z] [LOG]       📉 Shortfall: 102.50 hours (75.00% of expected)
[2025-10-23T05:49:51.699Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T05:49:51.699Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T05:49:51.699Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T05:49:51.699Z] [LOG]    Actual Earned Base: Rs.10399.25
[2025-10-23T05:49:51.699Z] [LOG]    Attendance Shortfall: Rs.31199.69
[2025-10-23T05:49:51.699Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T05:49:51.700Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T05:49:51.700Z] [LOG]    Gross Salary: 10399.249595027779
[2025-10-23T05:49:51.700Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T05:49:51.701Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T05:49:51.701Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.701Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T05:49:51.702Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.702Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T05:49:51.702Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.702Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T05:49:51.702Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.702Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T05:49:51.703Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.703Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T05:49:51.703Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.703Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T05:49:51.704Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.704Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T05:49:51.704Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.704Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T05:49:51.705Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.705Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T05:49:51.705Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.706Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T05:49:51.706Z] [LOG]    EPF/ETF calculated on: Rs.10399.25
[2025-10-23T05:49:51.706Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T05:49:51.706Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T05:49:51.707Z] [LOG] 💰 GROSS CALCULATION for Sumaiya null:
[2025-10-23T05:49:51.707Z] [LOG]    Base Salary: 60000
[2025-10-23T05:49:51.707Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T05:49:51.708Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T05:49:51.708Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.708Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T05:49:51.708Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.709Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T05:49:51.709Z] [LOG]    Fixed amount: 0
[2025-10-23T05:49:51.934Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T05:49:51.935Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:51.935Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T05:49:51.935Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T05:49:51.935Z] [LOG]    Actual Earned Base: Rs.10399.25
[2025-10-23T05:49:51.936Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T05:49:51.936Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T05:49:51.936Z] [LOG]    = Gross Salary: Rs.10399.25
[2025-10-23T05:49:51.936Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T05:49:51.937Z] [LOG]    Attendance Shortfall (Info): Rs.31199.69
[2025-10-23T05:49:51.937Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T05:49:51.937Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:51.938Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T05:49:51.938Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T05:49:51.938Z] [LOG]    Gross Salary: Rs.10399.25
[2025-10-23T05:49:51.939Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T05:49:51.939Z] [LOG]    = NET SALARY: Rs.10399.25
[2025-10-23T05:49:51.939Z] [LOG] 
💾 Database Update:
[2025-10-23T05:49:51.939Z] [LOG]    Total Earnings: Rs.10399.25 (Base: 10399.25 + Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T05:49:51.940Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T05:49:52.139Z] [LOG] 
📝 Components to save:
[2025-10-23T05:49:52.140Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T05:49:52.140Z] [LOG]    Deduction components: 1
[2025-10-23T05:49:52.140Z] [LOG] Creating components for record fd0e54af-5936-4270-a6ee-42efaab5cd44: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T05:49:52.141Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10399.249595027779
}
[2025-10-23T05:49:52.336Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T05:49:52.532Z] [LOG] Created payroll_record_component: fe700b2f-8d62-441d-a8b0-d1cce7ba1f0b for Base Salary
[2025-10-23T05:49:52.532Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 31199.695
}
[2025-10-23T05:49:52.777Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T05:49:53.006Z] [LOG] Created payroll_record_component: 47a70975-6595-42be-b139-79d63f553437 for Attendance Shortfall (Info)
[2025-10-23T05:49:53.544Z] [LOG] ✅ Financial balances updated successfully for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T05:49:53.544Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T05:49:53.544Z] [LOG] 
======================================================================
[2025-10-23T05:49:53.545Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sumaiya null
[2025-10-23T05:49:53.545Z] [LOG] ======================================================================
[2025-10-23T05:49:53.545Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T05:49:53.546Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10399.25
[2025-10-23T05:49:53.546Z] [LOG]    Attendance Shortfall: Rs.31199.69
[2025-10-23T05:49:53.546Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:53.546Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T05:49:53.547Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T05:49:53.547Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:53.548Z] [LOG]    GROSS SALARY: Rs.10399.25
[2025-10-23T05:49:53.548Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:53.548Z] [LOG]    Deductions Breakdown:
[2025-10-23T05:49:53.549Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T05:49:53.549Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T05:49:53.549Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T05:49:53.549Z] [LOG]       - Attendance Shortfall (Info): Rs.31199.69
[2025-10-23T05:49:53.549Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T05:49:53.550Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T05:49:53.551Z] [LOG]    NET SALARY: Rs.10399.25
[2025-10-23T05:49:53.551Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T05:49:53.551Z] [LOG] ======================================================================

[2025-10-23T05:49:53.552Z] [LOG] ✅ Sumaiya null: Calculation completed successfully
[2025-10-23T05:49:53.552Z] [LOG] 📊 Progress: 34/34 (100.0%)
[2025-10-23T05:49:53.552Z] [LOG] 
============================================================
[2025-10-23T05:49:53.553Z] [LOG] 📈 Processing Summary: 34 successful, 0 failed
[2025-10-23T05:49:55.505Z] [LOG] 🎉 Payroll calculation completed successfully!
[2025-10-23T05:49:55.505Z] [LOG] 📊 Final Summary: 34 processed, 0 errors
[2025-10-23T05:49:55.506Z] [INFO] ================================================================================
[2025-10-23T05:49:55.506Z] [INFO] ⏰ Completed at: 2025-10-23T05:49:55.506Z
[2025-10-23T05:49:55.506Z] [INFO] 📊 Total log entries: 5977