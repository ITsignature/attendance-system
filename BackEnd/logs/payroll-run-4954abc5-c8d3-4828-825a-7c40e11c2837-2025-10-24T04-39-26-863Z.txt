[2025-10-24T04:39:26.863Z] [INFO] 🚀 Payroll calculation logging started for run: 4954abc5-c8d3-4828-825a-7c40e11c2837
[2025-10-24T04:39:26.863Z] [INFO] 📁 Log file: D:\attendance-system\BackEnd\logs\payroll-run-4954abc5-c8d3-4828-825a-7c40e11c2837-2025-10-24T04-39-26-863Z.txt
[2025-10-24T04:39:26.863Z] [INFO] ⏰ Started at: 2025-10-24T04:39:26.863Z
[2025-10-24T04:39:26.863Z] [INFO] ================================================================================
[2025-10-24T04:39:26.863Z] [LOG] 🚀 Starting payroll calculation for run: 4954abc5-c8d3-4828-825a-7c40e11c2837
[2025-10-24T04:39:26.864Z] [LOG] 👤 Client ID: it-signature, User ID: 059304ea-24a5-4d78-a290-cf09b9e53c4c
[2025-10-24T04:39:29.068Z] [LOG] ✅ Payroll run verified: October (MONTHLY_2025_10_REGULAR)
[2025-10-24T04:39:29.506Z] [LOG] 📊 Status updated to 'calculating'
[2025-10-24T04:39:30.439Z] [LOG] 👥 Processing 34 employee records:
[2025-10-24T04:39:30.439Z] [LOG] ============================================================
[2025-10-24T04:39:30.440Z] [LOG] 
🧮 Processing: Anoj null (EMP000014)
[2025-10-24T04:39:30.441Z] [LOG] 📋 Record ID: 0c2edbd9-b43c-49a6-90c8-854e65e58381
[2025-10-24T04:39:30.443Z] [LOG] 
======================================================================
[2025-10-24T04:39:30.444Z] [LOG] 🧮 CALCULATING PAYROLL: Anoj null (EMP000014)
[2025-10-24T04:39:30.445Z] [LOG] ======================================================================
[2025-10-24T04:39:32.354Z] [LOG] 🔍 Component filtering for employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-24T04:39:32.355Z] [LOG]    Total components: 13
[2025-10-24T04:39:32.356Z] [LOG]    Applicable components: 13
[2025-10-24T04:39:32.356Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-24T04:39:35.151Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:39:35.153Z] [LOG] 🔄 Processing financial records for employee 0143afc6-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:39:35.621Z] [LOG] 📊 Found 0 active loans for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:36.091Z] [LOG] 📊 Found 0 active advances for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:36.582Z] [LOG] 📊 Found 0 approved bonuses for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:36.584Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:39:36.585Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:39:36.810Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:39:36.811Z] [LOG]    Employee ID: 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:36.811Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:39:36.812Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:39:36.813Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:39:37.047Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:39:37.048Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:39:37.048Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:39:37.049Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:39:37.049Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:39:37.050Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:39:37.051Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:39:37.759Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:39:37.760Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:39:37.988Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:39:37.989Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:39:37.990Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:39:37.990Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:39:37.991Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:39:37.992Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:39:37.992Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:39:37.993Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:39:37.993Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:39:38.218Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:39:38.219Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:39:38.219Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:39:38.220Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:39:38.453Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:39:38.454Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:39:38.454Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:39:38.455Z] [LOG]       Current Time: 10:09:38
[2025-10-24T04:39:38.456Z] [LOG]       Expected Hours (scheduled → now): 1.66h
[2025-10-24T04:39:38.457Z] [LOG]       Actual Hours (check-in → now): 1.66h
[2025-10-24T04:39:38.457Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:39:38.458Z] [LOG]       Weekday: 129.16h
[2025-10-24T04:39:38.459Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:39:38.459Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:39:38.460Z] [LOG]       Total Expected: 142.66h
[2025-10-24T04:39:38.461Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:39:38.462Z] [LOG]       Weekday: 35.66h (includes 1.66h live)
[2025-10-24T04:39:38.463Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:39:38.463Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:39:38.464Z] [LOG]       Total Actual: 40.16h
[2025-10-24T04:39:38.464Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:39:38.465Z] [LOG]       Weekday: 129.16h × Rs.235.29 = Rs.30390.22
[2025-10-24T04:39:38.466Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:39:38.467Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:39:38.468Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:39:38.469Z] [LOG]       Total Expected Earned: Rs.36390.16
[2025-10-24T04:39:38.469Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:39:38.470Z] [LOG]       Weekday: 35.66h × Rs.235.29 = Rs.8390.60
[2025-10-24T04:39:38.471Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:39:38.472Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:39:38.472Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:39:38.473Z] [LOG]       Total Actual Earned: Rs.10390.58
[2025-10-24T04:39:38.474Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:39:38.475Z] [LOG]       Calculated At: Oct 24, 2025, 10:09:38
[2025-10-24T04:39:38.476Z] [LOG]       Expected Earned (until NOW): Rs.36390.16
[2025-10-24T04:39:38.476Z] [LOG]       Actual Earned (until NOW): Rs.10390.58
[2025-10-24T04:39:38.477Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:39:38.477Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-24T04:39:38.478Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:39:38.478Z] [LOG]       📉 Shortfall: 102.50 hours (71.45% of expected)
[2025-10-24T04:39:38.479Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:39:38.480Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:39:38.480Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:39:38.481Z] [LOG]    Actual Earned Base: Rs.10390.58
[2025-10-24T04:39:38.482Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:39:38.483Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:39:38.485Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:39:38.486Z] [LOG]    Gross Salary: 10390.581723991667
[2025-10-24T04:39:38.487Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:39:38.488Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:39:38.489Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.490Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:39:38.490Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.491Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:39:38.491Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.492Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:39:38.493Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.493Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:39:38.494Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.495Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:39:38.495Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.496Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:39:38.496Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.497Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:39:38.498Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.498Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:39:38.498Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.499Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:39:38.499Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.500Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:39:38.500Z] [LOG]    EPF/ETF calculated on: Rs.10390.58
[2025-10-24T04:39:38.500Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:39:38.500Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:39:38.502Z] [LOG] 💰 GROSS CALCULATION for Anoj null:
[2025-10-24T04:39:38.502Z] [LOG]    Base Salary: 50000
[2025-10-24T04:39:38.502Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:39:38.503Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:39:38.503Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.503Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:39:38.504Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.504Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:39:38.504Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:38.955Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:39:38.956Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:39:38.956Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:39:38.957Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:39:38.957Z] [LOG]    Actual Earned Base: Rs.10390.58
[2025-10-24T04:39:38.958Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:39:38.959Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:39:38.959Z] [LOG]    = Gross Salary: Rs.10390.58
[2025-10-24T04:39:38.960Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:39:38.961Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:39:38.961Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:39:38.962Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:39:38.963Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:39:38.963Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:39:38.964Z] [LOG]    Gross Salary: Rs.10390.58
[2025-10-24T04:39:38.965Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:39:38.965Z] [LOG]    = NET SALARY: Rs.10390.58
[2025-10-24T04:39:38.966Z] [LOG] 
💾 Database Update:
[2025-10-24T04:39:38.967Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:39:38.968Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:39:39.440Z] [LOG] 
📝 Components to save:
[2025-10-24T04:39:39.441Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:39:39.442Z] [LOG]    Deduction components: 1
[2025-10-24T04:39:39.443Z] [LOG] Creating components for record 0c2edbd9-b43c-49a6-90c8-854e65e58381: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:39:39.445Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10390.581723991667
}
[2025-10-24T04:39:39.893Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:39:40.362Z] [LOG] Created payroll_record_component: 835356be-7b1d-43d8-aaf0-62dc36c87848 for Base Salary
[2025-10-24T04:39:40.363Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-24T04:39:40.593Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:39:40.831Z] [LOG] Created payroll_record_component: bc2e947d-70a6-41b1-88c8-e437617c9cd7 for Attendance Shortfall (Info)
[2025-10-24T04:39:41.508Z] [LOG] ✅ Financial balances updated successfully for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:41.509Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:39:41.509Z] [LOG] 
======================================================================
[2025-10-24T04:39:41.509Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Anoj null
[2025-10-24T04:39:41.510Z] [LOG] ======================================================================
[2025-10-24T04:39:41.510Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:39:41.510Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10390.58
[2025-10-24T04:39:41.510Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:39:41.511Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:41.511Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:39:41.511Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:39:41.511Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:41.512Z] [LOG]    GROSS SALARY: Rs.10390.58
[2025-10-24T04:39:41.512Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:41.512Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:39:41.512Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:39:41.513Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:39:41.513Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:39:41.513Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:39:41.513Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:39:41.513Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:41.514Z] [LOG]    NET SALARY: Rs.10390.58
[2025-10-24T04:39:41.514Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:39:41.514Z] [LOG] ======================================================================

[2025-10-24T04:39:41.514Z] [LOG] ✅ Anoj null: Calculation completed successfully
[2025-10-24T04:39:41.515Z] [LOG] 📊 Progress: 1/34 (2.9%)
[2025-10-24T04:39:41.515Z] [LOG] 
🧮 Processing: Shandeep null (EMP000034)
[2025-10-24T04:39:41.515Z] [LOG] 📋 Record ID: 13f6188f-a80b-4fa5-84dc-342268beb9e4
[2025-10-24T04:39:41.516Z] [LOG] 
======================================================================
[2025-10-24T04:39:41.516Z] [LOG] 🧮 CALCULATING PAYROLL: Shandeep null (EMP000034)
[2025-10-24T04:39:41.516Z] [LOG] ======================================================================
[2025-10-24T04:39:42.421Z] [LOG] 🔍 Component filtering for employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-24T04:39:42.421Z] [LOG]    Total components: 13
[2025-10-24T04:39:42.422Z] [LOG]    Applicable components: 13
[2025-10-24T04:39:42.422Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-24T04:39:43.799Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:39:43.800Z] [LOG] 🔄 Processing financial records for employee 0143fc5a-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:39:44.034Z] [LOG] 📊 Found 0 active loans for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:44.266Z] [LOG] 📊 Found 0 active advances for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:44.470Z] [LOG] 📊 Found 0 approved bonuses for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:44.471Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:39:44.472Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:39:44.669Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:39:44.670Z] [LOG]    Employee ID: 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:44.671Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:39:44.671Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:39:44.672Z] [LOG]    Base Salary (Full Month): Rs.80000.00
[2025-10-24T04:39:44.874Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:39:44.875Z] [LOG]       Daily Salary: Rs.3200.00
[2025-10-24T04:39:44.875Z] [LOG]       Weekday Hourly Rate: Rs.376.47
[2025-10-24T04:39:44.876Z] [LOG]       Saturday Hourly Rate: Rs.711.11
[2025-10-24T04:39:44.877Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:39:44.877Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:39:44.878Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:39:45.483Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:39:45.484Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:39:45.681Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:39:45.681Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:39:45.682Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:39:45.682Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:39:45.683Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:39:45.684Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:39:45.684Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:39:45.685Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:39:45.686Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:39:45.885Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:39:45.886Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:39:45.886Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:39:45.887Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:39:46.085Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:39:46.086Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:39:46.086Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:39:46.087Z] [LOG]       Current Time: 10:09:46
[2025-10-24T04:39:46.088Z] [LOG]       Expected Hours (scheduled → now): 1.66h
[2025-10-24T04:39:46.089Z] [LOG]       Actual Hours (check-in → now): 1.66h
[2025-10-24T04:39:46.089Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:39:46.090Z] [LOG]       Weekday: 129.16h
[2025-10-24T04:39:46.091Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:39:46.091Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:39:46.092Z] [LOG]       Total Expected: 142.66h
[2025-10-24T04:39:46.093Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:39:46.094Z] [LOG]       Weekday: 35.66h (includes 1.66h live)
[2025-10-24T04:39:46.094Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:39:46.095Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:39:46.096Z] [LOG]       Total Actual: 40.16h
[2025-10-24T04:39:46.096Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:39:46.097Z] [LOG]       Weekday: 129.16h × Rs.376.47 = Rs.48625.92
[2025-10-24T04:39:46.098Z] [LOG]       Saturday: 13.50h × Rs.711.11 = Rs.9599.99
[2025-10-24T04:39:46.099Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:39:46.099Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:39:46.100Z] [LOG]       Total Expected Earned: Rs.58225.90
[2025-10-24T04:39:46.101Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:39:46.102Z] [LOG]       Weekday: 35.66h × Rs.376.47 = Rs.13425.97
[2025-10-24T04:39:46.103Z] [LOG]       Saturday: 4.50h × Rs.711.11 = Rs.3199.99
[2025-10-24T04:39:46.104Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:39:46.105Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:39:46.105Z] [LOG]       Total Actual Earned: Rs.16625.97
[2025-10-24T04:39:46.106Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:39:46.107Z] [LOG]       Calculated At: Oct 24, 2025, 10:09:46
[2025-10-24T04:39:46.108Z] [LOG]       Expected Earned (until NOW): Rs.58225.90
[2025-10-24T04:39:46.109Z] [LOG]       Actual Earned (until NOW): Rs.16625.97
[2025-10-24T04:39:46.109Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:39:46.110Z] [LOG]       Attendance Deduction: Rs.41599.93
[2025-10-24T04:39:46.110Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:39:46.111Z] [LOG]       📉 Shortfall: 102.50 hours (71.45% of expected)
[2025-10-24T04:39:46.112Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:39:46.112Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:39:46.113Z] [LOG]    Base Salary (Full): Rs.80000.00
[2025-10-24T04:39:46.114Z] [LOG]    Actual Earned Base: Rs.16625.97
[2025-10-24T04:39:46.115Z] [LOG]    Attendance Shortfall: Rs.41599.93
[2025-10-24T04:39:46.115Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:39:46.117Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:39:46.117Z] [LOG]    Gross Salary: 16625.969838875
[2025-10-24T04:39:46.118Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:39:46.118Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:39:46.118Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.119Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:39:46.119Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.119Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:39:46.120Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.120Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:39:46.120Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.121Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:39:46.121Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.121Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:39:46.122Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.122Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:39:46.122Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.122Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:39:46.123Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.123Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:39:46.123Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.123Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:39:46.124Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.124Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:39:46.124Z] [LOG]    EPF/ETF calculated on: Rs.16625.97
[2025-10-24T04:39:46.124Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:39:46.125Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:39:46.125Z] [LOG] 💰 GROSS CALCULATION for Shandeep null:
[2025-10-24T04:39:46.125Z] [LOG]    Base Salary: 80000
[2025-10-24T04:39:46.125Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:39:46.126Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:39:46.126Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.126Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:39:46.126Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.127Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:39:46.127Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:46.328Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:39:46.329Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:39:46.330Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:39:46.330Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:39:46.331Z] [LOG]    Actual Earned Base: Rs.16625.97
[2025-10-24T04:39:46.332Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:39:46.332Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:39:46.333Z] [LOG]    = Gross Salary: Rs.16625.97
[2025-10-24T04:39:46.334Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:39:46.334Z] [LOG]    Attendance Shortfall (Info): Rs.41599.93
[2025-10-24T04:39:46.335Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:39:46.336Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:39:46.337Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:39:46.337Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:39:46.338Z] [LOG]    Gross Salary: Rs.16625.97
[2025-10-24T04:39:46.339Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:39:46.339Z] [LOG]    = NET SALARY: Rs.16625.97
[2025-10-24T04:39:46.340Z] [LOG] 
💾 Database Update:
[2025-10-24T04:39:46.341Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:39:46.342Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:39:46.539Z] [LOG] 
📝 Components to save:
[2025-10-24T04:39:46.540Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:39:46.541Z] [LOG]    Deduction components: 1
[2025-10-24T04:39:46.542Z] [LOG] Creating components for record 13f6188f-a80b-4fa5-84dc-342268beb9e4: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:39:46.543Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 16625.969838875
}
[2025-10-24T04:39:46.751Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:39:46.960Z] [LOG] Created payroll_record_component: d73c70f4-28c6-4d77-aed1-829507992d97 for Base Salary
[2025-10-24T04:39:46.961Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 41599.935
}
[2025-10-24T04:39:47.165Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:39:47.375Z] [LOG] Created payroll_record_component: 4c7373c9-dd19-4466-9745-c818eeae5fea for Attendance Shortfall (Info)
[2025-10-24T04:39:47.773Z] [LOG] ✅ Financial balances updated successfully for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:47.773Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:39:47.774Z] [LOG] 
======================================================================
[2025-10-24T04:39:47.775Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Shandeep null
[2025-10-24T04:39:47.775Z] [LOG] ======================================================================
[2025-10-24T04:39:47.776Z] [LOG]    Base Salary (Full): Rs.80000.00
[2025-10-24T04:39:47.777Z] [LOG]    Actual Earned Base (Attendance-based): Rs.16625.97
[2025-10-24T04:39:47.777Z] [LOG]    Attendance Shortfall: Rs.41599.93
[2025-10-24T04:39:47.778Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:47.778Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:39:47.779Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:39:47.780Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:47.781Z] [LOG]    GROSS SALARY: Rs.16625.97
[2025-10-24T04:39:47.781Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:47.782Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:39:47.783Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:39:47.784Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:39:47.785Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:39:47.786Z] [LOG]       - Attendance Shortfall (Info): Rs.41599.93
[2025-10-24T04:39:47.786Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:39:47.787Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:47.788Z] [LOG]    NET SALARY: Rs.16625.97
[2025-10-24T04:39:47.788Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:39:47.789Z] [LOG] ======================================================================

[2025-10-24T04:39:47.790Z] [LOG] ✅ Shandeep null: Calculation completed successfully
[2025-10-24T04:39:47.790Z] [LOG] 📊 Progress: 2/34 (5.9%)
[2025-10-24T04:39:47.791Z] [LOG] 
🧮 Processing: Ishara null (EMP000011)
[2025-10-24T04:39:47.792Z] [LOG] 📋 Record ID: 1935273c-36ea-4f4e-955d-42d69f461ab4
[2025-10-24T04:39:47.792Z] [LOG] 
======================================================================
[2025-10-24T04:39:47.793Z] [LOG] 🧮 CALCULATING PAYROLL: Ishara null (EMP000011)
[2025-10-24T04:39:47.793Z] [LOG] ======================================================================
[2025-10-24T04:39:48.582Z] [LOG] 🔍 Component filtering for employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-24T04:39:48.582Z] [LOG]    Total components: 13
[2025-10-24T04:39:48.583Z] [LOG]    Applicable components: 13
[2025-10-24T04:39:48.583Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-24T04:39:50.170Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:39:50.171Z] [LOG] 🔄 Processing financial records for employee 0143ac0c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:39:50.375Z] [LOG] 📊 Found 0 active loans for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:50.573Z] [LOG] 📊 Found 0 active advances for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:50.770Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:50.771Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:39:50.773Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:39:50.977Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:39:50.977Z] [LOG]    Employee ID: 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:50.978Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:39:50.979Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:39:50.979Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:39:51.183Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:39:51.184Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:39:51.184Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:39:51.185Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:39:51.185Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:39:51.186Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:39:51.187Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:39:51.788Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:39:51.788Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:39:51.993Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:39:51.994Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:39:51.995Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:39:51.995Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:39:51.996Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:39:51.997Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:39:51.997Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:39:51.998Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:39:51.998Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:39:52.197Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:39:52.198Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:39:52.199Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:39:52.200Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:39:52.397Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:39:52.398Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:39:52.398Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:39:52.399Z] [LOG]       Current Time: 10:09:52
[2025-10-24T04:39:52.400Z] [LOG]       Expected Hours (scheduled → now): 1.66h
[2025-10-24T04:39:52.401Z] [LOG]       Actual Hours (check-in → now): 1.66h
[2025-10-24T04:39:52.401Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:39:52.404Z] [LOG]       Weekday: 129.16h
[2025-10-24T04:39:52.405Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:39:52.406Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:39:52.407Z] [LOG]       Total Expected: 142.66h
[2025-10-24T04:39:52.407Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:39:52.408Z] [LOG]       Weekday: 35.66h (includes 1.66h live)
[2025-10-24T04:39:52.409Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:39:52.410Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:39:52.410Z] [LOG]       Total Actual: 40.16h
[2025-10-24T04:39:52.411Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:39:52.412Z] [LOG]       Weekday: 129.16h × Rs.235.29 = Rs.30391.13
[2025-10-24T04:39:52.412Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:39:52.413Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:39:52.414Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:39:52.415Z] [LOG]       Total Expected Earned: Rs.36391.07
[2025-10-24T04:39:52.415Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:39:52.417Z] [LOG]       Weekday: 35.66h × Rs.235.29 = Rs.8391.51
[2025-10-24T04:39:52.417Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:39:52.418Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:39:52.419Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:39:52.419Z] [LOG]       Total Actual Earned: Rs.10391.49
[2025-10-24T04:39:52.420Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:39:52.420Z] [LOG]       Calculated At: Oct 24, 2025, 10:09:52
[2025-10-24T04:39:52.420Z] [LOG]       Expected Earned (until NOW): Rs.36391.07
[2025-10-24T04:39:52.421Z] [LOG]       Actual Earned (until NOW): Rs.10391.49
[2025-10-24T04:39:52.421Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:39:52.422Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-24T04:39:52.422Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:39:52.422Z] [LOG]       📉 Shortfall: 102.50 hours (71.44% of expected)
[2025-10-24T04:39:52.423Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:39:52.423Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:39:52.424Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:39:52.424Z] [LOG]    Actual Earned Base: Rs.10391.49
[2025-10-24T04:39:52.424Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-24T04:39:52.424Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:39:52.425Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:39:52.425Z] [LOG]    Gross Salary: 10391.493080591665
[2025-10-24T04:39:52.426Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:39:52.426Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:39:52.426Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.426Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:39:52.427Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.427Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:39:52.427Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.428Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:39:52.428Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.428Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:39:52.429Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.429Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:39:52.430Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.430Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:39:52.430Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.431Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:39:52.431Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.431Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:39:52.431Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.432Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:39:52.432Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.432Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:39:52.433Z] [LOG]    EPF/ETF calculated on: Rs.10391.49
[2025-10-24T04:39:52.434Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:39:52.434Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:39:52.434Z] [LOG] 💰 GROSS CALCULATION for Ishara null:
[2025-10-24T04:39:52.435Z] [LOG]    Base Salary: 50000
[2025-10-24T04:39:52.435Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:39:52.435Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:39:52.436Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.436Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:39:52.436Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.437Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:39:52.437Z] [LOG]    Fixed amount: 0
[2025-10-24T04:39:52.637Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:39:52.638Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:39:52.638Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:39:52.639Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:39:52.640Z] [LOG]    Actual Earned Base: Rs.10391.49
[2025-10-24T04:39:52.640Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:39:52.641Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:39:52.641Z] [LOG]    = Gross Salary: Rs.10391.49
[2025-10-24T04:39:52.642Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:39:52.642Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-24T04:39:52.643Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:39:52.644Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:39:52.644Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:39:52.645Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:39:52.646Z] [LOG]    Gross Salary: Rs.10391.49
[2025-10-24T04:39:52.647Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:39:52.647Z] [LOG]    = NET SALARY: Rs.10391.49
[2025-10-24T04:39:52.648Z] [LOG] 
💾 Database Update:
[2025-10-24T04:39:52.649Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:39:52.650Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:39:52.850Z] [LOG] 
📝 Components to save:
[2025-10-24T04:39:52.851Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:39:52.852Z] [LOG]    Deduction components: 1
[2025-10-24T04:39:52.852Z] [LOG] Creating components for record 1935273c-36ea-4f4e-955d-42d69f461ab4: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:39:52.854Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10391.493080591665
}
[2025-10-24T04:39:53.058Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:39:53.265Z] [LOG] Created payroll_record_component: af039e67-8925-4440-9206-0f7acbde32f3 for Base Salary
[2025-10-24T04:39:53.266Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-24T04:39:53.468Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:39:53.665Z] [LOG] Created payroll_record_component: 550ef1af-44fc-441e-aa83-d1398f519cb5 for Attendance Shortfall (Info)
[2025-10-24T04:39:54.057Z] [LOG] ✅ Financial balances updated successfully for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:54.057Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:39:54.058Z] [LOG] 
======================================================================
[2025-10-24T04:39:54.059Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ishara null
[2025-10-24T04:39:54.059Z] [LOG] ======================================================================
[2025-10-24T04:39:54.060Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:39:54.061Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10391.49
[2025-10-24T04:39:54.061Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-24T04:39:54.062Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:54.062Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:39:54.063Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:39:54.064Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:54.065Z] [LOG]    GROSS SALARY: Rs.10391.49
[2025-10-24T04:39:54.065Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:54.066Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:39:54.067Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:39:54.068Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:39:54.069Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:39:54.069Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-24T04:39:54.070Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:39:54.071Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:39:54.071Z] [LOG]    NET SALARY: Rs.10391.49
[2025-10-24T04:39:54.072Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:39:54.072Z] [LOG] ======================================================================

[2025-10-24T04:39:54.073Z] [LOG] ✅ Ishara null: Calculation completed successfully
[2025-10-24T04:39:54.074Z] [LOG] 📊 Progress: 3/34 (8.8%)
[2025-10-24T04:39:54.075Z] [LOG] 
🧮 Processing: Nimdiya Ranasinghe null (EMP000045)
[2025-10-24T04:39:54.075Z] [LOG] 📋 Record ID: 248c9a63-73a9-4c6a-9831-c70dc1ac41e2
[2025-10-24T04:39:54.076Z] [LOG] 
======================================================================
[2025-10-24T04:39:54.077Z] [LOG] 🧮 CALCULATING PAYROLL: Nimdiya Ranasinghe null (EMP000045)
[2025-10-24T04:39:54.077Z] [LOG] ======================================================================
[2025-10-24T04:39:55.276Z] [LOG] 🔍 Component filtering for employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-24T04:39:55.277Z] [LOG]    Total components: 13
[2025-10-24T04:39:55.277Z] [LOG]    Applicable components: 13
[2025-10-24T04:39:55.278Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-24T04:39:56.504Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:39:56.504Z] [LOG] 🔄 Processing financial records for employee 01444074-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:39:56.705Z] [LOG] 📊 Found 0 active loans for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:56.906Z] [LOG] 📊 Found 0 active advances for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:57.930Z] [LOG] 📊 Found 0 approved bonuses for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:57.931Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:39:57.931Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:39:58.138Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:39:58.138Z] [LOG]    Employee ID: 01444074-7105-11f0-a50f-98e743540430
[2025-10-24T04:39:58.138Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:39:58.138Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:39:58.138Z] [LOG]    Base Salary (Full Month): Rs.35000.00
[2025-10-24T04:39:58.752Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:39:58.753Z] [LOG]       Daily Salary: Rs.1400.00
[2025-10-24T04:39:58.753Z] [LOG]       Weekday Hourly Rate: Rs.164.71
[2025-10-24T04:39:58.753Z] [LOG]       Saturday Hourly Rate: Rs.311.11
[2025-10-24T04:39:58.753Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:39:58.753Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:39:58.753Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:39:59.373Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:39:59.374Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:39:59.583Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:39:59.583Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:39:59.583Z] [LOG]       Total completed sessions found: 4
[2025-10-24T04:39:59.583Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:39:59.584Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:39:59.584Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:39:59.584Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:39:59.584Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:39:59.791Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:39:59.792Z] [LOG]          Weekday: 25.50h
[2025-10-24T04:39:59.792Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:39:59.792Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:39:59.995Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:39:59.996Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:39:59.996Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:39:59.997Z] [LOG]       Current Time: 10:09:59
[2025-10-24T04:39:59.997Z] [LOG]       Expected Hours (scheduled → now): 1.67h
[2025-10-24T04:39:59.997Z] [LOG]       Actual Hours (check-in → now): 1.67h
[2025-10-24T04:39:59.997Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:39:59.997Z] [LOG]       Weekday: 129.17h
[2025-10-24T04:39:59.998Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:39:59.998Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:39:59.998Z] [LOG]       Total Expected: 142.67h
[2025-10-24T04:39:59.998Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:39:59.998Z] [LOG]       Weekday: 27.17h (includes 1.67h live)
[2025-10-24T04:39:59.998Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:39:59.999Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:39:59.999Z] [LOG]       Total Actual: 31.67h
[2025-10-24T04:39:59.999Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:39:59.999Z] [LOG]       Weekday: 129.17h × Rs.164.71 = Rs.21275.04
[2025-10-24T04:39:59.999Z] [LOG]       Saturday: 13.50h × Rs.311.11 = Rs.4199.99
[2025-10-24T04:40:00.000Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:00.000Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:00.000Z] [LOG]       Total Expected Earned: Rs.25475.03
[2025-10-24T04:40:00.000Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:40:00.001Z] [LOG]       Weekday: 27.17h × Rs.164.71 = Rs.4474.62
[2025-10-24T04:40:00.002Z] [LOG]       Saturday: 4.50h × Rs.311.11 = Rs.1400.00
[2025-10-24T04:40:00.003Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:00.003Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:00.003Z] [LOG]       Total Actual Earned: Rs.5874.62
[2025-10-24T04:40:00.003Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:40:00.004Z] [LOG]       Calculated At: Oct 24, 2025, 10:10:00
[2025-10-24T04:40:00.004Z] [LOG]       Expected Earned (until NOW): Rs.25475.03
[2025-10-24T04:40:00.004Z] [LOG]       Actual Earned (until NOW): Rs.5874.62
[2025-10-24T04:40:00.004Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:00.004Z] [LOG]       Attendance Deduction: Rs.19600.41
[2025-10-24T04:40:00.004Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:40:00.004Z] [LOG]       📉 Shortfall: 111.00 hours (76.94% of expected)
[2025-10-24T04:40:00.005Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:40:00.005Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:40:00.005Z] [LOG]    Base Salary (Full): Rs.35000.00
[2025-10-24T04:40:00.005Z] [LOG]    Actual Earned Base: Rs.5874.62
[2025-10-24T04:40:00.005Z] [LOG]    Attendance Shortfall: Rs.19600.41
[2025-10-24T04:40:00.006Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:40:00.006Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:40:00.006Z] [LOG]    Gross Salary: 5874.616437902778
[2025-10-24T04:40:00.006Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:40:00.006Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:40:00.007Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.007Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:40:00.007Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.007Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:40:00.007Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.008Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:40:00.008Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.008Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:40:00.008Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.008Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:40:00.008Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.008Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:40:00.008Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.009Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:40:00.009Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.009Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:40:00.009Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.009Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:40:00.009Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.010Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:40:00.010Z] [LOG]    EPF/ETF calculated on: Rs.5874.62
[2025-10-24T04:40:00.010Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:40:00.010Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:40:00.010Z] [LOG] 💰 GROSS CALCULATION for Nimdiya Ranasinghe null:
[2025-10-24T04:40:00.010Z] [LOG]    Base Salary: 35000
[2025-10-24T04:40:00.011Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:40:00.011Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:40:00.011Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.011Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:40:00.011Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.011Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:40:00.012Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:00.208Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:40:00.208Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:00.208Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:40:00.208Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:40:00.208Z] [LOG]    Actual Earned Base: Rs.5874.62
[2025-10-24T04:40:00.209Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:40:00.209Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:40:00.209Z] [LOG]    = Gross Salary: Rs.5874.62
[2025-10-24T04:40:00.209Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:40:00.209Z] [LOG]    Attendance Shortfall (Info): Rs.19600.41
[2025-10-24T04:40:00.210Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:40:00.210Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:00.210Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:40:00.210Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:40:00.210Z] [LOG]    Gross Salary: Rs.5874.62
[2025-10-24T04:40:00.211Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:40:00.211Z] [LOG]    = NET SALARY: Rs.5874.62
[2025-10-24T04:40:00.211Z] [LOG] 
💾 Database Update:
[2025-10-24T04:40:00.211Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:40:00.212Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:40:00.418Z] [LOG] 
📝 Components to save:
[2025-10-24T04:40:00.418Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:40:00.419Z] [LOG]    Deduction components: 1
[2025-10-24T04:40:00.419Z] [LOG] Creating components for record 248c9a63-73a9-4c6a-9831-c70dc1ac41e2: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:40:00.420Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 5874.616437902778
}
[2025-10-24T04:40:00.620Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:40:00.825Z] [LOG] Created payroll_record_component: bf7aebbf-ae0a-41ef-ae76-c3355813c48e for Base Salary
[2025-10-24T04:40:00.825Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 19600.410000000003
}
[2025-10-24T04:40:01.026Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:40:01.235Z] [LOG] Created payroll_record_component: 97857d76-6f1e-4cfd-b74a-3d25d91754ea for Attendance Shortfall (Info)
[2025-10-24T04:40:01.633Z] [LOG] ✅ Financial balances updated successfully for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:01.634Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:40:01.634Z] [LOG] 
======================================================================
[2025-10-24T04:40:01.634Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Nimdiya Ranasinghe null
[2025-10-24T04:40:01.634Z] [LOG] ======================================================================
[2025-10-24T04:40:01.635Z] [LOG]    Base Salary (Full): Rs.35000.00
[2025-10-24T04:40:01.635Z] [LOG]    Actual Earned Base (Attendance-based): Rs.5874.62
[2025-10-24T04:40:01.635Z] [LOG]    Attendance Shortfall: Rs.19600.41
[2025-10-24T04:40:01.635Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:01.636Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:01.636Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:40:01.636Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:01.637Z] [LOG]    GROSS SALARY: Rs.5874.62
[2025-10-24T04:40:01.637Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:01.637Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:40:01.638Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:40:01.638Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:40:01.638Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:40:01.639Z] [LOG]       - Attendance Shortfall (Info): Rs.19600.41
[2025-10-24T04:40:01.639Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:01.639Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:01.639Z] [LOG]    NET SALARY: Rs.5874.62
[2025-10-24T04:40:01.640Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:40:01.640Z] [LOG] ======================================================================

[2025-10-24T04:40:01.640Z] [LOG] ✅ Nimdiya Ranasinghe null: Calculation completed successfully
[2025-10-24T04:40:01.640Z] [LOG] 📊 Progress: 4/34 (11.8%)
[2025-10-24T04:40:01.641Z] [LOG] 
🧮 Processing: Sithira null (EMP000039)
[2025-10-24T04:40:01.641Z] [LOG] 📋 Record ID: 2b75917c-d93f-4a04-8154-ada5c4f1a47b
[2025-10-24T04:40:01.641Z] [LOG] 
======================================================================
[2025-10-24T04:40:01.642Z] [LOG] 🧮 CALCULATING PAYROLL: Sithira null (EMP000039)
[2025-10-24T04:40:01.642Z] [LOG] ======================================================================
[2025-10-24T04:40:02.452Z] [LOG] 🔍 Component filtering for employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-24T04:40:02.453Z] [LOG]    Total components: 13
[2025-10-24T04:40:02.453Z] [LOG]    Applicable components: 13
[2025-10-24T04:40:02.453Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-24T04:40:03.674Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:40:03.675Z] [LOG] 🔄 Processing financial records for employee 01441e19-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:40:03.873Z] [LOG] 📊 Found 0 active loans for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:04.073Z] [LOG] 📊 Found 0 active advances for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:04.278Z] [LOG] 📊 Found 0 approved bonuses for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:04.279Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:40:04.279Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:40:04.479Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:40:04.480Z] [LOG]    Employee ID: 01441e19-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:04.480Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:40:04.481Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:40:04.482Z] [LOG]    Base Salary (Full Month): Rs.40000.00
[2025-10-24T04:40:04.684Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:40:04.684Z] [LOG]       Daily Salary: Rs.1600.00
[2025-10-24T04:40:04.685Z] [LOG]       Weekday Hourly Rate: Rs.188.24
[2025-10-24T04:40:04.685Z] [LOG]       Saturday Hourly Rate: Rs.355.56
[2025-10-24T04:40:04.685Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:40:04.686Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:40:04.686Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:40:05.303Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:40:05.304Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:40:05.503Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:40:05.504Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:40:05.504Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:40:05.505Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:40:05.506Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:40:05.506Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:40:05.507Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:40:05.508Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:40:05.508Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:40:05.712Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:40:05.713Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:40:05.714Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:40:05.714Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:40:05.916Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:40:05.917Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:40:05.918Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:40:05.919Z] [LOG]       Current Time: 10:10:05
[2025-10-24T04:40:05.919Z] [LOG]       Expected Hours (scheduled → now): 1.67h
[2025-10-24T04:40:05.920Z] [LOG]       Actual Hours (check-in → now): 1.67h
[2025-10-24T04:40:05.921Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:40:05.921Z] [LOG]       Weekday: 129.17h
[2025-10-24T04:40:05.922Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:40:05.923Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:05.923Z] [LOG]       Total Expected: 142.67h
[2025-10-24T04:40:05.927Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:40:05.930Z] [LOG]       Weekday: 35.67h (includes 1.67h live)
[2025-10-24T04:40:05.931Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:40:05.931Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:05.933Z] [LOG]       Total Actual: 40.17h
[2025-10-24T04:40:05.934Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:40:05.935Z] [LOG]       Weekday: 129.17h × Rs.188.24 = Rs.24314.64
[2025-10-24T04:40:05.936Z] [LOG]       Saturday: 13.50h × Rs.355.56 = Rs.4800.06
[2025-10-24T04:40:05.937Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:05.937Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:05.938Z] [LOG]       Total Expected Earned: Rs.29114.70
[2025-10-24T04:40:05.938Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:40:05.939Z] [LOG]       Weekday: 35.67h × Rs.188.24 = Rs.6714.20
[2025-10-24T04:40:05.940Z] [LOG]       Saturday: 4.50h × Rs.355.56 = Rs.1600.02
[2025-10-24T04:40:05.941Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:05.941Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:05.942Z] [LOG]       Total Actual Earned: Rs.8314.22
[2025-10-24T04:40:05.943Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:40:05.944Z] [LOG]       Calculated At: Oct 24, 2025, 10:10:05
[2025-10-24T04:40:05.944Z] [LOG]       Expected Earned (until NOW): Rs.29114.70
[2025-10-24T04:40:05.945Z] [LOG]       Actual Earned (until NOW): Rs.8314.22
[2025-10-24T04:40:05.946Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:05.946Z] [LOG]       Attendance Deduction: Rs.20800.48
[2025-10-24T04:40:05.947Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:40:05.947Z] [LOG]       📉 Shortfall: 102.50 hours (71.44% of expected)
[2025-10-24T04:40:05.947Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:40:05.947Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:40:05.948Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-24T04:40:05.949Z] [LOG]    Actual Earned Base: Rs.8314.22
[2025-10-24T04:40:05.950Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-24T04:40:05.950Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:40:05.950Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:40:05.951Z] [LOG]    Gross Salary: 8314.2226744
[2025-10-24T04:40:05.951Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:40:05.951Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:40:05.952Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.952Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:40:05.952Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.952Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:40:05.953Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.953Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:40:05.953Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.954Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:40:05.954Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.954Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:40:05.954Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.955Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:40:05.955Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.955Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:40:05.956Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.956Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:40:05.956Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.956Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:40:05.957Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.957Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:40:05.957Z] [LOG]    EPF/ETF calculated on: Rs.8314.22
[2025-10-24T04:40:05.957Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:40:05.958Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:40:05.958Z] [LOG] 💰 GROSS CALCULATION for Sithira null:
[2025-10-24T04:40:05.958Z] [LOG]    Base Salary: 40000
[2025-10-24T04:40:05.958Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:40:05.959Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:40:05.959Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.959Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:40:05.959Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:05.960Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:40:05.960Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:06.160Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:40:06.161Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:06.162Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:40:06.162Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:40:06.163Z] [LOG]    Actual Earned Base: Rs.8314.22
[2025-10-24T04:40:06.164Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:40:06.164Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:40:06.165Z] [LOG]    = Gross Salary: Rs.8314.22
[2025-10-24T04:40:06.168Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:40:06.169Z] [LOG]    Attendance Shortfall (Info): Rs.20800.48
[2025-10-24T04:40:06.170Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:40:06.171Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:06.171Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:40:06.172Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:40:06.173Z] [LOG]    Gross Salary: Rs.8314.22
[2025-10-24T04:40:06.174Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:40:06.174Z] [LOG]    = NET SALARY: Rs.8314.22
[2025-10-24T04:40:06.175Z] [LOG] 
💾 Database Update:
[2025-10-24T04:40:06.176Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:40:06.176Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:40:06.379Z] [LOG] 
📝 Components to save:
[2025-10-24T04:40:06.379Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:40:06.380Z] [LOG]    Deduction components: 1
[2025-10-24T04:40:06.381Z] [LOG] Creating components for record 2b75917c-d93f-4a04-8154-ada5c4f1a47b: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:40:06.384Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8314.2226744
}
[2025-10-24T04:40:06.589Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:40:06.792Z] [LOG] Created payroll_record_component: 9ab89b7b-76c0-43c9-86a0-217b02a01af1 for Base Salary
[2025-10-24T04:40:06.793Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 20800.48
}
[2025-10-24T04:40:06.997Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:40:07.198Z] [LOG] Created payroll_record_component: 262211b3-782d-49f2-87b9-6b974444b04c for Attendance Shortfall (Info)
[2025-10-24T04:40:07.597Z] [LOG] ✅ Financial balances updated successfully for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:07.597Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:40:07.597Z] [LOG] 
======================================================================
[2025-10-24T04:40:07.597Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sithira null
[2025-10-24T04:40:07.598Z] [LOG] ======================================================================
[2025-10-24T04:40:07.598Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-24T04:40:07.598Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8314.22
[2025-10-24T04:40:07.599Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-24T04:40:07.599Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:07.599Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:07.599Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:40:07.600Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:07.600Z] [LOG]    GROSS SALARY: Rs.8314.22
[2025-10-24T04:40:07.600Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:07.600Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:40:07.601Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:40:07.601Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:40:07.601Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:40:07.601Z] [LOG]       - Attendance Shortfall (Info): Rs.20800.48
[2025-10-24T04:40:07.602Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:07.602Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:07.602Z] [LOG]    NET SALARY: Rs.8314.22
[2025-10-24T04:40:07.603Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:40:07.603Z] [LOG] ======================================================================

[2025-10-24T04:40:07.604Z] [LOG] ✅ Sithira null: Calculation completed successfully
[2025-10-24T04:40:07.604Z] [LOG] 📊 Progress: 5/34 (14.7%)
[2025-10-24T04:40:07.604Z] [LOG] 
🧮 Processing: Ruvindu Hewabandu null (EMP000027)
[2025-10-24T04:40:07.605Z] [LOG] 📋 Record ID: 2c866524-a2bf-4dea-92a6-9f0224e54357
[2025-10-24T04:40:07.605Z] [LOG] 
======================================================================
[2025-10-24T04:40:07.605Z] [LOG] 🧮 CALCULATING PAYROLL: Ruvindu Hewabandu null (EMP000027)
[2025-10-24T04:40:07.606Z] [LOG] ======================================================================
[2025-10-24T04:40:08.399Z] [LOG] 🔍 Component filtering for employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-24T04:40:08.399Z] [LOG]    Total components: 13
[2025-10-24T04:40:08.399Z] [LOG]    Applicable components: 13
[2025-10-24T04:40:08.399Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-24T04:40:09.823Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:40:09.823Z] [LOG] 🔄 Processing financial records for employee 0143e915-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:40:10.026Z] [LOG] 📊 Found 0 active loans for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:10.223Z] [LOG] 📊 Found 0 active advances for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:10.422Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:10.423Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:40:10.423Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:40:10.635Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:40:10.635Z] [LOG]    Employee ID: 0143e915-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:10.635Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:40:10.636Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:40:10.636Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-24T04:40:10.832Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:40:10.832Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-24T04:40:10.833Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-24T04:40:10.833Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-24T04:40:10.833Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:40:10.833Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:40:10.834Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:40:11.442Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:40:11.442Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:40:11.647Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:40:11.647Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:40:11.647Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:40:11.647Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:40:11.648Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:40:11.648Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:40:11.649Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:40:11.649Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:40:11.649Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:40:11.852Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:40:11.852Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:40:11.852Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:40:11.852Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:40:12.056Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:40:12.057Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:40:12.057Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:40:12.057Z] [LOG]       Current Time: 10:10:12
[2025-10-24T04:40:12.057Z] [LOG]       Expected Hours (scheduled → now): 1.67h
[2025-10-24T04:40:12.057Z] [LOG]       Actual Hours (check-in → now): 1.67h
[2025-10-24T04:40:12.058Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:40:12.058Z] [LOG]       Weekday: 129.17h
[2025-10-24T04:40:12.058Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:40:12.058Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:12.059Z] [LOG]       Total Expected: 142.67h
[2025-10-24T04:40:12.059Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:40:12.059Z] [LOG]       Weekday: 35.67h (includes 1.67h live)
[2025-10-24T04:40:12.059Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:40:12.060Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:12.060Z] [LOG]       Total Actual: 40.17h
[2025-10-24T04:40:12.060Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:40:12.060Z] [LOG]       Weekday: 129.17h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:12.061Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:12.061Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:12.061Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:12.061Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-24T04:40:12.061Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:40:12.062Z] [LOG]       Weekday: 35.67h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:12.062Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:12.062Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:12.062Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:12.062Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-24T04:40:12.063Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:40:12.063Z] [LOG]       Calculated At: Oct 24, 2025, 10:10:12
[2025-10-24T04:40:12.063Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-24T04:40:12.064Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-24T04:40:12.064Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:12.064Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-24T04:40:12.064Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:40:12.064Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-24T04:40:12.065Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:40:12.066Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:40:12.066Z] [LOG]    Base Salary (Full): Rs.NaN
[2025-10-24T04:40:12.066Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-24T04:40:12.067Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-24T04:40:12.067Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:40:12.067Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:40:12.067Z] [LOG]    Gross Salary: 0
[2025-10-24T04:40:12.068Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:40:12.068Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:40:12.068Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.068Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:40:12.069Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.069Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:40:12.069Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.069Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:40:12.070Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.070Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:40:12.070Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.070Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:40:12.070Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.071Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:40:12.071Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.071Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:40:12.071Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.072Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:40:12.072Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.072Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:40:12.072Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.072Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:40:12.073Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-24T04:40:12.073Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:40:12.073Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:40:12.073Z] [LOG] 💰 GROSS CALCULATION for Ruvindu Hewabandu null:
[2025-10-24T04:40:12.074Z] [LOG]    Base Salary: 0
[2025-10-24T04:40:12.074Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:40:12.074Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:40:12.074Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.074Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:40:12.075Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.075Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:40:12.075Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:12.275Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:40:12.275Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:12.275Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:40:12.275Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:40:12.276Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-24T04:40:12.276Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:40:12.276Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:40:12.276Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-24T04:40:12.277Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:40:12.277Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:40:12.277Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:12.277Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:40:12.277Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:40:12.278Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-24T04:40:12.278Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:40:12.278Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-24T04:40:12.278Z] [LOG] 
💾 Database Update:
[2025-10-24T04:40:12.279Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:40:12.279Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:40:12.475Z] [LOG] 
📝 Components to save:
[2025-10-24T04:40:12.476Z] [LOG]    Gross/Earnings components: 0
[2025-10-24T04:40:12.476Z] [LOG]    Deduction components: 0
[2025-10-24T04:40:12.476Z] [LOG] Creating components for record 2c866524-a2bf-4dea-92a6-9f0224e54357: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-24T04:40:12.884Z] [LOG] ✅ Financial balances updated successfully for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:12.884Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:40:12.885Z] [LOG] 
======================================================================
[2025-10-24T04:40:12.885Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ruvindu Hewabandu null
[2025-10-24T04:40:12.885Z] [LOG] ======================================================================
[2025-10-24T04:40:12.885Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-24T04:40:12.886Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-24T04:40:12.886Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-24T04:40:12.886Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:12.886Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:12.886Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:40:12.887Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:12.887Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-24T04:40:12.887Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:12.887Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:40:12.887Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:40:12.888Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:40:12.888Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:40:12.888Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-24T04:40:12.888Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:12.889Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:12.889Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-24T04:40:12.889Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:40:12.889Z] [LOG] ======================================================================

[2025-10-24T04:40:12.890Z] [LOG] ✅ Ruvindu Hewabandu null: Calculation completed successfully
[2025-10-24T04:40:12.890Z] [LOG] 📊 Progress: 6/34 (17.6%)
[2025-10-24T04:40:12.890Z] [LOG] 
🧮 Processing: Maryam null (EMP000035)
[2025-10-24T04:40:12.891Z] [LOG] 📋 Record ID: 35a5d411-5f30-4356-9c17-87f2d5f3d80d
[2025-10-24T04:40:12.891Z] [LOG] 
======================================================================
[2025-10-24T04:40:12.891Z] [LOG] 🧮 CALCULATING PAYROLL: Maryam null (EMP000035)
[2025-10-24T04:40:12.891Z] [LOG] ======================================================================
[2025-10-24T04:40:13.699Z] [LOG] 🔍 Component filtering for employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-24T04:40:13.699Z] [LOG]    Total components: 13
[2025-10-24T04:40:13.699Z] [LOG]    Applicable components: 13
[2025-10-24T04:40:13.700Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-24T04:40:14.958Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:40:14.959Z] [LOG] 🔄 Processing financial records for employee 01440221-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:40:15.178Z] [LOG] 📊 Found 0 active loans for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:15.405Z] [LOG] 📊 Found 0 active advances for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:15.621Z] [LOG] 📊 Found 0 approved bonuses for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:15.622Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:40:15.623Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:40:15.861Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:40:15.862Z] [LOG]    Employee ID: 01440221-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:15.862Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:40:15.863Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:40:15.863Z] [LOG]    Base Salary (Full Month): Rs.40000.00
[2025-10-24T04:40:16.089Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:40:16.090Z] [LOG]       Daily Salary: Rs.1600.00
[2025-10-24T04:40:16.091Z] [LOG]       Weekday Hourly Rate: Rs.188.24
[2025-10-24T04:40:16.091Z] [LOG]       Saturday Hourly Rate: Rs.355.56
[2025-10-24T04:40:16.092Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:40:16.092Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:40:16.093Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:40:16.762Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:40:16.762Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:40:16.975Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:40:16.976Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:40:16.976Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:40:16.977Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:40:16.977Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:40:16.977Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:40:16.978Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:40:16.978Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:40:16.978Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:40:17.177Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:40:17.177Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:40:17.178Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:40:17.179Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:40:17.404Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:40:17.404Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:40:17.405Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:40:17.407Z] [LOG]       Current Time: 10:10:17
[2025-10-24T04:40:17.407Z] [LOG]       Expected Hours (scheduled → now): 1.67h
[2025-10-24T04:40:17.408Z] [LOG]       Actual Hours (check-in → now): 1.67h
[2025-10-24T04:40:17.408Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:40:17.409Z] [LOG]       Weekday: 129.17h
[2025-10-24T04:40:17.410Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:40:17.411Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:17.411Z] [LOG]       Total Expected: 142.67h
[2025-10-24T04:40:17.412Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:40:17.413Z] [LOG]       Weekday: 35.67h (includes 1.67h live)
[2025-10-24T04:40:17.414Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:40:17.414Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:17.417Z] [LOG]       Total Actual: 40.17h
[2025-10-24T04:40:17.418Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:40:17.419Z] [LOG]       Weekday: 129.17h × Rs.188.24 = Rs.24315.24
[2025-10-24T04:40:17.420Z] [LOG]       Saturday: 13.50h × Rs.355.56 = Rs.4800.06
[2025-10-24T04:40:17.421Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:17.422Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:17.423Z] [LOG]       Total Expected Earned: Rs.29115.30
[2025-10-24T04:40:17.423Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:40:17.424Z] [LOG]       Weekday: 35.67h × Rs.188.24 = Rs.6714.80
[2025-10-24T04:40:17.425Z] [LOG]       Saturday: 4.50h × Rs.355.56 = Rs.1600.02
[2025-10-24T04:40:17.425Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:17.426Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:17.426Z] [LOG]       Total Actual Earned: Rs.8314.82
[2025-10-24T04:40:17.427Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:40:17.429Z] [LOG]       Calculated At: Oct 24, 2025, 10:10:17
[2025-10-24T04:40:17.430Z] [LOG]       Expected Earned (until NOW): Rs.29115.30
[2025-10-24T04:40:17.431Z] [LOG]       Actual Earned (until NOW): Rs.8314.82
[2025-10-24T04:40:17.431Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:17.434Z] [LOG]       Attendance Deduction: Rs.20800.48
[2025-10-24T04:40:17.435Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:40:17.436Z] [LOG]       📉 Shortfall: 102.50 hours (71.44% of expected)
[2025-10-24T04:40:17.438Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:40:17.438Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:40:17.439Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-24T04:40:17.439Z] [LOG]    Actual Earned Base: Rs.8314.82
[2025-10-24T04:40:17.440Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-24T04:40:17.440Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:40:17.440Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:40:17.441Z] [LOG]    Gross Salary: 8314.823369155556
[2025-10-24T04:40:17.441Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:40:17.441Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:40:17.442Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.442Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:40:17.442Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.443Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:40:17.443Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.443Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:40:17.444Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.444Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:40:17.444Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.445Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:40:17.445Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.445Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:40:17.446Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.446Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:40:17.446Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.446Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:40:17.447Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.447Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:40:17.447Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.447Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:40:17.448Z] [LOG]    EPF/ETF calculated on: Rs.8314.82
[2025-10-24T04:40:17.449Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:40:17.450Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:40:17.450Z] [LOG] 💰 GROSS CALCULATION for Maryam null:
[2025-10-24T04:40:17.451Z] [LOG]    Base Salary: 40000
[2025-10-24T04:40:17.451Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:40:17.452Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:40:17.452Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.452Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:40:17.453Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.454Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:40:17.454Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:17.658Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:40:17.658Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:17.659Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:40:17.659Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:40:17.660Z] [LOG]    Actual Earned Base: Rs.8314.82
[2025-10-24T04:40:17.660Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:40:17.660Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:40:17.661Z] [LOG]    = Gross Salary: Rs.8314.82
[2025-10-24T04:40:17.661Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:40:17.662Z] [LOG]    Attendance Shortfall (Info): Rs.20800.48
[2025-10-24T04:40:17.662Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:40:17.662Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:17.662Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:40:17.663Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:40:17.663Z] [LOG]    Gross Salary: Rs.8314.82
[2025-10-24T04:40:17.664Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:40:17.664Z] [LOG]    = NET SALARY: Rs.8314.82
[2025-10-24T04:40:17.664Z] [LOG] 
💾 Database Update:
[2025-10-24T04:40:17.666Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:40:17.667Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:40:17.900Z] [LOG] 
📝 Components to save:
[2025-10-24T04:40:17.900Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:40:17.900Z] [LOG]    Deduction components: 1
[2025-10-24T04:40:17.901Z] [LOG] Creating components for record 35a5d411-5f30-4356-9c17-87f2d5f3d80d: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:40:17.902Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8314.823369155556
}
[2025-10-24T04:40:18.114Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:40:18.330Z] [LOG] Created payroll_record_component: 155bb3d5-ba23-4562-b3df-8b7043b49c4a for Base Salary
[2025-10-24T04:40:18.330Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 20800.479999999996
}
[2025-10-24T04:40:18.543Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:40:18.783Z] [LOG] Created payroll_record_component: df18603a-09fe-4c83-a08d-c06b8cba5bc9 for Attendance Shortfall (Info)
[2025-10-24T04:40:19.229Z] [LOG] ✅ Financial balances updated successfully for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:19.229Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:40:19.230Z] [LOG] 
======================================================================
[2025-10-24T04:40:19.231Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Maryam null
[2025-10-24T04:40:19.231Z] [LOG] ======================================================================
[2025-10-24T04:40:19.232Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-24T04:40:19.233Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8314.82
[2025-10-24T04:40:19.234Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-24T04:40:19.234Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:19.235Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:19.236Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:40:19.237Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:19.238Z] [LOG]    GROSS SALARY: Rs.8314.82
[2025-10-24T04:40:19.238Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:19.239Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:40:19.240Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:40:19.240Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:40:19.241Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:40:19.242Z] [LOG]       - Attendance Shortfall (Info): Rs.20800.48
[2025-10-24T04:40:19.242Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:19.243Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:19.243Z] [LOG]    NET SALARY: Rs.8314.82
[2025-10-24T04:40:19.244Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:40:19.244Z] [LOG] ======================================================================

[2025-10-24T04:40:19.245Z] [LOG] ✅ Maryam null: Calculation completed successfully
[2025-10-24T04:40:19.246Z] [LOG] 📊 Progress: 7/34 (20.6%)
[2025-10-24T04:40:19.246Z] [LOG] 
🧮 Processing: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-24T04:40:19.247Z] [LOG] 📋 Record ID: 3db04746-96b4-4619-8cd0-58b21bff0262
[2025-10-24T04:40:19.248Z] [LOG] 
======================================================================
[2025-10-24T04:40:19.250Z] [LOG] 🧮 CALCULATING PAYROLL: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-24T04:40:19.250Z] [LOG] ======================================================================
[2025-10-24T04:40:20.093Z] [LOG] 🔍 Component filtering for employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-24T04:40:20.094Z] [LOG]    Total components: 13
[2025-10-24T04:40:20.094Z] [LOG]    Applicable components: 13
[2025-10-24T04:40:20.095Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-24T04:40:21.380Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:40:21.381Z] [LOG] 🔄 Processing financial records for employee 0144461e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:40:21.597Z] [LOG] 📊 Found 0 active loans for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:21.819Z] [LOG] 📊 Found 0 active advances for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:22.045Z] [LOG] 📊 Found 0 approved bonuses for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:22.045Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:40:22.047Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:40:22.262Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:40:22.263Z] [LOG]    Employee ID: 0144461e-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:22.263Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:40:22.264Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:40:22.264Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:40:22.467Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:40:22.468Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:40:22.469Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:40:22.469Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:40:22.470Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:40:22.471Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:40:22.471Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:40:23.107Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:40:23.107Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:40:23.332Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:40:23.336Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:40:23.337Z] [LOG]       Total completed sessions found: 4
[2025-10-24T04:40:23.337Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:40:23.338Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:40:23.339Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:40:23.339Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:40:23.340Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:40:23.546Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:40:23.547Z] [LOG]          Weekday: 25.50h
[2025-10-24T04:40:23.547Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:40:23.548Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:40:23.752Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:40:23.753Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:40:23.753Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:40:23.754Z] [LOG]       Current Time: 10:10:23
[2025-10-24T04:40:23.755Z] [LOG]       Expected Hours (scheduled → now): 1.67h
[2025-10-24T04:40:23.756Z] [LOG]       Actual Hours (check-in → now): 1.67h
[2025-10-24T04:40:23.756Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:40:23.757Z] [LOG]       Weekday: 129.17h
[2025-10-24T04:40:23.757Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:40:23.758Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:23.759Z] [LOG]       Total Expected: 142.67h
[2025-10-24T04:40:23.759Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:40:23.760Z] [LOG]       Weekday: 27.17h (includes 1.67h live)
[2025-10-24T04:40:23.761Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:40:23.762Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:23.762Z] [LOG]       Total Actual: 31.67h
[2025-10-24T04:40:23.763Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:40:23.764Z] [LOG]       Weekday: 129.17h × Rs.235.29 = Rs.30393.18
[2025-10-24T04:40:23.764Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:40:23.767Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:23.768Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:23.768Z] [LOG]       Total Expected Earned: Rs.36393.12
[2025-10-24T04:40:23.769Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:40:23.770Z] [LOG]       Weekday: 27.17h × Rs.235.29 = Rs.6393.60
[2025-10-24T04:40:23.770Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:40:23.771Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:23.772Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:23.773Z] [LOG]       Total Actual Earned: Rs.8393.58
[2025-10-24T04:40:23.774Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:40:23.774Z] [LOG]       Calculated At: Oct 24, 2025, 10:10:23
[2025-10-24T04:40:23.775Z] [LOG]       Expected Earned (until NOW): Rs.36393.12
[2025-10-24T04:40:23.776Z] [LOG]       Actual Earned (until NOW): Rs.8393.58
[2025-10-24T04:40:23.776Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:23.777Z] [LOG]       Attendance Deduction: Rs.27999.54
[2025-10-24T04:40:23.778Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:40:23.778Z] [LOG]       📉 Shortfall: 111.00 hours (76.94% of expected)
[2025-10-24T04:40:23.779Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:40:23.779Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:40:23.780Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:40:23.781Z] [LOG]    Actual Earned Base: Rs.8393.58
[2025-10-24T04:40:23.781Z] [LOG]    Attendance Shortfall: Rs.27999.54
[2025-10-24T04:40:23.784Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:40:23.785Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:40:23.786Z] [LOG]    Gross Salary: 8393.577391133333
[2025-10-24T04:40:23.786Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:40:23.787Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:40:23.788Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.788Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:40:23.789Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.790Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:40:23.790Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.791Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:40:23.791Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.792Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:40:23.792Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.793Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:40:23.793Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.794Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:40:23.795Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.795Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:40:23.796Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.797Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:40:23.797Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.797Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:40:23.798Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.798Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:40:23.799Z] [LOG]    EPF/ETF calculated on: Rs.8393.58
[2025-10-24T04:40:23.799Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:40:23.800Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:40:23.800Z] [LOG] 💰 GROSS CALCULATION for Ashen Nirmal Wadugodapitiya null:
[2025-10-24T04:40:23.801Z] [LOG]    Base Salary: 50000
[2025-10-24T04:40:23.801Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:40:23.801Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:40:23.802Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.802Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:40:23.802Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:23.803Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:40:23.803Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:24.015Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:40:24.016Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:24.017Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:40:24.018Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:40:24.019Z] [LOG]    Actual Earned Base: Rs.8393.58
[2025-10-24T04:40:24.019Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:40:24.020Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:40:24.020Z] [LOG]    = Gross Salary: Rs.8393.58
[2025-10-24T04:40:24.021Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:40:24.022Z] [LOG]    Attendance Shortfall (Info): Rs.27999.54
[2025-10-24T04:40:24.023Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:40:24.024Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:24.024Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:40:24.025Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:40:24.026Z] [LOG]    Gross Salary: Rs.8393.58
[2025-10-24T04:40:24.026Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:40:24.027Z] [LOG]    = NET SALARY: Rs.8393.58
[2025-10-24T04:40:24.028Z] [LOG] 
💾 Database Update:
[2025-10-24T04:40:24.029Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:40:24.029Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:40:24.252Z] [LOG] 
📝 Components to save:
[2025-10-24T04:40:24.253Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:40:24.253Z] [LOG]    Deduction components: 1
[2025-10-24T04:40:24.254Z] [LOG] Creating components for record 3db04746-96b4-4619-8cd0-58b21bff0262: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:40:24.256Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8393.577391133333
}
[2025-10-24T04:40:24.473Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:40:24.695Z] [LOG] Created payroll_record_component: fff76d6d-7e8a-455b-b32a-01a2ffa25f9b for Base Salary
[2025-10-24T04:40:24.696Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 27999.54
}
[2025-10-24T04:40:24.914Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:40:25.133Z] [LOG] Created payroll_record_component: 8b86af79-d72f-4fdd-85b3-e18ac04de013 for Attendance Shortfall (Info)
[2025-10-24T04:40:25.548Z] [LOG] ✅ Financial balances updated successfully for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:25.549Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:40:25.549Z] [LOG] 
======================================================================
[2025-10-24T04:40:25.550Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ashen Nirmal Wadugodapitiya null
[2025-10-24T04:40:25.550Z] [LOG] ======================================================================
[2025-10-24T04:40:25.550Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:40:25.551Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8393.58
[2025-10-24T04:40:25.551Z] [LOG]    Attendance Shortfall: Rs.27999.54
[2025-10-24T04:40:25.551Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:25.551Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:25.551Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:40:25.552Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:25.552Z] [LOG]    GROSS SALARY: Rs.8393.58
[2025-10-24T04:40:25.552Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:25.552Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:40:25.552Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:40:25.553Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:40:25.553Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:40:25.553Z] [LOG]       - Attendance Shortfall (Info): Rs.27999.54
[2025-10-24T04:40:25.553Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:25.561Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:25.566Z] [LOG]    NET SALARY: Rs.8393.58
[2025-10-24T04:40:25.566Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:40:25.566Z] [LOG] ======================================================================

[2025-10-24T04:40:25.567Z] [LOG] ✅ Ashen Nirmal Wadugodapitiya null: Calculation completed successfully
[2025-10-24T04:40:25.567Z] [LOG] 📊 Progress: 8/34 (23.5%)
[2025-10-24T04:40:25.567Z] [LOG] 
🧮 Processing: Piyumi null (EMP000025)
[2025-10-24T04:40:25.568Z] [LOG] 📋 Record ID: 42f460da-6b55-4c17-95df-8ae7f5e8850c
[2025-10-24T04:40:25.568Z] [LOG] 
======================================================================
[2025-10-24T04:40:25.569Z] [LOG] 🧮 CALCULATING PAYROLL: Piyumi null (EMP000025)
[2025-10-24T04:40:25.569Z] [LOG] ======================================================================
[2025-10-24T04:40:26.462Z] [LOG] 🔍 Component filtering for employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-24T04:40:26.463Z] [LOG]    Total components: 13
[2025-10-24T04:40:26.463Z] [LOG]    Applicable components: 13
[2025-10-24T04:40:26.464Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-24T04:40:27.781Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:40:27.782Z] [LOG] 🔄 Processing financial records for employee 0143e565-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:40:28.008Z] [LOG] 📊 Found 0 active loans for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:28.224Z] [LOG] 📊 Found 0 active advances for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:28.440Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:28.442Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:40:28.443Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:40:28.664Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:40:28.666Z] [LOG]    Employee ID: 0143e565-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:28.667Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:40:28.667Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:40:28.668Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:40:28.894Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:40:28.894Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:40:28.895Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:40:28.895Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:40:28.896Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:40:28.897Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:40:28.897Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:40:29.593Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:40:29.594Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:40:29.804Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:40:29.807Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:40:29.807Z] [LOG]       Total completed sessions found: 4
[2025-10-24T04:40:29.808Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:40:29.809Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:40:29.812Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:40:29.813Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:40:29.814Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:40:30.032Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:40:30.033Z] [LOG]          Weekday: 25.50h
[2025-10-24T04:40:30.033Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:40:30.033Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:40:30.248Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:40:30.249Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:40:30.249Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:40:30.249Z] [LOG]       Current Time: 10:10:30
[2025-10-24T04:40:30.249Z] [LOG]       Expected Hours (scheduled → now): 1.68h
[2025-10-24T04:40:30.250Z] [LOG]       Actual Hours (check-in → now): 1.68h
[2025-10-24T04:40:30.250Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:40:30.250Z] [LOG]       Weekday: 129.18h
[2025-10-24T04:40:30.250Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:40:30.250Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:30.250Z] [LOG]       Total Expected: 142.68h
[2025-10-24T04:40:30.251Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:40:30.251Z] [LOG]       Weekday: 27.18h (includes 1.68h live)
[2025-10-24T04:40:30.251Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:40:30.251Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:30.251Z] [LOG]       Total Actual: 31.68h
[2025-10-24T04:40:30.251Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:40:30.251Z] [LOG]       Weekday: 129.18h × Rs.235.29 = Rs.30393.60
[2025-10-24T04:40:30.252Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:40:30.252Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:30.252Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:30.252Z] [LOG]       Total Expected Earned: Rs.36393.54
[2025-10-24T04:40:30.252Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:40:30.252Z] [LOG]       Weekday: 27.18h × Rs.235.29 = Rs.6394.02
[2025-10-24T04:40:30.252Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:40:30.253Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:30.253Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:30.253Z] [LOG]       Total Actual Earned: Rs.8394.00
[2025-10-24T04:40:30.253Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:40:30.253Z] [LOG]       Calculated At: Oct 24, 2025, 10:10:30
[2025-10-24T04:40:30.254Z] [LOG]       Expected Earned (until NOW): Rs.36393.54
[2025-10-24T04:40:30.254Z] [LOG]       Actual Earned (until NOW): Rs.8394.00
[2025-10-24T04:40:30.254Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:30.254Z] [LOG]       Attendance Deduction: Rs.27999.54
[2025-10-24T04:40:30.254Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:40:30.254Z] [LOG]       📉 Shortfall: 111.00 hours (76.94% of expected)
[2025-10-24T04:40:30.254Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:40:30.255Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:40:30.255Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:40:30.255Z] [LOG]    Actual Earned Base: Rs.8394.00
[2025-10-24T04:40:30.255Z] [LOG]    Attendance Shortfall: Rs.27999.54
[2025-10-24T04:40:30.255Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:40:30.255Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:40:30.256Z] [LOG]    Gross Salary: 8394.001958866666
[2025-10-24T04:40:30.256Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:40:30.256Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:40:30.256Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.256Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:40:30.256Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.256Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:40:30.256Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.257Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:40:30.257Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.257Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:40:30.257Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.257Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:40:30.257Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.257Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:40:30.257Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.258Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:40:30.258Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.258Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:40:30.258Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.258Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:40:30.258Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.259Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:40:30.259Z] [LOG]    EPF/ETF calculated on: Rs.8394.00
[2025-10-24T04:40:30.259Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:40:30.259Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:40:30.259Z] [LOG] 💰 GROSS CALCULATION for Piyumi null:
[2025-10-24T04:40:30.259Z] [LOG]    Base Salary: 50000
[2025-10-24T04:40:30.260Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:40:30.260Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:40:30.260Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.260Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:40:30.260Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.260Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:40:30.260Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:30.473Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:40:30.473Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:30.473Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:40:30.474Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:40:30.474Z] [LOG]    Actual Earned Base: Rs.8394.00
[2025-10-24T04:40:30.474Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:40:30.474Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:40:30.474Z] [LOG]    = Gross Salary: Rs.8394.00
[2025-10-24T04:40:30.474Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:40:30.475Z] [LOG]    Attendance Shortfall (Info): Rs.27999.54
[2025-10-24T04:40:30.475Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:40:30.475Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:30.475Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:40:30.475Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:40:30.476Z] [LOG]    Gross Salary: Rs.8394.00
[2025-10-24T04:40:30.476Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:40:30.476Z] [LOG]    = NET SALARY: Rs.8394.00
[2025-10-24T04:40:30.476Z] [LOG] 
💾 Database Update:
[2025-10-24T04:40:30.476Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:40:30.476Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:40:30.697Z] [LOG] 
📝 Components to save:
[2025-10-24T04:40:30.698Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:40:30.699Z] [LOG]    Deduction components: 1
[2025-10-24T04:40:30.700Z] [LOG] Creating components for record 42f460da-6b55-4c17-95df-8ae7f5e8850c: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:40:30.701Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8394.001958866666
}
[2025-10-24T04:40:30.917Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:40:31.137Z] [LOG] Created payroll_record_component: 308adcb2-1aec-4c98-8992-a338b28c6ac7 for Base Salary
[2025-10-24T04:40:31.137Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 27999.539999999997
}
[2025-10-24T04:40:31.357Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:40:31.586Z] [LOG] Created payroll_record_component: f3e3ac7c-6afb-474a-81bc-b3df95472305 for Attendance Shortfall (Info)
[2025-10-24T04:40:32.007Z] [LOG] ✅ Financial balances updated successfully for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:32.008Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:40:32.009Z] [LOG] 
======================================================================
[2025-10-24T04:40:32.009Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Piyumi null
[2025-10-24T04:40:32.010Z] [LOG] ======================================================================
[2025-10-24T04:40:32.011Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:40:32.011Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8394.00
[2025-10-24T04:40:32.012Z] [LOG]    Attendance Shortfall: Rs.27999.54
[2025-10-24T04:40:32.012Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:32.013Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:32.013Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:40:32.014Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:32.016Z] [LOG]    GROSS SALARY: Rs.8394.00
[2025-10-24T04:40:32.017Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:32.018Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:40:32.018Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:40:32.019Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:40:32.020Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:40:32.020Z] [LOG]       - Attendance Shortfall (Info): Rs.27999.54
[2025-10-24T04:40:32.021Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:32.021Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:32.022Z] [LOG]    NET SALARY: Rs.8394.00
[2025-10-24T04:40:32.023Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:40:32.023Z] [LOG] ======================================================================

[2025-10-24T04:40:32.025Z] [LOG] ✅ Piyumi null: Calculation completed successfully
[2025-10-24T04:40:32.026Z] [LOG] 📊 Progress: 9/34 (26.5%)
[2025-10-24T04:40:32.026Z] [LOG] 
🧮 Processing: Dharshika null (EMP000009)
[2025-10-24T04:40:32.027Z] [LOG] 📋 Record ID: 56b2794d-8d1f-443a-a28c-316378d7b6e4
[2025-10-24T04:40:32.028Z] [LOG] 
======================================================================
[2025-10-24T04:40:32.028Z] [LOG] 🧮 CALCULATING PAYROLL: Dharshika null (EMP000009)
[2025-10-24T04:40:32.029Z] [LOG] ======================================================================
[2025-10-24T04:40:32.908Z] [LOG] 🔍 Component filtering for employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-24T04:40:32.908Z] [LOG]    Total components: 13
[2025-10-24T04:40:32.909Z] [LOG]    Applicable components: 13
[2025-10-24T04:40:32.909Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-24T04:40:34.228Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:40:34.229Z] [LOG] 🔄 Processing financial records for employee 0143a994-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:40:34.450Z] [LOG] 📊 Found 0 active loans for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:34.670Z] [LOG] 📊 Found 0 active advances for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:34.896Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:34.897Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:40:34.901Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:40:35.132Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:40:35.133Z] [LOG]    Employee ID: 0143a994-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:35.133Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:40:35.134Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:40:35.134Z] [LOG]    Base Salary (Full Month): Rs.100000.00
[2025-10-24T04:40:35.353Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:40:35.354Z] [LOG]       Daily Salary: Rs.4000.00
[2025-10-24T04:40:35.355Z] [LOG]       Weekday Hourly Rate: Rs.470.59
[2025-10-24T04:40:35.355Z] [LOG]       Saturday Hourly Rate: Rs.888.89
[2025-10-24T04:40:35.356Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:40:35.356Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:40:35.357Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:40:35.996Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:40:35.996Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:40:36.204Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:40:36.205Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:40:36.206Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:40:36.206Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:40:36.207Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:40:36.207Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:40:36.208Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:40:36.209Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:40:36.209Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:40:36.434Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:40:36.435Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:40:36.435Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:40:36.436Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:40:36.645Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:40:36.646Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:40:36.646Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:40:36.647Z] [LOG]       Current Time: 10:10:36
[2025-10-24T04:40:36.648Z] [LOG]       Expected Hours (scheduled → now): 1.68h
[2025-10-24T04:40:36.649Z] [LOG]       Actual Hours (check-in → now): 1.68h
[2025-10-24T04:40:36.650Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:40:36.651Z] [LOG]       Weekday: 129.18h
[2025-10-24T04:40:36.651Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:40:36.652Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:36.653Z] [LOG]       Total Expected: 142.68h
[2025-10-24T04:40:36.654Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:40:36.654Z] [LOG]       Weekday: 35.68h (includes 1.68h live)
[2025-10-24T04:40:36.655Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:40:36.656Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:36.656Z] [LOG]       Total Actual: 40.18h
[2025-10-24T04:40:36.657Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:40:36.658Z] [LOG]       Weekday: 129.18h × Rs.470.59 = Rs.60789.33
[2025-10-24T04:40:36.658Z] [LOG]       Saturday: 13.50h × Rs.888.89 = Rs.12000.01
[2025-10-24T04:40:36.659Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:36.659Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:36.660Z] [LOG]       Total Expected Earned: Rs.72789.35
[2025-10-24T04:40:36.661Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:40:36.661Z] [LOG]       Weekday: 35.68h × Rs.470.59 = Rs.16789.17
[2025-10-24T04:40:36.662Z] [LOG]       Saturday: 4.50h × Rs.888.89 = Rs.4000.01
[2025-10-24T04:40:36.663Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:36.663Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:36.664Z] [LOG]       Total Actual Earned: Rs.20789.17
[2025-10-24T04:40:36.666Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:40:36.668Z] [LOG]       Calculated At: Oct 24, 2025, 10:10:36
[2025-10-24T04:40:36.668Z] [LOG]       Expected Earned (until NOW): Rs.72789.35
[2025-10-24T04:40:36.668Z] [LOG]       Actual Earned (until NOW): Rs.20789.17
[2025-10-24T04:40:36.669Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:36.669Z] [LOG]       Attendance Deduction: Rs.52000.17
[2025-10-24T04:40:36.670Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:40:36.670Z] [LOG]       📉 Shortfall: 102.50 hours (71.44% of expected)
[2025-10-24T04:40:36.670Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:40:36.671Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:40:36.671Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-24T04:40:36.672Z] [LOG]    Actual Earned Base: Rs.20789.17
[2025-10-24T04:40:36.672Z] [LOG]    Attendance Shortfall: Rs.52000.17
[2025-10-24T04:40:36.672Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:40:36.673Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:40:36.673Z] [LOG]    Gross Salary: 20789.17188070833
[2025-10-24T04:40:36.674Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:40:36.674Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:40:36.674Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.675Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:40:36.675Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.675Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:40:36.676Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.676Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:40:36.676Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.677Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:40:36.677Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.677Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:40:36.678Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.678Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:40:36.678Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.679Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:40:36.679Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.679Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:40:36.679Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.680Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:40:36.680Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.680Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:40:36.680Z] [LOG]    EPF/ETF calculated on: Rs.20789.17
[2025-10-24T04:40:36.681Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:40:36.681Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:40:36.682Z] [LOG] 💰 GROSS CALCULATION for Dharshika null:
[2025-10-24T04:40:36.683Z] [LOG]    Base Salary: 100000
[2025-10-24T04:40:36.683Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:40:36.684Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:40:36.684Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.684Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:40:36.685Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.685Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:40:36.685Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:36.907Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:40:36.907Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:36.908Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:40:36.909Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:40:36.909Z] [LOG]    Actual Earned Base: Rs.20789.17
[2025-10-24T04:40:36.910Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:40:36.911Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:40:36.911Z] [LOG]    = Gross Salary: Rs.20789.17
[2025-10-24T04:40:36.912Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:40:36.913Z] [LOG]    Attendance Shortfall (Info): Rs.52000.17
[2025-10-24T04:40:36.913Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:40:36.914Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:36.914Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:40:36.917Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:40:36.918Z] [LOG]    Gross Salary: Rs.20789.17
[2025-10-24T04:40:36.919Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:40:36.920Z] [LOG]    = NET SALARY: Rs.20789.17
[2025-10-24T04:40:36.920Z] [LOG] 
💾 Database Update:
[2025-10-24T04:40:36.921Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:40:36.922Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:40:37.152Z] [LOG] 
📝 Components to save:
[2025-10-24T04:40:37.152Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:40:37.153Z] [LOG]    Deduction components: 1
[2025-10-24T04:40:37.153Z] [LOG] Creating components for record 56b2794d-8d1f-443a-a28c-316378d7b6e4: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:40:37.155Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 20789.17188070833
}
[2025-10-24T04:40:37.368Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:40:37.586Z] [LOG] Created payroll_record_component: 58ee8c3b-b4b4-4084-9df4-f3b864279718 for Base Salary
[2025-10-24T04:40:37.587Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 52000.174999999996
}
[2025-10-24T04:40:37.811Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:40:38.027Z] [LOG] Created payroll_record_component: ab7369a7-30b3-456f-8dda-1a87089ba51a for Attendance Shortfall (Info)
[2025-10-24T04:40:38.449Z] [LOG] ✅ Financial balances updated successfully for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:38.450Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:40:38.451Z] [LOG] 
======================================================================
[2025-10-24T04:40:38.451Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Dharshika null
[2025-10-24T04:40:38.452Z] [LOG] ======================================================================
[2025-10-24T04:40:38.453Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-24T04:40:38.453Z] [LOG]    Actual Earned Base (Attendance-based): Rs.20789.17
[2025-10-24T04:40:38.454Z] [LOG]    Attendance Shortfall: Rs.52000.17
[2025-10-24T04:40:38.454Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:38.455Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:38.455Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:40:38.456Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:38.457Z] [LOG]    GROSS SALARY: Rs.20789.17
[2025-10-24T04:40:38.458Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:38.458Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:40:38.459Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:40:38.460Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:40:38.460Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:40:38.461Z] [LOG]       - Attendance Shortfall (Info): Rs.52000.17
[2025-10-24T04:40:38.461Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:38.462Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:38.463Z] [LOG]    NET SALARY: Rs.20789.17
[2025-10-24T04:40:38.463Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:40:38.464Z] [LOG] ======================================================================

[2025-10-24T04:40:38.465Z] [LOG] ✅ Dharshika null: Calculation completed successfully
[2025-10-24T04:40:38.467Z] [LOG] 📊 Progress: 10/34 (29.4%)
[2025-10-24T04:40:38.468Z] [LOG] 
🧮 Processing: Rasanga null (EMP000028)
[2025-10-24T04:40:38.468Z] [LOG] 📋 Record ID: 57841527-f3a9-4968-b1cb-fabd44ddd34b
[2025-10-24T04:40:38.469Z] [LOG] 
======================================================================
[2025-10-24T04:40:38.469Z] [LOG] 🧮 CALCULATING PAYROLL: Rasanga null (EMP000028)
[2025-10-24T04:40:38.470Z] [LOG] ======================================================================
[2025-10-24T04:40:39.329Z] [LOG] 🔍 Component filtering for employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-24T04:40:39.330Z] [LOG]    Total components: 13
[2025-10-24T04:40:39.331Z] [LOG]    Applicable components: 13
[2025-10-24T04:40:39.331Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-24T04:40:41.065Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:40:41.066Z] [LOG] 🔄 Processing financial records for employee 0143eaec-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:40:41.288Z] [LOG] 📊 Found 0 active loans for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:41.505Z] [LOG] 📊 Found 0 active advances for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:41.719Z] [LOG] 📊 Found 0 approved bonuses for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:41.720Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:40:41.721Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:40:41.948Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:40:41.949Z] [LOG]    Employee ID: 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:41.950Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:40:41.951Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:40:41.952Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:40:42.171Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:40:42.172Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:40:42.173Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:40:42.173Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:40:42.174Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:40:42.174Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:40:42.175Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:40:42.824Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:40:42.825Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:40:43.052Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:40:43.053Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:40:43.053Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:40:43.054Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:40:43.055Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:40:43.055Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:40:43.056Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:40:43.056Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:40:43.057Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:40:43.272Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:40:43.273Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:40:43.273Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:40:43.274Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:40:43.484Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:40:43.485Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:40:43.485Z] [LOG]       Check-in Time: 09:30:00
[2025-10-24T04:40:43.487Z] [LOG]       Current Time: 10:10:43
[2025-10-24T04:40:43.487Z] [LOG]       Expected Hours (scheduled → now): 1.68h
[2025-10-24T04:40:43.488Z] [LOG]       Actual Hours (check-in → now): 0.68h
[2025-10-24T04:40:43.488Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:40:43.489Z] [LOG]       Weekday: 129.18h
[2025-10-24T04:40:43.490Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:40:43.490Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:43.491Z] [LOG]       Total Expected: 142.68h
[2025-10-24T04:40:43.492Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:40:43.493Z] [LOG]       Weekday: 34.68h (includes 0.68h live)
[2025-10-24T04:40:43.493Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:40:43.494Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:43.495Z] [LOG]       Total Actual: 39.18h
[2025-10-24T04:40:43.495Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:40:43.496Z] [LOG]       Weekday: 129.18h × Rs.235.29 = Rs.30394.47
[2025-10-24T04:40:43.497Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:40:43.497Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:43.498Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:43.501Z] [LOG]       Total Expected Earned: Rs.36394.41
[2025-10-24T04:40:43.501Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:40:43.503Z] [LOG]       Weekday: 34.68h × Rs.235.29 = Rs.8159.56
[2025-10-24T04:40:43.503Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:40:43.504Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:43.504Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:43.505Z] [LOG]       Total Actual Earned: Rs.10159.54
[2025-10-24T04:40:43.506Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:40:43.507Z] [LOG]       Calculated At: Oct 24, 2025, 10:10:43
[2025-10-24T04:40:43.507Z] [LOG]       Expected Earned (until NOW): Rs.36394.41
[2025-10-24T04:40:43.508Z] [LOG]       Actual Earned (until NOW): Rs.10159.54
[2025-10-24T04:40:43.508Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:43.508Z] [LOG]       Attendance Deduction: Rs.26234.86
[2025-10-24T04:40:43.509Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:40:43.509Z] [LOG]       📉 Shortfall: 103.50 hours (72.08% of expected)
[2025-10-24T04:40:43.509Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:40:43.510Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:40:43.510Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:40:43.510Z] [LOG]    Actual Earned Base: Rs.10159.54
[2025-10-24T04:40:43.511Z] [LOG]    Attendance Shortfall: Rs.26234.86
[2025-10-24T04:40:43.511Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:40:43.512Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:40:43.512Z] [LOG]    Gross Salary: 10159.542041766666
[2025-10-24T04:40:43.513Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:40:43.513Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:40:43.514Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.514Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:40:43.514Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.516Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:40:43.517Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.517Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:40:43.518Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.518Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:40:43.518Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.519Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:40:43.519Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.519Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:40:43.520Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.520Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:40:43.520Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.521Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:40:43.521Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.522Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:40:43.522Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.522Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:40:43.523Z] [LOG]    EPF/ETF calculated on: Rs.10159.54
[2025-10-24T04:40:43.523Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:40:43.524Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:40:43.524Z] [LOG] 💰 GROSS CALCULATION for Rasanga null:
[2025-10-24T04:40:43.525Z] [LOG]    Base Salary: 50000
[2025-10-24T04:40:43.525Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:40:43.525Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:40:43.526Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.526Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:40:43.526Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.527Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:40:43.527Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:43.738Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:40:43.739Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:43.739Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:40:43.740Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:40:43.741Z] [LOG]    Actual Earned Base: Rs.10159.54
[2025-10-24T04:40:43.741Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:40:43.742Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:40:43.742Z] [LOG]    = Gross Salary: Rs.10159.54
[2025-10-24T04:40:43.743Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:40:43.744Z] [LOG]    Attendance Shortfall (Info): Rs.26234.86
[2025-10-24T04:40:43.744Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:40:43.745Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:43.746Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:40:43.747Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:40:43.747Z] [LOG]    Gross Salary: Rs.10159.54
[2025-10-24T04:40:43.748Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:40:43.750Z] [LOG]    = NET SALARY: Rs.10159.54
[2025-10-24T04:40:43.751Z] [LOG] 
💾 Database Update:
[2025-10-24T04:40:43.752Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:40:43.753Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:40:43.968Z] [LOG] 
📝 Components to save:
[2025-10-24T04:40:43.969Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:40:43.969Z] [LOG]    Deduction components: 1
[2025-10-24T04:40:43.970Z] [LOG] Creating components for record 57841527-f3a9-4968-b1cb-fabd44ddd34b: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:40:43.972Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10159.542041766666
}
[2025-10-24T04:40:44.183Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:40:44.404Z] [LOG] Created payroll_record_component: e35d3474-99ca-4b76-807a-1c4d293bb60b for Base Salary
[2025-10-24T04:40:44.404Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 26234.864999999998
}
[2025-10-24T04:40:44.624Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:40:44.839Z] [LOG] Created payroll_record_component: 8a4966ec-f809-4676-ac0e-9d6f9b07b191 for Attendance Shortfall (Info)
[2025-10-24T04:40:45.248Z] [LOG] ✅ Financial balances updated successfully for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:45.249Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:40:45.250Z] [LOG] 
======================================================================
[2025-10-24T04:40:45.251Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Rasanga null
[2025-10-24T04:40:45.252Z] [LOG] ======================================================================
[2025-10-24T04:40:45.252Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:40:45.253Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10159.54
[2025-10-24T04:40:45.253Z] [LOG]    Attendance Shortfall: Rs.26234.86
[2025-10-24T04:40:45.254Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:45.255Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:45.255Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:40:45.256Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:45.257Z] [LOG]    GROSS SALARY: Rs.10159.54
[2025-10-24T04:40:45.258Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:45.258Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:40:45.259Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:40:45.259Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:40:45.260Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:40:45.261Z] [LOG]       - Attendance Shortfall (Info): Rs.26234.86
[2025-10-24T04:40:45.261Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:45.262Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:45.262Z] [LOG]    NET SALARY: Rs.10159.54
[2025-10-24T04:40:45.263Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:40:45.263Z] [LOG] ======================================================================

[2025-10-24T04:40:45.264Z] [LOG] ✅ Rasanga null: Calculation completed successfully
[2025-10-24T04:40:45.267Z] [LOG] 📊 Progress: 11/34 (32.4%)
[2025-10-24T04:40:45.268Z] [LOG] 
🧮 Processing: Faizan Faizan (EMP000003)
[2025-10-24T04:40:45.268Z] [LOG] 📋 Record ID: 5963cb1c-9a79-4ae0-a263-fc8a68053be0
[2025-10-24T04:40:45.269Z] [LOG] 
======================================================================
[2025-10-24T04:40:45.270Z] [LOG] 🧮 CALCULATING PAYROLL: Faizan Faizan (EMP000003)
[2025-10-24T04:40:45.270Z] [LOG] ======================================================================
[2025-10-24T04:40:46.125Z] [LOG] 🔍 Component filtering for employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-24T04:40:46.125Z] [LOG]    Total components: 13
[2025-10-24T04:40:46.125Z] [LOG]    Applicable components: 13
[2025-10-24T04:40:46.126Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-24T04:40:47.764Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:40:47.765Z] [LOG] 🔄 Processing financial records for employee 0143a057-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:40:47.977Z] [LOG] 📊 Found 0 active loans for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:48.189Z] [LOG] 📊 Found 0 active advances for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:48.417Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:48.417Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:40:48.419Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:40:48.629Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:40:48.630Z] [LOG]    Employee ID: 0143a057-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:48.630Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:40:48.630Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:40:48.631Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:40:48.836Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:40:48.836Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:40:48.837Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:40:48.837Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:40:48.837Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:40:48.837Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:40:48.838Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:40:49.460Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:40:49.461Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:40:49.660Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:40:49.661Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:40:49.661Z] [LOG]       Total completed sessions found: 4
[2025-10-24T04:40:49.661Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:40:49.662Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:40:49.662Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:40:49.663Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:40:49.663Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:40:49.872Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:40:49.873Z] [LOG]          Weekday: 25.50h
[2025-10-24T04:40:49.873Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:40:49.873Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:40:50.076Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:40:50.076Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:40:50.077Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:40:50.078Z] [LOG]       Current Time: 10:10:50
[2025-10-24T04:40:50.078Z] [LOG]       Expected Hours (scheduled → now): 1.68h
[2025-10-24T04:40:50.079Z] [LOG]       Actual Hours (check-in → now): 1.68h
[2025-10-24T04:40:50.079Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:40:50.080Z] [LOG]       Weekday: 129.18h
[2025-10-24T04:40:50.081Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:40:50.082Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:50.085Z] [LOG]       Total Expected: 142.68h
[2025-10-24T04:40:50.085Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:40:50.087Z] [LOG]       Weekday: 27.18h (includes 1.68h live)
[2025-10-24T04:40:50.087Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:40:50.088Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:50.089Z] [LOG]       Total Actual: 31.68h
[2025-10-24T04:40:50.089Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:40:50.090Z] [LOG]       Weekday: 129.18h × Rs.235.29 = Rs.30394.90
[2025-10-24T04:40:50.090Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:40:50.091Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:50.092Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:50.093Z] [LOG]       Total Expected Earned: Rs.36394.84
[2025-10-24T04:40:50.094Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:40:50.094Z] [LOG]       Weekday: 27.18h × Rs.235.29 = Rs.6395.32
[2025-10-24T04:40:50.095Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:40:50.095Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:50.096Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:50.097Z] [LOG]       Total Actual Earned: Rs.8395.30
[2025-10-24T04:40:50.098Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:40:50.103Z] [LOG]       Calculated At: Oct 24, 2025, 10:10:50
[2025-10-24T04:40:50.104Z] [LOG]       Expected Earned (until NOW): Rs.36394.84
[2025-10-24T04:40:50.105Z] [LOG]       Actual Earned (until NOW): Rs.8395.30
[2025-10-24T04:40:50.105Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:50.106Z] [LOG]       Attendance Deduction: Rs.27999.54
[2025-10-24T04:40:50.106Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:40:50.107Z] [LOG]       📉 Shortfall: 111.00 hours (76.93% of expected)
[2025-10-24T04:40:50.107Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:40:50.107Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:40:50.107Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:40:50.110Z] [LOG]    Actual Earned Base: Rs.8395.30
[2025-10-24T04:40:50.114Z] [LOG]    Attendance Shortfall: Rs.27999.54
[2025-10-24T04:40:50.114Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:40:50.114Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:40:50.114Z] [LOG]    Gross Salary: 8395.2978839
[2025-10-24T04:40:50.114Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:40:50.116Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:40:50.117Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.119Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:40:50.119Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.119Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:40:50.119Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.120Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:40:50.120Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.120Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:40:50.120Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.121Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:40:50.121Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.121Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:40:50.121Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.122Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:40:50.122Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.122Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:40:50.123Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.123Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:40:50.123Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.124Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:40:50.124Z] [LOG]    EPF/ETF calculated on: Rs.8395.30
[2025-10-24T04:40:50.124Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:40:50.124Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:40:50.125Z] [LOG] 💰 GROSS CALCULATION for Faizan Faizan:
[2025-10-24T04:40:50.125Z] [LOG]    Base Salary: 50000
[2025-10-24T04:40:50.125Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:40:50.125Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:40:50.125Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.125Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:40:50.126Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.126Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:40:50.126Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:50.332Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:40:50.333Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:50.333Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:40:50.333Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:40:50.334Z] [LOG]    Actual Earned Base: Rs.8395.30
[2025-10-24T04:40:50.334Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:40:50.334Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:40:50.334Z] [LOG]    = Gross Salary: Rs.8395.30
[2025-10-24T04:40:50.335Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:40:50.335Z] [LOG]    Attendance Shortfall (Info): Rs.27999.54
[2025-10-24T04:40:50.335Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:40:50.335Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:50.336Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:40:50.336Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:40:50.336Z] [LOG]    Gross Salary: Rs.8395.30
[2025-10-24T04:40:50.337Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:40:50.337Z] [LOG]    = NET SALARY: Rs.8395.30
[2025-10-24T04:40:50.337Z] [LOG] 
💾 Database Update:
[2025-10-24T04:40:50.338Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:40:50.338Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:40:50.549Z] [LOG] 
📝 Components to save:
[2025-10-24T04:40:50.550Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:40:50.550Z] [LOG]    Deduction components: 1
[2025-10-24T04:40:50.551Z] [LOG] Creating components for record 5963cb1c-9a79-4ae0-a263-fc8a68053be0: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:40:50.551Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8395.2978839
}
[2025-10-24T04:40:50.756Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:40:50.964Z] [LOG] Created payroll_record_component: 3883c54c-68cc-4319-8378-05d6b897fb96 for Base Salary
[2025-10-24T04:40:50.964Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 27999.54
}
[2025-10-24T04:40:51.173Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:40:51.385Z] [LOG] Created payroll_record_component: f6e9eb45-c674-4057-af4b-a0486a1b1994 for Attendance Shortfall (Info)
[2025-10-24T04:40:51.796Z] [LOG] ✅ Financial balances updated successfully for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-24T04:40:51.797Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:40:51.797Z] [LOG] 
======================================================================
[2025-10-24T04:40:51.798Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Faizan Faizan
[2025-10-24T04:40:51.799Z] [LOG] ======================================================================
[2025-10-24T04:40:51.800Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:40:51.801Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8395.30
[2025-10-24T04:40:51.802Z] [LOG]    Attendance Shortfall: Rs.27999.54
[2025-10-24T04:40:51.802Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:51.803Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:51.804Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:40:51.805Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:51.805Z] [LOG]    GROSS SALARY: Rs.8395.30
[2025-10-24T04:40:51.806Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:51.806Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:40:51.807Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:40:51.808Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:40:51.808Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:40:51.809Z] [LOG]       - Attendance Shortfall (Info): Rs.27999.54
[2025-10-24T04:40:51.810Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:51.810Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:51.811Z] [LOG]    NET SALARY: Rs.8395.30
[2025-10-24T04:40:51.811Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:40:51.812Z] [LOG] ======================================================================

[2025-10-24T04:40:51.812Z] [LOG] ✅ Faizan Faizan: Calculation completed successfully
[2025-10-24T04:40:51.813Z] [LOG] 📊 Progress: 12/34 (35.3%)
[2025-10-24T04:40:51.814Z] [LOG] 
🧮 Processing: Kaushal Thambi (EMP465256103)
[2025-10-24T04:40:51.815Z] [LOG] 📋 Record ID: 62cf4001-feab-401f-9236-92c78c925dc9
[2025-10-24T04:40:51.817Z] [LOG] 
======================================================================
[2025-10-24T04:40:51.817Z] [LOG] 🧮 CALCULATING PAYROLL: Kaushal Thambi (EMP465256103)
[2025-10-24T04:40:51.818Z] [LOG] ======================================================================
[2025-10-24T04:40:52.640Z] [LOG] 🔍 Component filtering for employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-24T04:40:52.640Z] [LOG]    Total components: 13
[2025-10-24T04:40:52.641Z] [LOG]    Applicable components: 13
[2025-10-24T04:40:52.641Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-24T04:40:53.862Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:40:53.862Z] [LOG] 🔄 Processing financial records for employee 9e8125c4-ce58-411a-b617-9f75d481c613 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:40:54.064Z] [LOG] 📊 Found 0 active loans for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-24T04:40:54.274Z] [LOG] 📊 Found 0 active advances for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-24T04:40:54.480Z] [LOG] 📊 Found 0 approved bonuses for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-24T04:40:54.481Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:40:54.482Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:40:54.689Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:40:54.689Z] [LOG]    Employee ID: 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-24T04:40:54.690Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:40:54.690Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:40:54.691Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:40:54.901Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:40:54.901Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:40:54.901Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:40:54.902Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:40:54.902Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:40:54.903Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:40:54.904Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:40:55.521Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:40:55.522Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:40:55.730Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:40:55.731Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:40:55.731Z] [LOG]       Total completed sessions found: 2
[2025-10-24T04:40:55.731Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:40:55.731Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:40:55.731Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:40:55.936Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:40:55.936Z] [LOG]          Weekday: 8.50h
[2025-10-24T04:40:55.937Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:40:55.937Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:40:56.136Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:40:56.136Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:40:56.137Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:40:56.137Z] [LOG]       Current Time: 10:10:56
[2025-10-24T04:40:56.137Z] [LOG]       Expected Hours (scheduled → now): 1.68h
[2025-10-24T04:40:56.138Z] [LOG]       Actual Hours (check-in → now): 1.68h
[2025-10-24T04:40:56.138Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:40:56.138Z] [LOG]       Weekday: 129.18h
[2025-10-24T04:40:56.139Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:40:56.139Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:56.139Z] [LOG]       Total Expected: 142.68h
[2025-10-24T04:40:56.139Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:40:56.140Z] [LOG]       Weekday: 10.18h (includes 1.68h live)
[2025-10-24T04:40:56.140Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:40:56.140Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:40:56.141Z] [LOG]       Total Actual: 14.68h
[2025-10-24T04:40:56.141Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:40:56.141Z] [LOG]       Weekday: 129.18h × Rs.235.29 = Rs.30395.29
[2025-10-24T04:40:56.141Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:40:56.142Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:56.142Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:56.143Z] [LOG]       Total Expected Earned: Rs.36395.23
[2025-10-24T04:40:56.143Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:40:56.144Z] [LOG]       Weekday: 10.18h × Rs.235.29 = Rs.2395.78
[2025-10-24T04:40:56.144Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:40:56.144Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:40:56.144Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:56.144Z] [LOG]       Total Actual Earned: Rs.4395.76
[2025-10-24T04:40:56.145Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:40:56.146Z] [LOG]       Calculated At: Oct 24, 2025, 10:10:56
[2025-10-24T04:40:56.146Z] [LOG]       Expected Earned (until NOW): Rs.36395.23
[2025-10-24T04:40:56.146Z] [LOG]       Actual Earned (until NOW): Rs.4395.76
[2025-10-24T04:40:56.146Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:40:56.147Z] [LOG]       Attendance Deduction: Rs.31999.47
[2025-10-24T04:40:56.147Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:40:56.147Z] [LOG]       📉 Shortfall: 128.00 hours (87.92% of expected)
[2025-10-24T04:40:56.147Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:40:56.148Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:40:56.148Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:40:56.148Z] [LOG]    Actual Earned Base: Rs.4395.76
[2025-10-24T04:40:56.148Z] [LOG]    Attendance Shortfall: Rs.31999.47
[2025-10-24T04:40:56.148Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:40:56.150Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:40:56.150Z] [LOG]    Gross Salary: 4395.7639554
[2025-10-24T04:40:56.150Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:40:56.150Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:40:56.151Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.151Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:40:56.151Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.151Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:40:56.152Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.152Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:40:56.152Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.153Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:40:56.153Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.153Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:40:56.154Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.154Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:40:56.154Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.154Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:40:56.154Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.155Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:40:56.155Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.155Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:40:56.155Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.155Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:40:56.156Z] [LOG]    EPF/ETF calculated on: Rs.4395.76
[2025-10-24T04:40:56.156Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:40:56.156Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:40:56.157Z] [LOG] 💰 GROSS CALCULATION for Kaushal Thambi:
[2025-10-24T04:40:56.157Z] [LOG]    Base Salary: 50000
[2025-10-24T04:40:56.157Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:40:56.157Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:40:56.158Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.158Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:40:56.158Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.158Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:40:56.158Z] [LOG]    Fixed amount: 0
[2025-10-24T04:40:56.359Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:40:56.359Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:56.360Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:40:56.360Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:40:56.360Z] [LOG]    Actual Earned Base: Rs.4395.76
[2025-10-24T04:40:56.360Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:40:56.361Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:40:56.361Z] [LOG]    = Gross Salary: Rs.4395.76
[2025-10-24T04:40:56.361Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:40:56.361Z] [LOG]    Attendance Shortfall (Info): Rs.31999.47
[2025-10-24T04:40:56.361Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:40:56.362Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:56.362Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:40:56.362Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:40:56.362Z] [LOG]    Gross Salary: Rs.4395.76
[2025-10-24T04:40:56.363Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:40:56.363Z] [LOG]    = NET SALARY: Rs.4395.76
[2025-10-24T04:40:56.363Z] [LOG] 
💾 Database Update:
[2025-10-24T04:40:56.363Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:40:56.364Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:40:56.571Z] [LOG] 
📝 Components to save:
[2025-10-24T04:40:56.571Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:40:56.571Z] [LOG]    Deduction components: 1
[2025-10-24T04:40:56.571Z] [LOG] Creating components for record 62cf4001-feab-401f-9236-92c78c925dc9: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:40:56.572Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 4395.7639554
}
[2025-10-24T04:40:56.772Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:40:56.977Z] [LOG] Created payroll_record_component: 65c1b0e8-a5bc-4f3c-9450-aa98636e7069 for Base Salary
[2025-10-24T04:40:56.996Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 31999.47
}
[2025-10-24T04:40:57.211Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:40:57.432Z] [LOG] Created payroll_record_component: f3581ffd-a811-42a8-bc24-da7091aab5d0 for Attendance Shortfall (Info)
[2025-10-24T04:40:57.864Z] [LOG] ✅ Financial balances updated successfully for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-24T04:40:57.874Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:40:57.874Z] [LOG] 
======================================================================
[2025-10-24T04:40:57.885Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Kaushal Thambi
[2025-10-24T04:40:57.886Z] [LOG] ======================================================================
[2025-10-24T04:40:57.886Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:40:57.887Z] [LOG]    Actual Earned Base (Attendance-based): Rs.4395.76
[2025-10-24T04:40:57.891Z] [LOG]    Attendance Shortfall: Rs.31999.47
[2025-10-24T04:40:57.893Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:57.894Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:40:57.896Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:40:57.897Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:57.897Z] [LOG]    GROSS SALARY: Rs.4395.76
[2025-10-24T04:40:57.902Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:57.909Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:40:57.912Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:40:57.921Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:40:57.923Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:40:57.923Z] [LOG]       - Attendance Shortfall (Info): Rs.31999.47
[2025-10-24T04:40:57.924Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:40:57.925Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:40:57.926Z] [LOG]    NET SALARY: Rs.4395.76
[2025-10-24T04:40:57.926Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:40:57.927Z] [LOG] ======================================================================

[2025-10-24T04:40:57.927Z] [LOG] ✅ Kaushal Thambi: Calculation completed successfully
[2025-10-24T04:40:57.928Z] [LOG] 📊 Progress: 13/34 (38.2%)
[2025-10-24T04:40:57.928Z] [LOG] 
🧮 Processing: Sumaiya null (EMP000016)
[2025-10-24T04:40:57.929Z] [LOG] 📋 Record ID: 63a979b7-74ec-44cb-899c-c70b435ab04f
[2025-10-24T04:40:57.929Z] [LOG] 
======================================================================
[2025-10-24T04:40:57.929Z] [LOG] 🧮 CALCULATING PAYROLL: Sumaiya null (EMP000016)
[2025-10-24T04:40:57.930Z] [LOG] ======================================================================
[2025-10-24T04:40:58.777Z] [LOG] 🔍 Component filtering for employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-24T04:40:58.778Z] [LOG]    Total components: 13
[2025-10-24T04:40:58.780Z] [LOG]    Applicable components: 13
[2025-10-24T04:40:58.781Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-24T04:41:00.067Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:41:00.068Z] [LOG] 🔄 Processing financial records for employee 0143b22f-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:41:00.302Z] [LOG] 📊 Found 0 active loans for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:00.536Z] [LOG] 📊 Found 0 active advances for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:00.746Z] [LOG] 📊 Found 0 approved bonuses for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:00.747Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:41:00.748Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:41:00.957Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:41:00.958Z] [LOG]    Employee ID: 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:00.958Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:41:00.958Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:41:00.958Z] [LOG]    Base Salary (Full Month): Rs.60000.00
[2025-10-24T04:41:01.168Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:41:01.168Z] [LOG]       Daily Salary: Rs.2400.00
[2025-10-24T04:41:01.168Z] [LOG]       Weekday Hourly Rate: Rs.282.35
[2025-10-24T04:41:01.169Z] [LOG]       Saturday Hourly Rate: Rs.533.33
[2025-10-24T04:41:01.169Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:41:01.169Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:41:01.170Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:41:01.835Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:41:01.836Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:41:02.045Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:41:02.046Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:41:02.046Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:41:02.046Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:41:02.046Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:41:02.047Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:41:02.047Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:41:02.047Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:41:02.047Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:41:02.268Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:41:02.269Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:41:02.269Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:41:02.269Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:41:02.488Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:41:02.489Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:41:02.489Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:41:02.490Z] [LOG]       Current Time: 10:11:02
[2025-10-24T04:41:02.492Z] [LOG]       Expected Hours (scheduled → now): 1.68h
[2025-10-24T04:41:02.492Z] [LOG]       Actual Hours (check-in → now): 1.68h
[2025-10-24T04:41:02.492Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:41:02.493Z] [LOG]       Weekday: 129.18h
[2025-10-24T04:41:02.493Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:41:02.494Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:02.495Z] [LOG]       Total Expected: 142.68h
[2025-10-24T04:41:02.495Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:41:02.495Z] [LOG]       Weekday: 35.68h (includes 1.68h live)
[2025-10-24T04:41:02.495Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:41:02.496Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:02.496Z] [LOG]       Total Actual: 40.18h
[2025-10-24T04:41:02.496Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:41:02.497Z] [LOG]       Weekday: 129.18h × Rs.282.35 = Rs.36475.11
[2025-10-24T04:41:02.497Z] [LOG]       Saturday: 13.50h × Rs.533.33 = Rs.7199.96
[2025-10-24T04:41:02.497Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:02.497Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:02.498Z] [LOG]       Total Expected Earned: Rs.43675.06
[2025-10-24T04:41:02.498Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:41:02.499Z] [LOG]       Weekday: 35.68h × Rs.282.35 = Rs.10075.38
[2025-10-24T04:41:02.500Z] [LOG]       Saturday: 4.50h × Rs.533.33 = Rs.2399.99
[2025-10-24T04:41:02.501Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:02.501Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:02.501Z] [LOG]       Total Actual Earned: Rs.12475.37
[2025-10-24T04:41:02.502Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:41:02.502Z] [LOG]       Calculated At: Oct 24, 2025, 10:11:02
[2025-10-24T04:41:02.502Z] [LOG]       Expected Earned (until NOW): Rs.43675.06
[2025-10-24T04:41:02.503Z] [LOG]       Actual Earned (until NOW): Rs.12475.37
[2025-10-24T04:41:02.503Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:02.503Z] [LOG]       Attendance Deduction: Rs.31199.70
[2025-10-24T04:41:02.503Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:41:02.504Z] [LOG]       📉 Shortfall: 102.50 hours (71.44% of expected)
[2025-10-24T04:41:02.504Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:41:02.504Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:41:02.505Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-24T04:41:02.505Z] [LOG]    Actual Earned Base: Rs.12475.37
[2025-10-24T04:41:02.507Z] [LOG]    Attendance Shortfall: Rs.31199.70
[2025-10-24T04:41:02.507Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:41:02.508Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:41:02.508Z] [LOG]    Gross Salary: 12475.369301888892
[2025-10-24T04:41:02.508Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:41:02.509Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:41:02.509Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.510Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:41:02.510Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.510Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:41:02.511Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.512Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:41:02.513Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.514Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:41:02.514Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.515Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:41:02.517Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.518Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:41:02.519Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.519Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:41:02.520Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.522Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:41:02.522Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.523Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:41:02.523Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.523Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:41:02.523Z] [LOG]    EPF/ETF calculated on: Rs.12475.37
[2025-10-24T04:41:02.525Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:41:02.525Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:41:02.525Z] [LOG] 💰 GROSS CALCULATION for Sumaiya null:
[2025-10-24T04:41:02.526Z] [LOG]    Base Salary: 60000
[2025-10-24T04:41:02.526Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:41:02.526Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:41:02.526Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.529Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:41:02.529Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.529Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:41:02.531Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:02.761Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:41:02.762Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:02.762Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:41:02.763Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:41:02.763Z] [LOG]    Actual Earned Base: Rs.12475.37
[2025-10-24T04:41:02.763Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:41:02.764Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:41:02.764Z] [LOG]    = Gross Salary: Rs.12475.37
[2025-10-24T04:41:02.764Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:41:02.765Z] [LOG]    Attendance Shortfall (Info): Rs.31199.70
[2025-10-24T04:41:02.765Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:41:02.767Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:02.768Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:41:02.769Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:41:02.769Z] [LOG]    Gross Salary: Rs.12475.37
[2025-10-24T04:41:02.770Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:41:02.770Z] [LOG]    = NET SALARY: Rs.12475.37
[2025-10-24T04:41:02.770Z] [LOG] 
💾 Database Update:
[2025-10-24T04:41:02.771Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:41:02.771Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:41:02.994Z] [LOG] 
📝 Components to save:
[2025-10-24T04:41:02.994Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:41:02.995Z] [LOG]    Deduction components: 1
[2025-10-24T04:41:02.995Z] [LOG] Creating components for record 63a979b7-74ec-44cb-899c-c70b435ab04f: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:41:02.997Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 12475.369301888892
}
[2025-10-24T04:41:03.222Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:41:03.449Z] [LOG] Created payroll_record_component: b87bb2af-8683-41bf-a395-e2bcd7fcf8db for Base Salary
[2025-10-24T04:41:03.450Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 31199.695000000003
}
[2025-10-24T04:41:03.671Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:41:03.887Z] [LOG] Created payroll_record_component: 3c69d0f7-aa81-4396-b141-f35c574e01ce for Attendance Shortfall (Info)
[2025-10-24T04:41:04.307Z] [LOG] ✅ Financial balances updated successfully for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:04.308Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:41:04.309Z] [LOG] 
======================================================================
[2025-10-24T04:41:04.309Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sumaiya null
[2025-10-24T04:41:04.310Z] [LOG] ======================================================================
[2025-10-24T04:41:04.310Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-24T04:41:04.311Z] [LOG]    Actual Earned Base (Attendance-based): Rs.12475.37
[2025-10-24T04:41:04.312Z] [LOG]    Attendance Shortfall: Rs.31199.70
[2025-10-24T04:41:04.312Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:04.313Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:04.314Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:41:04.314Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:04.317Z] [LOG]    GROSS SALARY: Rs.12475.37
[2025-10-24T04:41:04.318Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:04.318Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:41:04.319Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:41:04.320Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:41:04.320Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:41:04.321Z] [LOG]       - Attendance Shortfall (Info): Rs.31199.70
[2025-10-24T04:41:04.322Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:04.322Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:04.323Z] [LOG]    NET SALARY: Rs.12475.37
[2025-10-24T04:41:04.323Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:41:04.324Z] [LOG] ======================================================================

[2025-10-24T04:41:04.325Z] [LOG] ✅ Sumaiya null: Calculation completed successfully
[2025-10-24T04:41:04.326Z] [LOG] 📊 Progress: 14/34 (41.2%)
[2025-10-24T04:41:04.326Z] [LOG] 
🧮 Processing: Viruna Damsiha Cooray null (EMP000038)
[2025-10-24T04:41:04.327Z] [LOG] 📋 Record ID: 6f299085-8346-41af-8a7f-0da90dc52e45
[2025-10-24T04:41:04.327Z] [LOG] 
======================================================================
[2025-10-24T04:41:04.328Z] [LOG] 🧮 CALCULATING PAYROLL: Viruna Damsiha Cooray null (EMP000038)
[2025-10-24T04:41:04.329Z] [LOG] ======================================================================
[2025-10-24T04:41:05.188Z] [LOG] 🔍 Component filtering for employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-24T04:41:05.188Z] [LOG]    Total components: 13
[2025-10-24T04:41:05.189Z] [LOG]    Applicable components: 13
[2025-10-24T04:41:05.189Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-24T04:41:06.499Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:41:06.500Z] [LOG] 🔄 Processing financial records for employee 01441633-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:41:06.711Z] [LOG] 📊 Found 0 active loans for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:06.935Z] [LOG] 📊 Found 0 active advances for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:07.162Z] [LOG] 📊 Found 0 approved bonuses for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:07.162Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:41:07.163Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:41:07.368Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:41:07.368Z] [LOG]    Employee ID: 01441633-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:07.368Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:41:07.369Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:41:07.369Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:41:07.592Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:41:07.592Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:41:07.592Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:41:07.593Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:41:07.593Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:41:07.593Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:41:07.593Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:41:08.228Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:41:08.228Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:41:08.438Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:41:08.439Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:41:08.440Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:41:08.440Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:41:08.441Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:41:08.441Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:41:08.442Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:41:08.442Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:41:08.443Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:41:08.661Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:41:08.661Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:41:08.661Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:41:08.661Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:41:08.899Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:41:08.900Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:41:08.900Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:41:08.901Z] [LOG]       Current Time: 10:11:08
[2025-10-24T04:41:08.902Z] [LOG]       Expected Hours (scheduled → now): 1.69h
[2025-10-24T04:41:08.902Z] [LOG]       Actual Hours (check-in → now): 1.69h
[2025-10-24T04:41:08.902Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:41:08.903Z] [LOG]       Weekday: 129.19h
[2025-10-24T04:41:08.903Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:41:08.903Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:08.904Z] [LOG]       Total Expected: 142.69h
[2025-10-24T04:41:08.904Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:41:08.904Z] [LOG]       Weekday: 35.69h (includes 1.69h live)
[2025-10-24T04:41:08.905Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:41:08.905Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:08.905Z] [LOG]       Total Actual: 40.19h
[2025-10-24T04:41:08.905Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:41:08.906Z] [LOG]       Weekday: 129.19h × Rs.235.29 = Rs.30396.13
[2025-10-24T04:41:08.906Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:41:08.906Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:08.907Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:08.907Z] [LOG]       Total Expected Earned: Rs.36396.07
[2025-10-24T04:41:08.907Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:41:08.908Z] [LOG]       Weekday: 35.69h × Rs.235.29 = Rs.8396.51
[2025-10-24T04:41:08.908Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:41:08.908Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:08.909Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:08.909Z] [LOG]       Total Actual Earned: Rs.10396.49
[2025-10-24T04:41:08.909Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:41:08.910Z] [LOG]       Calculated At: Oct 24, 2025, 10:11:08
[2025-10-24T04:41:08.910Z] [LOG]       Expected Earned (until NOW): Rs.36396.07
[2025-10-24T04:41:08.910Z] [LOG]       Actual Earned (until NOW): Rs.10396.49
[2025-10-24T04:41:08.911Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:08.911Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-24T04:41:08.911Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:41:08.911Z] [LOG]       📉 Shortfall: 102.50 hours (71.44% of expected)
[2025-10-24T04:41:08.911Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:41:08.912Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:41:08.912Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:41:08.912Z] [LOG]    Actual Earned Base: Rs.10396.49
[2025-10-24T04:41:08.912Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:41:08.913Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:41:08.913Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:41:08.913Z] [LOG]    Gross Salary: 10396.493123808332
[2025-10-24T04:41:08.913Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:41:08.914Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:41:08.914Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.914Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:41:08.914Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.915Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:41:08.915Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.915Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:41:08.918Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.918Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:41:08.918Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.919Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:41:08.919Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.919Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:41:08.919Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.920Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:41:08.920Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.920Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:41:08.920Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.921Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:41:08.921Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.921Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:41:08.921Z] [LOG]    EPF/ETF calculated on: Rs.10396.49
[2025-10-24T04:41:08.921Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:41:08.922Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:41:08.922Z] [LOG] 💰 GROSS CALCULATION for Viruna Damsiha Cooray null:
[2025-10-24T04:41:08.922Z] [LOG]    Base Salary: 50000
[2025-10-24T04:41:08.922Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:41:08.922Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:41:08.922Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.922Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:41:08.923Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:08.923Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:41:08.923Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:09.134Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:41:09.134Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:09.135Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:41:09.135Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:41:09.136Z] [LOG]    Actual Earned Base: Rs.10396.49
[2025-10-24T04:41:09.136Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:41:09.136Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:41:09.137Z] [LOG]    = Gross Salary: Rs.10396.49
[2025-10-24T04:41:09.137Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:41:09.137Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:41:09.138Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:41:09.138Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:09.138Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:41:09.139Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:41:09.139Z] [LOG]    Gross Salary: Rs.10396.49
[2025-10-24T04:41:09.139Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:41:09.140Z] [LOG]    = NET SALARY: Rs.10396.49
[2025-10-24T04:41:09.140Z] [LOG] 
💾 Database Update:
[2025-10-24T04:41:09.140Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:41:09.141Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:41:09.359Z] [LOG] 
📝 Components to save:
[2025-10-24T04:41:09.360Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:41:09.360Z] [LOG]    Deduction components: 1
[2025-10-24T04:41:09.360Z] [LOG] Creating components for record 6f299085-8346-41af-8a7f-0da90dc52e45: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:41:09.361Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10396.493123808332
}
[2025-10-24T04:41:09.569Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:41:09.791Z] [LOG] Created payroll_record_component: c486f5c6-d58f-4b75-985e-192beb336cc6 for Base Salary
[2025-10-24T04:41:09.791Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-24T04:41:10.028Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:41:10.254Z] [LOG] Created payroll_record_component: ef729154-86be-4311-8918-4af9a16317be for Attendance Shortfall (Info)
[2025-10-24T04:41:10.691Z] [LOG] ✅ Financial balances updated successfully for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:10.691Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:41:10.692Z] [LOG] 
======================================================================
[2025-10-24T04:41:10.693Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Viruna Damsiha Cooray null
[2025-10-24T04:41:10.693Z] [LOG] ======================================================================
[2025-10-24T04:41:10.694Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:41:10.695Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10396.49
[2025-10-24T04:41:10.695Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:41:10.696Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:10.696Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:10.697Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:41:10.698Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:10.702Z] [LOG]    GROSS SALARY: Rs.10396.49
[2025-10-24T04:41:10.703Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:10.704Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:41:10.705Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:41:10.705Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:41:10.706Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:41:10.706Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:41:10.707Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:10.707Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:10.708Z] [LOG]    NET SALARY: Rs.10396.49
[2025-10-24T04:41:10.709Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:41:10.709Z] [LOG] ======================================================================

[2025-10-24T04:41:10.710Z] [LOG] ✅ Viruna Damsiha Cooray null: Calculation completed successfully
[2025-10-24T04:41:10.710Z] [LOG] 📊 Progress: 15/34 (44.1%)
[2025-10-24T04:41:10.711Z] [LOG] 
🧮 Processing: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-24T04:41:10.712Z] [LOG] 📋 Record ID: 712966cd-79c7-4a48-81cf-fb79742d8688
[2025-10-24T04:41:10.712Z] [LOG] 
======================================================================
[2025-10-24T04:41:10.713Z] [LOG] 🧮 CALCULATING PAYROLL: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-24T04:41:10.714Z] [LOG] ======================================================================
[2025-10-24T04:41:11.620Z] [LOG] 🔍 Component filtering for employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-24T04:41:11.620Z] [LOG]    Total components: 13
[2025-10-24T04:41:11.621Z] [LOG]    Applicable components: 13
[2025-10-24T04:41:11.621Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-24T04:41:13.353Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:41:13.354Z] [LOG] 🔄 Processing financial records for employee 0144315c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:41:13.571Z] [LOG] 📊 Found 0 active loans for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:13.788Z] [LOG] 📊 Found 0 active advances for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:14.001Z] [LOG] 📊 Found 0 approved bonuses for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:14.001Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:41:14.003Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:41:14.236Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:41:14.237Z] [LOG]    Employee ID: 0144315c-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:14.238Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:41:14.238Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:41:14.239Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:41:14.859Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:41:14.860Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:41:14.860Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:41:14.860Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:41:14.860Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:41:14.861Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:41:14.861Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:41:15.463Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:41:15.463Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:41:15.660Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:41:15.661Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:41:15.661Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:41:15.661Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:41:15.661Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:41:15.661Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:41:15.661Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:41:15.662Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:41:15.662Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:41:15.875Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:41:15.875Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:41:15.875Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:41:15.875Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:41:16.077Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:41:16.084Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:41:16.085Z] [LOG]       Check-in Time: 09:30:00
[2025-10-24T04:41:16.086Z] [LOG]       Current Time: 10:11:16
[2025-10-24T04:41:16.087Z] [LOG]       Expected Hours (scheduled → now): 1.69h
[2025-10-24T04:41:16.087Z] [LOG]       Actual Hours (check-in → now): 0.69h
[2025-10-24T04:41:16.087Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:41:16.087Z] [LOG]       Weekday: 129.19h
[2025-10-24T04:41:16.088Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:41:16.088Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:16.088Z] [LOG]       Total Expected: 142.69h
[2025-10-24T04:41:16.088Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:41:16.089Z] [LOG]       Weekday: 34.69h (includes 0.69h live)
[2025-10-24T04:41:16.089Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:41:16.089Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:16.089Z] [LOG]       Total Actual: 39.19h
[2025-10-24T04:41:16.090Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:41:16.090Z] [LOG]       Weekday: 129.19h × Rs.235.29 = Rs.30396.60
[2025-10-24T04:41:16.090Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:41:16.091Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:16.092Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:16.092Z] [LOG]       Total Expected Earned: Rs.36396.54
[2025-10-24T04:41:16.092Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:41:16.093Z] [LOG]       Weekday: 34.69h × Rs.235.29 = Rs.8161.69
[2025-10-24T04:41:16.093Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:41:16.093Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:16.094Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:16.094Z] [LOG]       Total Actual Earned: Rs.10161.67
[2025-10-24T04:41:16.094Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:41:16.094Z] [LOG]       Calculated At: Oct 24, 2025, 10:11:16
[2025-10-24T04:41:16.094Z] [LOG]       Expected Earned (until NOW): Rs.36396.54
[2025-10-24T04:41:16.095Z] [LOG]       Actual Earned (until NOW): Rs.10161.67
[2025-10-24T04:41:16.095Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:16.095Z] [LOG]       Attendance Deduction: Rs.26234.86
[2025-10-24T04:41:16.095Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:41:16.096Z] [LOG]       📉 Shortfall: 103.50 hours (72.08% of expected)
[2025-10-24T04:41:16.096Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:41:16.096Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:41:16.096Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:41:16.097Z] [LOG]    Actual Earned Base: Rs.10161.67
[2025-10-24T04:41:16.097Z] [LOG]    Attendance Shortfall: Rs.26234.86
[2025-10-24T04:41:16.097Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:41:16.098Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:41:16.102Z] [LOG]    Gross Salary: 10161.672265924999
[2025-10-24T04:41:16.105Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:41:16.106Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:41:16.106Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.106Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:41:16.107Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.108Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:41:16.108Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.108Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:41:16.108Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.109Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:41:16.109Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.109Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:41:16.109Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.109Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:41:16.109Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.110Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:41:16.110Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.110Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:41:16.110Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.110Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:41:16.111Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.111Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:41:16.112Z] [LOG]    EPF/ETF calculated on: Rs.10161.67
[2025-10-24T04:41:16.114Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:41:16.114Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:41:16.115Z] [LOG] 💰 GROSS CALCULATION for G.M Supathala Sadaru Madhushan null:
[2025-10-24T04:41:16.119Z] [LOG]    Base Salary: 50000
[2025-10-24T04:41:16.120Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:41:16.120Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:41:16.121Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.121Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:41:16.121Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.121Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:41:16.122Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:16.322Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:41:16.324Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:16.324Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:41:16.325Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:41:16.325Z] [LOG]    Actual Earned Base: Rs.10161.67
[2025-10-24T04:41:16.325Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:41:16.325Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:41:16.326Z] [LOG]    = Gross Salary: Rs.10161.67
[2025-10-24T04:41:16.326Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:41:16.326Z] [LOG]    Attendance Shortfall (Info): Rs.26234.86
[2025-10-24T04:41:16.327Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:41:16.327Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:16.327Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:41:16.327Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:41:16.327Z] [LOG]    Gross Salary: Rs.10161.67
[2025-10-24T04:41:16.328Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:41:16.328Z] [LOG]    = NET SALARY: Rs.10161.67
[2025-10-24T04:41:16.328Z] [LOG] 
💾 Database Update:
[2025-10-24T04:41:16.328Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:41:16.328Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:41:16.523Z] [LOG] 
📝 Components to save:
[2025-10-24T04:41:16.523Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:41:16.523Z] [LOG]    Deduction components: 1
[2025-10-24T04:41:16.523Z] [LOG] Creating components for record 712966cd-79c7-4a48-81cf-fb79742d8688: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:41:16.524Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10161.672265924999
}
[2025-10-24T04:41:16.727Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:41:16.931Z] [LOG] Created payroll_record_component: 94967d77-f180-48db-8369-81722f462f4e for Base Salary
[2025-10-24T04:41:16.931Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 26234.864999999998
}
[2025-10-24T04:41:17.131Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:41:17.334Z] [LOG] Created payroll_record_component: 3ca33099-3205-4662-ad5b-d6eb7dffd74e for Attendance Shortfall (Info)
[2025-10-24T04:41:17.731Z] [LOG] ✅ Financial balances updated successfully for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:17.732Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:41:17.733Z] [LOG] 
======================================================================
[2025-10-24T04:41:17.733Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: G.M Supathala Sadaru Madhushan null
[2025-10-24T04:41:17.733Z] [LOG] ======================================================================
[2025-10-24T04:41:17.734Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:41:17.734Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10161.67
[2025-10-24T04:41:17.734Z] [LOG]    Attendance Shortfall: Rs.26234.86
[2025-10-24T04:41:17.734Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:17.735Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:17.735Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:41:17.735Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:17.735Z] [LOG]    GROSS SALARY: Rs.10161.67
[2025-10-24T04:41:17.735Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:17.735Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:41:17.736Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:41:17.736Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:41:17.736Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:41:17.736Z] [LOG]       - Attendance Shortfall (Info): Rs.26234.86
[2025-10-24T04:41:17.736Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:17.736Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:17.736Z] [LOG]    NET SALARY: Rs.10161.67
[2025-10-24T04:41:17.737Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:41:17.737Z] [LOG] ======================================================================

[2025-10-24T04:41:17.737Z] [LOG] ✅ G.M Supathala Sadaru Madhushan null: Calculation completed successfully
[2025-10-24T04:41:17.737Z] [LOG] 📊 Progress: 16/34 (47.1%)
[2025-10-24T04:41:17.737Z] [LOG] 
🧮 Processing: P.D.P Dilini Madushani null (EMP000043)
[2025-10-24T04:41:17.737Z] [LOG] 📋 Record ID: 7a5358b6-5a3c-4452-8477-2422fd8b65da
[2025-10-24T04:41:17.737Z] [LOG] 
======================================================================
[2025-10-24T04:41:17.738Z] [LOG] 🧮 CALCULATING PAYROLL: P.D.P Dilini Madushani null (EMP000043)
[2025-10-24T04:41:17.738Z] [LOG] ======================================================================
[2025-10-24T04:41:18.551Z] [LOG] 🔍 Component filtering for employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-24T04:41:18.552Z] [LOG]    Total components: 13
[2025-10-24T04:41:18.553Z] [LOG]    Applicable components: 13
[2025-10-24T04:41:18.553Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-24T04:41:19.792Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:41:19.793Z] [LOG] 🔄 Processing financial records for employee 014435dc-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:41:19.998Z] [LOG] 📊 Found 0 active loans for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:20.210Z] [LOG] 📊 Found 0 active advances for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:20.421Z] [LOG] 📊 Found 0 approved bonuses for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:20.421Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:41:20.422Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:41:20.628Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:41:20.628Z] [LOG]    Employee ID: 014435dc-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:20.629Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:41:20.629Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:41:20.629Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:41:20.920Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:41:20.920Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:41:20.920Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:41:20.921Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:41:20.921Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:41:20.921Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:41:20.921Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:41:21.536Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:41:21.537Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:41:21.761Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:41:21.761Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:41:21.762Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:41:21.762Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:41:21.763Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:41:21.763Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:41:21.764Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:41:21.765Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:41:21.767Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:41:21.964Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:41:21.965Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:41:21.966Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:41:21.967Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:41:22.171Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:41:22.172Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:41:22.172Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:41:22.173Z] [LOG]       Current Time: 10:11:22
[2025-10-24T04:41:22.174Z] [LOG]       Expected Hours (scheduled → now): 1.69h
[2025-10-24T04:41:22.174Z] [LOG]       Actual Hours (check-in → now): 1.69h
[2025-10-24T04:41:22.174Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:41:22.175Z] [LOG]       Weekday: 129.19h
[2025-10-24T04:41:22.176Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:41:22.176Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:22.177Z] [LOG]       Total Expected: 142.69h
[2025-10-24T04:41:22.177Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:41:22.178Z] [LOG]       Weekday: 35.69h (includes 1.69h live)
[2025-10-24T04:41:22.179Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:41:22.179Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:22.180Z] [LOG]       Total Actual: 40.19h
[2025-10-24T04:41:22.180Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:41:22.181Z] [LOG]       Weekday: 129.19h × Rs.235.29 = Rs.30397.00
[2025-10-24T04:41:22.182Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:41:22.184Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:22.185Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:22.185Z] [LOG]       Total Expected Earned: Rs.36396.94
[2025-10-24T04:41:22.186Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:41:22.186Z] [LOG]       Weekday: 35.69h × Rs.235.29 = Rs.8397.38
[2025-10-24T04:41:22.187Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:41:22.187Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:22.189Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:22.192Z] [LOG]       Total Actual Earned: Rs.10397.36
[2025-10-24T04:41:22.193Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:41:22.194Z] [LOG]       Calculated At: Oct 24, 2025, 10:11:22
[2025-10-24T04:41:22.194Z] [LOG]       Expected Earned (until NOW): Rs.36396.94
[2025-10-24T04:41:22.195Z] [LOG]       Actual Earned (until NOW): Rs.10397.36
[2025-10-24T04:41:22.195Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:22.196Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-24T04:41:22.196Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:41:22.197Z] [LOG]       📉 Shortfall: 102.50 hours (71.43% of expected)
[2025-10-24T04:41:22.197Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:41:22.198Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:41:22.200Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:41:22.201Z] [LOG]    Actual Earned Base: Rs.10397.36
[2025-10-24T04:41:22.201Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:41:22.202Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:41:22.203Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:41:22.203Z] [LOG]    Gross Salary: 10397.360559608333
[2025-10-24T04:41:22.204Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:41:22.204Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:41:22.205Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.205Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:41:22.206Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.207Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:41:22.207Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.207Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:41:22.207Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.208Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:41:22.208Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.208Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:41:22.209Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.209Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:41:22.209Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.209Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:41:22.209Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.210Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:41:22.210Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.210Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:41:22.210Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.210Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:41:22.211Z] [LOG]    EPF/ETF calculated on: Rs.10397.36
[2025-10-24T04:41:22.211Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:41:22.211Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:41:22.211Z] [LOG] 💰 GROSS CALCULATION for P.D.P Dilini Madushani null:
[2025-10-24T04:41:22.211Z] [LOG]    Base Salary: 50000
[2025-10-24T04:41:22.211Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:41:22.212Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:41:22.212Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.212Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:41:22.212Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.212Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:41:22.213Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:22.411Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:41:22.412Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:22.412Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:41:22.413Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:41:22.414Z] [LOG]    Actual Earned Base: Rs.10397.36
[2025-10-24T04:41:22.415Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:41:22.415Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:41:22.416Z] [LOG]    = Gross Salary: Rs.10397.36
[2025-10-24T04:41:22.416Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:41:22.417Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:41:22.418Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:41:22.418Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:22.419Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:41:22.419Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:41:22.420Z] [LOG]    Gross Salary: Rs.10397.36
[2025-10-24T04:41:22.420Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:41:22.421Z] [LOG]    = NET SALARY: Rs.10397.36
[2025-10-24T04:41:22.421Z] [LOG] 
💾 Database Update:
[2025-10-24T04:41:22.421Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:41:22.422Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:41:22.628Z] [LOG] 
📝 Components to save:
[2025-10-24T04:41:22.628Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:41:22.629Z] [LOG]    Deduction components: 1
[2025-10-24T04:41:22.629Z] [LOG] Creating components for record 7a5358b6-5a3c-4452-8477-2422fd8b65da: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:41:22.630Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10397.360559608333
}
[2025-10-24T04:41:22.832Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:41:23.035Z] [LOG] Created payroll_record_component: 8dd9e3c1-9c1b-422f-bb8b-8d69940fdbf5 for Base Salary
[2025-10-24T04:41:23.036Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-24T04:41:23.237Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:41:23.441Z] [LOG] Created payroll_record_component: f72d3b06-c5dc-456b-81f0-ae84f3cd833d for Attendance Shortfall (Info)
[2025-10-24T04:41:23.850Z] [LOG] ✅ Financial balances updated successfully for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:23.851Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:41:23.852Z] [LOG] 
======================================================================
[2025-10-24T04:41:23.852Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: P.D.P Dilini Madushani null
[2025-10-24T04:41:23.853Z] [LOG] ======================================================================
[2025-10-24T04:41:23.853Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:41:23.854Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10397.36
[2025-10-24T04:41:23.854Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:41:23.854Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:23.855Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:23.855Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:41:23.855Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:23.856Z] [LOG]    GROSS SALARY: Rs.10397.36
[2025-10-24T04:41:23.856Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:23.857Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:41:23.857Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:41:23.858Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:41:23.858Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:41:23.858Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:41:23.859Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:23.860Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:23.861Z] [LOG]    NET SALARY: Rs.10397.36
[2025-10-24T04:41:23.862Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:41:23.863Z] [LOG] ======================================================================

[2025-10-24T04:41:23.863Z] [LOG] ✅ P.D.P Dilini Madushani null: Calculation completed successfully
[2025-10-24T04:41:23.864Z] [LOG] 📊 Progress: 17/34 (50.0%)
[2025-10-24T04:41:23.864Z] [LOG] 
🧮 Processing: Hari null (EMP000017)
[2025-10-24T04:41:23.865Z] [LOG] 📋 Record ID: 7f0bab92-3c82-4209-bbe3-c5d2e5c40ad9
[2025-10-24T04:41:23.869Z] [LOG] 
======================================================================
[2025-10-24T04:41:23.870Z] [LOG] 🧮 CALCULATING PAYROLL: Hari null (EMP000017)
[2025-10-24T04:41:23.870Z] [LOG] ======================================================================
[2025-10-24T04:41:25.119Z] [LOG] 🔍 Component filtering for employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-24T04:41:25.121Z] [LOG]    Total components: 13
[2025-10-24T04:41:25.121Z] [LOG]    Applicable components: 13
[2025-10-24T04:41:25.122Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-24T04:41:26.353Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:41:26.354Z] [LOG] 🔄 Processing financial records for employee 0143bc58-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:41:26.572Z] [LOG] 📊 Found 0 active loans for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:26.776Z] [LOG] 📊 Found 0 active advances for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:26.972Z] [LOG] 📊 Found 0 approved bonuses for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:26.972Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:41:26.973Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:41:27.172Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:41:27.176Z] [LOG]    Employee ID: 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:27.176Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:41:27.178Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:41:27.178Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:41:27.392Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:41:27.392Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:41:27.392Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:41:27.392Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:41:27.392Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:41:27.393Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:41:27.393Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:41:28.007Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:41:28.010Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:41:28.224Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:41:28.225Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:41:28.225Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:41:28.225Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:41:28.226Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:41:28.226Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:41:28.226Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:41:28.226Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:41:28.227Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:41:28.461Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:41:28.462Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:41:28.462Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:41:28.462Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:41:28.668Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:41:28.668Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:41:28.669Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:41:28.670Z] [LOG]       Current Time: 10:11:28
[2025-10-24T04:41:28.670Z] [LOG]       Expected Hours (scheduled → now): 1.69h
[2025-10-24T04:41:28.670Z] [LOG]       Actual Hours (check-in → now): 1.69h
[2025-10-24T04:41:28.671Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:41:28.671Z] [LOG]       Weekday: 129.19h
[2025-10-24T04:41:28.671Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:41:28.672Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:28.672Z] [LOG]       Total Expected: 142.69h
[2025-10-24T04:41:28.672Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:41:28.673Z] [LOG]       Weekday: 35.69h (includes 1.69h live)
[2025-10-24T04:41:28.673Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:41:28.673Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:28.674Z] [LOG]       Total Actual: 40.19h
[2025-10-24T04:41:28.674Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:41:28.674Z] [LOG]       Weekday: 129.19h × Rs.235.29 = Rs.30397.42
[2025-10-24T04:41:28.675Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:41:28.675Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:28.676Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:28.676Z] [LOG]       Total Expected Earned: Rs.36397.36
[2025-10-24T04:41:28.677Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:41:28.677Z] [LOG]       Weekday: 35.69h × Rs.235.29 = Rs.8397.81
[2025-10-24T04:41:28.677Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:41:28.678Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:28.678Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:28.678Z] [LOG]       Total Actual Earned: Rs.10397.79
[2025-10-24T04:41:28.679Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:41:28.680Z] [LOG]       Calculated At: Oct 24, 2025, 10:11:28
[2025-10-24T04:41:28.680Z] [LOG]       Expected Earned (until NOW): Rs.36397.36
[2025-10-24T04:41:28.680Z] [LOG]       Actual Earned (until NOW): Rs.10397.79
[2025-10-24T04:41:28.681Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:28.681Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-24T04:41:28.681Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:41:28.682Z] [LOG]       📉 Shortfall: 102.50 hours (71.43% of expected)
[2025-10-24T04:41:28.682Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:41:28.683Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:41:28.683Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:41:28.684Z] [LOG]    Actual Earned Base: Rs.10397.79
[2025-10-24T04:41:28.685Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-24T04:41:28.686Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:41:28.686Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:41:28.686Z] [LOG]    Gross Salary: 10397.7851927
[2025-10-24T04:41:28.686Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:41:28.687Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:41:28.687Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.688Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:41:28.688Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.688Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:41:28.689Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.689Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:41:28.689Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.690Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:41:28.690Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.691Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:41:28.691Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.691Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:41:28.692Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.692Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:41:28.693Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.693Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:41:28.693Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.694Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:41:28.694Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.695Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:41:28.695Z] [LOG]    EPF/ETF calculated on: Rs.10397.79
[2025-10-24T04:41:28.696Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:41:28.696Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:41:28.697Z] [LOG] 💰 GROSS CALCULATION for Hari null:
[2025-10-24T04:41:28.697Z] [LOG]    Base Salary: 50000
[2025-10-24T04:41:28.697Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:41:28.698Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:41:28.700Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.701Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:41:28.702Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.702Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:41:28.702Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:28.903Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:41:28.904Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:28.904Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:41:28.905Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:41:28.905Z] [LOG]    Actual Earned Base: Rs.10397.79
[2025-10-24T04:41:28.906Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:41:28.906Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:41:28.907Z] [LOG]    = Gross Salary: Rs.10397.79
[2025-10-24T04:41:28.907Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:41:28.908Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-24T04:41:28.909Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:41:28.910Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:28.910Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:41:28.911Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:41:28.911Z] [LOG]    Gross Salary: Rs.10397.79
[2025-10-24T04:41:28.911Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:41:28.912Z] [LOG]    = NET SALARY: Rs.10397.79
[2025-10-24T04:41:28.912Z] [LOG] 
💾 Database Update:
[2025-10-24T04:41:28.913Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:41:28.913Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:41:29.123Z] [LOG] 
📝 Components to save:
[2025-10-24T04:41:29.124Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:41:29.124Z] [LOG]    Deduction components: 1
[2025-10-24T04:41:29.125Z] [LOG] Creating components for record 7f0bab92-3c82-4209-bbe3-c5d2e5c40ad9: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:41:29.126Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10397.7851927
}
[2025-10-24T04:41:29.375Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:41:29.584Z] [LOG] Created payroll_record_component: 37a01ec3-643e-4926-9951-4c1b2797214f for Base Salary
[2025-10-24T04:41:29.585Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-24T04:41:29.791Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:41:29.994Z] [LOG] Created payroll_record_component: 106f39da-8526-4dfb-82df-8be5f7d10238 for Attendance Shortfall (Info)
[2025-10-24T04:41:30.411Z] [LOG] ✅ Financial balances updated successfully for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:30.412Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:41:30.413Z] [LOG] 
======================================================================
[2025-10-24T04:41:30.413Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Hari null
[2025-10-24T04:41:30.414Z] [LOG] ======================================================================
[2025-10-24T04:41:30.414Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:41:30.415Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10397.79
[2025-10-24T04:41:30.416Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-24T04:41:30.416Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:30.417Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:30.418Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:41:30.419Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:30.419Z] [LOG]    GROSS SALARY: Rs.10397.79
[2025-10-24T04:41:30.420Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:30.421Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:41:30.421Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:41:30.422Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:41:30.423Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:41:30.423Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-24T04:41:30.424Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:30.424Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:30.425Z] [LOG]    NET SALARY: Rs.10397.79
[2025-10-24T04:41:30.425Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:41:30.426Z] [LOG] ======================================================================

[2025-10-24T04:41:30.426Z] [LOG] ✅ Hari null: Calculation completed successfully
[2025-10-24T04:41:30.427Z] [LOG] 📊 Progress: 18/34 (52.9%)
[2025-10-24T04:41:30.428Z] [LOG] 
🧮 Processing: Ratheeshanan null (EMP000047)
[2025-10-24T04:41:30.428Z] [LOG] 📋 Record ID: 7fca82a3-77fa-4c07-b832-c8de63343c10
[2025-10-24T04:41:30.429Z] [LOG] 
======================================================================
[2025-10-24T04:41:30.430Z] [LOG] 🧮 CALCULATING PAYROLL: Ratheeshanan null (EMP000047)
[2025-10-24T04:41:30.430Z] [LOG] ======================================================================
[2025-10-24T04:41:31.262Z] [LOG] 🔍 Component filtering for employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-24T04:41:31.263Z] [LOG]    Total components: 13
[2025-10-24T04:41:31.264Z] [LOG]    Applicable components: 13
[2025-10-24T04:41:31.265Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-24T04:41:32.519Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:41:32.519Z] [LOG] 🔄 Processing financial records for employee 01444966-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:41:32.718Z] [LOG] 📊 Found 0 active loans for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:32.926Z] [LOG] 📊 Found 0 active advances for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:33.129Z] [LOG] 📊 Found 0 approved bonuses for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:33.135Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:41:33.135Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:41:33.347Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:41:33.348Z] [LOG]    Employee ID: 01444966-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:33.348Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:41:33.348Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:41:33.348Z] [LOG]    Base Salary (Full Month): Rs.25000.00
[2025-10-24T04:41:33.550Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:41:33.551Z] [LOG]       Daily Salary: Rs.1000.00
[2025-10-24T04:41:33.552Z] [LOG]       Weekday Hourly Rate: Rs.117.65
[2025-10-24T04:41:33.552Z] [LOG]       Saturday Hourly Rate: Rs.222.22
[2025-10-24T04:41:33.553Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:41:33.553Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:41:33.554Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:41:34.173Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:41:34.174Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:41:34.400Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:41:34.401Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:41:34.401Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:41:34.401Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:41:34.401Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:41:34.402Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:41:34.402Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:41:34.402Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:41:34.402Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:41:34.606Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:41:34.606Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:41:34.607Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:41:34.607Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:41:34.818Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:41:34.819Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:41:34.819Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:41:34.820Z] [LOG]       Current Time: 10:11:34
[2025-10-24T04:41:34.820Z] [LOG]       Expected Hours (scheduled → now): 1.69h
[2025-10-24T04:41:34.821Z] [LOG]       Actual Hours (check-in → now): 1.69h
[2025-10-24T04:41:34.821Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:41:34.822Z] [LOG]       Weekday: 129.19h
[2025-10-24T04:41:34.822Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:41:34.822Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:34.823Z] [LOG]       Total Expected: 142.69h
[2025-10-24T04:41:34.823Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:41:34.824Z] [LOG]       Weekday: 35.69h (includes 1.69h live)
[2025-10-24T04:41:34.824Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:41:34.824Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:34.825Z] [LOG]       Total Actual: 40.19h
[2025-10-24T04:41:34.825Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:41:34.825Z] [LOG]       Weekday: 129.19h × Rs.117.65 = Rs.15199.56
[2025-10-24T04:41:34.825Z] [LOG]       Saturday: 13.50h × Rs.222.22 = Rs.2999.97
[2025-10-24T04:41:34.826Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:34.826Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:34.826Z] [LOG]       Total Expected Earned: Rs.18199.53
[2025-10-24T04:41:34.827Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:41:34.827Z] [LOG]       Weekday: 35.69h × Rs.117.65 = Rs.4199.28
[2025-10-24T04:41:34.827Z] [LOG]       Saturday: 4.50h × Rs.222.22 = Rs.999.99
[2025-10-24T04:41:34.828Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:34.828Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:34.828Z] [LOG]       Total Actual Earned: Rs.5199.27
[2025-10-24T04:41:34.828Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:41:34.829Z] [LOG]       Calculated At: Oct 24, 2025, 10:11:34
[2025-10-24T04:41:34.829Z] [LOG]       Expected Earned (until NOW): Rs.18199.53
[2025-10-24T04:41:34.829Z] [LOG]       Actual Earned (until NOW): Rs.5199.27
[2025-10-24T04:41:34.829Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:34.830Z] [LOG]       Attendance Deduction: Rs.13000.26
[2025-10-24T04:41:34.830Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:41:34.830Z] [LOG]       📉 Shortfall: 102.50 hours (71.43% of expected)
[2025-10-24T04:41:34.831Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:41:34.831Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:41:34.831Z] [LOG]    Base Salary (Full): Rs.25000.00
[2025-10-24T04:41:34.831Z] [LOG]    Actual Earned Base: Rs.5199.27
[2025-10-24T04:41:34.832Z] [LOG]    Attendance Shortfall: Rs.13000.26
[2025-10-24T04:41:34.833Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:41:34.833Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:41:34.833Z] [LOG]    Gross Salary: 5199.27203825
[2025-10-24T04:41:34.833Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:41:34.834Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:41:34.834Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.834Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:41:34.834Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.835Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:41:34.835Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.835Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:41:34.835Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.835Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:41:34.835Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.836Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:41:34.836Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.836Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:41:34.837Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.837Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:41:34.837Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.837Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:41:34.838Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.838Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:41:34.838Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.838Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:41:34.839Z] [LOG]    EPF/ETF calculated on: Rs.5199.27
[2025-10-24T04:41:34.839Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:41:34.839Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:41:34.839Z] [LOG] 💰 GROSS CALCULATION for Ratheeshanan null:
[2025-10-24T04:41:34.840Z] [LOG]    Base Salary: 25000
[2025-10-24T04:41:34.840Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:41:34.840Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:41:34.840Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.841Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:41:34.841Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:34.841Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:41:34.841Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:35.053Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:41:35.053Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:35.053Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:41:35.054Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:41:35.054Z] [LOG]    Actual Earned Base: Rs.5199.27
[2025-10-24T04:41:35.055Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:41:35.055Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:41:35.055Z] [LOG]    = Gross Salary: Rs.5199.27
[2025-10-24T04:41:35.056Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:41:35.056Z] [LOG]    Attendance Shortfall (Info): Rs.13000.26
[2025-10-24T04:41:35.057Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:41:35.057Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:35.057Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:41:35.058Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:41:35.058Z] [LOG]    Gross Salary: Rs.5199.27
[2025-10-24T04:41:35.059Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:41:35.059Z] [LOG]    = NET SALARY: Rs.5199.27
[2025-10-24T04:41:35.060Z] [LOG] 
💾 Database Update:
[2025-10-24T04:41:35.061Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:41:35.061Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:41:35.270Z] [LOG] 
📝 Components to save:
[2025-10-24T04:41:35.271Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:41:35.272Z] [LOG]    Deduction components: 1
[2025-10-24T04:41:35.273Z] [LOG] Creating components for record 7fca82a3-77fa-4c07-b832-c8de63343c10: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:41:35.276Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 5199.27203825
}
[2025-10-24T04:41:35.481Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:41:35.686Z] [LOG] Created payroll_record_component: 04c03426-7c15-472e-9c18-f767ff7e64c4 for Base Salary
[2025-10-24T04:41:35.687Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 13000.255000000001
}
[2025-10-24T04:41:35.892Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:41:36.098Z] [LOG] Created payroll_record_component: 24816a58-326a-48d0-ae05-d671654a40f4 for Attendance Shortfall (Info)
[2025-10-24T04:41:36.616Z] [LOG] ✅ Financial balances updated successfully for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:36.616Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:41:36.617Z] [LOG] 
======================================================================
[2025-10-24T04:41:36.617Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ratheeshanan null
[2025-10-24T04:41:36.617Z] [LOG] ======================================================================
[2025-10-24T04:41:36.618Z] [LOG]    Base Salary (Full): Rs.25000.00
[2025-10-24T04:41:36.618Z] [LOG]    Actual Earned Base (Attendance-based): Rs.5199.27
[2025-10-24T04:41:36.618Z] [LOG]    Attendance Shortfall: Rs.13000.26
[2025-10-24T04:41:36.618Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:36.619Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:36.619Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:41:36.619Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:36.619Z] [LOG]    GROSS SALARY: Rs.5199.27
[2025-10-24T04:41:36.619Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:36.620Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:41:36.620Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:41:36.620Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:41:36.621Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:41:36.621Z] [LOG]       - Attendance Shortfall (Info): Rs.13000.26
[2025-10-24T04:41:36.621Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:36.622Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:36.622Z] [LOG]    NET SALARY: Rs.5199.27
[2025-10-24T04:41:36.622Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:41:36.623Z] [LOG] ======================================================================

[2025-10-24T04:41:36.623Z] [LOG] ✅ Ratheeshanan null: Calculation completed successfully
[2025-10-24T04:41:36.623Z] [LOG] 📊 Progress: 19/34 (55.9%)
[2025-10-24T04:41:36.624Z] [LOG] 
🧮 Processing: Prasanthan null (EMP000001)
[2025-10-24T04:41:36.624Z] [LOG] 📋 Record ID: 82136d10-0312-4400-8e5b-b0e23f318d49
[2025-10-24T04:41:36.624Z] [LOG] 
======================================================================
[2025-10-24T04:41:36.625Z] [LOG] 🧮 CALCULATING PAYROLL: Prasanthan null (EMP000001)
[2025-10-24T04:41:36.625Z] [LOG] ======================================================================
[2025-10-24T04:41:37.919Z] [LOG] 🔍 Component filtering for employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-24T04:41:37.919Z] [LOG]    Total components: 13
[2025-10-24T04:41:37.919Z] [LOG]    Applicable components: 13
[2025-10-24T04:41:37.920Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-24T04:41:39.174Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:41:39.174Z] [LOG] 🔄 Processing financial records for employee 014397c7-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:41:39.375Z] [LOG] 📊 Found 0 active loans for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:39.591Z] [LOG] 📊 Found 0 active advances for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:39.791Z] [LOG] 📊 Found 0 approved bonuses for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:39.792Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:41:39.793Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:41:39.994Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:41:39.994Z] [LOG]    Employee ID: 014397c7-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:39.995Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:41:39.995Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:41:39.995Z] [LOG]    Base Salary (Full Month): Rs.150000.00
[2025-10-24T04:41:40.194Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:41:40.195Z] [LOG]       Daily Salary: Rs.6000.00
[2025-10-24T04:41:40.195Z] [LOG]       Weekday Hourly Rate: Rs.705.88
[2025-10-24T04:41:40.195Z] [LOG]       Saturday Hourly Rate: Rs.1333.33
[2025-10-24T04:41:40.195Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:41:40.195Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:41:40.196Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:41:40.802Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:41:40.802Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:41:41.006Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:41:41.006Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:41:41.007Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:41:41.007Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:41:41.007Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:41:41.007Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:41:41.007Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:41:41.008Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:41:41.008Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:41:41.210Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:41:41.210Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:41:41.211Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:41:41.211Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:41:41.419Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:41:41.419Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:41:41.420Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:41:41.420Z] [LOG]       Current Time: 10:11:41
[2025-10-24T04:41:41.420Z] [LOG]       Expected Hours (scheduled → now): 1.69h
[2025-10-24T04:41:41.421Z] [LOG]       Actual Hours (check-in → now): 1.69h
[2025-10-24T04:41:41.421Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:41:41.421Z] [LOG]       Weekday: 129.19h
[2025-10-24T04:41:41.421Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:41:41.422Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:41.422Z] [LOG]       Total Expected: 142.69h
[2025-10-24T04:41:41.422Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:41:41.422Z] [LOG]       Weekday: 35.69h (includes 1.69h live)
[2025-10-24T04:41:41.423Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:41:41.423Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:41.423Z] [LOG]       Total Actual: 40.19h
[2025-10-24T04:41:41.423Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:41:41.423Z] [LOG]       Weekday: 129.19h × Rs.705.88 = Rs.91196.05
[2025-10-24T04:41:41.424Z] [LOG]       Saturday: 13.50h × Rs.1333.33 = Rs.17999.95
[2025-10-24T04:41:41.424Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:41.424Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:41.424Z] [LOG]       Total Expected Earned: Rs.109196.01
[2025-10-24T04:41:41.424Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:41:41.425Z] [LOG]       Weekday: 35.69h × Rs.705.88 = Rs.25196.27
[2025-10-24T04:41:41.425Z] [LOG]       Saturday: 4.50h × Rs.1333.33 = Rs.5999.98
[2025-10-24T04:41:41.425Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:41.425Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:41.426Z] [LOG]       Total Actual Earned: Rs.31196.26
[2025-10-24T04:41:41.426Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:41:41.427Z] [LOG]       Calculated At: Oct 24, 2025, 10:11:41
[2025-10-24T04:41:41.427Z] [LOG]       Expected Earned (until NOW): Rs.109196.01
[2025-10-24T04:41:41.427Z] [LOG]       Actual Earned (until NOW): Rs.31196.26
[2025-10-24T04:41:41.427Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:41.427Z] [LOG]       Attendance Deduction: Rs.77999.75
[2025-10-24T04:41:41.427Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:41:41.428Z] [LOG]       📉 Shortfall: 102.50 hours (71.43% of expected)
[2025-10-24T04:41:41.428Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:41:41.428Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:41:41.428Z] [LOG]    Base Salary (Full): Rs.150000.00
[2025-10-24T04:41:41.428Z] [LOG]    Actual Earned Base: Rs.31196.26
[2025-10-24T04:41:41.429Z] [LOG]    Attendance Shortfall: Rs.77999.75
[2025-10-24T04:41:41.429Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:41:41.429Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:41:41.429Z] [LOG]    Gross Salary: 31196.25767881111
[2025-10-24T04:41:41.429Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:41:41.430Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:41:41.430Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.430Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:41:41.430Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.431Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:41:41.431Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.431Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:41:41.431Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.431Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:41:41.432Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.432Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:41:41.432Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.432Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:41:41.433Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.433Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:41:41.433Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.434Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:41:41.434Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.435Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:41:41.435Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.435Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:41:41.436Z] [LOG]    EPF/ETF calculated on: Rs.31196.26
[2025-10-24T04:41:41.436Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:41:41.436Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:41:41.436Z] [LOG] 💰 GROSS CALCULATION for Prasanthan null:
[2025-10-24T04:41:41.437Z] [LOG]    Base Salary: 150000
[2025-10-24T04:41:41.437Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:41:41.437Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:41:41.437Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.437Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:41:41.438Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.438Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:41:41.438Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:41.646Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:41:41.647Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:41.647Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:41:41.648Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:41:41.648Z] [LOG]    Actual Earned Base: Rs.31196.26
[2025-10-24T04:41:41.649Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:41:41.649Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:41:41.650Z] [LOG]    = Gross Salary: Rs.31196.26
[2025-10-24T04:41:41.650Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:41:41.651Z] [LOG]    Attendance Shortfall (Info): Rs.77999.75
[2025-10-24T04:41:41.651Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:41:41.652Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:41.653Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:41:41.653Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:41:41.654Z] [LOG]    Gross Salary: Rs.31196.26
[2025-10-24T04:41:41.654Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:41:41.654Z] [LOG]    = NET SALARY: Rs.31196.26
[2025-10-24T04:41:41.655Z] [LOG] 
💾 Database Update:
[2025-10-24T04:41:41.655Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:41:41.656Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:41:41.874Z] [LOG] 
📝 Components to save:
[2025-10-24T04:41:41.874Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:41:41.874Z] [LOG]    Deduction components: 1
[2025-10-24T04:41:41.875Z] [LOG] Creating components for record 82136d10-0312-4400-8e5b-b0e23f318d49: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:41:41.875Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 31196.25767881111
}
[2025-10-24T04:41:42.079Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:41:42.290Z] [LOG] Created payroll_record_component: e9d27b30-0bc2-4846-9fc3-0865c5982388 for Base Salary
[2025-10-24T04:41:42.290Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 77999.75
}
[2025-10-24T04:41:42.494Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:41:42.703Z] [LOG] Created payroll_record_component: 88310038-3329-4fa0-bdad-ce931f340198 for Attendance Shortfall (Info)
[2025-10-24T04:41:43.106Z] [LOG] ✅ Financial balances updated successfully for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:43.106Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:41:43.107Z] [LOG] 
======================================================================
[2025-10-24T04:41:43.107Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Prasanthan null
[2025-10-24T04:41:43.108Z] [LOG] ======================================================================
[2025-10-24T04:41:43.109Z] [LOG]    Base Salary (Full): Rs.150000.00
[2025-10-24T04:41:43.109Z] [LOG]    Actual Earned Base (Attendance-based): Rs.31196.26
[2025-10-24T04:41:43.110Z] [LOG]    Attendance Shortfall: Rs.77999.75
[2025-10-24T04:41:43.110Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:43.111Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:43.111Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:41:43.112Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:43.113Z] [LOG]    GROSS SALARY: Rs.31196.26
[2025-10-24T04:41:43.114Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:43.114Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:41:43.115Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:41:43.116Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:41:43.116Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:41:43.117Z] [LOG]       - Attendance Shortfall (Info): Rs.77999.75
[2025-10-24T04:41:43.117Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:43.118Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:43.119Z] [LOG]    NET SALARY: Rs.31196.26
[2025-10-24T04:41:43.120Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:41:43.120Z] [LOG] ======================================================================

[2025-10-24T04:41:43.121Z] [LOG] ✅ Prasanthan null: Calculation completed successfully
[2025-10-24T04:41:43.121Z] [LOG] 📊 Progress: 20/34 (58.8%)
[2025-10-24T04:41:43.122Z] [LOG] 
🧮 Processing: Chamodi null (EMP000032)
[2025-10-24T04:41:43.123Z] [LOG] 📋 Record ID: 9c6906e1-6c45-4d4d-87a7-1f4ccf784880
[2025-10-24T04:41:43.123Z] [LOG] 
======================================================================
[2025-10-24T04:41:43.124Z] [LOG] 🧮 CALCULATING PAYROLL: Chamodi null (EMP000032)
[2025-10-24T04:41:43.125Z] [LOG] ======================================================================
[2025-10-24T04:41:43.938Z] [LOG] 🔍 Component filtering for employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-24T04:41:43.939Z] [LOG]    Total components: 13
[2025-10-24T04:41:43.939Z] [LOG]    Applicable components: 13
[2025-10-24T04:41:43.941Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-24T04:41:45.203Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:41:45.204Z] [LOG] 🔄 Processing financial records for employee 0143f302-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:41:45.410Z] [LOG] 📊 Found 0 active loans for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:45.613Z] [LOG] 📊 Found 0 active advances for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:45.815Z] [LOG] 📊 Found 0 approved bonuses for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:45.816Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:41:45.817Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:41:46.023Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:41:46.024Z] [LOG]    Employee ID: 0143f302-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:46.024Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:41:46.024Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:41:46.024Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:41:46.224Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:41:46.224Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:41:46.224Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:41:46.225Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:41:46.225Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:41:46.225Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:41:46.226Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:41:46.831Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:41:46.832Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:41:47.039Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:41:47.039Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:41:47.039Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:41:47.040Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:41:47.040Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:41:47.040Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:41:47.041Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:41:47.041Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:41:47.041Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:41:47.243Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:41:47.244Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:41:47.245Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:41:47.245Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:41:47.447Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:41:47.448Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:41:47.449Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:41:47.451Z] [LOG]       Current Time: 10:11:47
[2025-10-24T04:41:47.451Z] [LOG]       Expected Hours (scheduled → now): 1.70h
[2025-10-24T04:41:47.453Z] [LOG]       Actual Hours (check-in → now): 1.70h
[2025-10-24T04:41:47.453Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:41:47.454Z] [LOG]       Weekday: 129.20h
[2025-10-24T04:41:47.455Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:41:47.456Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:47.457Z] [LOG]       Total Expected: 142.70h
[2025-10-24T04:41:47.457Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:41:47.458Z] [LOG]       Weekday: 35.70h (includes 1.70h live)
[2025-10-24T04:41:47.459Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:41:47.460Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:47.460Z] [LOG]       Total Actual: 40.20h
[2025-10-24T04:41:47.461Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:41:47.462Z] [LOG]       Weekday: 129.20h × Rs.235.29 = Rs.30398.65
[2025-10-24T04:41:47.462Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:41:47.463Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:47.463Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:47.464Z] [LOG]       Total Expected Earned: Rs.36398.59
[2025-10-24T04:41:47.465Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:41:47.467Z] [LOG]       Weekday: 35.70h × Rs.235.29 = Rs.8399.03
[2025-10-24T04:41:47.467Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:41:47.468Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:47.469Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:47.469Z] [LOG]       Total Actual Earned: Rs.10399.01
[2025-10-24T04:41:47.471Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:41:47.471Z] [LOG]       Calculated At: Oct 24, 2025, 10:11:47
[2025-10-24T04:41:47.472Z] [LOG]       Expected Earned (until NOW): Rs.36398.59
[2025-10-24T04:41:47.472Z] [LOG]       Actual Earned (until NOW): Rs.10399.01
[2025-10-24T04:41:47.473Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:47.474Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-24T04:41:47.474Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:41:47.475Z] [LOG]       📉 Shortfall: 102.50 hours (71.43% of expected)
[2025-10-24T04:41:47.476Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:41:47.477Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:41:47.477Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:41:47.478Z] [LOG]    Actual Earned Base: Rs.10399.01
[2025-10-24T04:41:47.479Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:41:47.479Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:41:47.480Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:41:47.481Z] [LOG]    Gross Salary: 10399.012556841666
[2025-10-24T04:41:47.481Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:41:47.482Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:41:47.483Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.484Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:41:47.484Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.485Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:41:47.486Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.487Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:41:47.487Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.488Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:41:47.488Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.489Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:41:47.490Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.490Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:41:47.491Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.491Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:41:47.492Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.493Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:41:47.493Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.494Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:41:47.494Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.495Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:41:47.495Z] [LOG]    EPF/ETF calculated on: Rs.10399.01
[2025-10-24T04:41:47.496Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:41:47.497Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:41:47.497Z] [LOG] 💰 GROSS CALCULATION for Chamodi null:
[2025-10-24T04:41:47.498Z] [LOG]    Base Salary: 50000
[2025-10-24T04:41:47.498Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:41:47.498Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:41:47.499Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.499Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:41:47.500Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.500Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:41:47.500Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:47.703Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:41:47.703Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:47.703Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:41:47.704Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:41:47.704Z] [LOG]    Actual Earned Base: Rs.10399.01
[2025-10-24T04:41:47.705Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:41:47.705Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:41:47.705Z] [LOG]    = Gross Salary: Rs.10399.01
[2025-10-24T04:41:47.706Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:41:47.706Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:41:47.706Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:41:47.707Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:47.707Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:41:47.707Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:41:47.708Z] [LOG]    Gross Salary: Rs.10399.01
[2025-10-24T04:41:47.708Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:41:47.709Z] [LOG]    = NET SALARY: Rs.10399.01
[2025-10-24T04:41:47.709Z] [LOG] 
💾 Database Update:
[2025-10-24T04:41:47.710Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:41:47.710Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:41:47.921Z] [LOG] 
📝 Components to save:
[2025-10-24T04:41:47.921Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:41:47.923Z] [LOG]    Deduction components: 1
[2025-10-24T04:41:47.924Z] [LOG] Creating components for record 9c6906e1-6c45-4d4d-87a7-1f4ccf784880: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:41:47.927Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10399.012556841666
}
[2025-10-24T04:41:48.130Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:41:48.359Z] [LOG] Created payroll_record_component: 706ebf91-9461-4f9b-9a9e-5fc052f36045 for Base Salary
[2025-10-24T04:41:48.360Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-24T04:41:48.564Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:41:48.773Z] [LOG] Created payroll_record_component: 5a9fb8db-049c-4b2a-b04e-fac2fcc47eab for Attendance Shortfall (Info)
[2025-10-24T04:41:49.175Z] [LOG] ✅ Financial balances updated successfully for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:49.176Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:41:49.177Z] [LOG] 
======================================================================
[2025-10-24T04:41:49.177Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Chamodi null
[2025-10-24T04:41:49.178Z] [LOG] ======================================================================
[2025-10-24T04:41:49.179Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:41:49.179Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10399.01
[2025-10-24T04:41:49.180Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:41:49.180Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:49.181Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:49.181Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:41:49.182Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:49.183Z] [LOG]    GROSS SALARY: Rs.10399.01
[2025-10-24T04:41:49.184Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:49.185Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:41:49.185Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:41:49.186Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:41:49.186Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:41:49.187Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:41:49.187Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:49.188Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:49.189Z] [LOG]    NET SALARY: Rs.10399.01
[2025-10-24T04:41:49.190Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:41:49.190Z] [LOG] ======================================================================

[2025-10-24T04:41:49.191Z] [LOG] ✅ Chamodi null: Calculation completed successfully
[2025-10-24T04:41:49.191Z] [LOG] 📊 Progress: 21/34 (61.8%)
[2025-10-24T04:41:49.192Z] [LOG] 
🧮 Processing: Saruban null (EMP000007)
[2025-10-24T04:41:49.193Z] [LOG] 📋 Record ID: b0b704ce-d467-4e04-a630-89b902c0bb02
[2025-10-24T04:41:49.194Z] [LOG] 
======================================================================
[2025-10-24T04:41:49.194Z] [LOG] 🧮 CALCULATING PAYROLL: Saruban null (EMP000007)
[2025-10-24T04:41:49.195Z] [LOG] ======================================================================
[2025-10-24T04:41:50.015Z] [LOG] 🔍 Component filtering for employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-24T04:41:50.016Z] [LOG]    Total components: 13
[2025-10-24T04:41:50.016Z] [LOG]    Applicable components: 13
[2025-10-24T04:41:50.017Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-24T04:41:51.227Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:41:51.228Z] [LOG] 🔄 Processing financial records for employee 0143a6e3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:41:51.429Z] [LOG] 📊 Found 0 active loans for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:51.627Z] [LOG] 📊 Found 0 active advances for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:51.831Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:51.832Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:41:51.833Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:41:52.036Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:41:52.037Z] [LOG]    Employee ID: 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:52.038Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:41:52.038Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:41:52.039Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-24T04:41:52.240Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:41:52.241Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-24T04:41:52.241Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-24T04:41:52.242Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-24T04:41:52.243Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:41:52.243Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:41:52.244Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:41:52.847Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:41:52.847Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:41:53.048Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:41:53.049Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:41:53.050Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:41:53.051Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:41:53.051Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:41:53.052Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:41:53.053Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:41:53.053Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:41:53.054Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:41:53.257Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:41:53.257Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:41:53.257Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:41:53.258Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:41:53.460Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:41:53.460Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:41:53.461Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:41:53.462Z] [LOG]       Current Time: 10:11:53
[2025-10-24T04:41:53.463Z] [LOG]       Expected Hours (scheduled → now): 1.70h
[2025-10-24T04:41:53.463Z] [LOG]       Actual Hours (check-in → now): 1.70h
[2025-10-24T04:41:53.464Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:41:53.464Z] [LOG]       Weekday: 129.20h
[2025-10-24T04:41:53.465Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:41:53.465Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:53.467Z] [LOG]       Total Expected: 142.70h
[2025-10-24T04:41:53.468Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:41:53.469Z] [LOG]       Weekday: 35.70h (includes 1.70h live)
[2025-10-24T04:41:53.469Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:41:53.470Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:53.470Z] [LOG]       Total Actual: 40.20h
[2025-10-24T04:41:53.471Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:41:53.472Z] [LOG]       Weekday: 129.20h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:53.473Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:53.473Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:53.474Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:53.474Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-24T04:41:53.475Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:41:53.476Z] [LOG]       Weekday: 35.70h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:53.476Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:53.477Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:53.477Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:53.478Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-24T04:41:53.479Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:41:53.480Z] [LOG]       Calculated At: Oct 24, 2025, 10:11:53
[2025-10-24T04:41:53.481Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-24T04:41:53.481Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-24T04:41:53.482Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:53.483Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-24T04:41:53.484Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:41:53.485Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-24T04:41:53.485Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:41:53.486Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:41:53.487Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-24T04:41:53.487Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-24T04:41:53.488Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-24T04:41:53.488Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:41:53.489Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:41:53.490Z] [LOG]    Gross Salary: 0
[2025-10-24T04:41:53.490Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:41:53.491Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:41:53.491Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.492Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:41:53.492Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.493Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:41:53.493Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.494Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:41:53.495Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.496Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:41:53.496Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.497Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:41:53.497Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.497Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:41:53.498Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.498Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:41:53.498Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.499Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:41:53.499Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.500Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:41:53.500Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.500Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:41:53.500Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-24T04:41:53.501Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:41:53.501Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:41:53.501Z] [LOG] 💰 GROSS CALCULATION for Saruban null:
[2025-10-24T04:41:53.502Z] [LOG]    Base Salary: 0
[2025-10-24T04:41:53.502Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:41:53.502Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:41:53.503Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.503Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:41:53.503Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.503Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:41:53.504Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:53.709Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:41:53.710Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:53.710Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:41:53.711Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:41:53.712Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-24T04:41:53.712Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:41:53.713Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:41:53.714Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-24T04:41:53.714Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:41:53.715Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:41:53.718Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:53.719Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:41:53.719Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:41:53.720Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-24T04:41:53.721Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:41:53.722Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-24T04:41:53.723Z] [LOG] 
💾 Database Update:
[2025-10-24T04:41:53.724Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:41:53.724Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:41:53.927Z] [LOG] 
📝 Components to save:
[2025-10-24T04:41:53.927Z] [LOG]    Gross/Earnings components: 0
[2025-10-24T04:41:53.928Z] [LOG]    Deduction components: 0
[2025-10-24T04:41:53.928Z] [LOG] Creating components for record b0b704ce-d467-4e04-a630-89b902c0bb02: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-24T04:41:54.331Z] [LOG] ✅ Financial balances updated successfully for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:54.332Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:41:54.333Z] [LOG] 
======================================================================
[2025-10-24T04:41:54.334Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Saruban null
[2025-10-24T04:41:54.335Z] [LOG] ======================================================================
[2025-10-24T04:41:54.335Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-24T04:41:54.336Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-24T04:41:54.336Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-24T04:41:54.337Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:54.338Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:54.339Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:41:54.340Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:54.340Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-24T04:41:54.341Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:54.341Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:41:54.342Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:41:54.342Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:41:54.343Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:41:54.344Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-24T04:41:54.345Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:54.345Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:41:54.346Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-24T04:41:54.346Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:41:54.347Z] [LOG] ======================================================================

[2025-10-24T04:41:54.348Z] [LOG] ✅ Saruban null: Calculation completed successfully
[2025-10-24T04:41:54.348Z] [LOG] 📊 Progress: 22/34 (64.7%)
[2025-10-24T04:41:54.350Z] [LOG] 
🧮 Processing: Chemil null (EMP000040)
[2025-10-24T04:41:54.351Z] [LOG] 📋 Record ID: b9f0870a-7f9e-4b93-8dd8-62c80a650c61
[2025-10-24T04:41:54.352Z] [LOG] 
======================================================================
[2025-10-24T04:41:54.352Z] [LOG] 🧮 CALCULATING PAYROLL: Chemil null (EMP000040)
[2025-10-24T04:41:54.353Z] [LOG] ======================================================================
[2025-10-24T04:41:55.189Z] [LOG] 🔍 Component filtering for employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-24T04:41:55.190Z] [LOG]    Total components: 13
[2025-10-24T04:41:55.191Z] [LOG]    Applicable components: 13
[2025-10-24T04:41:55.192Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-24T04:41:56.410Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:41:56.411Z] [LOG] 🔄 Processing financial records for employee 01442599-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:41:56.613Z] [LOG] 📊 Found 0 active loans for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:56.817Z] [LOG] 📊 Found 0 active advances for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:57.022Z] [LOG] 📊 Found 0 approved bonuses for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:57.022Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:41:57.023Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:41:57.227Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:41:57.227Z] [LOG]    Employee ID: 01442599-7105-11f0-a50f-98e743540430
[2025-10-24T04:41:57.227Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:41:57.228Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:41:57.228Z] [LOG]    Base Salary (Full Month): Rs.250000.00
[2025-10-24T04:41:57.431Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:41:57.432Z] [LOG]       Daily Salary: Rs.10000.00
[2025-10-24T04:41:57.432Z] [LOG]       Weekday Hourly Rate: Rs.1176.47
[2025-10-24T04:41:57.433Z] [LOG]       Saturday Hourly Rate: Rs.2222.22
[2025-10-24T04:41:57.433Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:41:57.433Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:41:57.434Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:41:58.046Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:41:58.047Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:41:58.258Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:41:58.259Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:41:58.259Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:41:58.260Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:41:58.260Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:41:58.260Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:41:58.261Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:41:58.261Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:41:58.261Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:41:58.464Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:41:58.465Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:41:58.466Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:41:58.466Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:41:58.668Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:41:58.669Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:41:58.669Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:41:58.670Z] [LOG]       Current Time: 10:11:58
[2025-10-24T04:41:58.671Z] [LOG]       Expected Hours (scheduled → now): 1.70h
[2025-10-24T04:41:58.672Z] [LOG]       Actual Hours (check-in → now): 1.70h
[2025-10-24T04:41:58.672Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:41:58.673Z] [LOG]       Weekday: 129.20h
[2025-10-24T04:41:58.673Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:41:58.674Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:58.675Z] [LOG]       Total Expected: 142.70h
[2025-10-24T04:41:58.676Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:41:58.677Z] [LOG]       Weekday: 35.70h (includes 1.70h live)
[2025-10-24T04:41:58.677Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:41:58.678Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:41:58.678Z] [LOG]       Total Actual: 40.20h
[2025-10-24T04:41:58.679Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:41:58.680Z] [LOG]       Weekday: 129.20h × Rs.1176.47 = Rs.151999.49
[2025-10-24T04:41:58.680Z] [LOG]       Saturday: 13.50h × Rs.2222.22 = Rs.29999.97
[2025-10-24T04:41:58.681Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:58.682Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:58.683Z] [LOG]       Total Expected Earned: Rs.181999.46
[2025-10-24T04:41:58.683Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:41:58.684Z] [LOG]       Weekday: 35.70h × Rs.1176.47 = Rs.41999.54
[2025-10-24T04:41:58.686Z] [LOG]       Saturday: 4.50h × Rs.2222.22 = Rs.9999.99
[2025-10-24T04:41:58.686Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:41:58.687Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:58.687Z] [LOG]       Total Actual Earned: Rs.51999.53
[2025-10-24T04:41:58.688Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:41:58.688Z] [LOG]       Calculated At: Oct 24, 2025, 10:11:58
[2025-10-24T04:41:58.689Z] [LOG]       Expected Earned (until NOW): Rs.181999.46
[2025-10-24T04:41:58.689Z] [LOG]       Actual Earned (until NOW): Rs.51999.53
[2025-10-24T04:41:58.689Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:41:58.690Z] [LOG]       Attendance Deduction: Rs.129999.93
[2025-10-24T04:41:58.690Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:41:58.691Z] [LOG]       📉 Shortfall: 102.50 hours (71.43% of expected)
[2025-10-24T04:41:58.691Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:41:58.691Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:41:58.692Z] [LOG]    Base Salary (Full): Rs.250000.00
[2025-10-24T04:41:58.692Z] [LOG]    Actual Earned Base: Rs.51999.53
[2025-10-24T04:41:58.692Z] [LOG]    Attendance Shortfall: Rs.129999.93
[2025-10-24T04:41:58.693Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:41:58.693Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:41:58.693Z] [LOG]    Gross Salary: 51999.533706099995
[2025-10-24T04:41:58.694Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:41:58.694Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:41:58.694Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.694Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:41:58.695Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.695Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:41:58.695Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.696Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:41:58.696Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.696Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:41:58.696Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.697Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:41:58.697Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.697Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:41:58.698Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.698Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:41:58.698Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.698Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:41:58.698Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.699Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:41:58.699Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.700Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:41:58.700Z] [LOG]    EPF/ETF calculated on: Rs.51999.53
[2025-10-24T04:41:58.700Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:41:58.701Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:41:58.701Z] [LOG] 💰 GROSS CALCULATION for Chemil null:
[2025-10-24T04:41:58.701Z] [LOG]    Base Salary: 250000
[2025-10-24T04:41:58.702Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:41:58.702Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:41:58.702Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.702Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:41:58.702Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.703Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:41:58.703Z] [LOG]    Fixed amount: 0
[2025-10-24T04:41:58.908Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:41:58.908Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:41:58.909Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:41:58.909Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:41:58.909Z] [LOG]    Actual Earned Base: Rs.51999.53
[2025-10-24T04:41:58.909Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:41:58.910Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:41:58.910Z] [LOG]    = Gross Salary: Rs.51999.53
[2025-10-24T04:41:58.910Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:41:58.910Z] [LOG]    Attendance Shortfall (Info): Rs.129999.93
[2025-10-24T04:41:58.911Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:41:58.911Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:41:58.911Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:41:58.911Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:41:58.911Z] [LOG]    Gross Salary: Rs.51999.53
[2025-10-24T04:41:58.912Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:41:58.912Z] [LOG]    = NET SALARY: Rs.51999.53
[2025-10-24T04:41:58.912Z] [LOG] 
💾 Database Update:
[2025-10-24T04:41:58.912Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:41:58.912Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:41:59.115Z] [LOG] 
📝 Components to save:
[2025-10-24T04:41:59.116Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:41:59.116Z] [LOG]    Deduction components: 1
[2025-10-24T04:41:59.116Z] [LOG] Creating components for record b9f0870a-7f9e-4b93-8dd8-62c80a650c61: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:41:59.117Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 51999.533706099995
}
[2025-10-24T04:41:59.321Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:41:59.582Z] [LOG] Created payroll_record_component: a934833c-1ecd-4256-8c5b-cf60db137d04 for Base Salary
[2025-10-24T04:41:59.582Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 129999.92500000005
}
[2025-10-24T04:41:59.791Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:42:00.018Z] [LOG] Created payroll_record_component: 2e9503ff-bc22-4551-a2e9-05f8d883ff5b for Attendance Shortfall (Info)
[2025-10-24T04:42:00.545Z] [LOG] ✅ Financial balances updated successfully for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:00.545Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:42:00.546Z] [LOG] 
======================================================================
[2025-10-24T04:42:00.547Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Chemil null
[2025-10-24T04:42:00.548Z] [LOG] ======================================================================
[2025-10-24T04:42:00.548Z] [LOG]    Base Salary (Full): Rs.250000.00
[2025-10-24T04:42:00.549Z] [LOG]    Actual Earned Base (Attendance-based): Rs.51999.53
[2025-10-24T04:42:00.550Z] [LOG]    Attendance Shortfall: Rs.129999.93
[2025-10-24T04:42:00.551Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:00.551Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:00.552Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:42:00.554Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:00.555Z] [LOG]    GROSS SALARY: Rs.51999.53
[2025-10-24T04:42:00.555Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:00.556Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:42:00.557Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:42:00.558Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:42:00.558Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:42:00.559Z] [LOG]       - Attendance Shortfall (Info): Rs.129999.93
[2025-10-24T04:42:00.560Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:00.560Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:00.561Z] [LOG]    NET SALARY: Rs.51999.53
[2025-10-24T04:42:00.562Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:42:00.563Z] [LOG] ======================================================================

[2025-10-24T04:42:00.563Z] [LOG] ✅ Chemil null: Calculation completed successfully
[2025-10-24T04:42:00.564Z] [LOG] 📊 Progress: 23/34 (67.6%)
[2025-10-24T04:42:00.564Z] [LOG] 
🧮 Processing: Jessie null (EMP000013)
[2025-10-24T04:42:00.565Z] [LOG] 📋 Record ID: bca2b094-f4f8-4f86-bb67-3c799f40928c
[2025-10-24T04:42:00.566Z] [LOG] 
======================================================================
[2025-10-24T04:42:00.567Z] [LOG] 🧮 CALCULATING PAYROLL: Jessie null (EMP000013)
[2025-10-24T04:42:00.568Z] [LOG] ======================================================================
[2025-10-24T04:42:01.401Z] [LOG] 🔍 Component filtering for employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-24T04:42:01.402Z] [LOG]    Total components: 13
[2025-10-24T04:42:01.402Z] [LOG]    Applicable components: 13
[2025-10-24T04:42:01.403Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-24T04:42:02.672Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:42:02.672Z] [LOG] 🔄 Processing financial records for employee 0143ae6e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:42:02.882Z] [LOG] 📊 Found 0 active loans for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:03.093Z] [LOG] 📊 Found 0 active advances for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:03.294Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:03.295Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:42:03.295Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:42:03.505Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:42:03.505Z] [LOG]    Employee ID: 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:03.506Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:42:03.506Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:42:03.506Z] [LOG]    Base Salary (Full Month): Rs.60000.00
[2025-10-24T04:42:03.720Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:42:03.720Z] [LOG]       Daily Salary: Rs.2400.00
[2025-10-24T04:42:03.721Z] [LOG]       Weekday Hourly Rate: Rs.282.35
[2025-10-24T04:42:03.721Z] [LOG]       Saturday Hourly Rate: Rs.533.33
[2025-10-24T04:42:03.722Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:42:03.722Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:42:03.723Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:42:04.339Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:42:04.340Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:42:04.549Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:42:04.551Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:42:04.551Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:42:04.552Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:42:04.553Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:42:04.553Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:42:04.554Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:42:04.554Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:42:04.555Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:42:04.777Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:42:04.777Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:42:04.778Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:42:04.779Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:42:04.985Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:42:04.985Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:42:04.986Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:42:04.987Z] [LOG]       Current Time: 10:12:04
[2025-10-24T04:42:04.988Z] [LOG]       Expected Hours (scheduled → now): 1.70h
[2025-10-24T04:42:04.988Z] [LOG]       Actual Hours (check-in → now): 1.70h
[2025-10-24T04:42:04.989Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:42:04.989Z] [LOG]       Weekday: 129.20h
[2025-10-24T04:42:04.990Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:42:04.991Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:04.991Z] [LOG]       Total Expected: 142.70h
[2025-10-24T04:42:04.992Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:42:04.993Z] [LOG]       Weekday: 35.70h (includes 1.70h live)
[2025-10-24T04:42:04.994Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:42:04.994Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:04.995Z] [LOG]       Total Actual: 40.20h
[2025-10-24T04:42:04.996Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:42:04.997Z] [LOG]       Weekday: 129.20h × Rs.282.35 = Rs.36480.01
[2025-10-24T04:42:04.997Z] [LOG]       Saturday: 13.50h × Rs.533.33 = Rs.7199.96
[2025-10-24T04:42:04.998Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:05.000Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:05.001Z] [LOG]       Total Expected Earned: Rs.43679.97
[2025-10-24T04:42:05.002Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:42:05.002Z] [LOG]       Weekday: 35.70h × Rs.282.35 = Rs.10080.29
[2025-10-24T04:42:05.003Z] [LOG]       Saturday: 4.50h × Rs.533.33 = Rs.2399.99
[2025-10-24T04:42:05.004Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:05.004Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:05.005Z] [LOG]       Total Actual Earned: Rs.12480.27
[2025-10-24T04:42:05.006Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:42:05.007Z] [LOG]       Calculated At: Oct 24, 2025, 10:12:05
[2025-10-24T04:42:05.007Z] [LOG]       Expected Earned (until NOW): Rs.43679.97
[2025-10-24T04:42:05.008Z] [LOG]       Actual Earned (until NOW): Rs.12480.27
[2025-10-24T04:42:05.009Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:05.009Z] [LOG]       Attendance Deduction: Rs.31199.70
[2025-10-24T04:42:05.010Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:42:05.010Z] [LOG]       📉 Shortfall: 102.50 hours (71.43% of expected)
[2025-10-24T04:42:05.011Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:42:05.012Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:42:05.012Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-24T04:42:05.013Z] [LOG]    Actual Earned Base: Rs.12480.27
[2025-10-24T04:42:05.014Z] [LOG]    Attendance Shortfall: Rs.31199.70
[2025-10-24T04:42:05.014Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:42:05.015Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:42:05.016Z] [LOG]    Gross Salary: 12480.270976319445
[2025-10-24T04:42:05.016Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:42:05.017Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:42:05.017Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.018Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:42:05.018Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.019Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:42:05.019Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.019Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:42:05.020Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.020Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:42:05.020Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.021Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:42:05.021Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.021Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:42:05.022Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.022Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:42:05.022Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.023Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:42:05.023Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.023Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:42:05.024Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.024Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:42:05.024Z] [LOG]    EPF/ETF calculated on: Rs.12480.27
[2025-10-24T04:42:05.025Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:42:05.025Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:42:05.025Z] [LOG] 💰 GROSS CALCULATION for Jessie null:
[2025-10-24T04:42:05.026Z] [LOG]    Base Salary: 60000
[2025-10-24T04:42:05.026Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:42:05.026Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:42:05.027Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.027Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:42:05.027Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.027Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:42:05.028Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:05.236Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:42:05.236Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:05.237Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:42:05.238Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:42:05.238Z] [LOG]    Actual Earned Base: Rs.12480.27
[2025-10-24T04:42:05.239Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:42:05.239Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:42:05.240Z] [LOG]    = Gross Salary: Rs.12480.27
[2025-10-24T04:42:05.240Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:42:05.241Z] [LOG]    Attendance Shortfall (Info): Rs.31199.70
[2025-10-24T04:42:05.242Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:42:05.242Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:05.243Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:42:05.245Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:42:05.246Z] [LOG]    Gross Salary: Rs.12480.27
[2025-10-24T04:42:05.246Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:42:05.247Z] [LOG]    = NET SALARY: Rs.12480.27
[2025-10-24T04:42:05.247Z] [LOG] 
💾 Database Update:
[2025-10-24T04:42:05.248Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:42:05.250Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:42:05.460Z] [LOG] 
📝 Components to save:
[2025-10-24T04:42:05.461Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:42:05.462Z] [LOG]    Deduction components: 1
[2025-10-24T04:42:05.462Z] [LOG] Creating components for record bca2b094-f4f8-4f86-bb67-3c799f40928c: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:42:05.464Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 12480.270976319445
}
[2025-10-24T04:42:05.673Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:42:05.883Z] [LOG] Created payroll_record_component: a26ae437-f5c2-4216-88fa-31b75855d3cc for Base Salary
[2025-10-24T04:42:05.884Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 31199.695000000007
}
[2025-10-24T04:42:06.092Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:42:06.295Z] [LOG] Created payroll_record_component: 501da032-e918-4da7-85d8-14bc63a37aa2 for Attendance Shortfall (Info)
[2025-10-24T04:42:06.703Z] [LOG] ✅ Financial balances updated successfully for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:06.704Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:42:06.704Z] [LOG] 
======================================================================
[2025-10-24T04:42:06.705Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Jessie null
[2025-10-24T04:42:06.706Z] [LOG] ======================================================================
[2025-10-24T04:42:06.706Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-24T04:42:06.707Z] [LOG]    Actual Earned Base (Attendance-based): Rs.12480.27
[2025-10-24T04:42:06.707Z] [LOG]    Attendance Shortfall: Rs.31199.70
[2025-10-24T04:42:06.708Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:06.708Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:06.709Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:42:06.710Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:06.710Z] [LOG]    GROSS SALARY: Rs.12480.27
[2025-10-24T04:42:06.711Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:06.712Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:42:06.712Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:42:06.713Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:42:06.714Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:42:06.714Z] [LOG]       - Attendance Shortfall (Info): Rs.31199.70
[2025-10-24T04:42:06.715Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:06.716Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:06.717Z] [LOG]    NET SALARY: Rs.12480.27
[2025-10-24T04:42:06.718Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:42:06.718Z] [LOG] ======================================================================

[2025-10-24T04:42:06.719Z] [LOG] ✅ Jessie null: Calculation completed successfully
[2025-10-24T04:42:06.720Z] [LOG] 📊 Progress: 24/34 (70.6%)
[2025-10-24T04:42:06.721Z] [LOG] 
🧮 Processing: R. D.A Kaushalya null (EMP000044)
[2025-10-24T04:42:06.721Z] [LOG] 📋 Record ID: be422f67-fda3-4906-8e2a-6e4ccea5a7f8
[2025-10-24T04:42:06.722Z] [LOG] 
======================================================================
[2025-10-24T04:42:06.723Z] [LOG] 🧮 CALCULATING PAYROLL: R. D.A Kaushalya null (EMP000044)
[2025-10-24T04:42:06.723Z] [LOG] ======================================================================
[2025-10-24T04:42:07.571Z] [LOG] 🔍 Component filtering for employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-24T04:42:07.572Z] [LOG]    Total components: 13
[2025-10-24T04:42:07.572Z] [LOG]    Applicable components: 13
[2025-10-24T04:42:07.572Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-24T04:42:08.835Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:42:08.836Z] [LOG] 🔄 Processing financial records for employee 01443963-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:42:09.047Z] [LOG] 📊 Found 0 active loans for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:09.255Z] [LOG] 📊 Found 0 active advances for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:09.468Z] [LOG] 📊 Found 0 approved bonuses for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:09.469Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:42:09.470Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:42:09.689Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:42:09.689Z] [LOG]    Employee ID: 01443963-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:09.690Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:42:09.691Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:42:09.691Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:42:09.899Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:42:09.899Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:42:09.900Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:42:09.900Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:42:09.900Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:42:09.901Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:42:09.901Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:42:10.525Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:42:10.526Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:42:10.735Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:42:10.735Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:42:10.735Z] [LOG]       Total completed sessions found: 4
[2025-10-24T04:42:10.736Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:42:10.737Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:42:10.737Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:42:10.737Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:42:10.738Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:42:10.958Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:42:10.959Z] [LOG]          Weekday: 25.50h
[2025-10-24T04:42:10.959Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:42:10.959Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:42:11.162Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:42:11.163Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:42:11.164Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:42:11.164Z] [LOG]       Current Time: 10:12:11
[2025-10-24T04:42:11.165Z] [LOG]       Expected Hours (scheduled → now): 1.70h
[2025-10-24T04:42:11.166Z] [LOG]       Actual Hours (check-in → now): 1.70h
[2025-10-24T04:42:11.167Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:42:11.168Z] [LOG]       Weekday: 129.20h
[2025-10-24T04:42:11.168Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:42:11.168Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:11.169Z] [LOG]       Total Expected: 142.70h
[2025-10-24T04:42:11.169Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:42:11.169Z] [LOG]       Weekday: 27.20h (includes 1.70h live)
[2025-10-24T04:42:11.170Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:42:11.170Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:11.170Z] [LOG]       Total Actual: 31.70h
[2025-10-24T04:42:11.171Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:42:11.171Z] [LOG]       Weekday: 129.20h × Rs.235.29 = Rs.30400.20
[2025-10-24T04:42:11.171Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:42:11.172Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:11.172Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:11.172Z] [LOG]       Total Expected Earned: Rs.36400.14
[2025-10-24T04:42:11.173Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:42:11.173Z] [LOG]       Weekday: 27.20h × Rs.235.29 = Rs.6400.62
[2025-10-24T04:42:11.173Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:42:11.174Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:11.174Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:11.174Z] [LOG]       Total Actual Earned: Rs.8400.60
[2025-10-24T04:42:11.175Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:42:11.175Z] [LOG]       Calculated At: Oct 24, 2025, 10:12:11
[2025-10-24T04:42:11.176Z] [LOG]       Expected Earned (until NOW): Rs.36400.14
[2025-10-24T04:42:11.176Z] [LOG]       Actual Earned (until NOW): Rs.8400.60
[2025-10-24T04:42:11.176Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:11.176Z] [LOG]       Attendance Deduction: Rs.27999.54
[2025-10-24T04:42:11.177Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:42:11.177Z] [LOG]       📉 Shortfall: 111.00 hours (76.92% of expected)
[2025-10-24T04:42:11.177Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:42:11.178Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:42:11.178Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:42:11.178Z] [LOG]    Actual Earned Base: Rs.8400.60
[2025-10-24T04:42:11.178Z] [LOG]    Attendance Shortfall: Rs.27999.54
[2025-10-24T04:42:11.179Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:42:11.179Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:42:11.179Z] [LOG]    Gross Salary: 8400.597529716666
[2025-10-24T04:42:11.179Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:42:11.180Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:42:11.180Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.180Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:42:11.180Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.181Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:42:11.181Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.181Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:42:11.181Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.182Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:42:11.182Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.183Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:42:11.183Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.183Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:42:11.184Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.184Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:42:11.184Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.184Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:42:11.185Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.185Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:42:11.185Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.185Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:42:11.186Z] [LOG]    EPF/ETF calculated on: Rs.8400.60
[2025-10-24T04:42:11.186Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:42:11.186Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:42:11.186Z] [LOG] 💰 GROSS CALCULATION for R. D.A Kaushalya null:
[2025-10-24T04:42:11.187Z] [LOG]    Base Salary: 50000
[2025-10-24T04:42:11.187Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:42:11.187Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:42:11.188Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.188Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:42:11.188Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.188Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:42:11.189Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:11.392Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:42:11.393Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:11.394Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:42:11.394Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:42:11.395Z] [LOG]    Actual Earned Base: Rs.8400.60
[2025-10-24T04:42:11.396Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:42:11.397Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:42:11.398Z] [LOG]    = Gross Salary: Rs.8400.60
[2025-10-24T04:42:11.398Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:42:11.401Z] [LOG]    Attendance Shortfall (Info): Rs.27999.54
[2025-10-24T04:42:11.402Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:42:11.403Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:11.403Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:42:11.404Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:42:11.407Z] [LOG]    Gross Salary: Rs.8400.60
[2025-10-24T04:42:11.407Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:42:11.407Z] [LOG]    = NET SALARY: Rs.8400.60
[2025-10-24T04:42:11.408Z] [LOG] 
💾 Database Update:
[2025-10-24T04:42:11.408Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:42:11.408Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:42:11.619Z] [LOG] 
📝 Components to save:
[2025-10-24T04:42:11.619Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:42:11.619Z] [LOG]    Deduction components: 1
[2025-10-24T04:42:11.620Z] [LOG] Creating components for record be422f67-fda3-4906-8e2a-6e4ccea5a7f8: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:42:11.621Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8400.597529716666
}
[2025-10-24T04:42:11.827Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:42:12.044Z] [LOG] Created payroll_record_component: 80ca2930-452e-4ae6-bc52-11891fa8ff84 for Base Salary
[2025-10-24T04:42:12.044Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 27999.54
}
[2025-10-24T04:42:12.253Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:42:12.464Z] [LOG] Created payroll_record_component: b90ae2f7-7823-4d49-b611-419bd3aa3e55 for Attendance Shortfall (Info)
[2025-10-24T04:42:12.894Z] [LOG] ✅ Financial balances updated successfully for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:12.894Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:42:12.894Z] [LOG] 
======================================================================
[2025-10-24T04:42:12.894Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: R. D.A Kaushalya null
[2025-10-24T04:42:12.895Z] [LOG] ======================================================================
[2025-10-24T04:42:12.895Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:42:12.895Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8400.60
[2025-10-24T04:42:12.896Z] [LOG]    Attendance Shortfall: Rs.27999.54
[2025-10-24T04:42:12.896Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:12.896Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:12.896Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:42:12.896Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:12.896Z] [LOG]    GROSS SALARY: Rs.8400.60
[2025-10-24T04:42:12.897Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:12.897Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:42:12.897Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:42:12.897Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:42:12.897Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:42:12.898Z] [LOG]       - Attendance Shortfall (Info): Rs.27999.54
[2025-10-24T04:42:12.898Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:12.898Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:12.898Z] [LOG]    NET SALARY: Rs.8400.60
[2025-10-24T04:42:12.898Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:42:12.898Z] [LOG] ======================================================================

[2025-10-24T04:42:12.900Z] [LOG] ✅ R. D.A Kaushalya null: Calculation completed successfully
[2025-10-24T04:42:12.900Z] [LOG] 📊 Progress: 25/34 (73.5%)
[2025-10-24T04:42:12.901Z] [LOG] 
🧮 Processing: Sujevan Selvaratnam null (EMP000026)
[2025-10-24T04:42:12.902Z] [LOG] 📋 Record ID: be7f0f13-3f2a-4279-ad32-af0efa87c362
[2025-10-24T04:42:12.902Z] [LOG] 
======================================================================
[2025-10-24T04:42:12.902Z] [LOG] 🧮 CALCULATING PAYROLL: Sujevan Selvaratnam null (EMP000026)
[2025-10-24T04:42:12.902Z] [LOG] ======================================================================
[2025-10-24T04:42:13.735Z] [LOG] 🔍 Component filtering for employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-24T04:42:13.735Z] [LOG]    Total components: 13
[2025-10-24T04:42:13.735Z] [LOG]    Applicable components: 13
[2025-10-24T04:42:13.735Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-24T04:42:14.993Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:42:14.993Z] [LOG] 🔄 Processing financial records for employee 0143e6c3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:42:15.204Z] [LOG] 📊 Found 0 active loans for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:15.409Z] [LOG] 📊 Found 0 active advances for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:15.616Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:15.616Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:42:15.618Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:42:15.820Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:42:15.821Z] [LOG]    Employee ID: 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:15.821Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:42:15.821Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:42:15.821Z] [LOG]    Base Salary (Full Month): Rs.1.00
[2025-10-24T04:42:16.026Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:42:16.026Z] [LOG]       Daily Salary: Rs.0.04
[2025-10-24T04:42:16.027Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-24T04:42:16.028Z] [LOG]       Saturday Hourly Rate: Rs.0.01
[2025-10-24T04:42:16.028Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:42:16.029Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:42:16.029Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:42:16.645Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:42:16.645Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:42:16.859Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:42:16.860Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:42:16.860Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:42:16.860Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:42:16.860Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:42:16.861Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:42:16.861Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:42:16.861Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:42:16.861Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:42:17.066Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:42:17.067Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:42:17.067Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:42:17.068Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:42:17.271Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:42:17.271Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:42:17.271Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:42:17.272Z] [LOG]       Current Time: 10:12:17
[2025-10-24T04:42:17.272Z] [LOG]       Expected Hours (scheduled → now): 1.70h
[2025-10-24T04:42:17.272Z] [LOG]       Actual Hours (check-in → now): 1.70h
[2025-10-24T04:42:17.272Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:42:17.273Z] [LOG]       Weekday: 129.20h
[2025-10-24T04:42:17.273Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:42:17.273Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:17.273Z] [LOG]       Total Expected: 142.70h
[2025-10-24T04:42:17.273Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:42:17.274Z] [LOG]       Weekday: 35.70h (includes 1.70h live)
[2025-10-24T04:42:17.274Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:42:17.274Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:17.274Z] [LOG]       Total Actual: 40.20h
[2025-10-24T04:42:17.274Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:42:17.274Z] [LOG]       Weekday: 129.20h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:17.275Z] [LOG]       Saturday: 13.50h × Rs.0.01 = Rs.0.14
[2025-10-24T04:42:17.275Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:17.275Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:17.275Z] [LOG]       Total Expected Earned: Rs.0.14
[2025-10-24T04:42:17.276Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:42:17.276Z] [LOG]       Weekday: 35.70h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:17.276Z] [LOG]       Saturday: 4.50h × Rs.0.01 = Rs.0.04
[2025-10-24T04:42:17.276Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:17.277Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:17.277Z] [LOG]       Total Actual Earned: Rs.0.04
[2025-10-24T04:42:17.277Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:42:17.278Z] [LOG]       Calculated At: Oct 24, 2025, 10:12:17
[2025-10-24T04:42:17.278Z] [LOG]       Expected Earned (until NOW): Rs.0.14
[2025-10-24T04:42:17.278Z] [LOG]       Actual Earned (until NOW): Rs.0.04
[2025-10-24T04:42:17.278Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:17.278Z] [LOG]       Attendance Deduction: Rs.0.09
[2025-10-24T04:42:17.278Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:42:17.279Z] [LOG]       📉 Shortfall: 102.50 hours (66.67% of expected)
[2025-10-24T04:42:17.279Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:42:17.279Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:42:17.279Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-24T04:42:17.279Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-24T04:42:17.279Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-24T04:42:17.280Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:42:17.280Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:42:17.280Z] [LOG]    Gross Salary: 0.045
[2025-10-24T04:42:17.280Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:42:17.280Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:42:17.280Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.280Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:42:17.281Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.281Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:42:17.281Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.281Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:42:17.281Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.281Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:42:17.281Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.282Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:42:17.282Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.282Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:42:17.282Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.282Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:42:17.283Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.283Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:42:17.283Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.283Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:42:17.283Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.284Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:42:17.284Z] [LOG]    EPF/ETF calculated on: Rs.0.04
[2025-10-24T04:42:17.284Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:42:17.285Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:42:17.285Z] [LOG] 💰 GROSS CALCULATION for Sujevan Selvaratnam null:
[2025-10-24T04:42:17.285Z] [LOG]    Base Salary: 1
[2025-10-24T04:42:17.285Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:42:17.285Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:42:17.285Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.286Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:42:17.286Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.286Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:42:17.286Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:17.486Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:42:17.486Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:17.487Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:42:17.487Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:42:17.487Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-24T04:42:17.488Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:42:17.488Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:42:17.488Z] [LOG]    = Gross Salary: Rs.0.04
[2025-10-24T04:42:17.489Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:42:17.489Z] [LOG]    Attendance Shortfall (Info): Rs.0.09
[2025-10-24T04:42:17.490Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:42:17.490Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:17.490Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:42:17.490Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:42:17.491Z] [LOG]    Gross Salary: Rs.0.04
[2025-10-24T04:42:17.491Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:42:17.491Z] [LOG]    = NET SALARY: Rs.0.04
[2025-10-24T04:42:17.492Z] [LOG] 
💾 Database Update:
[2025-10-24T04:42:17.493Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:42:17.493Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:42:17.693Z] [LOG] 
📝 Components to save:
[2025-10-24T04:42:17.693Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:42:17.693Z] [LOG]    Deduction components: 1
[2025-10-24T04:42:17.694Z] [LOG] Creating components for record be7f0f13-3f2a-4279-ad32-af0efa87c362: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:42:17.694Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 0.045
}
[2025-10-24T04:42:17.898Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:42:18.103Z] [LOG] Created payroll_record_component: 5f349759-d16c-45b3-8e16-543ff257c270 for Base Salary
[2025-10-24T04:42:18.104Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 0.09000000000000001
}
[2025-10-24T04:42:18.305Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:42:18.526Z] [LOG] Created payroll_record_component: 35aa90c4-c311-42b7-b6f6-41f10d489595 for Attendance Shortfall (Info)
[2025-10-24T04:42:18.937Z] [LOG] ✅ Financial balances updated successfully for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:18.937Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:42:18.937Z] [LOG] 
======================================================================
[2025-10-24T04:42:18.937Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sujevan Selvaratnam null
[2025-10-24T04:42:18.938Z] [LOG] ======================================================================
[2025-10-24T04:42:18.938Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-24T04:42:18.938Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.04
[2025-10-24T04:42:18.939Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-24T04:42:18.939Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:18.939Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:18.939Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:42:18.940Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:18.940Z] [LOG]    GROSS SALARY: Rs.0.04
[2025-10-24T04:42:18.940Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:18.941Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:42:18.941Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:42:18.941Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:42:18.941Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:42:18.942Z] [LOG]       - Attendance Shortfall (Info): Rs.0.09
[2025-10-24T04:42:18.942Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:18.942Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:18.943Z] [LOG]    NET SALARY: Rs.0.04
[2025-10-24T04:42:18.943Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:42:18.943Z] [LOG] ======================================================================

[2025-10-24T04:42:18.944Z] [LOG] ✅ Sujevan Selvaratnam null: Calculation completed successfully
[2025-10-24T04:42:18.944Z] [LOG] 📊 Progress: 26/34 (76.5%)
[2025-10-24T04:42:18.944Z] [LOG] 
🧮 Processing: Office Team null (EMP000041)
[2025-10-24T04:42:18.944Z] [LOG] 📋 Record ID: e20cc537-0824-419d-9beb-4a6042ad0546
[2025-10-24T04:42:18.945Z] [LOG] 
======================================================================
[2025-10-24T04:42:18.945Z] [LOG] 🧮 CALCULATING PAYROLL: Office Team null (EMP000041)
[2025-10-24T04:42:18.945Z] [LOG] ======================================================================
[2025-10-24T04:42:19.788Z] [LOG] 🔍 Component filtering for employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-24T04:42:19.790Z] [LOG]    Total components: 13
[2025-10-24T04:42:19.791Z] [LOG]    Applicable components: 13
[2025-10-24T04:42:19.791Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-24T04:42:21.038Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:42:21.039Z] [LOG] 🔄 Processing financial records for employee 01442b21-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:42:21.244Z] [LOG] 📊 Found 0 active loans for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:21.451Z] [LOG] 📊 Found 0 active advances for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:21.653Z] [LOG] 📊 Found 0 approved bonuses for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:21.654Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:42:21.655Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:42:21.859Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:42:21.860Z] [LOG]    Employee ID: 01442b21-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:21.861Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:42:21.861Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:42:21.862Z] [LOG]    Base Salary (Full Month): Rs.1.00
[2025-10-24T04:42:22.068Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:42:22.069Z] [LOG]       Daily Salary: Rs.0.04
[2025-10-24T04:42:22.070Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-24T04:42:22.070Z] [LOG]       Saturday Hourly Rate: Rs.0.01
[2025-10-24T04:42:22.071Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:42:22.071Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:42:22.072Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:42:22.692Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:42:22.693Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:42:22.897Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:42:22.903Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:42:22.904Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:42:22.904Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:42:22.905Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:42:22.906Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:42:22.906Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:42:22.907Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:42:22.912Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:42:23.142Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:42:23.143Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:42:23.144Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:42:23.145Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:42:23.347Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:42:23.347Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:42:23.348Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:42:23.348Z] [LOG]       Current Time: 10:12:23
[2025-10-24T04:42:23.350Z] [LOG]       Expected Hours (scheduled → now): 1.71h
[2025-10-24T04:42:23.350Z] [LOG]       Actual Hours (check-in → now): 1.71h
[2025-10-24T04:42:23.351Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:42:23.351Z] [LOG]       Weekday: 129.21h
[2025-10-24T04:42:23.352Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:42:23.352Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:23.353Z] [LOG]       Total Expected: 142.71h
[2025-10-24T04:42:23.353Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:42:23.354Z] [LOG]       Weekday: 35.71h (includes 1.71h live)
[2025-10-24T04:42:23.354Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:42:23.355Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:23.355Z] [LOG]       Total Actual: 40.21h
[2025-10-24T04:42:23.356Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:42:23.356Z] [LOG]       Weekday: 129.21h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:23.357Z] [LOG]       Saturday: 13.50h × Rs.0.01 = Rs.0.14
[2025-10-24T04:42:23.357Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:23.357Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:23.358Z] [LOG]       Total Expected Earned: Rs.0.14
[2025-10-24T04:42:23.358Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:42:23.359Z] [LOG]       Weekday: 35.71h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:23.359Z] [LOG]       Saturday: 4.50h × Rs.0.01 = Rs.0.04
[2025-10-24T04:42:23.360Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:23.360Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:23.360Z] [LOG]       Total Actual Earned: Rs.0.04
[2025-10-24T04:42:23.361Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:42:23.362Z] [LOG]       Calculated At: Oct 24, 2025, 10:12:23
[2025-10-24T04:42:23.362Z] [LOG]       Expected Earned (until NOW): Rs.0.14
[2025-10-24T04:42:23.362Z] [LOG]       Actual Earned (until NOW): Rs.0.04
[2025-10-24T04:42:23.363Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:23.363Z] [LOG]       Attendance Deduction: Rs.0.09
[2025-10-24T04:42:23.364Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:42:23.364Z] [LOG]       📉 Shortfall: 102.50 hours (66.67% of expected)
[2025-10-24T04:42:23.364Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:42:23.365Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:42:23.365Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-24T04:42:23.366Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-24T04:42:23.366Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-24T04:42:23.367Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:42:23.367Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:42:23.368Z] [LOG]    Gross Salary: 0.045
[2025-10-24T04:42:23.368Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:42:23.369Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:42:23.369Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.369Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:42:23.370Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.370Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:42:23.370Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.371Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:42:23.371Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.371Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:42:23.372Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.372Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:42:23.372Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.373Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:42:23.373Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.374Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:42:23.374Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.374Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:42:23.375Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.375Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:42:23.375Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.376Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:42:23.376Z] [LOG]    EPF/ETF calculated on: Rs.0.04
[2025-10-24T04:42:23.376Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:42:23.377Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:42:23.377Z] [LOG] 💰 GROSS CALCULATION for Office Team null:
[2025-10-24T04:42:23.377Z] [LOG]    Base Salary: 1
[2025-10-24T04:42:23.377Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:42:23.377Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:42:23.378Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.378Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:42:23.378Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.378Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:42:23.378Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:23.588Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:42:23.589Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:23.589Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:42:23.590Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:42:23.591Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-24T04:42:23.591Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:42:23.592Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:42:23.592Z] [LOG]    = Gross Salary: Rs.0.04
[2025-10-24T04:42:23.593Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:42:23.594Z] [LOG]    Attendance Shortfall (Info): Rs.0.09
[2025-10-24T04:42:23.595Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:42:23.596Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:23.597Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:42:23.597Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:42:23.598Z] [LOG]    Gross Salary: Rs.0.04
[2025-10-24T04:42:23.599Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:42:23.600Z] [LOG]    = NET SALARY: Rs.0.04
[2025-10-24T04:42:23.601Z] [LOG] 
💾 Database Update:
[2025-10-24T04:42:23.602Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:42:23.603Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:42:23.801Z] [LOG] 
📝 Components to save:
[2025-10-24T04:42:23.802Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:42:23.803Z] [LOG]    Deduction components: 1
[2025-10-24T04:42:23.803Z] [LOG] Creating components for record e20cc537-0824-419d-9beb-4a6042ad0546: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:42:23.805Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 0.045
}
[2025-10-24T04:42:24.016Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:42:24.233Z] [LOG] Created payroll_record_component: 55aac7df-0e96-403d-9c9a-27f706033c37 for Base Salary
[2025-10-24T04:42:24.233Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 0.09000000000000001
}
[2025-10-24T04:42:24.439Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:42:24.641Z] [LOG] Created payroll_record_component: e3a28fff-504c-4a42-957a-ccbb314d1486 for Attendance Shortfall (Info)
[2025-10-24T04:42:25.087Z] [LOG] ✅ Financial balances updated successfully for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:25.088Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:42:25.089Z] [LOG] 
======================================================================
[2025-10-24T04:42:25.089Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Office Team null
[2025-10-24T04:42:25.090Z] [LOG] ======================================================================
[2025-10-24T04:42:25.091Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-24T04:42:25.091Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.04
[2025-10-24T04:42:25.092Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-24T04:42:25.092Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:25.093Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:25.094Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:42:25.094Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:25.095Z] [LOG]    GROSS SALARY: Rs.0.04
[2025-10-24T04:42:25.096Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:25.097Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:42:25.097Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:42:25.098Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:42:25.098Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:42:25.099Z] [LOG]       - Attendance Shortfall (Info): Rs.0.09
[2025-10-24T04:42:25.102Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:25.103Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:25.103Z] [LOG]    NET SALARY: Rs.0.04
[2025-10-24T04:42:25.104Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:42:25.104Z] [LOG] ======================================================================

[2025-10-24T04:42:25.105Z] [LOG] ✅ Office Team null: Calculation completed successfully
[2025-10-24T04:42:25.106Z] [LOG] 📊 Progress: 27/34 (79.4%)
[2025-10-24T04:42:25.107Z] [LOG] 
🧮 Processing: Safna Nawas null (EMP000021)
[2025-10-24T04:42:25.108Z] [LOG] 📋 Record ID: e2579459-4dd9-402b-84f9-ca2820eb0c69
[2025-10-24T04:42:25.108Z] [LOG] 
======================================================================
[2025-10-24T04:42:25.109Z] [LOG] 🧮 CALCULATING PAYROLL: Safna Nawas null (EMP000021)
[2025-10-24T04:42:25.110Z] [LOG] ======================================================================
[2025-10-24T04:42:25.950Z] [LOG] 🔍 Component filtering for employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-24T04:42:25.951Z] [LOG]    Total components: 13
[2025-10-24T04:42:25.951Z] [LOG]    Applicable components: 13
[2025-10-24T04:42:25.951Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-24T04:42:27.207Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:42:27.235Z] [LOG] 🔄 Processing financial records for employee 0143c977-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:42:27.449Z] [LOG] 📊 Found 0 active loans for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:27.680Z] [LOG] 📊 Found 0 active advances for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:27.883Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:27.884Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:42:27.886Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:42:28.095Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:42:28.102Z] [LOG]    Employee ID: 0143c977-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:28.103Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:42:28.103Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:42:28.104Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:42:28.330Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:42:28.330Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:42:28.330Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:42:28.330Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:42:28.331Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:42:28.331Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:42:28.331Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:42:28.979Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:42:28.979Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:42:29.191Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:42:29.191Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:42:29.192Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:42:29.192Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:42:29.193Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:42:29.193Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:42:29.194Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:42:29.194Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:42:29.195Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:42:29.396Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:42:29.396Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:42:29.397Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:42:29.397Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:42:29.616Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:42:29.617Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:42:29.618Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:42:29.619Z] [LOG]       Current Time: 10:12:29
[2025-10-24T04:42:29.619Z] [LOG]       Expected Hours (scheduled → now): 1.71h
[2025-10-24T04:42:29.620Z] [LOG]       Actual Hours (check-in → now): 1.71h
[2025-10-24T04:42:29.621Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:42:29.622Z] [LOG]       Weekday: 129.21h
[2025-10-24T04:42:29.623Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:42:29.623Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:29.624Z] [LOG]       Total Expected: 142.71h
[2025-10-24T04:42:29.625Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:42:29.626Z] [LOG]       Weekday: 35.71h (includes 1.71h live)
[2025-10-24T04:42:29.626Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:42:29.627Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:29.627Z] [LOG]       Total Actual: 40.21h
[2025-10-24T04:42:29.628Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:42:29.629Z] [LOG]       Weekday: 129.21h × Rs.235.29 = Rs.30401.40
[2025-10-24T04:42:29.629Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:42:29.630Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:29.630Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:29.631Z] [LOG]       Total Expected Earned: Rs.36401.34
[2025-10-24T04:42:29.632Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:42:29.633Z] [LOG]       Weekday: 35.71h × Rs.235.29 = Rs.8401.79
[2025-10-24T04:42:29.633Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:42:29.634Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:29.635Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:29.635Z] [LOG]       Total Actual Earned: Rs.10401.77
[2025-10-24T04:42:29.637Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:42:29.638Z] [LOG]       Calculated At: Oct 24, 2025, 10:12:29
[2025-10-24T04:42:29.638Z] [LOG]       Expected Earned (until NOW): Rs.36401.34
[2025-10-24T04:42:29.639Z] [LOG]       Actual Earned (until NOW): Rs.10401.77
[2025-10-24T04:42:29.639Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:29.640Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-24T04:42:29.641Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:42:29.641Z] [LOG]       📉 Shortfall: 102.50 hours (71.42% of expected)
[2025-10-24T04:42:29.642Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:42:29.643Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:42:29.643Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:42:29.644Z] [LOG]    Actual Earned Base: Rs.10401.77
[2025-10-24T04:42:29.644Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-24T04:42:29.645Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:42:29.646Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:42:29.646Z] [LOG]    Gross Salary: 10401.7686524
[2025-10-24T04:42:29.647Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:42:29.647Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:42:29.648Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.648Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:42:29.648Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.649Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:42:29.649Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.650Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:42:29.650Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.650Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:42:29.651Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.651Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:42:29.651Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.652Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:42:29.652Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.652Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:42:29.653Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.653Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:42:29.653Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.654Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:42:29.654Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.654Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:42:29.655Z] [LOG]    EPF/ETF calculated on: Rs.10401.77
[2025-10-24T04:42:29.655Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:42:29.655Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:42:29.655Z] [LOG] 💰 GROSS CALCULATION for Safna Nawas null:
[2025-10-24T04:42:29.656Z] [LOG]    Base Salary: 50000
[2025-10-24T04:42:29.656Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:42:29.656Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:42:29.657Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.657Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:42:29.657Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.657Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:42:29.658Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:29.895Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:42:29.896Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:29.897Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:42:29.897Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:42:29.898Z] [LOG]    Actual Earned Base: Rs.10401.77
[2025-10-24T04:42:29.899Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:42:29.899Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:42:29.900Z] [LOG]    = Gross Salary: Rs.10401.77
[2025-10-24T04:42:29.901Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:42:29.902Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-24T04:42:29.903Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:42:29.904Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:29.905Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:42:29.905Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:42:29.906Z] [LOG]    Gross Salary: Rs.10401.77
[2025-10-24T04:42:29.907Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:42:29.907Z] [LOG]    = NET SALARY: Rs.10401.77
[2025-10-24T04:42:29.908Z] [LOG] 
💾 Database Update:
[2025-10-24T04:42:29.908Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:42:29.909Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:42:30.123Z] [LOG] 
📝 Components to save:
[2025-10-24T04:42:30.144Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:42:30.144Z] [LOG]    Deduction components: 1
[2025-10-24T04:42:30.145Z] [LOG] Creating components for record e2579459-4dd9-402b-84f9-ca2820eb0c69: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:42:30.146Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10401.7686524
}
[2025-10-24T04:42:30.357Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:42:30.571Z] [LOG] Created payroll_record_component: 3901e04e-684b-4d48-af67-1f0869f901d2 for Base Salary
[2025-10-24T04:42:30.572Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-24T04:42:30.792Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:42:31.018Z] [LOG] Created payroll_record_component: fe55d4f7-a2ae-4cb3-9bef-4a78924f289e for Attendance Shortfall (Info)
[2025-10-24T04:42:31.440Z] [LOG] ✅ Financial balances updated successfully for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:31.441Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:42:31.443Z] [LOG] 
======================================================================
[2025-10-24T04:42:31.444Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Safna Nawas null
[2025-10-24T04:42:31.445Z] [LOG] ======================================================================
[2025-10-24T04:42:31.447Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:42:31.448Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10401.77
[2025-10-24T04:42:31.452Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-24T04:42:31.453Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:31.454Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:31.455Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:42:31.456Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:31.457Z] [LOG]    GROSS SALARY: Rs.10401.77
[2025-10-24T04:42:31.457Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:31.458Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:42:31.458Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:42:31.458Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:42:31.459Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:42:31.459Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-24T04:42:31.460Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:31.460Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:31.460Z] [LOG]    NET SALARY: Rs.10401.77
[2025-10-24T04:42:31.461Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:42:31.461Z] [LOG] ======================================================================

[2025-10-24T04:42:31.461Z] [LOG] ✅ Safna Nawas null: Calculation completed successfully
[2025-10-24T04:42:31.462Z] [LOG] 📊 Progress: 28/34 (82.4%)
[2025-10-24T04:42:31.462Z] [LOG] 
🧮 Processing: customer null (EMP000036)
[2025-10-24T04:42:31.462Z] [LOG] 📋 Record ID: e48a97eb-bef8-4313-a84a-5d5ed4f3ffde
[2025-10-24T04:42:31.463Z] [LOG] 
======================================================================
[2025-10-24T04:42:31.463Z] [LOG] 🧮 CALCULATING PAYROLL: customer null (EMP000036)
[2025-10-24T04:42:31.463Z] [LOG] ======================================================================
[2025-10-24T04:42:32.299Z] [LOG] 🔍 Component filtering for employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-24T04:42:32.300Z] [LOG]    Total components: 13
[2025-10-24T04:42:32.301Z] [LOG]    Applicable components: 13
[2025-10-24T04:42:32.301Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-24T04:42:33.579Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:42:33.579Z] [LOG] 🔄 Processing financial records for employee 014409a2-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:42:33.784Z] [LOG] 📊 Found 0 active loans for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:33.998Z] [LOG] 📊 Found 0 active advances for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:34.211Z] [LOG] 📊 Found 0 approved bonuses for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:34.211Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:42:34.212Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:42:34.420Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:42:34.423Z] [LOG]    Employee ID: 014409a2-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:34.424Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:42:34.424Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:42:34.425Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-24T04:42:34.641Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:42:34.641Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-24T04:42:34.642Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-24T04:42:34.642Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-24T04:42:34.642Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:42:34.643Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:42:34.643Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:42:35.274Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:42:35.274Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:42:35.488Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:42:35.488Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:42:35.490Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:42:35.492Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:42:35.494Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:42:35.497Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:42:35.497Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:42:35.498Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:42:35.499Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:42:35.705Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:42:35.705Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:42:35.706Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:42:35.706Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:42:35.943Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:42:35.943Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:42:35.944Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:42:35.944Z] [LOG]       Current Time: 10:12:35
[2025-10-24T04:42:35.944Z] [LOG]       Expected Hours (scheduled → now): 1.71h
[2025-10-24T04:42:35.945Z] [LOG]       Actual Hours (check-in → now): 1.71h
[2025-10-24T04:42:35.945Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:42:35.945Z] [LOG]       Weekday: 129.21h
[2025-10-24T04:42:35.946Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:42:35.946Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:35.946Z] [LOG]       Total Expected: 142.71h
[2025-10-24T04:42:35.947Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:42:35.947Z] [LOG]       Weekday: 35.71h (includes 1.71h live)
[2025-10-24T04:42:35.947Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:42:35.947Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:35.948Z] [LOG]       Total Actual: 40.21h
[2025-10-24T04:42:35.948Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:42:35.948Z] [LOG]       Weekday: 129.21h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:35.949Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:35.951Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:35.951Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:35.952Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-24T04:42:35.952Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:42:35.952Z] [LOG]       Weekday: 35.71h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:35.952Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:35.953Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:35.953Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:35.953Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-24T04:42:35.954Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:42:35.954Z] [LOG]       Calculated At: Oct 24, 2025, 10:12:35
[2025-10-24T04:42:35.954Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-24T04:42:35.955Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-24T04:42:35.955Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:35.955Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-24T04:42:35.956Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:42:35.956Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-24T04:42:35.957Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:42:35.957Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:42:35.957Z] [LOG]    Base Salary (Full): Rs.NaN
[2025-10-24T04:42:35.957Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-24T04:42:35.957Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-24T04:42:35.958Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:42:35.958Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:42:35.958Z] [LOG]    Gross Salary: 0
[2025-10-24T04:42:35.958Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:42:35.958Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:42:35.959Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.959Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:42:35.959Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.959Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:42:35.960Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.960Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:42:35.960Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.960Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:42:35.961Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.961Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:42:35.961Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.961Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:42:35.962Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.962Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:42:35.962Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.962Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:42:35.963Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.963Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:42:35.963Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.963Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:42:35.964Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-24T04:42:35.964Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:42:35.964Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:42:35.964Z] [LOG] 💰 GROSS CALCULATION for customer null:
[2025-10-24T04:42:35.964Z] [LOG]    Base Salary: 0
[2025-10-24T04:42:35.964Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:42:35.965Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:42:35.965Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.965Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:42:35.965Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:35.967Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:42:35.967Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:36.185Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:42:36.185Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:36.185Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:42:36.185Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:42:36.186Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-24T04:42:36.186Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:42:36.186Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:42:36.186Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-24T04:42:36.186Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:42:36.187Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:42:36.187Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:36.188Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:42:36.189Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:42:36.189Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-24T04:42:36.190Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:42:36.191Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-24T04:42:36.192Z] [LOG] 
💾 Database Update:
[2025-10-24T04:42:36.193Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:42:36.194Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:42:36.400Z] [LOG] 
📝 Components to save:
[2025-10-24T04:42:36.401Z] [LOG]    Gross/Earnings components: 0
[2025-10-24T04:42:36.402Z] [LOG]    Deduction components: 0
[2025-10-24T04:42:36.402Z] [LOG] Creating components for record e48a97eb-bef8-4313-a84a-5d5ed4f3ffde: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-24T04:42:36.813Z] [LOG] ✅ Financial balances updated successfully for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:36.813Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:42:36.813Z] [LOG] 
======================================================================
[2025-10-24T04:42:36.814Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: customer null
[2025-10-24T04:42:36.814Z] [LOG] ======================================================================
[2025-10-24T04:42:36.814Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-24T04:42:36.815Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-24T04:42:36.815Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-24T04:42:36.815Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:36.816Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:36.816Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:42:36.816Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:36.816Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-24T04:42:36.817Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:36.817Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:42:36.817Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:42:36.817Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:42:36.818Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:42:36.818Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-24T04:42:36.818Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:36.818Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:36.819Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-24T04:42:36.819Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:42:36.819Z] [LOG] ======================================================================

[2025-10-24T04:42:36.819Z] [LOG] ✅ customer null: Calculation completed successfully
[2025-10-24T04:42:36.820Z] [LOG] 📊 Progress: 29/34 (85.3%)
[2025-10-24T04:42:36.820Z] [LOG] 
🧮 Processing: Saru null (EMP000022)
[2025-10-24T04:42:36.820Z] [LOG] 📋 Record ID: efe8f3ca-138e-447e-82e7-38cfc337c6dc
[2025-10-24T04:42:36.820Z] [LOG] 
======================================================================
[2025-10-24T04:42:36.821Z] [LOG] 🧮 CALCULATING PAYROLL: Saru null (EMP000022)
[2025-10-24T04:42:36.821Z] [LOG] ======================================================================
[2025-10-24T04:42:37.644Z] [LOG] 🔍 Component filtering for employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-24T04:42:37.644Z] [LOG]    Total components: 13
[2025-10-24T04:42:37.645Z] [LOG]    Applicable components: 13
[2025-10-24T04:42:37.645Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-24T04:42:38.935Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:42:38.936Z] [LOG] 🔄 Processing financial records for employee 0143cc7e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:42:39.150Z] [LOG] 📊 Found 0 active loans for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:39.359Z] [LOG] 📊 Found 0 active advances for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:39.571Z] [LOG] 📊 Found 0 approved bonuses for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:39.572Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:42:39.572Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:42:39.775Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:42:39.776Z] [LOG]    Employee ID: 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:39.776Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:42:39.777Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:42:39.777Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:42:39.984Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:42:39.985Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:42:39.986Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:42:39.986Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:42:39.987Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:42:39.988Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:42:39.989Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:42:40.640Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:42:40.641Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:42:40.856Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:42:40.857Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:42:40.858Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:42:40.858Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:42:40.859Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:42:40.859Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:42:40.859Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:42:40.860Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:42:40.860Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:42:41.077Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:42:41.078Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:42:41.078Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:42:41.078Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:42:41.283Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:42:41.284Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:42:41.284Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:42:41.285Z] [LOG]       Current Time: 10:12:41
[2025-10-24T04:42:41.285Z] [LOG]       Expected Hours (scheduled → now): 1.71h
[2025-10-24T04:42:41.285Z] [LOG]       Actual Hours (check-in → now): 1.71h
[2025-10-24T04:42:41.286Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:42:41.286Z] [LOG]       Weekday: 129.21h
[2025-10-24T04:42:41.286Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:42:41.286Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:41.287Z] [LOG]       Total Expected: 142.71h
[2025-10-24T04:42:41.287Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:42:41.288Z] [LOG]       Weekday: 35.71h (includes 1.71h live)
[2025-10-24T04:42:41.288Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:42:41.289Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:41.289Z] [LOG]       Total Actual: 40.21h
[2025-10-24T04:42:41.290Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:42:41.291Z] [LOG]       Weekday: 129.21h × Rs.235.29 = Rs.30402.17
[2025-10-24T04:42:41.292Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:42:41.292Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:41.293Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:41.293Z] [LOG]       Total Expected Earned: Rs.36402.11
[2025-10-24T04:42:41.294Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:42:41.295Z] [LOG]       Weekday: 35.71h × Rs.235.29 = Rs.8402.55
[2025-10-24T04:42:41.295Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:42:41.296Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:41.297Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:41.297Z] [LOG]       Total Actual Earned: Rs.10402.53
[2025-10-24T04:42:41.298Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:42:41.300Z] [LOG]       Calculated At: Oct 24, 2025, 10:12:41
[2025-10-24T04:42:41.301Z] [LOG]       Expected Earned (until NOW): Rs.36402.11
[2025-10-24T04:42:41.302Z] [LOG]       Actual Earned (until NOW): Rs.10402.53
[2025-10-24T04:42:41.302Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:41.303Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-24T04:42:41.303Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:42:41.304Z] [LOG]       📉 Shortfall: 102.50 hours (71.42% of expected)
[2025-10-24T04:42:41.304Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:42:41.305Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:42:41.306Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:42:41.307Z] [LOG]    Actual Earned Base: Rs.10402.53
[2025-10-24T04:42:41.307Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-24T04:42:41.308Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:42:41.309Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:42:41.309Z] [LOG]    Gross Salary: 10402.531188075
[2025-10-24T04:42:41.310Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:42:41.310Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:42:41.311Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.312Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:42:41.312Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.313Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:42:41.314Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.314Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:42:41.315Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.315Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:42:41.316Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.317Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:42:41.318Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.318Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:42:41.318Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.318Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:42:41.319Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.319Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:42:41.319Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.319Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:42:41.320Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.320Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:42:41.320Z] [LOG]    EPF/ETF calculated on: Rs.10402.53
[2025-10-24T04:42:41.321Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:42:41.321Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:42:41.321Z] [LOG] 💰 GROSS CALCULATION for Saru null:
[2025-10-24T04:42:41.322Z] [LOG]    Base Salary: 50000
[2025-10-24T04:42:41.322Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:42:41.322Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:42:41.322Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.323Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:42:41.323Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.323Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:42:41.323Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:41.524Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:42:41.525Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:41.526Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:42:41.526Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:42:41.527Z] [LOG]    Actual Earned Base: Rs.10402.53
[2025-10-24T04:42:41.528Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:42:41.528Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:42:41.529Z] [LOG]    = Gross Salary: Rs.10402.53
[2025-10-24T04:42:41.529Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:42:41.530Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-24T04:42:41.531Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:42:41.532Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:41.533Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:42:41.533Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:42:41.534Z] [LOG]    Gross Salary: Rs.10402.53
[2025-10-24T04:42:41.535Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:42:41.535Z] [LOG]    = NET SALARY: Rs.10402.53
[2025-10-24T04:42:41.536Z] [LOG] 
💾 Database Update:
[2025-10-24T04:42:41.537Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:42:41.538Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:42:41.743Z] [LOG] 
📝 Components to save:
[2025-10-24T04:42:41.744Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:42:41.744Z] [LOG]    Deduction components: 1
[2025-10-24T04:42:41.744Z] [LOG] Creating components for record efe8f3ca-138e-447e-82e7-38cfc337c6dc: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:42:41.745Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10402.531188075
}
[2025-10-24T04:42:41.952Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:42:42.164Z] [LOG] Created payroll_record_component: 9c618193-dd6a-455c-a690-28d384f21b9a for Base Salary
[2025-10-24T04:42:42.164Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-24T04:42:42.380Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:42:42.595Z] [LOG] Created payroll_record_component: eff79827-8746-4b92-a937-5c5166ffd678 for Attendance Shortfall (Info)
[2025-10-24T04:42:43.007Z] [LOG] ✅ Financial balances updated successfully for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:43.008Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:42:43.008Z] [LOG] 
======================================================================
[2025-10-24T04:42:43.009Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Saru null
[2025-10-24T04:42:43.010Z] [LOG] ======================================================================
[2025-10-24T04:42:43.010Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:42:43.011Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10402.53
[2025-10-24T04:42:43.011Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-24T04:42:43.012Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:43.012Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:43.013Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:42:43.014Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:43.014Z] [LOG]    GROSS SALARY: Rs.10402.53
[2025-10-24T04:42:43.015Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:43.016Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:42:43.017Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:42:43.017Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:42:43.018Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:42:43.019Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-24T04:42:43.019Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:43.020Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:43.020Z] [LOG]    NET SALARY: Rs.10402.53
[2025-10-24T04:42:43.021Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:42:43.021Z] [LOG] ======================================================================

[2025-10-24T04:42:43.022Z] [LOG] ✅ Saru null: Calculation completed successfully
[2025-10-24T04:42:43.023Z] [LOG] 📊 Progress: 30/34 (88.2%)
[2025-10-24T04:42:43.023Z] [LOG] 
🧮 Processing: Uthpala null (EMP000006)
[2025-10-24T04:42:43.024Z] [LOG] 📋 Record ID: f12b4eb9-5696-42a0-b79f-9868b8147da4
[2025-10-24T04:42:43.025Z] [LOG] 
======================================================================
[2025-10-24T04:42:43.026Z] [LOG] 🧮 CALCULATING PAYROLL: Uthpala null (EMP000006)
[2025-10-24T04:42:43.026Z] [LOG] ======================================================================
[2025-10-24T04:42:43.887Z] [LOG] 🔍 Component filtering for employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-24T04:42:43.888Z] [LOG]    Total components: 13
[2025-10-24T04:42:43.888Z] [LOG]    Applicable components: 13
[2025-10-24T04:42:43.888Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-24T04:42:46.467Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:42:46.468Z] [LOG] 🔄 Processing financial records for employee 0143a539-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:42:46.687Z] [LOG] 📊 Found 0 active loans for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:46.900Z] [LOG] 📊 Found 0 active advances for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:47.111Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:47.111Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:42:47.112Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:42:47.327Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:42:47.327Z] [LOG]    Employee ID: 0143a539-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:47.328Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:42:47.328Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:42:47.329Z] [LOG]    Base Salary (Full Month): Rs.100000.00
[2025-10-24T04:42:47.543Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:42:47.544Z] [LOG]       Daily Salary: Rs.4000.00
[2025-10-24T04:42:47.545Z] [LOG]       Weekday Hourly Rate: Rs.500.00
[2025-10-24T04:42:47.546Z] [LOG]       Saturday Hourly Rate: Rs.888.89
[2025-10-24T04:42:47.547Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:42:47.547Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:42:47.549Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:42:48.185Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:42:48.186Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:42:48.407Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:42:48.408Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:42:48.408Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:42:48.408Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:42:48.409Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:42:48.409Z] [LOG]          2. 2025-10-15 (Weekday): 7.50h
[2025-10-24T04:42:48.409Z] [LOG]          3. 2025-10-16 (Weekday): 7.50h
[2025-10-24T04:42:48.410Z] [LOG]          4. 2025-10-22 (Weekday): 7.50h
[2025-10-24T04:42:48.410Z] [LOG]          5. 2025-10-23 (Weekday): 7.50h
[2025-10-24T04:42:48.631Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:42:48.632Z] [LOG]          Weekday: 30.00h
[2025-10-24T04:42:48.633Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:42:48.633Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:42:48.845Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:42:48.846Z] [LOG]       Scheduled Start: 09:30:00
[2025-10-24T04:42:48.846Z] [LOG]       Check-in Time: 00:00:00
[2025-10-24T04:42:48.848Z] [LOG]       Current Time: 10:12:48
[2025-10-24T04:42:48.848Z] [LOG]       Expected Hours (scheduled → now): 0.71h
[2025-10-24T04:42:48.849Z] [LOG]       Actual Hours (check-in → now): 10.21h
[2025-10-24T04:42:48.849Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:42:48.850Z] [LOG]       Weekday: 120.71h
[2025-10-24T04:42:48.851Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:42:48.852Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:48.853Z] [LOG]       Total Expected: 134.21h
[2025-10-24T04:42:48.853Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:42:48.854Z] [LOG]       Weekday: 40.21h (includes 10.21h live)
[2025-10-24T04:42:48.855Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:42:48.855Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:48.856Z] [LOG]       Total Actual: 44.71h
[2025-10-24T04:42:48.857Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:42:48.857Z] [LOG]       Weekday: 120.71h × Rs.500.00 = Rs.60356.78
[2025-10-24T04:42:48.858Z] [LOG]       Saturday: 13.50h × Rs.888.89 = Rs.12000.01
[2025-10-24T04:42:48.858Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:48.859Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:48.860Z] [LOG]       Total Expected Earned: Rs.72356.80
[2025-10-24T04:42:48.861Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:42:48.864Z] [LOG]       Weekday: 40.21h × Rs.500.00 = Rs.20106.78
[2025-10-24T04:42:48.865Z] [LOG]       Saturday: 4.50h × Rs.888.89 = Rs.4000.01
[2025-10-24T04:42:48.866Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:48.867Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:48.867Z] [LOG]       Total Actual Earned: Rs.24106.79
[2025-10-24T04:42:48.868Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:42:48.869Z] [LOG]       Calculated At: Oct 24, 2025, 10:12:48
[2025-10-24T04:42:48.870Z] [LOG]       Expected Earned (until NOW): Rs.72356.80
[2025-10-24T04:42:48.870Z] [LOG]       Actual Earned (until NOW): Rs.24106.79
[2025-10-24T04:42:48.871Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:48.871Z] [LOG]       Attendance Deduction: Rs.48250.01
[2025-10-24T04:42:48.872Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:42:48.873Z] [LOG]       📉 Shortfall: 89.50 hours (66.68% of expected)
[2025-10-24T04:42:48.873Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:42:48.874Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:42:48.875Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-24T04:42:48.876Z] [LOG]    Actual Earned Base: Rs.24106.79
[2025-10-24T04:42:48.877Z] [LOG]    Attendance Shortfall: Rs.48250.01
[2025-10-24T04:42:48.877Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:42:48.878Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:42:48.878Z] [LOG]    Gross Salary: 24106.789027777777
[2025-10-24T04:42:48.878Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:42:48.879Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:42:48.879Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.879Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:42:48.880Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.880Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:42:48.880Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.881Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:42:48.881Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.881Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:42:48.882Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.882Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:42:48.882Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.883Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:42:48.883Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.883Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:42:48.884Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.884Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:42:48.884Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.885Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:42:48.885Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.885Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:42:48.885Z] [LOG]    EPF/ETF calculated on: Rs.24106.79
[2025-10-24T04:42:48.886Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:42:48.886Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:42:48.886Z] [LOG] 💰 GROSS CALCULATION for Uthpala null:
[2025-10-24T04:42:48.887Z] [LOG]    Base Salary: 100000
[2025-10-24T04:42:48.887Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:42:48.887Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:42:48.887Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.888Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:42:48.888Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:48.888Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:42:48.889Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:49.097Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:42:49.097Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:49.098Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:42:49.098Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:42:49.099Z] [LOG]    Actual Earned Base: Rs.24106.79
[2025-10-24T04:42:49.100Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:42:49.100Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:42:49.101Z] [LOG]    = Gross Salary: Rs.24106.79
[2025-10-24T04:42:49.102Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:42:49.102Z] [LOG]    Attendance Shortfall (Info): Rs.48250.01
[2025-10-24T04:42:49.103Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:42:49.104Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:49.105Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:42:49.105Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:42:49.106Z] [LOG]    Gross Salary: Rs.24106.79
[2025-10-24T04:42:49.107Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:42:49.107Z] [LOG]    = NET SALARY: Rs.24106.79
[2025-10-24T04:42:49.108Z] [LOG] 
💾 Database Update:
[2025-10-24T04:42:49.109Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:42:49.109Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:42:49.324Z] [LOG] 
📝 Components to save:
[2025-10-24T04:42:49.325Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:42:49.326Z] [LOG]    Deduction components: 1
[2025-10-24T04:42:49.327Z] [LOG] Creating components for record f12b4eb9-5696-42a0-b79f-9868b8147da4: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:42:49.329Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 24106.789027777777
}
[2025-10-24T04:42:49.555Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:42:49.777Z] [LOG] Created payroll_record_component: f3b29807-e1d5-4a80-8dc6-2ac12dbcba6f for Base Salary
[2025-10-24T04:42:49.778Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 48250.009999999995
}
[2025-10-24T04:42:49.985Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:42:50.193Z] [LOG] Created payroll_record_component: 8aa40dd5-d993-4713-83fa-211d7c66a781 for Attendance Shortfall (Info)
[2025-10-24T04:42:50.615Z] [LOG] ✅ Financial balances updated successfully for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:50.615Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:42:50.616Z] [LOG] 
======================================================================
[2025-10-24T04:42:50.617Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Uthpala null
[2025-10-24T04:42:50.617Z] [LOG] ======================================================================
[2025-10-24T04:42:50.618Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-24T04:42:50.618Z] [LOG]    Actual Earned Base (Attendance-based): Rs.24106.79
[2025-10-24T04:42:50.618Z] [LOG]    Attendance Shortfall: Rs.48250.01
[2025-10-24T04:42:50.618Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:50.618Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:50.619Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:42:50.619Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:50.619Z] [LOG]    GROSS SALARY: Rs.24106.79
[2025-10-24T04:42:50.619Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:50.619Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:42:50.620Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:42:50.620Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:42:50.620Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:42:50.620Z] [LOG]       - Attendance Shortfall (Info): Rs.48250.01
[2025-10-24T04:42:50.621Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:50.621Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:50.623Z] [LOG]    NET SALARY: Rs.24106.79
[2025-10-24T04:42:50.623Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:42:50.623Z] [LOG] ======================================================================

[2025-10-24T04:42:50.624Z] [LOG] ✅ Uthpala null: Calculation completed successfully
[2025-10-24T04:42:50.624Z] [LOG] 📊 Progress: 31/34 (91.2%)
[2025-10-24T04:42:50.625Z] [LOG] 
🧮 Processing: Franklin null (EMP000018)
[2025-10-24T04:42:50.625Z] [LOG] 📋 Record ID: f73c4944-c4d6-4c50-b2e6-2713fd4b8312
[2025-10-24T04:42:50.625Z] [LOG] 
======================================================================
[2025-10-24T04:42:50.625Z] [LOG] 🧮 CALCULATING PAYROLL: Franklin null (EMP000018)
[2025-10-24T04:42:50.626Z] [LOG] ======================================================================
[2025-10-24T04:42:51.473Z] [LOG] 🔍 Component filtering for employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-24T04:42:51.474Z] [LOG]    Total components: 13
[2025-10-24T04:42:51.474Z] [LOG]    Applicable components: 13
[2025-10-24T04:42:51.474Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-24T04:42:52.766Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:42:52.767Z] [LOG] 🔄 Processing financial records for employee 0143c037-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:42:52.973Z] [LOG] 📊 Found 0 active loans for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:53.186Z] [LOG] 📊 Found 0 active advances for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:53.394Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:53.395Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:42:53.396Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:42:53.607Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:42:53.608Z] [LOG]    Employee ID: 0143c037-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:53.608Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:42:53.609Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:42:53.610Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:42:53.819Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:42:53.819Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:42:53.820Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:42:53.821Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:42:53.821Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:42:53.822Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:42:53.822Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:42:54.445Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:42:54.445Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:42:54.660Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:42:54.661Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:42:54.662Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:42:54.662Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:42:54.664Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:42:54.665Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:42:54.665Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:42:54.666Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:42:54.669Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:42:54.878Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:42:54.878Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:42:54.879Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:42:54.880Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:42:55.095Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:42:55.096Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:42:55.096Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:42:55.097Z] [LOG]       Current Time: 10:12:55
[2025-10-24T04:42:55.097Z] [LOG]       Expected Hours (scheduled → now): 1.72h
[2025-10-24T04:42:55.098Z] [LOG]       Actual Hours (check-in → now): 1.72h
[2025-10-24T04:42:55.098Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:42:55.098Z] [LOG]       Weekday: 129.22h
[2025-10-24T04:42:55.099Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:42:55.100Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:55.100Z] [LOG]       Total Expected: 142.72h
[2025-10-24T04:42:55.100Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:42:55.102Z] [LOG]       Weekday: 35.72h (includes 1.72h live)
[2025-10-24T04:42:55.102Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:42:55.103Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:42:55.103Z] [LOG]       Total Actual: 40.22h
[2025-10-24T04:42:55.104Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:42:55.104Z] [LOG]       Weekday: 129.22h × Rs.235.29 = Rs.30403.07
[2025-10-24T04:42:55.104Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:42:55.105Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:55.105Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:55.106Z] [LOG]       Total Expected Earned: Rs.36403.01
[2025-10-24T04:42:55.106Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:42:55.107Z] [LOG]       Weekday: 35.72h × Rs.235.29 = Rs.8403.45
[2025-10-24T04:42:55.107Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:42:55.107Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:42:55.108Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:55.108Z] [LOG]       Total Actual Earned: Rs.10403.43
[2025-10-24T04:42:55.109Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:42:55.109Z] [LOG]       Calculated At: Oct 24, 2025, 10:12:55
[2025-10-24T04:42:55.110Z] [LOG]       Expected Earned (until NOW): Rs.36403.01
[2025-10-24T04:42:55.110Z] [LOG]       Actual Earned (until NOW): Rs.10403.43
[2025-10-24T04:42:55.110Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:42:55.111Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-24T04:42:55.111Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:42:55.111Z] [LOG]       📉 Shortfall: 102.50 hours (71.42% of expected)
[2025-10-24T04:42:55.112Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:42:55.112Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:42:55.113Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:42:55.113Z] [LOG]    Actual Earned Base: Rs.10403.43
[2025-10-24T04:42:55.113Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:42:55.114Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:42:55.114Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:42:55.115Z] [LOG]    Gross Salary: 10403.433917375
[2025-10-24T04:42:55.115Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:42:55.117Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:42:55.118Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.118Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:42:55.118Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.119Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:42:55.119Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.119Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:42:55.119Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.119Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:42:55.120Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.120Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:42:55.120Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.120Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:42:55.121Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.121Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:42:55.121Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.121Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:42:55.121Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.122Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:42:55.122Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.122Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:42:55.122Z] [LOG]    EPF/ETF calculated on: Rs.10403.43
[2025-10-24T04:42:55.123Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:42:55.123Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:42:55.123Z] [LOG] 💰 GROSS CALCULATION for Franklin null:
[2025-10-24T04:42:55.124Z] [LOG]    Base Salary: 50000
[2025-10-24T04:42:55.124Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:42:55.125Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:42:55.125Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.125Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:42:55.125Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.125Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:42:55.126Z] [LOG]    Fixed amount: 0
[2025-10-24T04:42:55.336Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:42:55.336Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:55.337Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:42:55.337Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:42:55.338Z] [LOG]    Actual Earned Base: Rs.10403.43
[2025-10-24T04:42:55.339Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:42:55.339Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:42:55.340Z] [LOG]    = Gross Salary: Rs.10403.43
[2025-10-24T04:42:55.340Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:42:55.341Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:42:55.342Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:42:55.343Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:55.344Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:42:55.345Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:42:55.345Z] [LOG]    Gross Salary: Rs.10403.43
[2025-10-24T04:42:55.346Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:42:55.346Z] [LOG]    = NET SALARY: Rs.10403.43
[2025-10-24T04:42:55.347Z] [LOG] 
💾 Database Update:
[2025-10-24T04:42:55.348Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:42:55.350Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:42:55.564Z] [LOG] 
📝 Components to save:
[2025-10-24T04:42:55.565Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:42:55.565Z] [LOG]    Deduction components: 1
[2025-10-24T04:42:55.566Z] [LOG] Creating components for record f73c4944-c4d6-4c50-b2e6-2713fd4b8312: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:42:55.567Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10403.433917375
}
[2025-10-24T04:42:55.777Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:42:55.999Z] [LOG] Created payroll_record_component: 22d3ac4d-6f9d-4c66-9266-b952b69a8b9f for Base Salary
[2025-10-24T04:42:56.000Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-24T04:42:56.214Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:42:56.423Z] [LOG] Created payroll_record_component: 10bef45f-54ef-418a-8498-c33578665d89 for Attendance Shortfall (Info)
[2025-10-24T04:42:56.855Z] [LOG] ✅ Financial balances updated successfully for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:56.855Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:42:56.856Z] [LOG] 
======================================================================
[2025-10-24T04:42:56.857Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Franklin null
[2025-10-24T04:42:56.857Z] [LOG] ======================================================================
[2025-10-24T04:42:56.858Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:42:56.858Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10403.43
[2025-10-24T04:42:56.859Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:42:56.860Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:56.860Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:42:56.861Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:42:56.862Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:56.863Z] [LOG]    GROSS SALARY: Rs.10403.43
[2025-10-24T04:42:56.864Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:56.865Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:42:56.865Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:42:56.866Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:42:56.867Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:42:56.868Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:42:56.869Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:42:56.869Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:42:56.870Z] [LOG]    NET SALARY: Rs.10403.43
[2025-10-24T04:42:56.871Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:42:56.871Z] [LOG] ======================================================================

[2025-10-24T04:42:56.872Z] [LOG] ✅ Franklin null: Calculation completed successfully
[2025-10-24T04:42:56.873Z] [LOG] 📊 Progress: 32/34 (94.1%)
[2025-10-24T04:42:56.873Z] [LOG] 
🧮 Processing: Ammaar Ilham (EMP000023)
[2025-10-24T04:42:56.874Z] [LOG] 📋 Record ID: f7db6bf3-8ebf-4d86-8cd1-55b223c524b7
[2025-10-24T04:42:56.875Z] [LOG] 
======================================================================
[2025-10-24T04:42:56.875Z] [LOG] 🧮 CALCULATING PAYROLL: Ammaar Ilham (EMP000023)
[2025-10-24T04:42:56.876Z] [LOG] ======================================================================
[2025-10-24T04:42:57.724Z] [LOG] 🔍 Component filtering for employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-24T04:42:57.725Z] [LOG]    Total components: 13
[2025-10-24T04:42:57.726Z] [LOG]    Applicable components: 13
[2025-10-24T04:42:57.726Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-24T04:42:59.016Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:42:59.017Z] [LOG] 🔄 Processing financial records for employee 0143de00-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:42:59.224Z] [LOG] 📊 Found 0 active loans for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:59.432Z] [LOG] 📊 Found 0 active advances for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:59.633Z] [LOG] 📊 Found 0 approved bonuses for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:59.634Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:42:59.635Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:42:59.857Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:42:59.857Z] [LOG]    Employee ID: 0143de00-7105-11f0-a50f-98e743540430
[2025-10-24T04:42:59.858Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:42:59.859Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:42:59.859Z] [LOG]    Base Salary (Full Month): Rs.70000.00
[2025-10-24T04:43:00.061Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:43:00.062Z] [LOG]       Daily Salary: Rs.2800.00
[2025-10-24T04:43:00.062Z] [LOG]       Weekday Hourly Rate: Rs.329.41
[2025-10-24T04:43:00.062Z] [LOG]       Saturday Hourly Rate: Rs.622.22
[2025-10-24T04:43:00.063Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:43:00.063Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:43:00.063Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:43:00.668Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:43:00.669Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:43:00.874Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:43:00.875Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:43:00.875Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:43:00.876Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:43:00.876Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:43:00.877Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:43:00.878Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:43:00.878Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:43:00.879Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:43:01.083Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:43:01.084Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:43:01.085Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:43:01.085Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:43:01.293Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:43:01.294Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:43:01.294Z] [LOG]       Check-in Time: 09:30:00
[2025-10-24T04:43:01.296Z] [LOG]       Current Time: 10:13:01
[2025-10-24T04:43:01.296Z] [LOG]       Expected Hours (scheduled → now): 1.72h
[2025-10-24T04:43:01.297Z] [LOG]       Actual Hours (check-in → now): 0.72h
[2025-10-24T04:43:01.297Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:43:01.298Z] [LOG]       Weekday: 129.22h
[2025-10-24T04:43:01.298Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:43:01.299Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:43:01.300Z] [LOG]       Total Expected: 142.72h
[2025-10-24T04:43:01.301Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:43:01.302Z] [LOG]       Weekday: 34.72h (includes 0.72h live)
[2025-10-24T04:43:01.302Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:43:01.303Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:43:01.303Z] [LOG]       Total Actual: 39.22h
[2025-10-24T04:43:01.304Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:43:01.305Z] [LOG]       Weekday: 129.22h × Rs.329.41 = Rs.42565.38
[2025-10-24T04:43:01.305Z] [LOG]       Saturday: 13.50h × Rs.622.22 = Rs.8399.97
[2025-10-24T04:43:01.306Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:43:01.307Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:43:01.307Z] [LOG]       Total Expected Earned: Rs.50965.35
[2025-10-24T04:43:01.308Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:43:01.309Z] [LOG]       Weekday: 34.72h × Rs.329.41 = Rs.11436.14
[2025-10-24T04:43:01.309Z] [LOG]       Saturday: 4.50h × Rs.622.22 = Rs.2799.99
[2025-10-24T04:43:01.310Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:43:01.310Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:43:01.311Z] [LOG]       Total Actual Earned: Rs.14236.13
[2025-10-24T04:43:01.312Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:43:01.313Z] [LOG]       Calculated At: Oct 24, 2025, 10:13:01
[2025-10-24T04:43:01.314Z] [LOG]       Expected Earned (until NOW): Rs.50965.35
[2025-10-24T04:43:01.314Z] [LOG]       Actual Earned (until NOW): Rs.14236.13
[2025-10-24T04:43:01.315Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:43:01.315Z] [LOG]       Attendance Deduction: Rs.36729.23
[2025-10-24T04:43:01.316Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:43:01.317Z] [LOG]       📉 Shortfall: 103.50 hours (72.07% of expected)
[2025-10-24T04:43:01.317Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:43:01.318Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:43:01.319Z] [LOG]    Base Salary (Full): Rs.70000.00
[2025-10-24T04:43:01.319Z] [LOG]    Actual Earned Base: Rs.14236.13
[2025-10-24T04:43:01.320Z] [LOG]    Attendance Shortfall: Rs.36729.23
[2025-10-24T04:43:01.321Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:43:01.322Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:43:01.322Z] [LOG]    Gross Salary: 14236.125479758333
[2025-10-24T04:43:01.323Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:43:01.324Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:43:01.325Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.325Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:43:01.326Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.326Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:43:01.327Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.328Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:43:01.328Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.328Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:43:01.329Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.329Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:43:01.329Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.330Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:43:01.330Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.330Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:43:01.331Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.331Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:43:01.331Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.332Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:43:01.332Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.332Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:43:01.333Z] [LOG]    EPF/ETF calculated on: Rs.14236.13
[2025-10-24T04:43:01.333Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:43:01.333Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:43:01.334Z] [LOG] 💰 GROSS CALCULATION for Ammaar Ilham:
[2025-10-24T04:43:01.334Z] [LOG]    Base Salary: 70000
[2025-10-24T04:43:01.334Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:43:01.335Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:43:01.335Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.335Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:43:01.336Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.336Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:43:01.336Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:01.556Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:43:01.557Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:43:01.557Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:43:01.558Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:43:01.559Z] [LOG]    Actual Earned Base: Rs.14236.13
[2025-10-24T04:43:01.559Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:43:01.560Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:43:01.560Z] [LOG]    = Gross Salary: Rs.14236.13
[2025-10-24T04:43:01.561Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:43:01.562Z] [LOG]    Attendance Shortfall (Info): Rs.36729.23
[2025-10-24T04:43:01.562Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:43:01.563Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:43:01.563Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:43:01.564Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:43:01.565Z] [LOG]    Gross Salary: Rs.14236.13
[2025-10-24T04:43:01.566Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:43:01.567Z] [LOG]    = NET SALARY: Rs.14236.13
[2025-10-24T04:43:01.567Z] [LOG] 
💾 Database Update:
[2025-10-24T04:43:01.568Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:43:01.569Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:43:01.780Z] [LOG] 
📝 Components to save:
[2025-10-24T04:43:01.781Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:43:01.782Z] [LOG]    Deduction components: 1
[2025-10-24T04:43:01.782Z] [LOG] Creating components for record f7db6bf3-8ebf-4d86-8cd1-55b223c524b7: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:43:01.784Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 14236.125479758333
}
[2025-10-24T04:43:01.989Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:43:02.212Z] [LOG] Created payroll_record_component: 46aed6a9-5775-4c18-94b9-e886c4b2823e for Base Salary
[2025-10-24T04:43:02.213Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 36729.225000000006
}
[2025-10-24T04:43:02.414Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:43:02.618Z] [LOG] Created payroll_record_component: 87301c63-ea00-4524-860b-5770b21c8428 for Attendance Shortfall (Info)
[2025-10-24T04:43:03.024Z] [LOG] ✅ Financial balances updated successfully for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-24T04:43:03.025Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:43:03.025Z] [LOG] 
======================================================================
[2025-10-24T04:43:03.026Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ammaar Ilham
[2025-10-24T04:43:03.026Z] [LOG] ======================================================================
[2025-10-24T04:43:03.027Z] [LOG]    Base Salary (Full): Rs.70000.00
[2025-10-24T04:43:03.028Z] [LOG]    Actual Earned Base (Attendance-based): Rs.14236.13
[2025-10-24T04:43:03.028Z] [LOG]    Attendance Shortfall: Rs.36729.23
[2025-10-24T04:43:03.029Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:43:03.029Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:43:03.030Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:43:03.031Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:43:03.032Z] [LOG]    GROSS SALARY: Rs.14236.13
[2025-10-24T04:43:03.033Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:43:03.033Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:43:03.034Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:43:03.035Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:43:03.035Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:43:03.036Z] [LOG]       - Attendance Shortfall (Info): Rs.36729.23
[2025-10-24T04:43:03.037Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:43:03.037Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:43:03.038Z] [LOG]    NET SALARY: Rs.14236.13
[2025-10-24T04:43:03.038Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:43:03.039Z] [LOG] ======================================================================

[2025-10-24T04:43:03.040Z] [LOG] ✅ Ammaar Ilham: Calculation completed successfully
[2025-10-24T04:43:03.040Z] [LOG] 📊 Progress: 33/34 (97.1%)
[2025-10-24T04:43:03.041Z] [LOG] 
🧮 Processing: Waruni null (EMP000024)
[2025-10-24T04:43:03.042Z] [LOG] 📋 Record ID: fe5e480a-380d-4a37-b89f-6a6e98dfd0a2
[2025-10-24T04:43:03.042Z] [LOG] 
======================================================================
[2025-10-24T04:43:03.043Z] [LOG] 🧮 CALCULATING PAYROLL: Waruni null (EMP000024)
[2025-10-24T04:43:03.044Z] [LOG] ======================================================================
[2025-10-24T04:43:03.900Z] [LOG] 🔍 Component filtering for employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-24T04:43:03.901Z] [LOG]    Total components: 13
[2025-10-24T04:43:03.901Z] [LOG]    Applicable components: 13
[2025-10-24T04:43:03.901Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-24T04:43:05.118Z] [LOG] 
🔄 Processing financial records...
[2025-10-24T04:43:05.118Z] [LOG] 🔄 Processing financial records for employee 0143e40c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-24T04:43:05.318Z] [LOG] 📊 Found 0 active loans for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-24T04:43:05.523Z] [LOG] 📊 Found 0 active advances for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-24T04:43:05.729Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-24T04:43:05.729Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-24T04:43:05.730Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-24T04:43:05.933Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-24T04:43:05.933Z] [LOG]    Employee ID: 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-24T04:43:05.934Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-24T04:43:05.935Z] [LOG]    📅 Calculation Until: 2025-10-23 (PARTIAL - Until Today)
[2025-10-24T04:43:05.935Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-24T04:43:06.143Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-24T04:43:06.144Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-24T04:43:06.145Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-24T04:43:06.145Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-24T04:43:06.146Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-24T04:43:06.146Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-24T04:43:06.147Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-24T04:43:06.767Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-24T04:43:06.776Z] [LOG]       Weekdays: 15, Saturdays: 3, Sundays: 0
[2025-10-24T04:43:06.993Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-24T04:43:07.005Z] [LOG]       Period: 2025-10-01 to 2025-10-23
[2025-10-24T04:43:07.005Z] [LOG]       Total completed sessions found: 5
[2025-10-24T04:43:07.005Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-24T04:43:07.006Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-24T04:43:07.012Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-24T04:43:07.013Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-24T04:43:07.014Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-24T04:43:07.022Z] [LOG]          5. 2025-10-23 (Weekday): 8.50h
[2025-10-24T04:43:07.235Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-24T04:43:07.235Z] [LOG]          Weekday: 34.00h
[2025-10-24T04:43:07.235Z] [LOG]          Saturday: 4.50h
[2025-10-24T04:43:07.236Z] [LOG]          Sunday: 0.00h
[2025-10-24T04:43:07.449Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-24T04:43:07.449Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-24T04:43:07.450Z] [LOG]       Check-in Time: 08:30:00
[2025-10-24T04:43:07.450Z] [LOG]       Current Time: 10:13:07
[2025-10-24T04:43:07.453Z] [LOG]       Expected Hours (scheduled → now): 1.72h
[2025-10-24T04:43:07.455Z] [LOG]       Actual Hours (check-in → now): 1.72h
[2025-10-24T04:43:07.456Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-24T04:43:07.457Z] [LOG]       Weekday: 129.22h
[2025-10-24T04:43:07.458Z] [LOG]       Saturday: 13.50h
[2025-10-24T04:43:07.458Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:43:07.458Z] [LOG]       Total Expected: 142.72h
[2025-10-24T04:43:07.460Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-24T04:43:07.460Z] [LOG]       Weekday: 35.72h (includes 1.72h live)
[2025-10-24T04:43:07.461Z] [LOG]       Saturday: 4.50h
[2025-10-24T04:43:07.461Z] [LOG]       Sunday: 0.00h
[2025-10-24T04:43:07.461Z] [LOG]       Total Actual: 40.22h
[2025-10-24T04:43:07.461Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-24T04:43:07.462Z] [LOG]       Weekday: 129.22h × Rs.235.29 = Rs.30403.88
[2025-10-24T04:43:07.462Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-24T04:43:07.462Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:43:07.462Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:43:07.463Z] [LOG]       Total Expected Earned: Rs.36403.82
[2025-10-24T04:43:07.463Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-24T04:43:07.463Z] [LOG]       Weekday: 35.72h × Rs.235.29 = Rs.8404.26
[2025-10-24T04:43:07.463Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-24T04:43:07.464Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-24T04:43:07.464Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:43:07.464Z] [LOG]       Total Actual Earned: Rs.10404.24
[2025-10-24T04:43:07.464Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-24T04:43:07.465Z] [LOG]       Calculated At: Oct 24, 2025, 10:13:07
[2025-10-24T04:43:07.465Z] [LOG]       Expected Earned (until NOW): Rs.36403.82
[2025-10-24T04:43:07.467Z] [LOG]       Actual Earned (until NOW): Rs.10404.24
[2025-10-24T04:43:07.467Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-24T04:43:07.467Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-24T04:43:07.468Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-24T04:43:07.468Z] [LOG]       📉 Shortfall: 102.50 hours (71.42% of expected)
[2025-10-24T04:43:07.468Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-24T04:43:07.468Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-24T04:43:07.468Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:43:07.469Z] [LOG]    Actual Earned Base: Rs.10404.24
[2025-10-24T04:43:07.469Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:43:07.469Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-24T04:43:07.469Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-24T04:43:07.469Z] [LOG]    Gross Salary: 10404.241354225
[2025-10-24T04:43:07.469Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-24T04:43:07.470Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-24T04:43:07.470Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.470Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-24T04:43:07.470Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.470Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-24T04:43:07.470Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.470Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-24T04:43:07.470Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.471Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-24T04:43:07.471Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.471Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-24T04:43:07.471Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.471Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-24T04:43:07.471Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.471Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-24T04:43:07.472Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.472Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-24T04:43:07.472Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.472Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-24T04:43:07.472Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.472Z] [LOG]    📊 Total Deductions: 0
[2025-10-24T04:43:07.472Z] [LOG]    EPF/ETF calculated on: Rs.10404.24
[2025-10-24T04:43:07.473Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-24T04:43:07.473Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-24T04:43:07.473Z] [LOG] 💰 GROSS CALCULATION for Waruni null:
[2025-10-24T04:43:07.473Z] [LOG]    Base Salary: 50000
[2025-10-24T04:43:07.473Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-24T04:43:07.473Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-24T04:43:07.473Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.473Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-24T04:43:07.474Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.474Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-24T04:43:07.474Z] [LOG]    Fixed amount: 0
[2025-10-24T04:43:07.685Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-24T04:43:07.686Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:43:07.686Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-24T04:43:07.686Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-24T04:43:07.687Z] [LOG]    Actual Earned Base: Rs.10404.24
[2025-10-24T04:43:07.687Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-24T04:43:07.687Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-24T04:43:07.687Z] [LOG]    = Gross Salary: Rs.10404.24
[2025-10-24T04:43:07.688Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-24T04:43:07.689Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:43:07.689Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-24T04:43:07.689Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-24T04:43:07.690Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-24T04:43:07.690Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-24T04:43:07.690Z] [LOG]    Gross Salary: Rs.10404.24
[2025-10-24T04:43:07.692Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-24T04:43:07.693Z] [LOG]    = NET SALARY: Rs.10404.24
[2025-10-24T04:43:07.696Z] [LOG] 
💾 Database Update:
[2025-10-24T04:43:07.696Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-24T04:43:07.696Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-24T04:43:07.900Z] [LOG] 
📝 Components to save:
[2025-10-24T04:43:07.901Z] [LOG]    Gross/Earnings components: 1
[2025-10-24T04:43:07.901Z] [LOG]    Deduction components: 1
[2025-10-24T04:43:07.902Z] [LOG] Creating components for record fe5e480a-380d-4a37-b89f-6a6e98dfd0a2: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-24T04:43:07.903Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10404.241354225
}
[2025-10-24T04:43:08.102Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-24T04:43:08.302Z] [LOG] Created payroll_record_component: 4deebe10-a646-4789-b7c3-bae4b81c76d5 for Base Salary
[2025-10-24T04:43:08.302Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-24T04:43:08.502Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-24T04:43:08.714Z] [LOG] Created payroll_record_component: 87b9cc55-0df7-4be2-b173-4780626626c4 for Attendance Shortfall (Info)
[2025-10-24T04:43:09.111Z] [LOG] ✅ Financial balances updated successfully for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-24T04:43:09.112Z] [LOG] ✅ Financial balances updated successfully
[2025-10-24T04:43:09.112Z] [LOG] 
======================================================================
[2025-10-24T04:43:09.113Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Waruni null
[2025-10-24T04:43:09.114Z] [LOG] ======================================================================
[2025-10-24T04:43:09.114Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-24T04:43:09.115Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10404.24
[2025-10-24T04:43:09.115Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-24T04:43:09.117Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:43:09.118Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-24T04:43:09.119Z] [LOG]    Bonuses: Rs.0.00
[2025-10-24T04:43:09.120Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:43:09.120Z] [LOG]    GROSS SALARY: Rs.10404.24
[2025-10-24T04:43:09.121Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:43:09.121Z] [LOG]    Deductions Breakdown:
[2025-10-24T04:43:09.122Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-24T04:43:09.123Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-24T04:43:09.123Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-24T04:43:09.124Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-24T04:43:09.124Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-24T04:43:09.125Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-24T04:43:09.126Z] [LOG]    NET SALARY: Rs.10404.24
[2025-10-24T04:43:09.126Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-24T04:43:09.127Z] [LOG] ======================================================================

[2025-10-24T04:43:09.128Z] [LOG] ✅ Waruni null: Calculation completed successfully
[2025-10-24T04:43:09.128Z] [LOG] 📊 Progress: 34/34 (100.0%)
[2025-10-24T04:43:09.129Z] [LOG] 
============================================================
[2025-10-24T04:43:09.130Z] [LOG] 📈 Processing Summary: 34 successful, 0 failed
[2025-10-24T04:43:10.959Z] [LOG] 🎉 Payroll calculation completed successfully!
[2025-10-24T04:43:10.959Z] [LOG] 📊 Final Summary: 34 processed, 0 errors
[2025-10-24T04:43:10.960Z] [INFO] ================================================================================
[2025-10-24T04:43:10.960Z] [INFO] ⏰ Completed at: 2025-10-24T04:43:10.960Z
[2025-10-24T04:43:10.960Z] [INFO] 📊 Total log entries: 6005