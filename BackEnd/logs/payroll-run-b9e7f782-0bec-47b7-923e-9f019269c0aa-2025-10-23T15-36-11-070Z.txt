[2025-10-23T15:36:11.071Z] [INFO] 🚀 Payroll calculation logging started for run: b9e7f782-0bec-47b7-923e-9f019269c0aa
[2025-10-23T15:36:11.071Z] [INFO] 📁 Log file: E:\smart_attendance_system\BackEnd\logs\payroll-run-b9e7f782-0bec-47b7-923e-9f019269c0aa-2025-10-23T15-36-11-070Z.txt
[2025-10-23T15:36:11.071Z] [INFO] ⏰ Started at: 2025-10-23T15:36:11.071Z
[2025-10-23T15:36:11.071Z] [INFO] ================================================================================
[2025-10-23T15:36:11.071Z] [LOG] 🚀 Starting payroll calculation for run: b9e7f782-0bec-47b7-923e-9f019269c0aa
[2025-10-23T15:36:11.072Z] [LOG] 👤 Client ID: it-signature, User ID: 059304ea-24a5-4d78-a290-cf09b9e53c4c
[2025-10-23T15:36:11.884Z] [LOG] ✅ Payroll run verified: October (MONTHLY_2025_10_REGULAR)
[2025-10-23T15:36:12.272Z] [LOG] 📊 Status updated to 'calculating'
[2025-10-23T15:36:12.894Z] [LOG] 👥 Processing 34 employee records:
[2025-10-23T15:36:12.895Z] [LOG] ============================================================
[2025-10-23T15:36:12.895Z] [LOG] 
🧮 Processing: Kaushal Thambi (EMP465256103)
[2025-10-23T15:36:12.896Z] [LOG] 📋 Record ID: 04e33f11-dc06-4ba7-ab84-b4f87cfe292e
[2025-10-23T15:36:12.897Z] [LOG] 
======================================================================
[2025-10-23T15:36:12.898Z] [LOG] 🧮 CALCULATING PAYROLL: Kaushal Thambi (EMP465256103)
[2025-10-23T15:36:12.898Z] [LOG] ======================================================================
[2025-10-23T15:36:14.629Z] [LOG] 🔍 Component filtering for employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-23T15:36:14.629Z] [LOG]    Total components: 13
[2025-10-23T15:36:14.629Z] [LOG]    Applicable components: 13
[2025-10-23T15:36:14.630Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T15:36:17.112Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:36:17.112Z] [LOG] 🔄 Processing financial records for employee 9e8125c4-ce58-411a-b617-9f75d481c613 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:36:17.516Z] [LOG] 📊 Found 0 active loans for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T15:36:17.925Z] [LOG] 📊 Found 0 active advances for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T15:36:18.359Z] [LOG] 📊 Found 0 approved bonuses for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T15:36:18.360Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:36:18.360Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:36:18.558Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:36:18.559Z] [LOG]    Employee ID: 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T15:36:18.559Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:36:18.560Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:36:18.560Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:36:18.965Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:36:18.965Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:36:18.965Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:36:18.966Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:36:18.966Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:36:18.966Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:36:18.967Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:36:19.972Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:36:19.972Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:36:20.171Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:36:20.172Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:36:20.172Z] [LOG]       Total completed sessions found: 2
[2025-10-23T15:36:20.172Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:36:20.173Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:36:20.173Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:36:20.372Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:36:20.372Z] [LOG]          Weekday: 8.50h
[2025-10-23T15:36:20.372Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:36:20.373Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:36:20.572Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:36:20.573Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:36:20.573Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:36:20.573Z] [LOG]       Current Time: 21:06:20
[2025-10-23T15:36:20.574Z] [LOG]       Expected Hours (scheduled → now): 12.61h
[2025-10-23T15:36:20.574Z] [LOG]       Actual Hours (check-in → now): 12.61h
[2025-10-23T15:36:20.574Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:36:20.575Z] [LOG]       Weekday: 131.61h
[2025-10-23T15:36:20.575Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:36:20.575Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:20.575Z] [LOG]       Total Expected: 145.11h
[2025-10-23T15:36:20.576Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:36:20.576Z] [LOG]       Weekday: 21.11h (includes 12.61h live)
[2025-10-23T15:36:20.577Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:36:20.577Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:20.577Z] [LOG]       Total Actual: 25.61h
[2025-10-23T15:36:20.578Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:36:20.578Z] [LOG]       Weekday: 131.61h × Rs.235.29 = Rs.30965.51
[2025-10-23T15:36:20.578Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:36:20.579Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:20.579Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:20.579Z] [LOG]       Total Expected Earned: Rs.36965.45
[2025-10-23T15:36:20.580Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:36:20.580Z] [LOG]       Weekday: 21.11h × Rs.235.29 = Rs.4965.96
[2025-10-23T15:36:20.580Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:36:20.581Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:20.581Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:20.581Z] [LOG]       Total Actual Earned: Rs.6965.94
[2025-10-23T15:36:20.583Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:36:20.583Z] [LOG]       Calculated At: Oct 23, 2025, 21:06:20
[2025-10-23T15:36:20.583Z] [LOG]       Expected Earned (until NOW): Rs.36965.45
[2025-10-23T15:36:20.584Z] [LOG]       Actual Earned (until NOW): Rs.6965.94
[2025-10-23T15:36:20.584Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:20.585Z] [LOG]       Attendance Deduction: Rs.29999.51
[2025-10-23T15:36:20.585Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:36:20.585Z] [LOG]       📉 Shortfall: 119.50 hours (81.16% of expected)
[2025-10-23T15:36:20.586Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:36:20.586Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:36:20.587Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:36:20.587Z] [LOG]    Actual Earned Base: Rs.6965.94
[2025-10-23T15:36:20.587Z] [LOG]    Attendance Shortfall: Rs.29999.51
[2025-10-23T15:36:20.588Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:36:20.589Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:36:20.589Z] [LOG]    Gross Salary: 6965.943551633332
[2025-10-23T15:36:20.589Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:36:20.590Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:36:20.590Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.591Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:36:20.591Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.591Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:36:20.592Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.592Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:36:20.592Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.592Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:36:20.593Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.593Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:36:20.593Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.593Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:36:20.594Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.594Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:36:20.594Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.595Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:36:20.595Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.595Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:36:20.595Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.596Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:36:20.596Z] [LOG]    EPF/ETF calculated on: Rs.6965.94
[2025-10-23T15:36:20.596Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:36:20.596Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:36:20.598Z] [LOG] 💰 GROSS CALCULATION for Kaushal Thambi:
[2025-10-23T15:36:20.598Z] [LOG]    Base Salary: 50000
[2025-10-23T15:36:20.598Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:36:20.599Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:36:20.599Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.599Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:36:20.600Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:20.600Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:36:20.600Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:21.051Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:36:21.052Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:21.052Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:36:21.053Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:36:21.053Z] [LOG]    Actual Earned Base: Rs.6965.94
[2025-10-23T15:36:21.053Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:36:21.054Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:36:21.054Z] [LOG]    = Gross Salary: Rs.6965.94
[2025-10-23T15:36:21.054Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:36:21.055Z] [LOG]    Attendance Shortfall (Info): Rs.29999.51
[2025-10-23T15:36:21.055Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:36:21.055Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:21.056Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:36:21.056Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:36:21.056Z] [LOG]    Gross Salary: Rs.6965.94
[2025-10-23T15:36:21.057Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:36:21.057Z] [LOG]    = NET SALARY: Rs.6965.94
[2025-10-23T15:36:21.057Z] [LOG] 
💾 Database Update:
[2025-10-23T15:36:21.058Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:36:21.058Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:36:21.471Z] [LOG] 
📝 Components to save:
[2025-10-23T15:36:21.472Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:36:21.472Z] [LOG]    Deduction components: 1
[2025-10-23T15:36:21.472Z] [LOG] Creating components for record 04e33f11-dc06-4ba7-ab84-b4f87cfe292e: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:36:21.473Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 6965.943551633332
}
[2025-10-23T15:36:21.871Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:36:22.280Z] [LOG] Created payroll_record_component: 074f1cfa-e1c2-4b4f-8f3d-c028773511c3 for Base Salary
[2025-10-23T15:36:22.280Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 29999.505000000005
}
[2025-10-23T15:36:22.470Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:36:22.686Z] [LOG] Created payroll_record_component: 1a9ac6de-0e5e-41f1-893d-6b4841476984 for Attendance Shortfall (Info)
[2025-10-23T15:36:23.311Z] [LOG] ✅ Financial balances updated successfully for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-23T15:36:23.312Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:36:23.312Z] [LOG] 
======================================================================
[2025-10-23T15:36:23.312Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Kaushal Thambi
[2025-10-23T15:36:23.312Z] [LOG] ======================================================================
[2025-10-23T15:36:23.312Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:36:23.313Z] [LOG]    Actual Earned Base (Attendance-based): Rs.6965.94
[2025-10-23T15:36:23.313Z] [LOG]    Attendance Shortfall: Rs.29999.51
[2025-10-23T15:36:23.313Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:23.313Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:23.314Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:36:23.314Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:23.314Z] [LOG]    GROSS SALARY: Rs.6965.94
[2025-10-23T15:36:23.314Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:23.315Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:36:23.315Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:36:23.315Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:36:23.315Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:36:23.316Z] [LOG]       - Attendance Shortfall (Info): Rs.29999.51
[2025-10-23T15:36:23.316Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:23.316Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:23.316Z] [LOG]    NET SALARY: Rs.6965.94
[2025-10-23T15:36:23.316Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:36:23.316Z] [LOG] ======================================================================

[2025-10-23T15:36:23.316Z] [LOG] ✅ Kaushal Thambi: Calculation completed successfully
[2025-10-23T15:36:23.317Z] [LOG] 📊 Progress: 1/34 (2.9%)
[2025-10-23T15:36:23.317Z] [LOG] 
🧮 Processing: Waruni null (EMP000024)
[2025-10-23T15:36:23.317Z] [LOG] 📋 Record ID: 0b8246b0-6378-4502-b6d1-093a3e121c9d
[2025-10-23T15:36:23.317Z] [LOG] 
======================================================================
[2025-10-23T15:36:23.317Z] [LOG] 🧮 CALCULATING PAYROLL: Waruni null (EMP000024)
[2025-10-23T15:36:23.317Z] [LOG] ======================================================================
[2025-10-23T15:36:24.179Z] [LOG] 🔍 Component filtering for employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-23T15:36:24.179Z] [LOG]    Total components: 13
[2025-10-23T15:36:24.179Z] [LOG]    Applicable components: 13
[2025-10-23T15:36:24.180Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T15:36:25.412Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:36:25.412Z] [LOG] 🔄 Processing financial records for employee 0143e40c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:36:25.655Z] [LOG] 📊 Found 0 active loans for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:25.888Z] [LOG] 📊 Found 0 active advances for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:26.113Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:26.113Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:36:26.114Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:36:26.311Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:36:26.312Z] [LOG]    Employee ID: 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:26.312Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:36:26.312Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:36:26.312Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:36:26.561Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:36:26.565Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:36:26.566Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:36:26.566Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:36:26.566Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:36:26.566Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:36:26.567Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:36:27.178Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:36:27.178Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:36:27.417Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:36:27.418Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:36:27.418Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:36:27.418Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:36:27.418Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:36:27.418Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:36:27.419Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:36:27.419Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:36:27.646Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:36:27.647Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:36:27.647Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:36:27.647Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:36:27.872Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:36:27.873Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:36:27.873Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:36:27.873Z] [LOG]       Current Time: 21:06:27
[2025-10-23T15:36:27.873Z] [LOG]       Expected Hours (scheduled → now): 12.61h
[2025-10-23T15:36:27.873Z] [LOG]       Actual Hours (check-in → now): 12.61h
[2025-10-23T15:36:27.874Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:36:27.874Z] [LOG]       Weekday: 131.61h
[2025-10-23T15:36:27.874Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:36:27.874Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:27.874Z] [LOG]       Total Expected: 145.11h
[2025-10-23T15:36:27.874Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:36:27.875Z] [LOG]       Weekday: 38.11h (includes 12.61h live)
[2025-10-23T15:36:27.875Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:36:27.875Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:27.875Z] [LOG]       Total Actual: 42.61h
[2025-10-23T15:36:27.875Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:36:27.875Z] [LOG]       Weekday: 131.61h × Rs.235.29 = Rs.30965.99
[2025-10-23T15:36:27.875Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:36:27.876Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:27.876Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:27.876Z] [LOG]       Total Expected Earned: Rs.36965.93
[2025-10-23T15:36:27.876Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:36:27.876Z] [LOG]       Weekday: 38.11h × Rs.235.29 = Rs.8966.37
[2025-10-23T15:36:27.876Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:36:27.877Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:27.877Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:27.877Z] [LOG]       Total Actual Earned: Rs.10966.35
[2025-10-23T15:36:27.878Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:36:27.878Z] [LOG]       Calculated At: Oct 23, 2025, 21:06:27
[2025-10-23T15:36:27.878Z] [LOG]       Expected Earned (until NOW): Rs.36965.93
[2025-10-23T15:36:27.878Z] [LOG]       Actual Earned (until NOW): Rs.10966.35
[2025-10-23T15:36:27.879Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:27.879Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T15:36:27.879Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:36:27.879Z] [LOG]       📉 Shortfall: 102.50 hours (70.33% of expected)
[2025-10-23T15:36:27.880Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:36:27.880Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:36:27.880Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:36:27.881Z] [LOG]    Actual Earned Base: Rs.10966.35
[2025-10-23T15:36:27.881Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:36:27.882Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:36:27.883Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:36:27.883Z] [LOG]    Gross Salary: 10966.350667466666
[2025-10-23T15:36:27.884Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:36:27.885Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:36:27.885Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.886Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:36:27.886Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.886Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:36:27.886Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.887Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:36:27.887Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.887Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:36:27.888Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.888Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:36:27.888Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.889Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:36:27.889Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.889Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:36:27.889Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.889Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:36:27.890Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.890Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:36:27.890Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.890Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:36:27.891Z] [LOG]    EPF/ETF calculated on: Rs.10966.35
[2025-10-23T15:36:27.891Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:36:27.891Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:36:27.891Z] [LOG] 💰 GROSS CALCULATION for Waruni null:
[2025-10-23T15:36:27.892Z] [LOG]    Base Salary: 50000
[2025-10-23T15:36:27.892Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:36:27.892Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:36:27.892Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.892Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:36:27.893Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:27.893Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:36:27.893Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:28.110Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:36:28.111Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:28.111Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:36:28.112Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:36:28.112Z] [LOG]    Actual Earned Base: Rs.10966.35
[2025-10-23T15:36:28.112Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:36:28.112Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:36:28.113Z] [LOG]    = Gross Salary: Rs.10966.35
[2025-10-23T15:36:28.113Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:36:28.113Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:36:28.113Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:36:28.114Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:28.114Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:36:28.114Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:36:28.115Z] [LOG]    Gross Salary: Rs.10966.35
[2025-10-23T15:36:28.116Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:36:28.116Z] [LOG]    = NET SALARY: Rs.10966.35
[2025-10-23T15:36:28.116Z] [LOG] 
💾 Database Update:
[2025-10-23T15:36:28.117Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:36:28.117Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:36:28.356Z] [LOG] 
📝 Components to save:
[2025-10-23T15:36:28.356Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:36:28.356Z] [LOG]    Deduction components: 1
[2025-10-23T15:36:28.357Z] [LOG] Creating components for record 0b8246b0-6378-4502-b6d1-093a3e121c9d: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:36:28.357Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10966.350667466666
}
[2025-10-23T15:36:28.556Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:36:28.757Z] [LOG] Created payroll_record_component: 31d4168d-5713-455c-af9a-8ff064cc24d6 for Base Salary
[2025-10-23T15:36:28.757Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T15:36:28.956Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:36:29.163Z] [LOG] Created payroll_record_component: 36d21ba8-ab1b-4c45-9c75-f42f4bbb1f62 for Attendance Shortfall (Info)
[2025-10-23T15:36:29.562Z] [LOG] ✅ Financial balances updated successfully for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:29.562Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:36:29.563Z] [LOG] 
======================================================================
[2025-10-23T15:36:29.563Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Waruni null
[2025-10-23T15:36:29.563Z] [LOG] ======================================================================
[2025-10-23T15:36:29.564Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:36:29.564Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10966.35
[2025-10-23T15:36:29.564Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:36:29.565Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:29.565Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:29.565Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:36:29.566Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:29.566Z] [LOG]    GROSS SALARY: Rs.10966.35
[2025-10-23T15:36:29.567Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:29.567Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:36:29.567Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:36:29.568Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:36:29.568Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:36:29.568Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:36:29.568Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:29.569Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:29.569Z] [LOG]    NET SALARY: Rs.10966.35
[2025-10-23T15:36:29.570Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:36:29.570Z] [LOG] ======================================================================

[2025-10-23T15:36:29.570Z] [LOG] ✅ Waruni null: Calculation completed successfully
[2025-10-23T15:36:29.571Z] [LOG] 📊 Progress: 2/34 (5.9%)
[2025-10-23T15:36:29.571Z] [LOG] 
🧮 Processing: Sithira null (EMP000039)
[2025-10-23T15:36:29.572Z] [LOG] 📋 Record ID: 13115a61-e2fb-4f62-9a1e-4354cda20bea
[2025-10-23T15:36:29.572Z] [LOG] 
======================================================================
[2025-10-23T15:36:29.572Z] [LOG] 🧮 CALCULATING PAYROLL: Sithira null (EMP000039)
[2025-10-23T15:36:29.573Z] [LOG] ======================================================================
[2025-10-23T15:36:30.461Z] [LOG] 🔍 Component filtering for employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-23T15:36:30.461Z] [LOG]    Total components: 13
[2025-10-23T15:36:30.461Z] [LOG]    Applicable components: 13
[2025-10-23T15:36:30.462Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T15:36:31.659Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:36:31.660Z] [LOG] 🔄 Processing financial records for employee 01441e19-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:36:31.871Z] [LOG] 📊 Found 0 active loans for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:32.097Z] [LOG] 📊 Found 0 active advances for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:32.308Z] [LOG] 📊 Found 0 approved bonuses for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:32.308Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:36:32.309Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:36:32.510Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:36:32.511Z] [LOG]    Employee ID: 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:32.511Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:36:32.511Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:36:32.512Z] [LOG]    Base Salary (Full Month): Rs.40000.00
[2025-10-23T15:36:32.721Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:36:32.721Z] [LOG]       Daily Salary: Rs.1600.00
[2025-10-23T15:36:32.721Z] [LOG]       Weekday Hourly Rate: Rs.188.24
[2025-10-23T15:36:32.721Z] [LOG]       Saturday Hourly Rate: Rs.355.56
[2025-10-23T15:36:32.722Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:36:32.722Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:36:32.722Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:36:33.310Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:36:33.311Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:36:33.519Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:36:33.520Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:36:33.520Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:36:33.521Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:36:33.521Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:36:33.521Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:36:33.521Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:36:33.522Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:36:33.718Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:36:33.718Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:36:33.719Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:36:33.719Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:36:33.918Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:36:33.918Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:36:33.919Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:36:33.919Z] [LOG]       Current Time: 21:06:33
[2025-10-23T15:36:33.919Z] [LOG]       Expected Hours (scheduled → now): 12.61h
[2025-10-23T15:36:33.920Z] [LOG]       Actual Hours (check-in → now): 12.61h
[2025-10-23T15:36:33.920Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:36:33.920Z] [LOG]       Weekday: 131.61h
[2025-10-23T15:36:33.920Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:36:33.921Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:33.921Z] [LOG]       Total Expected: 145.11h
[2025-10-23T15:36:33.921Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:36:33.921Z] [LOG]       Weekday: 38.11h (includes 12.61h live)
[2025-10-23T15:36:33.922Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:36:33.922Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:33.922Z] [LOG]       Total Actual: 42.61h
[2025-10-23T15:36:33.922Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:36:33.923Z] [LOG]       Weekday: 131.61h × Rs.188.24 = Rs.24774.16
[2025-10-23T15:36:33.923Z] [LOG]       Saturday: 13.50h × Rs.355.56 = Rs.4800.06
[2025-10-23T15:36:33.923Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:33.923Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:33.923Z] [LOG]       Total Expected Earned: Rs.29574.22
[2025-10-23T15:36:33.923Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:36:33.924Z] [LOG]       Weekday: 38.11h × Rs.188.24 = Rs.7173.72
[2025-10-23T15:36:33.925Z] [LOG]       Saturday: 4.50h × Rs.355.56 = Rs.1600.02
[2025-10-23T15:36:33.925Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:33.925Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:33.925Z] [LOG]       Total Actual Earned: Rs.8773.74
[2025-10-23T15:36:33.926Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:36:33.926Z] [LOG]       Calculated At: Oct 23, 2025, 21:06:33
[2025-10-23T15:36:33.926Z] [LOG]       Expected Earned (until NOW): Rs.29574.22
[2025-10-23T15:36:33.926Z] [LOG]       Actual Earned (until NOW): Rs.8773.74
[2025-10-23T15:36:33.927Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:33.927Z] [LOG]       Attendance Deduction: Rs.20800.48
[2025-10-23T15:36:33.927Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:36:33.927Z] [LOG]       📉 Shortfall: 102.50 hours (70.33% of expected)
[2025-10-23T15:36:33.927Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:36:33.928Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:36:33.928Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T15:36:33.928Z] [LOG]    Actual Earned Base: Rs.8773.74
[2025-10-23T15:36:33.928Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T15:36:33.929Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:36:33.929Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:36:33.929Z] [LOG]    Gross Salary: 8773.737534533333
[2025-10-23T15:36:33.930Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:36:33.930Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:36:33.931Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.932Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:36:33.933Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.933Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:36:33.934Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.934Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:36:33.934Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.934Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:36:33.935Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.935Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:36:33.935Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.935Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:36:33.935Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.935Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:36:33.936Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.936Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:36:33.936Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.936Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:36:33.936Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.937Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:36:33.937Z] [LOG]    EPF/ETF calculated on: Rs.8773.74
[2025-10-23T15:36:33.938Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:36:33.938Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:36:33.939Z] [LOG] 💰 GROSS CALCULATION for Sithira null:
[2025-10-23T15:36:33.939Z] [LOG]    Base Salary: 40000
[2025-10-23T15:36:33.939Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:36:33.939Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:36:33.940Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.940Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:36:33.940Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:33.940Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:36:33.940Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:34.159Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:36:34.160Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:34.160Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:36:34.160Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:36:34.161Z] [LOG]    Actual Earned Base: Rs.8773.74
[2025-10-23T15:36:34.161Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:36:34.161Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:36:34.162Z] [LOG]    = Gross Salary: Rs.8773.74
[2025-10-23T15:36:34.162Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:36:34.163Z] [LOG]    Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T15:36:34.163Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:36:34.163Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:34.164Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:36:34.164Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:36:34.164Z] [LOG]    Gross Salary: Rs.8773.74
[2025-10-23T15:36:34.164Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:36:34.165Z] [LOG]    = NET SALARY: Rs.8773.74
[2025-10-23T15:36:34.165Z] [LOG] 
💾 Database Update:
[2025-10-23T15:36:34.166Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:36:34.166Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:36:34.383Z] [LOG] 
📝 Components to save:
[2025-10-23T15:36:34.384Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:36:34.384Z] [LOG]    Deduction components: 1
[2025-10-23T15:36:34.384Z] [LOG] Creating components for record 13115a61-e2fb-4f62-9a1e-4354cda20bea: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:36:34.385Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8773.737534533333
}
[2025-10-23T15:36:34.590Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:36:34.782Z] [LOG] Created payroll_record_component: b8a09f44-1264-42cd-9eb9-7b5ee2ab7c55 for Base Salary
[2025-10-23T15:36:34.783Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 20800.480000000003
}
[2025-10-23T15:36:34.991Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:36:35.201Z] [LOG] Created payroll_record_component: 2c898ed5-2c41-4b4a-b069-f0acad72ad2e for Attendance Shortfall (Info)
[2025-10-23T15:36:35.611Z] [LOG] ✅ Financial balances updated successfully for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:35.611Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:36:35.611Z] [LOG] 
======================================================================
[2025-10-23T15:36:35.611Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sithira null
[2025-10-23T15:36:35.612Z] [LOG] ======================================================================
[2025-10-23T15:36:35.612Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T15:36:35.612Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8773.74
[2025-10-23T15:36:35.612Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T15:36:35.612Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:35.612Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:35.612Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:36:35.613Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:35.613Z] [LOG]    GROSS SALARY: Rs.8773.74
[2025-10-23T15:36:35.613Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:35.613Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:36:35.613Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:36:35.613Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:36:35.614Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:36:35.614Z] [LOG]       - Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T15:36:35.614Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:35.614Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:35.614Z] [LOG]    NET SALARY: Rs.8773.74
[2025-10-23T15:36:35.614Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:36:35.614Z] [LOG] ======================================================================

[2025-10-23T15:36:35.615Z] [LOG] ✅ Sithira null: Calculation completed successfully
[2025-10-23T15:36:35.615Z] [LOG] 📊 Progress: 3/34 (8.8%)
[2025-10-23T15:36:35.615Z] [LOG] 
🧮 Processing: Rasanga null (EMP000028)
[2025-10-23T15:36:35.615Z] [LOG] 📋 Record ID: 19f7225e-3339-42a2-b32f-a0686ec08756
[2025-10-23T15:36:35.616Z] [LOG] 
======================================================================
[2025-10-23T15:36:35.616Z] [LOG] 🧮 CALCULATING PAYROLL: Rasanga null (EMP000028)
[2025-10-23T15:36:35.617Z] [LOG] ======================================================================
[2025-10-23T15:36:36.459Z] [LOG] 🔍 Component filtering for employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-23T15:36:36.460Z] [LOG]    Total components: 13
[2025-10-23T15:36:36.460Z] [LOG]    Applicable components: 13
[2025-10-23T15:36:36.460Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T15:36:38.074Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:36:38.074Z] [LOG] 🔄 Processing financial records for employee 0143eaec-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:36:38.273Z] [LOG] 📊 Found 0 active loans for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:38.481Z] [LOG] 📊 Found 0 active advances for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:38.679Z] [LOG] 📊 Found 0 approved bonuses for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:38.679Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:36:38.680Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:36:38.894Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:36:38.895Z] [LOG]    Employee ID: 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:38.895Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:36:38.895Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:36:38.896Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:36:39.099Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:36:39.100Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:36:39.100Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:36:39.101Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:36:39.101Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:36:39.101Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:36:39.102Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:36:39.691Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:36:39.692Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:36:39.924Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:36:39.925Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:36:39.926Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:36:39.927Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:36:39.927Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:36:39.927Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:36:39.929Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:36:39.930Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:36:40.159Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:36:40.160Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:36:40.160Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:36:40.160Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:36:40.374Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:36:40.375Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:36:40.375Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:36:40.376Z] [LOG]       Current Time: 21:06:40
[2025-10-23T15:36:40.377Z] [LOG]       Expected Hours (scheduled → now): 12.61h
[2025-10-23T15:36:40.377Z] [LOG]       Actual Hours (check-in → now): 12.61h
[2025-10-23T15:36:40.377Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:36:40.378Z] [LOG]       Weekday: 131.61h
[2025-10-23T15:36:40.378Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:36:40.378Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:40.378Z] [LOG]       Total Expected: 145.11h
[2025-10-23T15:36:40.379Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:36:40.379Z] [LOG]       Weekday: 38.11h (includes 12.61h live)
[2025-10-23T15:36:40.379Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:36:40.380Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:40.380Z] [LOG]       Total Actual: 42.61h
[2025-10-23T15:36:40.380Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:36:40.380Z] [LOG]       Weekday: 131.61h × Rs.235.29 = Rs.30966.80
[2025-10-23T15:36:40.381Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:36:40.381Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:40.382Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:40.383Z] [LOG]       Total Expected Earned: Rs.36966.74
[2025-10-23T15:36:40.383Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:36:40.383Z] [LOG]       Weekday: 38.11h × Rs.235.29 = Rs.8967.19
[2025-10-23T15:36:40.383Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:36:40.384Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:40.384Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:40.384Z] [LOG]       Total Actual Earned: Rs.10967.17
[2025-10-23T15:36:40.385Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:36:40.385Z] [LOG]       Calculated At: Oct 23, 2025, 21:06:40
[2025-10-23T15:36:40.386Z] [LOG]       Expected Earned (until NOW): Rs.36966.74
[2025-10-23T15:36:40.386Z] [LOG]       Actual Earned (until NOW): Rs.10967.17
[2025-10-23T15:36:40.386Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:40.386Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T15:36:40.386Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:36:40.386Z] [LOG]       📉 Shortfall: 102.50 hours (70.33% of expected)
[2025-10-23T15:36:40.387Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:36:40.387Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:36:40.387Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:36:40.388Z] [LOG]    Actual Earned Base: Rs.10967.17
[2025-10-23T15:36:40.388Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:36:40.388Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:36:40.389Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:36:40.389Z] [LOG]    Gross Salary: 10967.16777735
[2025-10-23T15:36:40.389Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:36:40.390Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:36:40.390Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.390Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:36:40.390Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.391Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:36:40.391Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.391Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:36:40.392Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.392Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:36:40.392Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.393Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:36:40.393Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.393Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:36:40.394Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.394Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:36:40.394Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.395Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:36:40.395Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.395Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:36:40.396Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.396Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:36:40.396Z] [LOG]    EPF/ETF calculated on: Rs.10967.17
[2025-10-23T15:36:40.397Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:36:40.397Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:36:40.397Z] [LOG] 💰 GROSS CALCULATION for Rasanga null:
[2025-10-23T15:36:40.398Z] [LOG]    Base Salary: 50000
[2025-10-23T15:36:40.398Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:36:40.399Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:36:40.399Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.399Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:36:40.399Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.400Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:36:40.400Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:40.611Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:36:40.612Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:40.612Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:36:40.612Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:36:40.612Z] [LOG]    Actual Earned Base: Rs.10967.17
[2025-10-23T15:36:40.613Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:36:40.613Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:36:40.613Z] [LOG]    = Gross Salary: Rs.10967.17
[2025-10-23T15:36:40.614Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:36:40.614Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:36:40.614Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:36:40.614Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:40.615Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:36:40.615Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:36:40.616Z] [LOG]    Gross Salary: Rs.10967.17
[2025-10-23T15:36:40.616Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:36:40.616Z] [LOG]    = NET SALARY: Rs.10967.17
[2025-10-23T15:36:40.617Z] [LOG] 
💾 Database Update:
[2025-10-23T15:36:40.617Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:36:40.617Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:36:40.813Z] [LOG] 
📝 Components to save:
[2025-10-23T15:36:40.813Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:36:40.814Z] [LOG]    Deduction components: 1
[2025-10-23T15:36:40.814Z] [LOG] Creating components for record 19f7225e-3339-42a2-b32f-a0686ec08756: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:36:40.815Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10967.16777735
}
[2025-10-23T15:36:41.010Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:36:41.264Z] [LOG] Created payroll_record_component: d08391bb-422f-4e51-a3d4-4fa2c8f44b88 for Base Salary
[2025-10-23T15:36:41.265Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T15:36:41.487Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:36:41.692Z] [LOG] Created payroll_record_component: 5343986a-4d35-4468-8ba0-a83db0faa7bb for Attendance Shortfall (Info)
[2025-10-23T15:36:42.099Z] [LOG] ✅ Financial balances updated successfully for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:42.100Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:36:42.100Z] [LOG] 
======================================================================
[2025-10-23T15:36:42.100Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Rasanga null
[2025-10-23T15:36:42.101Z] [LOG] ======================================================================
[2025-10-23T15:36:42.101Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:36:42.101Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10967.17
[2025-10-23T15:36:42.102Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:36:42.102Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:42.102Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:42.103Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:36:42.103Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:42.103Z] [LOG]    GROSS SALARY: Rs.10967.17
[2025-10-23T15:36:42.104Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:42.104Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:36:42.104Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:36:42.105Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:36:42.105Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:36:42.105Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:36:42.106Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:42.106Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:42.106Z] [LOG]    NET SALARY: Rs.10967.17
[2025-10-23T15:36:42.107Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:36:42.107Z] [LOG] ======================================================================

[2025-10-23T15:36:42.107Z] [LOG] ✅ Rasanga null: Calculation completed successfully
[2025-10-23T15:36:42.108Z] [LOG] 📊 Progress: 4/34 (11.8%)
[2025-10-23T15:36:42.108Z] [LOG] 
🧮 Processing: Saruban null (EMP000007)
[2025-10-23T15:36:42.108Z] [LOG] 📋 Record ID: 2043c5c0-77f9-4927-885c-785b5bb23761
[2025-10-23T15:36:42.109Z] [LOG] 
======================================================================
[2025-10-23T15:36:42.109Z] [LOG] 🧮 CALCULATING PAYROLL: Saruban null (EMP000007)
[2025-10-23T15:36:42.109Z] [LOG] ======================================================================
[2025-10-23T15:36:42.913Z] [LOG] 🔍 Component filtering for employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-23T15:36:42.913Z] [LOG]    Total components: 13
[2025-10-23T15:36:42.914Z] [LOG]    Applicable components: 13
[2025-10-23T15:36:42.914Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T15:36:44.351Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:36:44.351Z] [LOG] 🔄 Processing financial records for employee 0143a6e3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:36:44.557Z] [LOG] 📊 Found 0 active loans for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:44.751Z] [LOG] 📊 Found 0 active advances for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:45.002Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:45.003Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:36:45.003Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:36:45.213Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:36:45.214Z] [LOG]    Employee ID: 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:45.214Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:36:45.214Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:36:45.214Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-23T15:36:45.414Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:36:45.414Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-23T15:36:45.414Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T15:36:45.415Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-23T15:36:45.415Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:36:45.416Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:36:45.416Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:36:46.212Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:36:46.213Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:36:46.432Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:36:46.432Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:36:46.432Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:36:46.433Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:36:46.433Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:36:46.433Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:36:46.433Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:36:46.434Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:36:46.656Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:36:46.656Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:36:46.657Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:36:46.657Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:36:46.872Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:36:46.873Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:36:46.873Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:36:46.874Z] [LOG]       Current Time: 21:06:46
[2025-10-23T15:36:46.874Z] [LOG]       Expected Hours (scheduled → now): 12.61h
[2025-10-23T15:36:46.874Z] [LOG]       Actual Hours (check-in → now): 12.61h
[2025-10-23T15:36:46.875Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:36:46.875Z] [LOG]       Weekday: 131.61h
[2025-10-23T15:36:46.875Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:36:46.876Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:46.876Z] [LOG]       Total Expected: 145.11h
[2025-10-23T15:36:46.876Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:36:46.876Z] [LOG]       Weekday: 38.11h (includes 12.61h live)
[2025-10-23T15:36:46.877Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:36:46.877Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:46.877Z] [LOG]       Total Actual: 42.61h
[2025-10-23T15:36:46.877Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:36:46.878Z] [LOG]       Weekday: 131.61h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:46.878Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:46.878Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:46.879Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:46.879Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-23T15:36:46.879Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:36:46.880Z] [LOG]       Weekday: 38.11h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:46.880Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:46.880Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:46.881Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:46.881Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-23T15:36:46.882Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:36:46.883Z] [LOG]       Calculated At: Oct 23, 2025, 21:06:46
[2025-10-23T15:36:46.883Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-23T15:36:46.884Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-23T15:36:46.884Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:46.884Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-23T15:36:46.885Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:36:46.885Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-23T15:36:46.885Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:36:46.886Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:36:46.886Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T15:36:46.887Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T15:36:46.887Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T15:36:46.887Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:36:46.888Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:36:46.888Z] [LOG]    Gross Salary: 0
[2025-10-23T15:36:46.888Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:36:46.888Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:36:46.888Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.889Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:36:46.889Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.889Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:36:46.890Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.890Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:36:46.890Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.890Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:36:46.891Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.891Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:36:46.891Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.892Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:36:46.892Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.892Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:36:46.892Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.893Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:36:46.893Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.893Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:36:46.894Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.894Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:36:46.894Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-23T15:36:46.895Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:36:46.895Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:36:46.895Z] [LOG] 💰 GROSS CALCULATION for Saruban null:
[2025-10-23T15:36:46.895Z] [LOG]    Base Salary: 0
[2025-10-23T15:36:46.896Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:36:46.896Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:36:46.896Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.897Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:36:46.897Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:46.897Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:36:46.898Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:47.118Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:36:47.119Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:47.119Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:36:47.119Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:36:47.120Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T15:36:47.120Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:36:47.120Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:36:47.121Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-23T15:36:47.121Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:36:47.122Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:36:47.122Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:47.122Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:36:47.122Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:36:47.123Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-23T15:36:47.123Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:36:47.123Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-23T15:36:47.123Z] [LOG] 
💾 Database Update:
[2025-10-23T15:36:47.124Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:36:47.124Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:36:47.320Z] [LOG] 
📝 Components to save:
[2025-10-23T15:36:47.321Z] [LOG]    Gross/Earnings components: 0
[2025-10-23T15:36:47.321Z] [LOG]    Deduction components: 0
[2025-10-23T15:36:47.321Z] [LOG] Creating components for record 2043c5c0-77f9-4927-885c-785b5bb23761: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-23T15:36:47.770Z] [LOG] ✅ Financial balances updated successfully for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:47.770Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:36:47.771Z] [LOG] 
======================================================================
[2025-10-23T15:36:47.771Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Saruban null
[2025-10-23T15:36:47.771Z] [LOG] ======================================================================
[2025-10-23T15:36:47.772Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T15:36:47.772Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-23T15:36:47.773Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T15:36:47.773Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:47.773Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:47.774Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:36:47.774Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:47.774Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-23T15:36:47.775Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:47.775Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:36:47.776Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:36:47.776Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:36:47.776Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:36:47.777Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-23T15:36:47.777Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:47.777Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:47.778Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-23T15:36:47.778Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:36:47.778Z] [LOG] ======================================================================

[2025-10-23T15:36:47.779Z] [LOG] ✅ Saruban null: Calculation completed successfully
[2025-10-23T15:36:47.779Z] [LOG] 📊 Progress: 5/34 (14.7%)
[2025-10-23T15:36:47.779Z] [LOG] 
🧮 Processing: Ruvindu Hewabandu null (EMP000027)
[2025-10-23T15:36:47.780Z] [LOG] 📋 Record ID: 26f98b9f-6bcc-45e8-bf2a-329db49c1e75
[2025-10-23T15:36:47.780Z] [LOG] 
======================================================================
[2025-10-23T15:36:47.780Z] [LOG] 🧮 CALCULATING PAYROLL: Ruvindu Hewabandu null (EMP000027)
[2025-10-23T15:36:47.781Z] [LOG] ======================================================================
[2025-10-23T15:36:48.593Z] [LOG] 🔍 Component filtering for employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-23T15:36:48.593Z] [LOG]    Total components: 13
[2025-10-23T15:36:48.594Z] [LOG]    Applicable components: 13
[2025-10-23T15:36:48.594Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T15:36:49.811Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:36:49.811Z] [LOG] 🔄 Processing financial records for employee 0143e915-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:36:50.028Z] [LOG] 📊 Found 0 active loans for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:50.256Z] [LOG] 📊 Found 0 active advances for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:50.451Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:50.452Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:36:50.452Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:36:50.658Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:36:50.658Z] [LOG]    Employee ID: 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:50.659Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:36:50.659Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:36:50.659Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-23T15:36:50.880Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:36:50.880Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-23T15:36:50.880Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T15:36:50.881Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-23T15:36:50.881Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:36:50.881Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:36:50.882Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:36:51.488Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:36:51.488Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:36:51.692Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:36:51.692Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:36:51.693Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:36:51.693Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:36:51.693Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:36:51.694Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:36:51.694Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:36:51.694Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:36:51.892Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:36:51.892Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:36:51.892Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:36:51.893Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:36:52.092Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:36:52.092Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:36:52.092Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:36:52.093Z] [LOG]       Current Time: 21:06:52
[2025-10-23T15:36:52.094Z] [LOG]       Expected Hours (scheduled → now): 12.61h
[2025-10-23T15:36:52.094Z] [LOG]       Actual Hours (check-in → now): 12.61h
[2025-10-23T15:36:52.094Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:36:52.095Z] [LOG]       Weekday: 131.61h
[2025-10-23T15:36:52.095Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:36:52.095Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:52.095Z] [LOG]       Total Expected: 145.11h
[2025-10-23T15:36:52.096Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:36:52.096Z] [LOG]       Weekday: 38.11h (includes 12.61h live)
[2025-10-23T15:36:52.096Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:36:52.097Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:52.097Z] [LOG]       Total Actual: 42.61h
[2025-10-23T15:36:52.097Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:36:52.098Z] [LOG]       Weekday: 131.61h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:52.098Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:52.098Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:52.099Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:52.099Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-23T15:36:52.100Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:36:52.100Z] [LOG]       Weekday: 38.11h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:52.100Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:52.101Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:52.101Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:52.101Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-23T15:36:52.102Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:36:52.102Z] [LOG]       Calculated At: Oct 23, 2025, 21:06:52
[2025-10-23T15:36:52.103Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-23T15:36:52.103Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-23T15:36:52.103Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:52.104Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-23T15:36:52.104Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:36:52.105Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-23T15:36:52.105Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:36:52.105Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:36:52.106Z] [LOG]    Base Salary (Full): Rs.NaN
[2025-10-23T15:36:52.107Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T15:36:52.107Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T15:36:52.107Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:36:52.107Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:36:52.108Z] [LOG]    Gross Salary: 0
[2025-10-23T15:36:52.108Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:36:52.108Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:36:52.108Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.109Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:36:52.109Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.109Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:36:52.110Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.110Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:36:52.110Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.111Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:36:52.111Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.111Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:36:52.112Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.112Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:36:52.112Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.112Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:36:52.113Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.113Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:36:52.113Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.114Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:36:52.114Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.114Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:36:52.115Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-23T15:36:52.115Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:36:52.116Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:36:52.116Z] [LOG] 💰 GROSS CALCULATION for Ruvindu Hewabandu null:
[2025-10-23T15:36:52.116Z] [LOG]    Base Salary: 0
[2025-10-23T15:36:52.116Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:36:52.116Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:36:52.116Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.116Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:36:52.116Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.117Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:36:52.117Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:52.320Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:36:52.320Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:52.320Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:36:52.321Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:36:52.321Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T15:36:52.321Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:36:52.322Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:36:52.322Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-23T15:36:52.323Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:36:52.323Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:36:52.323Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:52.324Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:36:52.324Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:36:52.324Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-23T15:36:52.325Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:36:52.325Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-23T15:36:52.325Z] [LOG] 
💾 Database Update:
[2025-10-23T15:36:52.326Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:36:52.326Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:36:52.540Z] [LOG] 
📝 Components to save:
[2025-10-23T15:36:52.541Z] [LOG]    Gross/Earnings components: 0
[2025-10-23T15:36:52.541Z] [LOG]    Deduction components: 0
[2025-10-23T15:36:52.542Z] [LOG] Creating components for record 26f98b9f-6bcc-45e8-bf2a-329db49c1e75: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-23T15:36:52.991Z] [LOG] ✅ Financial balances updated successfully for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:52.992Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:36:52.992Z] [LOG] 
======================================================================
[2025-10-23T15:36:52.992Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ruvindu Hewabandu null
[2025-10-23T15:36:52.993Z] [LOG] ======================================================================
[2025-10-23T15:36:52.993Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T15:36:52.993Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-23T15:36:52.994Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T15:36:52.994Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:52.994Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:52.995Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:36:52.995Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:52.995Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-23T15:36:52.996Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:52.996Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:36:52.996Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:36:52.997Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:36:52.997Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:36:52.997Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-23T15:36:52.998Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:52.998Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:52.998Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-23T15:36:52.999Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:36:52.999Z] [LOG] ======================================================================

[2025-10-23T15:36:53.000Z] [LOG] ✅ Ruvindu Hewabandu null: Calculation completed successfully
[2025-10-23T15:36:53.000Z] [LOG] 📊 Progress: 6/34 (17.6%)
[2025-10-23T15:36:53.000Z] [LOG] 
🧮 Processing: Faizan Faizan (EMP000003)
[2025-10-23T15:36:53.001Z] [LOG] 📋 Record ID: 2b304eb5-f5b2-4c18-9a53-4d02cee34730
[2025-10-23T15:36:53.001Z] [LOG] 
======================================================================
[2025-10-23T15:36:53.001Z] [LOG] 🧮 CALCULATING PAYROLL: Faizan Faizan (EMP000003)
[2025-10-23T15:36:53.002Z] [LOG] ======================================================================
[2025-10-23T15:36:53.820Z] [LOG] 🔍 Component filtering for employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-23T15:36:53.820Z] [LOG]    Total components: 13
[2025-10-23T15:36:53.821Z] [LOG]    Applicable components: 13
[2025-10-23T15:36:53.821Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T15:36:55.450Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:36:55.451Z] [LOG] 🔄 Processing financial records for employee 0143a057-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:36:55.659Z] [LOG] 📊 Found 0 active loans for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:55.859Z] [LOG] 📊 Found 0 active advances for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:56.055Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:56.055Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:36:56.056Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:36:56.261Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:36:56.261Z] [LOG]    Employee ID: 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:56.261Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:36:56.262Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:36:56.262Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:36:56.506Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:36:56.506Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:36:56.506Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:36:56.506Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:36:56.507Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:36:56.507Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:36:56.507Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:36:57.113Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:36:57.113Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:36:57.328Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:36:57.328Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:36:57.328Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:36:57.329Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:36:57.329Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:36:57.329Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:36:57.330Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:36:57.330Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:36:57.530Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:36:57.531Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:36:57.531Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:36:57.532Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:36:57.756Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:36:57.757Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:36:57.757Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:36:57.758Z] [LOG]       Current Time: 21:06:57
[2025-10-23T15:36:57.758Z] [LOG]       Expected Hours (scheduled → now): 12.62h
[2025-10-23T15:36:57.759Z] [LOG]       Actual Hours (check-in → now): 12.62h
[2025-10-23T15:36:57.759Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:36:57.759Z] [LOG]       Weekday: 131.62h
[2025-10-23T15:36:57.759Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:36:57.760Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:57.760Z] [LOG]       Total Expected: 145.12h
[2025-10-23T15:36:57.760Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:36:57.760Z] [LOG]       Weekday: 38.12h (includes 12.62h live)
[2025-10-23T15:36:57.761Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:36:57.761Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:36:57.761Z] [LOG]       Total Actual: 42.62h
[2025-10-23T15:36:57.762Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:36:57.762Z] [LOG]       Weekday: 131.62h × Rs.235.29 = Rs.30967.94
[2025-10-23T15:36:57.762Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:36:57.763Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:57.763Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:57.763Z] [LOG]       Total Expected Earned: Rs.36967.88
[2025-10-23T15:36:57.764Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:36:57.764Z] [LOG]       Weekday: 38.12h × Rs.235.29 = Rs.8968.32
[2025-10-23T15:36:57.764Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:36:57.764Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:36:57.765Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:57.766Z] [LOG]       Total Actual Earned: Rs.10968.30
[2025-10-23T15:36:57.766Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:36:57.767Z] [LOG]       Calculated At: Oct 23, 2025, 21:06:57
[2025-10-23T15:36:57.767Z] [LOG]       Expected Earned (until NOW): Rs.36967.88
[2025-10-23T15:36:57.768Z] [LOG]       Actual Earned (until NOW): Rs.10968.30
[2025-10-23T15:36:57.768Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:36:57.768Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T15:36:57.769Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:36:57.769Z] [LOG]       📉 Shortfall: 102.50 hours (70.33% of expected)
[2025-10-23T15:36:57.769Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:36:57.769Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:36:57.770Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:36:57.770Z] [LOG]    Actual Earned Base: Rs.10968.30
[2025-10-23T15:36:57.771Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:36:57.771Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:36:57.771Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:36:57.772Z] [LOG]    Gross Salary: 10968.3038359
[2025-10-23T15:36:57.772Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:36:57.772Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:36:57.772Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.772Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:36:57.773Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.773Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:36:57.773Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.774Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:36:57.774Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.774Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:36:57.774Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.775Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:36:57.775Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.775Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:36:57.776Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.776Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:36:57.776Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.777Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:36:57.777Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.777Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:36:57.777Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.778Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:36:57.778Z] [LOG]    EPF/ETF calculated on: Rs.10968.30
[2025-10-23T15:36:57.778Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:36:57.779Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:36:57.779Z] [LOG] 💰 GROSS CALCULATION for Faizan Faizan:
[2025-10-23T15:36:57.779Z] [LOG]    Base Salary: 50000
[2025-10-23T15:36:57.779Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:36:57.779Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:36:57.780Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.780Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:36:57.780Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.781Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:36:57.781Z] [LOG]    Fixed amount: 0
[2025-10-23T15:36:57.990Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:36:57.990Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:57.990Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:36:57.991Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:36:57.991Z] [LOG]    Actual Earned Base: Rs.10968.30
[2025-10-23T15:36:57.991Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:36:57.991Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:36:57.992Z] [LOG]    = Gross Salary: Rs.10968.30
[2025-10-23T15:36:57.992Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:36:57.992Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:36:57.993Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:36:57.993Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:57.993Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:36:57.993Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:36:57.994Z] [LOG]    Gross Salary: Rs.10968.30
[2025-10-23T15:36:57.994Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:36:57.994Z] [LOG]    = NET SALARY: Rs.10968.30
[2025-10-23T15:36:57.994Z] [LOG] 
💾 Database Update:
[2025-10-23T15:36:57.995Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:36:57.995Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:36:58.194Z] [LOG] 
📝 Components to save:
[2025-10-23T15:36:58.194Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:36:58.194Z] [LOG]    Deduction components: 1
[2025-10-23T15:36:58.195Z] [LOG] Creating components for record 2b304eb5-f5b2-4c18-9a53-4d02cee34730: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:36:58.195Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10968.3038359
}
[2025-10-23T15:36:58.392Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:36:58.592Z] [LOG] Created payroll_record_component: c8b8bfdd-c663-4ef0-8e22-1556493013a0 for Base Salary
[2025-10-23T15:36:58.592Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T15:36:58.811Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:36:59.020Z] [LOG] Created payroll_record_component: da8cdf7f-e92d-4020-903e-06797be16b80 for Attendance Shortfall (Info)
[2025-10-23T15:36:59.412Z] [LOG] ✅ Financial balances updated successfully for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-23T15:36:59.412Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:36:59.413Z] [LOG] 
======================================================================
[2025-10-23T15:36:59.413Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Faizan Faizan
[2025-10-23T15:36:59.413Z] [LOG] ======================================================================
[2025-10-23T15:36:59.414Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:36:59.414Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10968.30
[2025-10-23T15:36:59.414Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:36:59.415Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:59.415Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:36:59.416Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:36:59.416Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:59.416Z] [LOG]    GROSS SALARY: Rs.10968.30
[2025-10-23T15:36:59.417Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:59.417Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:36:59.417Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:36:59.418Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:36:59.418Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:36:59.418Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:36:59.419Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:36:59.419Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:36:59.419Z] [LOG]    NET SALARY: Rs.10968.30
[2025-10-23T15:36:59.420Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:36:59.420Z] [LOG] ======================================================================

[2025-10-23T15:36:59.420Z] [LOG] ✅ Faizan Faizan: Calculation completed successfully
[2025-10-23T15:36:59.420Z] [LOG] 📊 Progress: 7/34 (20.6%)
[2025-10-23T15:36:59.421Z] [LOG] 
🧮 Processing: Ishara null (EMP000011)
[2025-10-23T15:36:59.421Z] [LOG] 📋 Record ID: 31fa799d-0ab1-4cf0-a22f-dd3ae2bb3685
[2025-10-23T15:36:59.421Z] [LOG] 
======================================================================
[2025-10-23T15:36:59.422Z] [LOG] 🧮 CALCULATING PAYROLL: Ishara null (EMP000011)
[2025-10-23T15:36:59.422Z] [LOG] ======================================================================
[2025-10-23T15:37:00.214Z] [LOG] 🔍 Component filtering for employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-23T15:37:00.214Z] [LOG]    Total components: 13
[2025-10-23T15:37:00.214Z] [LOG]    Applicable components: 13
[2025-10-23T15:37:00.215Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T15:37:01.914Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:37:01.914Z] [LOG] 🔄 Processing financial records for employee 0143ac0c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:37:02.104Z] [LOG] 📊 Found 0 active loans for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:02.301Z] [LOG] 📊 Found 0 active advances for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:02.520Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:02.520Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:37:02.521Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:37:02.718Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:37:02.719Z] [LOG]    Employee ID: 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:02.719Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:37:02.719Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:37:02.719Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:37:02.933Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:37:02.934Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:37:02.934Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:37:02.934Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:37:02.934Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:37:02.935Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:37:02.935Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:37:03.582Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:37:03.583Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:37:03.822Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:37:03.822Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:37:03.823Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:37:03.823Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:37:03.823Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:37:03.823Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:37:03.824Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:37:03.824Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:37:04.056Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:37:04.057Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:37:04.057Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:37:04.057Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:37:04.278Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:37:04.279Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:37:04.279Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:37:04.280Z] [LOG]       Current Time: 21:07:04
[2025-10-23T15:37:04.280Z] [LOG]       Expected Hours (scheduled → now): 12.62h
[2025-10-23T15:37:04.281Z] [LOG]       Actual Hours (check-in → now): 12.62h
[2025-10-23T15:37:04.281Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:37:04.281Z] [LOG]       Weekday: 131.62h
[2025-10-23T15:37:04.282Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:37:04.282Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:04.283Z] [LOG]       Total Expected: 145.12h
[2025-10-23T15:37:04.283Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:37:04.283Z] [LOG]       Weekday: 38.12h (includes 12.62h live)
[2025-10-23T15:37:04.284Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:37:04.284Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:04.284Z] [LOG]       Total Actual: 42.62h
[2025-10-23T15:37:04.284Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:37:04.285Z] [LOG]       Weekday: 131.62h × Rs.235.29 = Rs.30968.37
[2025-10-23T15:37:04.285Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:37:04.286Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:04.286Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:04.286Z] [LOG]       Total Expected Earned: Rs.36968.31
[2025-10-23T15:37:04.287Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:37:04.287Z] [LOG]       Weekday: 38.12h × Rs.235.29 = Rs.8968.75
[2025-10-23T15:37:04.287Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:37:04.288Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:04.288Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:04.288Z] [LOG]       Total Actual Earned: Rs.10968.73
[2025-10-23T15:37:04.289Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:37:04.289Z] [LOG]       Calculated At: Oct 23, 2025, 21:07:04
[2025-10-23T15:37:04.290Z] [LOG]       Expected Earned (until NOW): Rs.36968.31
[2025-10-23T15:37:04.290Z] [LOG]       Actual Earned (until NOW): Rs.10968.73
[2025-10-23T15:37:04.291Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:04.291Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T15:37:04.291Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:37:04.292Z] [LOG]       📉 Shortfall: 102.50 hours (70.33% of expected)
[2025-10-23T15:37:04.292Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:37:04.293Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:37:04.293Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:04.294Z] [LOG]    Actual Earned Base: Rs.10968.73
[2025-10-23T15:37:04.294Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:37:04.294Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:37:04.295Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:37:04.295Z] [LOG]    Gross Salary: 10968.73010295
[2025-10-23T15:37:04.295Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:37:04.296Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:37:04.296Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.296Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:37:04.297Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.297Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:37:04.297Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.298Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:37:04.298Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.298Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:37:04.299Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.299Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:37:04.299Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.300Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:37:04.300Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.300Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:37:04.300Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.300Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:37:04.301Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.301Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:37:04.301Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.301Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:37:04.302Z] [LOG]    EPF/ETF calculated on: Rs.10968.73
[2025-10-23T15:37:04.302Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:37:04.302Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:37:04.303Z] [LOG] 💰 GROSS CALCULATION for Ishara null:
[2025-10-23T15:37:04.303Z] [LOG]    Base Salary: 50000
[2025-10-23T15:37:04.303Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:37:04.304Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:37:04.304Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.304Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:37:04.305Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.305Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:37:04.305Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:04.525Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:37:04.525Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:04.525Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:37:04.526Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:37:04.526Z] [LOG]    Actual Earned Base: Rs.10968.73
[2025-10-23T15:37:04.526Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:37:04.527Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:37:04.527Z] [LOG]    = Gross Salary: Rs.10968.73
[2025-10-23T15:37:04.527Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:37:04.528Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:37:04.528Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:37:04.529Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:04.529Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:37:04.529Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:37:04.530Z] [LOG]    Gross Salary: Rs.10968.73
[2025-10-23T15:37:04.530Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:37:04.530Z] [LOG]    = NET SALARY: Rs.10968.73
[2025-10-23T15:37:04.530Z] [LOG] 
💾 Database Update:
[2025-10-23T15:37:04.531Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:37:04.531Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:37:04.741Z] [LOG] 
📝 Components to save:
[2025-10-23T15:37:04.742Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:37:04.742Z] [LOG]    Deduction components: 1
[2025-10-23T15:37:04.742Z] [LOG] Creating components for record 31fa799d-0ab1-4cf0-a22f-dd3ae2bb3685: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:37:04.743Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10968.73010295
}
[2025-10-23T15:37:04.956Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:37:05.157Z] [LOG] Created payroll_record_component: b3df3d2f-8440-4bd8-b5ce-f1d092eda9ac for Base Salary
[2025-10-23T15:37:05.158Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T15:37:05.382Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:37:05.604Z] [LOG] Created payroll_record_component: 5eaf817c-3b38-4644-bd2c-0144e1572c0e for Attendance Shortfall (Info)
[2025-10-23T15:37:06.004Z] [LOG] ✅ Financial balances updated successfully for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:06.004Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:37:06.005Z] [LOG] 
======================================================================
[2025-10-23T15:37:06.005Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ishara null
[2025-10-23T15:37:06.006Z] [LOG] ======================================================================
[2025-10-23T15:37:06.006Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:06.006Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10968.73
[2025-10-23T15:37:06.007Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:37:06.007Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:06.007Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:06.007Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:37:06.008Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:06.008Z] [LOG]    GROSS SALARY: Rs.10968.73
[2025-10-23T15:37:06.009Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:06.009Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:37:06.009Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:37:06.009Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:37:06.010Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:37:06.010Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:37:06.010Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:06.011Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:06.011Z] [LOG]    NET SALARY: Rs.10968.73
[2025-10-23T15:37:06.011Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:37:06.012Z] [LOG] ======================================================================

[2025-10-23T15:37:06.012Z] [LOG] ✅ Ishara null: Calculation completed successfully
[2025-10-23T15:37:06.012Z] [LOG] 📊 Progress: 8/34 (23.5%)
[2025-10-23T15:37:06.012Z] [LOG] 
🧮 Processing: R. D.A Kaushalya null (EMP000044)
[2025-10-23T15:37:06.013Z] [LOG] 📋 Record ID: 3c1425e4-5e64-4cc4-9d1d-40e3737dfefe
[2025-10-23T15:37:06.013Z] [LOG] 
======================================================================
[2025-10-23T15:37:06.013Z] [LOG] 🧮 CALCULATING PAYROLL: R. D.A Kaushalya null (EMP000044)
[2025-10-23T15:37:06.014Z] [LOG] ======================================================================
[2025-10-23T15:37:06.879Z] [LOG] 🔍 Component filtering for employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-23T15:37:06.879Z] [LOG]    Total components: 13
[2025-10-23T15:37:06.880Z] [LOG]    Applicable components: 13
[2025-10-23T15:37:06.880Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T15:37:08.071Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:37:08.071Z] [LOG] 🔄 Processing financial records for employee 01443963-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:37:08.281Z] [LOG] 📊 Found 0 active loans for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:08.495Z] [LOG] 📊 Found 0 active advances for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:08.692Z] [LOG] 📊 Found 0 approved bonuses for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:08.692Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:37:08.693Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:37:08.899Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:37:08.900Z] [LOG]    Employee ID: 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:08.900Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:37:08.900Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:37:08.901Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:37:09.112Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:37:09.113Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:37:09.113Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:37:09.113Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:37:09.113Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:37:09.113Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:37:09.114Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:37:09.756Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:37:09.757Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:37:09.978Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:37:09.979Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:37:09.979Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:37:09.980Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:37:09.980Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:37:09.980Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:37:09.980Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:37:09.981Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:37:10.179Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:37:10.180Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:37:10.180Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:37:10.180Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:37:10.380Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:37:10.380Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:37:10.381Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:37:10.381Z] [LOG]       Current Time: 21:07:10
[2025-10-23T15:37:10.382Z] [LOG]       Expected Hours (scheduled → now): 12.62h
[2025-10-23T15:37:10.382Z] [LOG]       Actual Hours (check-in → now): 12.62h
[2025-10-23T15:37:10.382Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:37:10.383Z] [LOG]       Weekday: 131.62h
[2025-10-23T15:37:10.383Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:37:10.383Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:10.383Z] [LOG]       Total Expected: 145.12h
[2025-10-23T15:37:10.384Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:37:10.384Z] [LOG]       Weekday: 38.12h (includes 12.62h live)
[2025-10-23T15:37:10.384Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:37:10.384Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:10.385Z] [LOG]       Total Actual: 42.62h
[2025-10-23T15:37:10.385Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:37:10.385Z] [LOG]       Weekday: 131.62h × Rs.235.29 = Rs.30968.76
[2025-10-23T15:37:10.385Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:37:10.385Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:10.386Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:10.386Z] [LOG]       Total Expected Earned: Rs.36968.70
[2025-10-23T15:37:10.386Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:37:10.386Z] [LOG]       Weekday: 38.12h × Rs.235.29 = Rs.8969.15
[2025-10-23T15:37:10.387Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:37:10.387Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:10.387Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:10.388Z] [LOG]       Total Actual Earned: Rs.10969.13
[2025-10-23T15:37:10.389Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:37:10.389Z] [LOG]       Calculated At: Oct 23, 2025, 21:07:10
[2025-10-23T15:37:10.389Z] [LOG]       Expected Earned (until NOW): Rs.36968.70
[2025-10-23T15:37:10.389Z] [LOG]       Actual Earned (until NOW): Rs.10969.13
[2025-10-23T15:37:10.390Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:10.390Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T15:37:10.390Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:37:10.390Z] [LOG]       📉 Shortfall: 102.50 hours (70.33% of expected)
[2025-10-23T15:37:10.390Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:37:10.391Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:37:10.391Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:10.391Z] [LOG]    Actual Earned Base: Rs.10969.13
[2025-10-23T15:37:10.392Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:37:10.392Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:37:10.393Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:37:10.393Z] [LOG]    Gross Salary: 10969.1289195
[2025-10-23T15:37:10.393Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:37:10.394Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:37:10.394Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.394Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:37:10.394Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.394Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:37:10.395Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.395Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:37:10.395Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.395Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:37:10.395Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.395Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:37:10.395Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.395Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:37:10.396Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.396Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:37:10.397Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.397Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:37:10.398Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.398Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:37:10.399Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.399Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:37:10.400Z] [LOG]    EPF/ETF calculated on: Rs.10969.13
[2025-10-23T15:37:10.400Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:37:10.401Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:37:10.401Z] [LOG] 💰 GROSS CALCULATION for R. D.A Kaushalya null:
[2025-10-23T15:37:10.402Z] [LOG]    Base Salary: 50000
[2025-10-23T15:37:10.403Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:37:10.403Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:37:10.404Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.404Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:37:10.404Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.404Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:37:10.404Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:10.618Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:37:10.619Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:10.619Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:37:10.619Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:37:10.619Z] [LOG]    Actual Earned Base: Rs.10969.13
[2025-10-23T15:37:10.619Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:37:10.620Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:37:10.620Z] [LOG]    = Gross Salary: Rs.10969.13
[2025-10-23T15:37:10.620Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:37:10.620Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:37:10.620Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:37:10.621Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:10.621Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:37:10.621Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:37:10.621Z] [LOG]    Gross Salary: Rs.10969.13
[2025-10-23T15:37:10.622Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:37:10.622Z] [LOG]    = NET SALARY: Rs.10969.13
[2025-10-23T15:37:10.622Z] [LOG] 
💾 Database Update:
[2025-10-23T15:37:10.622Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:37:10.623Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:37:10.826Z] [LOG] 
📝 Components to save:
[2025-10-23T15:37:10.827Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:37:10.827Z] [LOG]    Deduction components: 1
[2025-10-23T15:37:10.827Z] [LOG] Creating components for record 3c1425e4-5e64-4cc4-9d1d-40e3737dfefe: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:37:10.828Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10969.1289195
}
[2025-10-23T15:37:11.031Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:37:11.274Z] [LOG] Created payroll_record_component: bd779ae6-b528-4d7e-b039-3726346e8169 for Base Salary
[2025-10-23T15:37:11.274Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T15:37:11.471Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:37:11.680Z] [LOG] Created payroll_record_component: 8985b1d8-1501-4404-a665-b1d37717af3a for Attendance Shortfall (Info)
[2025-10-23T15:37:12.074Z] [LOG] ✅ Financial balances updated successfully for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:12.075Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:37:12.075Z] [LOG] 
======================================================================
[2025-10-23T15:37:12.075Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: R. D.A Kaushalya null
[2025-10-23T15:37:12.076Z] [LOG] ======================================================================
[2025-10-23T15:37:12.076Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:12.076Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10969.13
[2025-10-23T15:37:12.076Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:37:12.077Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:12.077Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:12.077Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:37:12.077Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:12.078Z] [LOG]    GROSS SALARY: Rs.10969.13
[2025-10-23T15:37:12.078Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:12.078Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:37:12.078Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:37:12.078Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:37:12.079Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:37:12.079Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:37:12.079Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:12.079Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:12.080Z] [LOG]    NET SALARY: Rs.10969.13
[2025-10-23T15:37:12.080Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:37:12.080Z] [LOG] ======================================================================

[2025-10-23T15:37:12.080Z] [LOG] ✅ R. D.A Kaushalya null: Calculation completed successfully
[2025-10-23T15:37:12.081Z] [LOG] 📊 Progress: 9/34 (26.5%)
[2025-10-23T15:37:12.081Z] [LOG] 
🧮 Processing: Ratheeshanan null (EMP000047)
[2025-10-23T15:37:12.081Z] [LOG] 📋 Record ID: 3ec00afd-f3eb-4fca-b754-be87133c1f9f
[2025-10-23T15:37:12.081Z] [LOG] 
======================================================================
[2025-10-23T15:37:12.082Z] [LOG] 🧮 CALCULATING PAYROLL: Ratheeshanan null (EMP000047)
[2025-10-23T15:37:12.082Z] [LOG] ======================================================================
[2025-10-23T15:37:12.895Z] [LOG] 🔍 Component filtering for employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-23T15:37:12.896Z] [LOG]    Total components: 13
[2025-10-23T15:37:12.896Z] [LOG]    Applicable components: 13
[2025-10-23T15:37:12.896Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T15:37:14.149Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:37:14.150Z] [LOG] 🔄 Processing financial records for employee 01444966-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:37:14.349Z] [LOG] 📊 Found 0 active loans for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:14.557Z] [LOG] 📊 Found 0 active advances for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:14.774Z] [LOG] 📊 Found 0 approved bonuses for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:14.775Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:37:14.775Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:37:14.977Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:37:14.977Z] [LOG]    Employee ID: 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:14.977Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:37:14.978Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:37:14.978Z] [LOG]    Base Salary (Full Month): Rs.25000.00
[2025-10-23T15:37:15.174Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:37:15.174Z] [LOG]       Daily Salary: Rs.1000.00
[2025-10-23T15:37:15.175Z] [LOG]       Weekday Hourly Rate: Rs.117.65
[2025-10-23T15:37:15.175Z] [LOG]       Saturday Hourly Rate: Rs.222.22
[2025-10-23T15:37:15.175Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:37:15.176Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:37:15.176Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:37:15.801Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:37:15.801Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:37:15.999Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:37:15.999Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:37:16.000Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:37:16.000Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:37:16.000Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:37:16.000Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:37:16.000Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:37:16.001Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:37:16.192Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:37:16.193Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:37:16.193Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:37:16.194Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:37:16.393Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:37:16.393Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:37:16.393Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:37:16.394Z] [LOG]       Current Time: 21:07:16
[2025-10-23T15:37:16.394Z] [LOG]       Expected Hours (scheduled → now): 12.62h
[2025-10-23T15:37:16.395Z] [LOG]       Actual Hours (check-in → now): 12.62h
[2025-10-23T15:37:16.395Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:37:16.395Z] [LOG]       Weekday: 131.62h
[2025-10-23T15:37:16.395Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:37:16.396Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:16.396Z] [LOG]       Total Expected: 145.12h
[2025-10-23T15:37:16.397Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:37:16.397Z] [LOG]       Weekday: 38.12h (includes 12.62h live)
[2025-10-23T15:37:16.397Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:37:16.398Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:16.398Z] [LOG]       Total Actual: 42.62h
[2025-10-23T15:37:16.398Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:37:16.399Z] [LOG]       Weekday: 131.62h × Rs.117.65 = Rs.15485.24
[2025-10-23T15:37:16.399Z] [LOG]       Saturday: 13.50h × Rs.222.22 = Rs.2999.97
[2025-10-23T15:37:16.400Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:16.400Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:16.400Z] [LOG]       Total Expected Earned: Rs.18485.21
[2025-10-23T15:37:16.401Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:37:16.401Z] [LOG]       Weekday: 38.12h × Rs.117.65 = Rs.4484.96
[2025-10-23T15:37:16.401Z] [LOG]       Saturday: 4.50h × Rs.222.22 = Rs.999.99
[2025-10-23T15:37:16.402Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:16.402Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:16.402Z] [LOG]       Total Actual Earned: Rs.5484.95
[2025-10-23T15:37:16.403Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:37:16.404Z] [LOG]       Calculated At: Oct 23, 2025, 21:07:16
[2025-10-23T15:37:16.404Z] [LOG]       Expected Earned (until NOW): Rs.18485.21
[2025-10-23T15:37:16.404Z] [LOG]       Actual Earned (until NOW): Rs.5484.95
[2025-10-23T15:37:16.404Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:16.405Z] [LOG]       Attendance Deduction: Rs.13000.26
[2025-10-23T15:37:16.405Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:37:16.405Z] [LOG]       📉 Shortfall: 102.50 hours (70.33% of expected)
[2025-10-23T15:37:16.406Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:37:16.406Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:37:16.406Z] [LOG]    Base Salary (Full): Rs.25000.00
[2025-10-23T15:37:16.407Z] [LOG]    Actual Earned Base: Rs.5484.95
[2025-10-23T15:37:16.407Z] [LOG]    Attendance Shortfall: Rs.13000.26
[2025-10-23T15:37:16.407Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:37:16.408Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:37:16.408Z] [LOG]    Gross Salary: 5484.951565680556
[2025-10-23T15:37:16.408Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:37:16.409Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:37:16.409Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.410Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:37:16.410Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.411Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:37:16.411Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.411Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:37:16.412Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.412Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:37:16.412Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.413Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:37:16.413Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.413Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:37:16.414Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.414Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:37:16.414Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.415Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:37:16.415Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.416Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:37:16.416Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.416Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:37:16.416Z] [LOG]    EPF/ETF calculated on: Rs.5484.95
[2025-10-23T15:37:16.417Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:37:16.417Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:37:16.417Z] [LOG] 💰 GROSS CALCULATION for Ratheeshanan null:
[2025-10-23T15:37:16.418Z] [LOG]    Base Salary: 25000
[2025-10-23T15:37:16.418Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:37:16.418Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:37:16.419Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.419Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:37:16.419Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.420Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:37:16.420Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:16.657Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:37:16.658Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:16.658Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:37:16.658Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:37:16.659Z] [LOG]    Actual Earned Base: Rs.5484.95
[2025-10-23T15:37:16.659Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:37:16.660Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:37:16.660Z] [LOG]    = Gross Salary: Rs.5484.95
[2025-10-23T15:37:16.660Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:37:16.661Z] [LOG]    Attendance Shortfall (Info): Rs.13000.26
[2025-10-23T15:37:16.661Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:37:16.662Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:16.662Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:37:16.662Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:37:16.662Z] [LOG]    Gross Salary: Rs.5484.95
[2025-10-23T15:37:16.663Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:37:16.663Z] [LOG]    = NET SALARY: Rs.5484.95
[2025-10-23T15:37:16.663Z] [LOG] 
💾 Database Update:
[2025-10-23T15:37:16.664Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:37:16.664Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:37:16.882Z] [LOG] 
📝 Components to save:
[2025-10-23T15:37:16.883Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:37:16.883Z] [LOG]    Deduction components: 1
[2025-10-23T15:37:16.883Z] [LOG] Creating components for record 3ec00afd-f3eb-4fca-b754-be87133c1f9f: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:37:16.884Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 5484.951565680556
}
[2025-10-23T15:37:17.079Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:37:17.272Z] [LOG] Created payroll_record_component: 0e907e1c-093f-4e55-9e4e-2474ce260619 for Base Salary
[2025-10-23T15:37:17.272Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 13000.255000000001
}
[2025-10-23T15:37:17.470Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:37:17.681Z] [LOG] Created payroll_record_component: d7d645cd-8e85-427b-ac4a-f72a3f386310 for Attendance Shortfall (Info)
[2025-10-23T15:37:18.071Z] [LOG] ✅ Financial balances updated successfully for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:18.071Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:37:18.071Z] [LOG] 
======================================================================
[2025-10-23T15:37:18.072Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ratheeshanan null
[2025-10-23T15:37:18.072Z] [LOG] ======================================================================
[2025-10-23T15:37:18.073Z] [LOG]    Base Salary (Full): Rs.25000.00
[2025-10-23T15:37:18.073Z] [LOG]    Actual Earned Base (Attendance-based): Rs.5484.95
[2025-10-23T15:37:18.073Z] [LOG]    Attendance Shortfall: Rs.13000.26
[2025-10-23T15:37:18.074Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:18.074Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:18.074Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:37:18.074Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:18.075Z] [LOG]    GROSS SALARY: Rs.5484.95
[2025-10-23T15:37:18.075Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:18.075Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:37:18.076Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:37:18.076Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:37:18.077Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:37:18.077Z] [LOG]       - Attendance Shortfall (Info): Rs.13000.26
[2025-10-23T15:37:18.078Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:18.078Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:18.079Z] [LOG]    NET SALARY: Rs.5484.95
[2025-10-23T15:37:18.079Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:37:18.079Z] [LOG] ======================================================================

[2025-10-23T15:37:18.080Z] [LOG] ✅ Ratheeshanan null: Calculation completed successfully
[2025-10-23T15:37:18.080Z] [LOG] 📊 Progress: 10/34 (29.4%)
[2025-10-23T15:37:18.081Z] [LOG] 
🧮 Processing: Maryam null (EMP000035)
[2025-10-23T15:37:18.081Z] [LOG] 📋 Record ID: 3f5df24a-92ac-4ecd-a0bd-29d4b780cd77
[2025-10-23T15:37:18.081Z] [LOG] 
======================================================================
[2025-10-23T15:37:18.082Z] [LOG] 🧮 CALCULATING PAYROLL: Maryam null (EMP000035)
[2025-10-23T15:37:18.082Z] [LOG] ======================================================================
[2025-10-23T15:37:18.895Z] [LOG] 🔍 Component filtering for employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-23T15:37:18.896Z] [LOG]    Total components: 13
[2025-10-23T15:37:18.896Z] [LOG]    Applicable components: 13
[2025-10-23T15:37:18.897Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T15:37:20.172Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:37:20.172Z] [LOG] 🔄 Processing financial records for employee 01440221-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:37:20.379Z] [LOG] 📊 Found 0 active loans for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:20.573Z] [LOG] 📊 Found 0 active advances for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:20.791Z] [LOG] 📊 Found 0 approved bonuses for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:20.792Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:37:20.792Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:37:20.993Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:37:20.993Z] [LOG]    Employee ID: 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:20.993Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:37:20.994Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:37:20.994Z] [LOG]    Base Salary (Full Month): Rs.40000.00
[2025-10-23T15:37:21.202Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:37:21.202Z] [LOG]       Daily Salary: Rs.1600.00
[2025-10-23T15:37:21.203Z] [LOG]       Weekday Hourly Rate: Rs.188.24
[2025-10-23T15:37:21.203Z] [LOG]       Saturday Hourly Rate: Rs.355.56
[2025-10-23T15:37:21.203Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:37:21.204Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:37:21.204Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:37:21.792Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:37:21.792Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:37:22.007Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:37:22.007Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:37:22.007Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:37:22.008Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:37:22.008Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:37:22.008Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:37:22.009Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:37:22.009Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:37:22.212Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:37:22.213Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:37:22.213Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:37:22.213Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:37:22.412Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:37:22.412Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:37:22.412Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:37:22.413Z] [LOG]       Current Time: 21:07:22
[2025-10-23T15:37:22.414Z] [LOG]       Expected Hours (scheduled → now): 12.62h
[2025-10-23T15:37:22.414Z] [LOG]       Actual Hours (check-in → now): 12.62h
[2025-10-23T15:37:22.414Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:37:22.415Z] [LOG]       Weekday: 131.62h
[2025-10-23T15:37:22.415Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:37:22.415Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:22.416Z] [LOG]       Total Expected: 145.12h
[2025-10-23T15:37:22.416Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:37:22.416Z] [LOG]       Weekday: 38.12h (includes 12.62h live)
[2025-10-23T15:37:22.416Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:37:22.417Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:22.417Z] [LOG]       Total Actual: 42.62h
[2025-10-23T15:37:22.417Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:37:22.418Z] [LOG]       Weekday: 131.62h × Rs.188.24 = Rs.24776.69
[2025-10-23T15:37:22.418Z] [LOG]       Saturday: 13.50h × Rs.355.56 = Rs.4800.06
[2025-10-23T15:37:22.418Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:22.418Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:22.419Z] [LOG]       Total Expected Earned: Rs.29576.75
[2025-10-23T15:37:22.419Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:37:22.419Z] [LOG]       Weekday: 38.12h × Rs.188.24 = Rs.7176.25
[2025-10-23T15:37:22.420Z] [LOG]       Saturday: 4.50h × Rs.355.56 = Rs.1600.02
[2025-10-23T15:37:22.420Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:22.420Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:22.420Z] [LOG]       Total Actual Earned: Rs.8776.27
[2025-10-23T15:37:22.421Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:37:22.421Z] [LOG]       Calculated At: Oct 23, 2025, 21:07:22
[2025-10-23T15:37:22.422Z] [LOG]       Expected Earned (until NOW): Rs.29576.75
[2025-10-23T15:37:22.422Z] [LOG]       Actual Earned (until NOW): Rs.8776.27
[2025-10-23T15:37:22.422Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:22.423Z] [LOG]       Attendance Deduction: Rs.20800.48
[2025-10-23T15:37:22.423Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:37:22.423Z] [LOG]       📉 Shortfall: 102.50 hours (70.33% of expected)
[2025-10-23T15:37:22.424Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:37:22.424Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:37:22.425Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T15:37:22.425Z] [LOG]    Actual Earned Base: Rs.8776.27
[2025-10-23T15:37:22.425Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T15:37:22.426Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:37:22.426Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:37:22.426Z] [LOG]    Gross Salary: 8776.273231911111
[2025-10-23T15:37:22.427Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:37:22.427Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:37:22.427Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.427Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:37:22.428Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.428Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:37:22.428Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.429Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:37:22.429Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.429Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:37:22.430Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.430Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:37:22.431Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.431Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:37:22.431Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.432Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:37:22.433Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.433Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:37:22.433Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.433Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:37:22.434Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.434Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:37:22.434Z] [LOG]    EPF/ETF calculated on: Rs.8776.27
[2025-10-23T15:37:22.434Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:37:22.434Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:37:22.434Z] [LOG] 💰 GROSS CALCULATION for Maryam null:
[2025-10-23T15:37:22.435Z] [LOG]    Base Salary: 40000
[2025-10-23T15:37:22.435Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:37:22.435Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:37:22.435Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.436Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:37:22.436Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.437Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:37:22.437Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:22.657Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:37:22.658Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:22.658Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:37:22.658Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:37:22.658Z] [LOG]    Actual Earned Base: Rs.8776.27
[2025-10-23T15:37:22.659Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:37:22.659Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:37:22.659Z] [LOG]    = Gross Salary: Rs.8776.27
[2025-10-23T15:37:22.660Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:37:22.660Z] [LOG]    Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T15:37:22.660Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:37:22.661Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:22.661Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:37:22.661Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:37:22.662Z] [LOG]    Gross Salary: Rs.8776.27
[2025-10-23T15:37:22.662Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:37:22.662Z] [LOG]    = NET SALARY: Rs.8776.27
[2025-10-23T15:37:22.663Z] [LOG] 
💾 Database Update:
[2025-10-23T15:37:22.663Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:37:22.663Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:37:22.853Z] [LOG] 
📝 Components to save:
[2025-10-23T15:37:22.853Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:37:22.854Z] [LOG]    Deduction components: 1
[2025-10-23T15:37:22.854Z] [LOG] Creating components for record 3f5df24a-92ac-4ecd-a0bd-29d4b780cd77: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:37:22.854Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 8776.273231911111
}
[2025-10-23T15:37:23.052Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:37:23.261Z] [LOG] Created payroll_record_component: 55949b8d-d467-40ac-b5d0-41bea56f9c61 for Base Salary
[2025-10-23T15:37:23.261Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 20800.480000000003
}
[2025-10-23T15:37:23.476Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:37:23.681Z] [LOG] Created payroll_record_component: 4df4bce2-9241-4d9a-a6dd-11a8f37f8bff for Attendance Shortfall (Info)
[2025-10-23T15:37:24.072Z] [LOG] ✅ Financial balances updated successfully for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:24.072Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:37:24.072Z] [LOG] 
======================================================================
[2025-10-23T15:37:24.073Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Maryam null
[2025-10-23T15:37:24.073Z] [LOG] ======================================================================
[2025-10-23T15:37:24.073Z] [LOG]    Base Salary (Full): Rs.40000.00
[2025-10-23T15:37:24.074Z] [LOG]    Actual Earned Base (Attendance-based): Rs.8776.27
[2025-10-23T15:37:24.074Z] [LOG]    Attendance Shortfall: Rs.20800.48
[2025-10-23T15:37:24.074Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:24.075Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:24.075Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:37:24.075Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:24.075Z] [LOG]    GROSS SALARY: Rs.8776.27
[2025-10-23T15:37:24.076Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:24.076Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:37:24.076Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:37:24.076Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:37:24.077Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:37:24.077Z] [LOG]       - Attendance Shortfall (Info): Rs.20800.48
[2025-10-23T15:37:24.077Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:24.077Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:24.078Z] [LOG]    NET SALARY: Rs.8776.27
[2025-10-23T15:37:24.078Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:37:24.078Z] [LOG] ======================================================================

[2025-10-23T15:37:24.079Z] [LOG] ✅ Maryam null: Calculation completed successfully
[2025-10-23T15:37:24.079Z] [LOG] 📊 Progress: 11/34 (32.4%)
[2025-10-23T15:37:24.080Z] [LOG] 
🧮 Processing: Sujevan Selvaratnam null (EMP000026)
[2025-10-23T15:37:24.080Z] [LOG] 📋 Record ID: 4723d72c-e09c-448a-a786-686f30fd73ea
[2025-10-23T15:37:24.080Z] [LOG] 
======================================================================
[2025-10-23T15:37:24.081Z] [LOG] 🧮 CALCULATING PAYROLL: Sujevan Selvaratnam null (EMP000026)
[2025-10-23T15:37:24.081Z] [LOG] ======================================================================
[2025-10-23T15:37:24.872Z] [LOG] 🔍 Component filtering for employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-23T15:37:24.873Z] [LOG]    Total components: 13
[2025-10-23T15:37:24.873Z] [LOG]    Applicable components: 13
[2025-10-23T15:37:24.873Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T15:37:26.091Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:37:26.091Z] [LOG] 🔄 Processing financial records for employee 0143e6c3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:37:26.292Z] [LOG] 📊 Found 0 active loans for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:26.494Z] [LOG] 📊 Found 0 active advances for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:26.707Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:26.708Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:37:26.708Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:37:26.913Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:37:26.913Z] [LOG]    Employee ID: 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:26.914Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:37:26.914Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:37:26.914Z] [LOG]    Base Salary (Full Month): Rs.1.00
[2025-10-23T15:37:27.157Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:37:27.158Z] [LOG]       Daily Salary: Rs.0.04
[2025-10-23T15:37:27.158Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T15:37:27.158Z] [LOG]       Saturday Hourly Rate: Rs.0.01
[2025-10-23T15:37:27.158Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:37:27.158Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:37:27.158Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:37:27.771Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:37:27.771Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:37:27.988Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:37:27.988Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:37:27.989Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:37:27.989Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:37:27.989Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:37:27.990Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:37:27.990Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:37:27.990Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:37:28.190Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:37:28.191Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:37:28.191Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:37:28.191Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:37:28.401Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:37:28.401Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:37:28.402Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:37:28.402Z] [LOG]       Current Time: 21:07:28
[2025-10-23T15:37:28.403Z] [LOG]       Expected Hours (scheduled → now): 12.62h
[2025-10-23T15:37:28.403Z] [LOG]       Actual Hours (check-in → now): 12.62h
[2025-10-23T15:37:28.403Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:37:28.404Z] [LOG]       Weekday: 131.62h
[2025-10-23T15:37:28.404Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:37:28.404Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:28.405Z] [LOG]       Total Expected: 145.12h
[2025-10-23T15:37:28.405Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:37:28.405Z] [LOG]       Weekday: 38.12h (includes 12.62h live)
[2025-10-23T15:37:28.405Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:37:28.406Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:28.406Z] [LOG]       Total Actual: 42.62h
[2025-10-23T15:37:28.406Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:37:28.407Z] [LOG]       Weekday: 131.62h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:28.407Z] [LOG]       Saturday: 13.50h × Rs.0.01 = Rs.0.14
[2025-10-23T15:37:28.407Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:28.408Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:28.408Z] [LOG]       Total Expected Earned: Rs.0.14
[2025-10-23T15:37:28.408Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:37:28.409Z] [LOG]       Weekday: 38.12h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:28.409Z] [LOG]       Saturday: 4.50h × Rs.0.01 = Rs.0.04
[2025-10-23T15:37:28.409Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:28.410Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:28.410Z] [LOG]       Total Actual Earned: Rs.0.04
[2025-10-23T15:37:28.411Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:37:28.411Z] [LOG]       Calculated At: Oct 23, 2025, 21:07:28
[2025-10-23T15:37:28.412Z] [LOG]       Expected Earned (until NOW): Rs.0.14
[2025-10-23T15:37:28.412Z] [LOG]       Actual Earned (until NOW): Rs.0.04
[2025-10-23T15:37:28.413Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:28.413Z] [LOG]       Attendance Deduction: Rs.0.09
[2025-10-23T15:37:28.413Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:37:28.414Z] [LOG]       📉 Shortfall: 102.50 hours (66.67% of expected)
[2025-10-23T15:37:28.414Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:37:28.415Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:37:28.415Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T15:37:28.415Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T15:37:28.415Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T15:37:28.416Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:37:28.416Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:37:28.416Z] [LOG]    Gross Salary: 0.045
[2025-10-23T15:37:28.416Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:37:28.417Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:37:28.417Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.417Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:37:28.417Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.418Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:37:28.418Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.419Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:37:28.419Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.419Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:37:28.420Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.420Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:37:28.420Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.420Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:37:28.421Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.421Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:37:28.422Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.422Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:37:28.422Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.422Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:37:28.423Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.423Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:37:28.423Z] [LOG]    EPF/ETF calculated on: Rs.0.04
[2025-10-23T15:37:28.423Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:37:28.423Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:37:28.424Z] [LOG] 💰 GROSS CALCULATION for Sujevan Selvaratnam null:
[2025-10-23T15:37:28.424Z] [LOG]    Base Salary: 1
[2025-10-23T15:37:28.424Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:37:28.424Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:37:28.424Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.424Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:37:28.425Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.425Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:37:28.425Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:28.657Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:37:28.657Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:28.658Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:37:28.658Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:37:28.658Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T15:37:28.659Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:37:28.659Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:37:28.659Z] [LOG]    = Gross Salary: Rs.0.04
[2025-10-23T15:37:28.659Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:37:28.659Z] [LOG]    Attendance Shortfall (Info): Rs.0.09
[2025-10-23T15:37:28.660Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:37:28.660Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:28.660Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:37:28.660Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:37:28.660Z] [LOG]    Gross Salary: Rs.0.04
[2025-10-23T15:37:28.661Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:37:28.661Z] [LOG]    = NET SALARY: Rs.0.04
[2025-10-23T15:37:28.661Z] [LOG] 
💾 Database Update:
[2025-10-23T15:37:28.661Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:37:28.662Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:37:28.874Z] [LOG] 
📝 Components to save:
[2025-10-23T15:37:28.874Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:37:28.874Z] [LOG]    Deduction components: 1
[2025-10-23T15:37:28.874Z] [LOG] Creating components for record 4723d72c-e09c-448a-a786-686f30fd73ea: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:37:28.875Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 0.045
}
[2025-10-23T15:37:29.071Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:37:29.288Z] [LOG] Created payroll_record_component: 9d6c11c1-3398-4aa1-8ff0-d828c7233c8c for Base Salary
[2025-10-23T15:37:29.288Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 0.09000000000000001
}
[2025-10-23T15:37:29.491Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:37:29.700Z] [LOG] Created payroll_record_component: b33f176c-af5c-458d-b5b5-7c71fcf2d846 for Attendance Shortfall (Info)
[2025-10-23T15:37:30.092Z] [LOG] ✅ Financial balances updated successfully for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:30.092Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:37:30.092Z] [LOG] 
======================================================================
[2025-10-23T15:37:30.092Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sujevan Selvaratnam null
[2025-10-23T15:37:30.093Z] [LOG] ======================================================================
[2025-10-23T15:37:30.093Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T15:37:30.093Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.04
[2025-10-23T15:37:30.094Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T15:37:30.094Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:30.094Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:30.095Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:37:30.095Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:30.095Z] [LOG]    GROSS SALARY: Rs.0.04
[2025-10-23T15:37:30.095Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:30.095Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:37:30.096Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:37:30.096Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:37:30.096Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:37:30.096Z] [LOG]       - Attendance Shortfall (Info): Rs.0.09
[2025-10-23T15:37:30.097Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:30.097Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:30.097Z] [LOG]    NET SALARY: Rs.0.04
[2025-10-23T15:37:30.097Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:37:30.098Z] [LOG] ======================================================================

[2025-10-23T15:37:30.098Z] [LOG] ✅ Sujevan Selvaratnam null: Calculation completed successfully
[2025-10-23T15:37:30.098Z] [LOG] 📊 Progress: 12/34 (35.3%)
[2025-10-23T15:37:30.099Z] [LOG] 
🧮 Processing: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-23T15:37:30.099Z] [LOG] 📋 Record ID: 619302db-95e1-43b9-b200-1464d81ecc78
[2025-10-23T15:37:30.099Z] [LOG] 
======================================================================
[2025-10-23T15:37:30.100Z] [LOG] 🧮 CALCULATING PAYROLL: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-23T15:37:30.100Z] [LOG] ======================================================================
[2025-10-23T15:37:30.996Z] [LOG] 🔍 Component filtering for employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-23T15:37:30.997Z] [LOG]    Total components: 13
[2025-10-23T15:37:30.997Z] [LOG]    Applicable components: 13
[2025-10-23T15:37:30.997Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T15:37:32.257Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:37:32.258Z] [LOG] 🔄 Processing financial records for employee 0144461e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:37:32.484Z] [LOG] 📊 Found 0 active loans for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:32.701Z] [LOG] 📊 Found 0 active advances for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:32.924Z] [LOG] 📊 Found 0 approved bonuses for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:32.924Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:37:32.925Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:37:33.124Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:37:33.124Z] [LOG]    Employee ID: 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:33.125Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:37:33.125Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:37:33.126Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:37:33.326Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:37:33.327Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:37:33.327Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:37:33.327Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:37:33.328Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:37:33.328Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:37:33.328Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:37:33.959Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:37:33.960Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:37:34.175Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:37:34.175Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:37:34.175Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:37:34.175Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:37:34.176Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:37:34.176Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:37:34.176Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:37:34.176Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:37:34.388Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:37:34.388Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:37:34.388Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:37:34.389Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:37:34.578Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:37:34.579Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:37:34.579Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:37:34.580Z] [LOG]       Current Time: 21:07:34
[2025-10-23T15:37:34.580Z] [LOG]       Expected Hours (scheduled → now): 12.63h
[2025-10-23T15:37:34.581Z] [LOG]       Actual Hours (check-in → now): 12.63h
[2025-10-23T15:37:34.581Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:37:34.582Z] [LOG]       Weekday: 131.63h
[2025-10-23T15:37:34.582Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:37:34.582Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:34.583Z] [LOG]       Total Expected: 145.13h
[2025-10-23T15:37:34.583Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:37:34.583Z] [LOG]       Weekday: 38.13h (includes 12.63h live)
[2025-10-23T15:37:34.583Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:37:34.584Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:34.584Z] [LOG]       Total Actual: 42.63h
[2025-10-23T15:37:34.584Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:37:34.585Z] [LOG]       Weekday: 131.63h × Rs.235.29 = Rs.30970.35
[2025-10-23T15:37:34.585Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:37:34.585Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:34.585Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:34.586Z] [LOG]       Total Expected Earned: Rs.36970.29
[2025-10-23T15:37:34.586Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:37:34.586Z] [LOG]       Weekday: 38.13h × Rs.235.29 = Rs.8970.73
[2025-10-23T15:37:34.586Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:37:34.587Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:34.587Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:34.587Z] [LOG]       Total Actual Earned: Rs.10970.71
[2025-10-23T15:37:34.588Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:37:34.588Z] [LOG]       Calculated At: Oct 23, 2025, 21:07:34
[2025-10-23T15:37:34.588Z] [LOG]       Expected Earned (until NOW): Rs.36970.29
[2025-10-23T15:37:34.588Z] [LOG]       Actual Earned (until NOW): Rs.10970.71
[2025-10-23T15:37:34.588Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:34.588Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T15:37:34.588Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:37:34.589Z] [LOG]       📉 Shortfall: 102.50 hours (70.33% of expected)
[2025-10-23T15:37:34.589Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:37:34.589Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:37:34.589Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:34.589Z] [LOG]    Actual Earned Base: Rs.10970.71
[2025-10-23T15:37:34.589Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:37:34.589Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:37:34.589Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:37:34.589Z] [LOG]    Gross Salary: 10970.71046045
[2025-10-23T15:37:34.589Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:37:34.589Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:37:34.589Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.589Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:37:34.589Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.589Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:37:34.590Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.590Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:37:34.590Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.590Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:37:34.590Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.590Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:37:34.590Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.590Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:37:34.590Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.590Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:37:34.590Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.590Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:37:34.590Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.590Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:37:34.590Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.591Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:37:34.591Z] [LOG]    EPF/ETF calculated on: Rs.10970.71
[2025-10-23T15:37:34.591Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:37:34.591Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:37:34.591Z] [LOG] 💰 GROSS CALCULATION for Ashen Nirmal Wadugodapitiya null:
[2025-10-23T15:37:34.591Z] [LOG]    Base Salary: 50000
[2025-10-23T15:37:34.591Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:37:34.591Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:37:34.591Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.591Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:37:34.591Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.591Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:37:34.591Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:34.781Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:37:34.781Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:34.782Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:37:34.782Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:37:34.782Z] [LOG]    Actual Earned Base: Rs.10970.71
[2025-10-23T15:37:34.783Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:37:34.783Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:37:34.783Z] [LOG]    = Gross Salary: Rs.10970.71
[2025-10-23T15:37:34.784Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:37:34.784Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:37:34.784Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:37:34.785Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:34.785Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:37:34.785Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:37:34.786Z] [LOG]    Gross Salary: Rs.10970.71
[2025-10-23T15:37:34.786Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:37:34.786Z] [LOG]    = NET SALARY: Rs.10970.71
[2025-10-23T15:37:34.787Z] [LOG] 
💾 Database Update:
[2025-10-23T15:37:34.787Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:37:34.787Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:37:34.994Z] [LOG] 
📝 Components to save:
[2025-10-23T15:37:34.994Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:37:34.994Z] [LOG]    Deduction components: 1
[2025-10-23T15:37:34.995Z] [LOG] Creating components for record 619302db-95e1-43b9-b200-1464d81ecc78: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:37:34.995Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10970.71046045
}
[2025-10-23T15:37:35.195Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:37:35.392Z] [LOG] Created payroll_record_component: 66636268-71f5-40e9-8119-79ea257f55e7 for Base Salary
[2025-10-23T15:37:35.392Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T15:37:35.581Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:37:35.779Z] [LOG] Created payroll_record_component: 5b60c7b9-b30e-4614-9b9b-abc5d494c4bc for Attendance Shortfall (Info)
[2025-10-23T15:37:36.171Z] [LOG] ✅ Financial balances updated successfully for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:36.172Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:37:36.172Z] [LOG] 
======================================================================
[2025-10-23T15:37:36.172Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ashen Nirmal Wadugodapitiya null
[2025-10-23T15:37:36.173Z] [LOG] ======================================================================
[2025-10-23T15:37:36.173Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:36.173Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10970.71
[2025-10-23T15:37:36.173Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:37:36.174Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:36.174Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:36.174Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:37:36.174Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:36.175Z] [LOG]    GROSS SALARY: Rs.10970.71
[2025-10-23T15:37:36.175Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:36.175Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:37:36.175Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:37:36.175Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:37:36.176Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:37:36.176Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:37:36.176Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:36.176Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:36.176Z] [LOG]    NET SALARY: Rs.10970.71
[2025-10-23T15:37:36.177Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:37:36.177Z] [LOG] ======================================================================

[2025-10-23T15:37:36.177Z] [LOG] ✅ Ashen Nirmal Wadugodapitiya null: Calculation completed successfully
[2025-10-23T15:37:36.177Z] [LOG] 📊 Progress: 13/34 (38.2%)
[2025-10-23T15:37:36.178Z] [LOG] 
🧮 Processing: Chamodi null (EMP000032)
[2025-10-23T15:37:36.178Z] [LOG] 📋 Record ID: 64885e61-155f-4c97-b591-9d98470babce
[2025-10-23T15:37:36.178Z] [LOG] 
======================================================================
[2025-10-23T15:37:36.178Z] [LOG] 🧮 CALCULATING PAYROLL: Chamodi null (EMP000032)
[2025-10-23T15:37:36.178Z] [LOG] ======================================================================
[2025-10-23T15:37:36.995Z] [LOG] 🔍 Component filtering for employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-23T15:37:36.995Z] [LOG]    Total components: 13
[2025-10-23T15:37:36.996Z] [LOG]    Applicable components: 13
[2025-10-23T15:37:36.996Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T15:37:38.264Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:37:38.265Z] [LOG] 🔄 Processing financial records for employee 0143f302-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:37:38.463Z] [LOG] 📊 Found 0 active loans for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:38.673Z] [LOG] 📊 Found 0 active advances for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:38.876Z] [LOG] 📊 Found 0 approved bonuses for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:38.876Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:37:38.876Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:37:39.070Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:37:39.071Z] [LOG]    Employee ID: 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:39.071Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:37:39.071Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:37:39.071Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:37:39.265Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:37:39.266Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:37:39.266Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:37:39.266Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:37:39.266Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:37:39.266Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:37:39.266Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:37:39.883Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:37:39.884Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:37:40.071Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:37:40.071Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:37:40.071Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:37:40.072Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:37:40.072Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:37:40.072Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:37:40.073Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:37:40.073Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:37:40.271Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:37:40.271Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:37:40.272Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:37:40.272Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:37:40.479Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:37:40.480Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:37:40.480Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:37:40.481Z] [LOG]       Current Time: 21:07:40
[2025-10-23T15:37:40.481Z] [LOG]       Expected Hours (scheduled → now): 12.63h
[2025-10-23T15:37:40.481Z] [LOG]       Actual Hours (check-in → now): 12.63h
[2025-10-23T15:37:40.482Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:37:40.482Z] [LOG]       Weekday: 131.63h
[2025-10-23T15:37:40.482Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:37:40.483Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:40.483Z] [LOG]       Total Expected: 145.13h
[2025-10-23T15:37:40.483Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:37:40.484Z] [LOG]       Weekday: 38.13h (includes 12.63h live)
[2025-10-23T15:37:40.484Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:37:40.484Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:40.484Z] [LOG]       Total Actual: 42.63h
[2025-10-23T15:37:40.485Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:37:40.485Z] [LOG]       Weekday: 131.63h × Rs.235.29 = Rs.30970.73
[2025-10-23T15:37:40.485Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:37:40.486Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:40.486Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:40.486Z] [LOG]       Total Expected Earned: Rs.36970.67
[2025-10-23T15:37:40.487Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:37:40.487Z] [LOG]       Weekday: 38.13h × Rs.235.29 = Rs.8971.12
[2025-10-23T15:37:40.487Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:37:40.487Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:40.488Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:40.488Z] [LOG]       Total Actual Earned: Rs.10971.10
[2025-10-23T15:37:40.488Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:37:40.489Z] [LOG]       Calculated At: Oct 23, 2025, 21:07:40
[2025-10-23T15:37:40.489Z] [LOG]       Expected Earned (until NOW): Rs.36970.67
[2025-10-23T15:37:40.489Z] [LOG]       Actual Earned (until NOW): Rs.10971.10
[2025-10-23T15:37:40.489Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:40.489Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T15:37:40.489Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:37:40.489Z] [LOG]       📉 Shortfall: 102.50 hours (70.32% of expected)
[2025-10-23T15:37:40.490Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:37:40.490Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:37:40.490Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:40.490Z] [LOG]    Actual Earned Base: Rs.10971.10
[2025-10-23T15:37:40.490Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:37:40.490Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:37:40.490Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:37:40.490Z] [LOG]    Gross Salary: 10971.096139975
[2025-10-23T15:37:40.490Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:37:40.490Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:37:40.490Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.491Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:37:40.491Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.491Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:37:40.491Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.491Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:37:40.491Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.491Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:37:40.491Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.491Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:37:40.492Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.492Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:37:40.492Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.492Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:37:40.492Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.492Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:37:40.492Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.492Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:37:40.492Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.493Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:37:40.493Z] [LOG]    EPF/ETF calculated on: Rs.10971.10
[2025-10-23T15:37:40.493Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:37:40.493Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:37:40.493Z] [LOG] 💰 GROSS CALCULATION for Chamodi null:
[2025-10-23T15:37:40.493Z] [LOG]    Base Salary: 50000
[2025-10-23T15:37:40.494Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:37:40.494Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:37:40.494Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.494Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:37:40.494Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.494Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:37:40.494Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:40.707Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:37:40.708Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:40.708Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:37:40.709Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:37:40.709Z] [LOG]    Actual Earned Base: Rs.10971.10
[2025-10-23T15:37:40.709Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:37:40.709Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:37:40.710Z] [LOG]    = Gross Salary: Rs.10971.10
[2025-10-23T15:37:40.710Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:37:40.710Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:37:40.710Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:37:40.711Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:40.711Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:37:40.711Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:37:40.712Z] [LOG]    Gross Salary: Rs.10971.10
[2025-10-23T15:37:40.712Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:37:40.712Z] [LOG]    = NET SALARY: Rs.10971.10
[2025-10-23T15:37:40.713Z] [LOG] 
💾 Database Update:
[2025-10-23T15:37:40.713Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:37:40.713Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:37:40.958Z] [LOG] 
📝 Components to save:
[2025-10-23T15:37:40.958Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:37:40.959Z] [LOG]    Deduction components: 1
[2025-10-23T15:37:40.959Z] [LOG] Creating components for record 64885e61-155f-4c97-b591-9d98470babce: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:37:40.959Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10971.096139975
}
[2025-10-23T15:37:41.172Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:37:41.394Z] [LOG] Created payroll_record_component: c6c0ace7-18a4-4ac9-81a4-0c29a7ac982e for Base Salary
[2025-10-23T15:37:41.394Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T15:37:41.599Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:37:41.809Z] [LOG] Created payroll_record_component: 3d7dadd3-4aa4-48a4-bcd1-62dd02c8852c for Attendance Shortfall (Info)
[2025-10-23T15:37:42.218Z] [LOG] ✅ Financial balances updated successfully for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:42.219Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:37:42.219Z] [LOG] 
======================================================================
[2025-10-23T15:37:42.219Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Chamodi null
[2025-10-23T15:37:42.220Z] [LOG] ======================================================================
[2025-10-23T15:37:42.220Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:42.220Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10971.10
[2025-10-23T15:37:42.221Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:37:42.221Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:42.221Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:42.221Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:37:42.221Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:42.222Z] [LOG]    GROSS SALARY: Rs.10971.10
[2025-10-23T15:37:42.222Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:42.222Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:37:42.222Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:37:42.222Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:37:42.222Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:37:42.223Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:37:42.223Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:42.223Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:42.223Z] [LOG]    NET SALARY: Rs.10971.10
[2025-10-23T15:37:42.223Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:37:42.224Z] [LOG] ======================================================================

[2025-10-23T15:37:42.224Z] [LOG] ✅ Chamodi null: Calculation completed successfully
[2025-10-23T15:37:42.224Z] [LOG] 📊 Progress: 14/34 (41.2%)
[2025-10-23T15:37:42.224Z] [LOG] 
🧮 Processing: Viruna Damsiha Cooray null (EMP000038)
[2025-10-23T15:37:42.224Z] [LOG] 📋 Record ID: 76346607-d4e7-41ea-bb0f-018998ac3ef2
[2025-10-23T15:37:42.224Z] [LOG] 
======================================================================
[2025-10-23T15:37:42.224Z] [LOG] 🧮 CALCULATING PAYROLL: Viruna Damsiha Cooray null (EMP000038)
[2025-10-23T15:37:42.225Z] [LOG] ======================================================================
[2025-10-23T15:37:43.057Z] [LOG] 🔍 Component filtering for employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-23T15:37:43.057Z] [LOG]    Total components: 13
[2025-10-23T15:37:43.058Z] [LOG]    Applicable components: 13
[2025-10-23T15:37:43.058Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T15:37:44.300Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:37:44.300Z] [LOG] 🔄 Processing financial records for employee 01441633-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:37:44.491Z] [LOG] 📊 Found 0 active loans for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:44.709Z] [LOG] 📊 Found 0 active advances for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:44.920Z] [LOG] 📊 Found 0 approved bonuses for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:44.920Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:37:44.920Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:37:45.113Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:37:45.114Z] [LOG]    Employee ID: 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:45.114Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:37:45.115Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:37:45.115Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:37:45.314Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:37:45.314Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:37:45.314Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:37:45.315Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:37:45.315Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:37:45.315Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:37:45.315Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:37:45.982Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:37:45.982Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:37:46.230Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:37:46.230Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:37:46.231Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:37:46.231Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:37:46.231Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:37:46.231Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:37:46.231Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:37:46.231Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:37:46.437Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:37:46.437Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:37:46.437Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:37:46.437Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:37:46.662Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:37:46.663Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:37:46.663Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:37:46.664Z] [LOG]       Current Time: 21:07:46
[2025-10-23T15:37:46.664Z] [LOG]       Expected Hours (scheduled → now): 12.63h
[2025-10-23T15:37:46.664Z] [LOG]       Actual Hours (check-in → now): 12.63h
[2025-10-23T15:37:46.665Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:37:46.665Z] [LOG]       Weekday: 131.63h
[2025-10-23T15:37:46.665Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:37:46.665Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:46.665Z] [LOG]       Total Expected: 145.13h
[2025-10-23T15:37:46.665Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:37:46.666Z] [LOG]       Weekday: 38.13h (includes 12.63h live)
[2025-10-23T15:37:46.666Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:37:46.666Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:46.666Z] [LOG]       Total Actual: 42.63h
[2025-10-23T15:37:46.667Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:37:46.667Z] [LOG]       Weekday: 131.63h × Rs.235.29 = Rs.30971.14
[2025-10-23T15:37:46.667Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:37:46.667Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:46.667Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:46.667Z] [LOG]       Total Expected Earned: Rs.36971.08
[2025-10-23T15:37:46.667Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:37:46.667Z] [LOG]       Weekday: 38.13h × Rs.235.29 = Rs.8971.52
[2025-10-23T15:37:46.668Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:37:46.668Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:46.668Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:46.668Z] [LOG]       Total Actual Earned: Rs.10971.50
[2025-10-23T15:37:46.668Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:37:46.669Z] [LOG]       Calculated At: Oct 23, 2025, 21:07:46
[2025-10-23T15:37:46.669Z] [LOG]       Expected Earned (until NOW): Rs.36971.08
[2025-10-23T15:37:46.669Z] [LOG]       Actual Earned (until NOW): Rs.10971.50
[2025-10-23T15:37:46.669Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:46.669Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T15:37:46.669Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:37:46.669Z] [LOG]       📉 Shortfall: 102.50 hours (70.32% of expected)
[2025-10-23T15:37:46.670Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:37:46.670Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:37:46.670Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:46.670Z] [LOG]    Actual Earned Base: Rs.10971.50
[2025-10-23T15:37:46.670Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:37:46.670Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:37:46.671Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:37:46.671Z] [LOG]    Gross Salary: 10971.500250549998
[2025-10-23T15:37:46.671Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:37:46.671Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:37:46.671Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.671Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:37:46.671Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.671Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:37:46.671Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.671Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:37:46.671Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.671Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:37:46.671Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.671Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:37:46.671Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.671Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:37:46.672Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.672Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:37:46.672Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.672Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:37:46.672Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.672Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:37:46.672Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.672Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:37:46.672Z] [LOG]    EPF/ETF calculated on: Rs.10971.50
[2025-10-23T15:37:46.672Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:37:46.672Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:37:46.673Z] [LOG] 💰 GROSS CALCULATION for Viruna Damsiha Cooray null:
[2025-10-23T15:37:46.673Z] [LOG]    Base Salary: 50000
[2025-10-23T15:37:46.673Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:37:46.673Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:37:46.673Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.673Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:37:46.673Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.673Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:37:46.673Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:46.876Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:37:46.876Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:46.877Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:37:46.877Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:37:46.877Z] [LOG]    Actual Earned Base: Rs.10971.50
[2025-10-23T15:37:46.877Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:37:46.878Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:37:46.878Z] [LOG]    = Gross Salary: Rs.10971.50
[2025-10-23T15:37:46.878Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:37:46.878Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:37:46.878Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:37:46.878Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:46.878Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:37:46.879Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:37:46.879Z] [LOG]    Gross Salary: Rs.10971.50
[2025-10-23T15:37:46.879Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:37:46.879Z] [LOG]    = NET SALARY: Rs.10971.50
[2025-10-23T15:37:46.879Z] [LOG] 
💾 Database Update:
[2025-10-23T15:37:46.880Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:37:46.880Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:37:47.077Z] [LOG] 
📝 Components to save:
[2025-10-23T15:37:47.077Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:37:47.078Z] [LOG]    Deduction components: 1
[2025-10-23T15:37:47.078Z] [LOG] Creating components for record 76346607-d4e7-41ea-bb0f-018998ac3ef2: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:37:47.078Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10971.500250549998
}
[2025-10-23T15:37:47.355Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:37:47.558Z] [LOG] Created payroll_record_component: c06e4216-0c69-43ed-bec4-24e6ca0d6ed5 for Base Salary
[2025-10-23T15:37:47.559Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T15:37:47.767Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:37:47.982Z] [LOG] Created payroll_record_component: ae2351e0-cfe8-4196-90a6-bd716436a03d for Attendance Shortfall (Info)
[2025-10-23T15:37:48.396Z] [LOG] ✅ Financial balances updated successfully for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:48.397Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:37:48.397Z] [LOG] 
======================================================================
[2025-10-23T15:37:48.397Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Viruna Damsiha Cooray null
[2025-10-23T15:37:48.398Z] [LOG] ======================================================================
[2025-10-23T15:37:48.398Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:48.398Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10971.50
[2025-10-23T15:37:48.398Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:37:48.398Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:48.399Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:48.399Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:37:48.399Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:48.399Z] [LOG]    GROSS SALARY: Rs.10971.50
[2025-10-23T15:37:48.399Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:48.399Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:37:48.400Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:37:48.400Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:37:48.400Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:37:48.400Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:37:48.400Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:48.400Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:48.400Z] [LOG]    NET SALARY: Rs.10971.50
[2025-10-23T15:37:48.400Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:37:48.401Z] [LOG] ======================================================================

[2025-10-23T15:37:48.401Z] [LOG] ✅ Viruna Damsiha Cooray null: Calculation completed successfully
[2025-10-23T15:37:48.401Z] [LOG] 📊 Progress: 15/34 (44.1%)
[2025-10-23T15:37:48.401Z] [LOG] 
🧮 Processing: Piyumi null (EMP000025)
[2025-10-23T15:37:48.401Z] [LOG] 📋 Record ID: 773f574d-941a-4610-ae28-cf20f246d1c6
[2025-10-23T15:37:48.402Z] [LOG] 
======================================================================
[2025-10-23T15:37:48.402Z] [LOG] 🧮 CALCULATING PAYROLL: Piyumi null (EMP000025)
[2025-10-23T15:37:48.402Z] [LOG] ======================================================================
[2025-10-23T15:37:49.221Z] [LOG] 🔍 Component filtering for employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-23T15:37:49.222Z] [LOG]    Total components: 13
[2025-10-23T15:37:49.222Z] [LOG]    Applicable components: 13
[2025-10-23T15:37:49.222Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T15:37:50.558Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:37:50.558Z] [LOG] 🔄 Processing financial records for employee 0143e565-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:37:50.756Z] [LOG] 📊 Found 0 active loans for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:50.964Z] [LOG] 📊 Found 0 active advances for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:51.163Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:51.163Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:37:51.164Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:37:51.356Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:37:51.356Z] [LOG]    Employee ID: 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:51.356Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:37:51.357Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:37:51.357Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:37:51.556Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:37:51.556Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:37:51.556Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:37:51.556Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:37:51.556Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:37:51.556Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:37:51.556Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:37:52.162Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:37:52.163Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:37:52.368Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:37:52.368Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:37:52.368Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:37:52.368Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:37:52.369Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:37:52.369Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:37:52.369Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:37:52.369Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:37:52.570Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:37:52.571Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:37:52.571Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:37:52.571Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:37:52.774Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:37:52.774Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:37:52.775Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:37:52.776Z] [LOG]       Current Time: 21:07:52
[2025-10-23T15:37:52.776Z] [LOG]       Expected Hours (scheduled → now): 12.63h
[2025-10-23T15:37:52.776Z] [LOG]       Actual Hours (check-in → now): 12.63h
[2025-10-23T15:37:52.776Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:37:52.777Z] [LOG]       Weekday: 131.63h
[2025-10-23T15:37:52.777Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:37:52.777Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:52.778Z] [LOG]       Total Expected: 145.13h
[2025-10-23T15:37:52.778Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:37:52.778Z] [LOG]       Weekday: 38.13h (includes 12.63h live)
[2025-10-23T15:37:52.778Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:37:52.779Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:37:52.779Z] [LOG]       Total Actual: 42.63h
[2025-10-23T15:37:52.779Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:37:52.779Z] [LOG]       Weekday: 131.63h × Rs.235.29 = Rs.30971.53
[2025-10-23T15:37:52.779Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:37:52.779Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:52.779Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:52.780Z] [LOG]       Total Expected Earned: Rs.36971.47
[2025-10-23T15:37:52.780Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:37:52.780Z] [LOG]       Weekday: 38.13h × Rs.235.29 = Rs.8971.92
[2025-10-23T15:37:52.780Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:37:52.781Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:37:52.781Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:52.781Z] [LOG]       Total Actual Earned: Rs.10971.90
[2025-10-23T15:37:52.782Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:37:52.782Z] [LOG]       Calculated At: Oct 23, 2025, 21:07:52
[2025-10-23T15:37:52.782Z] [LOG]       Expected Earned (until NOW): Rs.36971.47
[2025-10-23T15:37:52.782Z] [LOG]       Actual Earned (until NOW): Rs.10971.90
[2025-10-23T15:37:52.782Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:37:52.783Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T15:37:52.783Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:37:52.783Z] [LOG]       📉 Shortfall: 102.50 hours (70.32% of expected)
[2025-10-23T15:37:52.783Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:37:52.783Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:37:52.784Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:52.784Z] [LOG]    Actual Earned Base: Rs.10971.90
[2025-10-23T15:37:52.784Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:37:52.785Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:37:52.785Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:37:52.786Z] [LOG]    Gross Salary: 10971.899720683332
[2025-10-23T15:37:52.787Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:37:52.787Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:37:52.787Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.787Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:37:52.788Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.788Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:37:52.788Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.789Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:37:52.789Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.789Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:37:52.790Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.791Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:37:52.791Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.792Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:37:52.792Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.792Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:37:52.792Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.793Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:37:52.793Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.793Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:37:52.793Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.793Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:37:52.793Z] [LOG]    EPF/ETF calculated on: Rs.10971.90
[2025-10-23T15:37:52.793Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:37:52.793Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:37:52.794Z] [LOG] 💰 GROSS CALCULATION for Piyumi null:
[2025-10-23T15:37:52.794Z] [LOG]    Base Salary: 50000
[2025-10-23T15:37:52.794Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:37:52.794Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:37:52.794Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.794Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:37:52.795Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:52.795Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:37:52.795Z] [LOG]    Fixed amount: 0
[2025-10-23T15:37:53.008Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:37:53.008Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:53.009Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:37:53.009Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:37:53.009Z] [LOG]    Actual Earned Base: Rs.10971.90
[2025-10-23T15:37:53.009Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:37:53.009Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:37:53.010Z] [LOG]    = Gross Salary: Rs.10971.90
[2025-10-23T15:37:53.010Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:37:53.010Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:37:53.010Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:37:53.011Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:53.011Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:37:53.011Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:37:53.011Z] [LOG]    Gross Salary: Rs.10971.90
[2025-10-23T15:37:53.011Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:37:53.012Z] [LOG]    = NET SALARY: Rs.10971.90
[2025-10-23T15:37:53.012Z] [LOG] 
💾 Database Update:
[2025-10-23T15:37:53.012Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:37:53.012Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:37:53.214Z] [LOG] 
📝 Components to save:
[2025-10-23T15:37:53.214Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:37:53.214Z] [LOG]    Deduction components: 1
[2025-10-23T15:37:53.215Z] [LOG] Creating components for record 773f574d-941a-4610-ae28-cf20f246d1c6: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:37:53.215Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10971.899720683332
}
[2025-10-23T15:37:53.413Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:37:53.614Z] [LOG] Created payroll_record_component: 2808bda7-d793-4001-9a9e-60c8e9122e55 for Base Salary
[2025-10-23T15:37:53.615Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T15:37:53.803Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:37:54.010Z] [LOG] Created payroll_record_component: 430343e3-f61c-450c-a6a9-3a6e6cb71fbd for Attendance Shortfall (Info)
[2025-10-23T15:37:54.459Z] [LOG] ✅ Financial balances updated successfully for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:54.459Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:37:54.460Z] [LOG] 
======================================================================
[2025-10-23T15:37:54.460Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Piyumi null
[2025-10-23T15:37:54.461Z] [LOG] ======================================================================
[2025-10-23T15:37:54.461Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:37:54.461Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10971.90
[2025-10-23T15:37:54.462Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:37:54.462Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:54.462Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:37:54.462Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:37:54.463Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:54.463Z] [LOG]    GROSS SALARY: Rs.10971.90
[2025-10-23T15:37:54.463Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:54.464Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:37:54.464Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:37:54.464Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:37:54.464Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:37:54.464Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:37:54.464Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:37:54.465Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:37:54.465Z] [LOG]    NET SALARY: Rs.10971.90
[2025-10-23T15:37:54.465Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:37:54.465Z] [LOG] ======================================================================

[2025-10-23T15:37:54.465Z] [LOG] ✅ Piyumi null: Calculation completed successfully
[2025-10-23T15:37:54.465Z] [LOG] 📊 Progress: 16/34 (47.1%)
[2025-10-23T15:37:54.466Z] [LOG] 
🧮 Processing: Prasanthan null (EMP000001)
[2025-10-23T15:37:54.466Z] [LOG] 📋 Record ID: 7ce72d2b-8d24-4cac-adc2-9635f91e7390
[2025-10-23T15:37:54.466Z] [LOG] 
======================================================================
[2025-10-23T15:37:54.466Z] [LOG] 🧮 CALCULATING PAYROLL: Prasanthan null (EMP000001)
[2025-10-23T15:37:54.466Z] [LOG] ======================================================================
[2025-10-23T15:37:55.402Z] [LOG] 🔍 Component filtering for employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-23T15:37:55.403Z] [LOG]    Total components: 13
[2025-10-23T15:37:55.403Z] [LOG]    Applicable components: 13
[2025-10-23T15:37:55.403Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T15:37:57.925Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:37:57.925Z] [LOG] 🔄 Processing financial records for employee 014397c7-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:37:58.126Z] [LOG] 📊 Found 0 active loans for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:58.363Z] [LOG] 📊 Found 0 active advances for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:58.582Z] [LOG] 📊 Found 0 approved bonuses for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:58.583Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:37:58.583Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:37:58.782Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:37:58.783Z] [LOG]    Employee ID: 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T15:37:58.783Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:37:58.783Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:37:58.783Z] [LOG]    Base Salary (Full Month): Rs.150000.00
[2025-10-23T15:37:59.021Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:37:59.021Z] [LOG]       Daily Salary: Rs.6000.00
[2025-10-23T15:37:59.022Z] [LOG]       Weekday Hourly Rate: Rs.705.88
[2025-10-23T15:37:59.022Z] [LOG]       Saturday Hourly Rate: Rs.1333.33
[2025-10-23T15:37:59.022Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:37:59.022Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:37:59.022Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:37:59.636Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:37:59.636Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:37:59.877Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:37:59.877Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:37:59.878Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:37:59.878Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:37:59.878Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:37:59.878Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:37:59.878Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:37:59.879Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:38:00.083Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:38:00.083Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:38:00.083Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:38:00.083Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:38:00.276Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:38:00.276Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:38:00.276Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:38:00.277Z] [LOG]       Current Time: 21:08:00
[2025-10-23T15:38:00.277Z] [LOG]       Expected Hours (scheduled → now): 12.63h
[2025-10-23T15:38:00.277Z] [LOG]       Actual Hours (check-in → now): 12.63h
[2025-10-23T15:38:00.277Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:38:00.278Z] [LOG]       Weekday: 131.63h
[2025-10-23T15:38:00.278Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:38:00.278Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:00.278Z] [LOG]       Total Expected: 145.13h
[2025-10-23T15:38:00.278Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:38:00.278Z] [LOG]       Weekday: 38.13h (includes 12.63h live)
[2025-10-23T15:38:00.279Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:38:00.279Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:00.279Z] [LOG]       Total Actual: 42.63h
[2025-10-23T15:38:00.279Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:38:00.279Z] [LOG]       Weekday: 131.63h × Rs.705.88 = Rs.92917.39
[2025-10-23T15:38:00.279Z] [LOG]       Saturday: 13.50h × Rs.1333.33 = Rs.17999.95
[2025-10-23T15:38:00.280Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:00.280Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:00.280Z] [LOG]       Total Expected Earned: Rs.110917.35
[2025-10-23T15:38:00.280Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:38:00.280Z] [LOG]       Weekday: 38.13h × Rs.705.88 = Rs.26917.61
[2025-10-23T15:38:00.280Z] [LOG]       Saturday: 4.50h × Rs.1333.33 = Rs.5999.98
[2025-10-23T15:38:00.280Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:00.280Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:00.280Z] [LOG]       Total Actual Earned: Rs.32917.60
[2025-10-23T15:38:00.281Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:38:00.281Z] [LOG]       Calculated At: Oct 23, 2025, 21:08:00
[2025-10-23T15:38:00.281Z] [LOG]       Expected Earned (until NOW): Rs.110917.35
[2025-10-23T15:38:00.281Z] [LOG]       Actual Earned (until NOW): Rs.32917.60
[2025-10-23T15:38:00.281Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:00.281Z] [LOG]       Attendance Deduction: Rs.77999.75
[2025-10-23T15:38:00.281Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:38:00.281Z] [LOG]       📉 Shortfall: 102.50 hours (70.32% of expected)
[2025-10-23T15:38:00.281Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:38:00.281Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:38:00.281Z] [LOG]    Base Salary (Full): Rs.150000.00
[2025-10-23T15:38:00.281Z] [LOG]    Actual Earned Base: Rs.32917.60
[2025-10-23T15:38:00.281Z] [LOG]    Attendance Shortfall: Rs.77999.75
[2025-10-23T15:38:00.281Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:38:00.282Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:38:00.282Z] [LOG]    Gross Salary: 32917.596450799996
[2025-10-23T15:38:00.282Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:38:00.282Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:38:00.282Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.283Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:38:00.283Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.283Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:38:00.283Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.283Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:38:00.283Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.283Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:38:00.283Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.283Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:38:00.284Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.284Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:38:00.284Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.284Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:38:00.284Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.284Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:38:00.284Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.284Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:38:00.284Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.284Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:38:00.284Z] [LOG]    EPF/ETF calculated on: Rs.32917.60
[2025-10-23T15:38:00.285Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:38:00.285Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:38:00.285Z] [LOG] 💰 GROSS CALCULATION for Prasanthan null:
[2025-10-23T15:38:00.285Z] [LOG]    Base Salary: 150000
[2025-10-23T15:38:00.285Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:38:00.285Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:38:00.285Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.285Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:38:00.285Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.286Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:38:00.286Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:00.502Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:38:00.502Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:00.502Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:38:00.503Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:38:00.503Z] [LOG]    Actual Earned Base: Rs.32917.60
[2025-10-23T15:38:00.503Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:38:00.503Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:38:00.503Z] [LOG]    = Gross Salary: Rs.32917.60
[2025-10-23T15:38:00.503Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:38:00.503Z] [LOG]    Attendance Shortfall (Info): Rs.77999.75
[2025-10-23T15:38:00.504Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:38:00.504Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:00.504Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:38:00.504Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:38:00.504Z] [LOG]    Gross Salary: Rs.32917.60
[2025-10-23T15:38:00.504Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:38:00.505Z] [LOG]    = NET SALARY: Rs.32917.60
[2025-10-23T15:38:00.505Z] [LOG] 
💾 Database Update:
[2025-10-23T15:38:00.505Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:38:00.505Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:38:00.721Z] [LOG] 
📝 Components to save:
[2025-10-23T15:38:00.725Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:38:00.726Z] [LOG]    Deduction components: 1
[2025-10-23T15:38:00.726Z] [LOG] Creating components for record 7ce72d2b-8d24-4cac-adc2-9635f91e7390: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:38:00.727Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 32917.596450799996
}
[2025-10-23T15:38:00.959Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:38:01.180Z] [LOG] Created payroll_record_component: 44fc6fc8-4290-48d8-9368-10ab24fe7c31 for Base Salary
[2025-10-23T15:38:01.180Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 77999.75
}
[2025-10-23T15:38:01.392Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:38:01.609Z] [LOG] Created payroll_record_component: 72208b80-2f43-4773-a8b7-1be1c421d2ef for Attendance Shortfall (Info)
[2025-10-23T15:38:02.014Z] [LOG] ✅ Financial balances updated successfully for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:02.015Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:38:02.015Z] [LOG] 
======================================================================
[2025-10-23T15:38:02.015Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Prasanthan null
[2025-10-23T15:38:02.015Z] [LOG] ======================================================================
[2025-10-23T15:38:02.015Z] [LOG]    Base Salary (Full): Rs.150000.00
[2025-10-23T15:38:02.015Z] [LOG]    Actual Earned Base (Attendance-based): Rs.32917.60
[2025-10-23T15:38:02.015Z] [LOG]    Attendance Shortfall: Rs.77999.75
[2025-10-23T15:38:02.015Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:02.016Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:02.016Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:38:02.016Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:02.016Z] [LOG]    GROSS SALARY: Rs.32917.60
[2025-10-23T15:38:02.016Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:02.016Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:38:02.017Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:38:02.017Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:38:02.017Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:38:02.017Z] [LOG]       - Attendance Shortfall (Info): Rs.77999.75
[2025-10-23T15:38:02.017Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:02.017Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:02.017Z] [LOG]    NET SALARY: Rs.32917.60
[2025-10-23T15:38:02.017Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:38:02.018Z] [LOG] ======================================================================

[2025-10-23T15:38:02.018Z] [LOG] ✅ Prasanthan null: Calculation completed successfully
[2025-10-23T15:38:02.018Z] [LOG] 📊 Progress: 17/34 (50.0%)
[2025-10-23T15:38:02.018Z] [LOG] 
🧮 Processing: Uthpala null (EMP000006)
[2025-10-23T15:38:02.018Z] [LOG] 📋 Record ID: 82815bbc-4a12-4255-9dbf-612d290aff55
[2025-10-23T15:38:02.018Z] [LOG] 
======================================================================
[2025-10-23T15:38:02.018Z] [LOG] 🧮 CALCULATING PAYROLL: Uthpala null (EMP000006)
[2025-10-23T15:38:02.018Z] [LOG] ======================================================================
[2025-10-23T15:38:02.858Z] [LOG] 🔍 Component filtering for employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-23T15:38:02.858Z] [LOG]    Total components: 13
[2025-10-23T15:38:02.858Z] [LOG]    Applicable components: 13
[2025-10-23T15:38:02.858Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T15:38:05.359Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:38:05.359Z] [LOG] 🔄 Processing financial records for employee 0143a539-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:38:05.576Z] [LOG] 📊 Found 0 active loans for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:05.789Z] [LOG] 📊 Found 0 active advances for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:06.008Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:06.008Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:38:06.009Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:38:06.212Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:38:06.213Z] [LOG]    Employee ID: 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:06.213Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:38:06.213Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:38:06.213Z] [LOG]    Base Salary (Full Month): Rs.100000.00
[2025-10-23T15:38:06.421Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:38:06.422Z] [LOG]       Daily Salary: Rs.4000.00
[2025-10-23T15:38:06.422Z] [LOG]       Weekday Hourly Rate: Rs.500.00
[2025-10-23T15:38:06.422Z] [LOG]       Saturday Hourly Rate: Rs.888.89
[2025-10-23T15:38:06.422Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:38:06.422Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:38:06.422Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:38:07.012Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:38:07.012Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:38:07.227Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:38:07.227Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:38:07.227Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:38:07.227Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:38:07.228Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:38:07.228Z] [LOG]          2. 2025-10-15 (Weekday): 7.50h
[2025-10-23T15:38:07.228Z] [LOG]          3. 2025-10-16 (Weekday): 7.50h
[2025-10-23T15:38:07.228Z] [LOG]          4. 2025-10-22 (Weekday): 7.50h
[2025-10-23T15:38:07.431Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:38:07.432Z] [LOG]          Weekday: 22.50h
[2025-10-23T15:38:07.432Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:38:07.433Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:38:07.659Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:38:07.659Z] [LOG]       Scheduled Start: 09:30:00
[2025-10-23T15:38:07.659Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:38:07.660Z] [LOG]       Current Time: 21:08:07
[2025-10-23T15:38:07.661Z] [LOG]       Expected Hours (scheduled → now): 11.64h
[2025-10-23T15:38:07.661Z] [LOG]       Actual Hours (check-in → now): 12.64h
[2025-10-23T15:38:07.661Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:38:07.662Z] [LOG]       Weekday: 123.64h
[2025-10-23T15:38:07.662Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:38:07.662Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:07.663Z] [LOG]       Total Expected: 137.14h
[2025-10-23T15:38:07.663Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:38:07.663Z] [LOG]       Weekday: 35.14h (includes 12.64h live)
[2025-10-23T15:38:07.664Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:38:07.664Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:07.664Z] [LOG]       Total Actual: 39.64h
[2025-10-23T15:38:07.665Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:38:07.665Z] [LOG]       Weekday: 123.64h × Rs.500.00 = Rs.61817.73
[2025-10-23T15:38:07.665Z] [LOG]       Saturday: 13.50h × Rs.888.89 = Rs.12000.01
[2025-10-23T15:38:07.666Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:07.666Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:07.666Z] [LOG]       Total Expected Earned: Rs.73817.75
[2025-10-23T15:38:07.667Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:38:07.667Z] [LOG]       Weekday: 35.14h × Rs.500.00 = Rs.17567.73
[2025-10-23T15:38:07.667Z] [LOG]       Saturday: 4.50h × Rs.888.89 = Rs.4000.01
[2025-10-23T15:38:07.667Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:07.668Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:07.668Z] [LOG]       Total Actual Earned: Rs.21567.74
[2025-10-23T15:38:07.669Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:38:07.669Z] [LOG]       Calculated At: Oct 23, 2025, 21:08:07
[2025-10-23T15:38:07.669Z] [LOG]       Expected Earned (until NOW): Rs.73817.75
[2025-10-23T15:38:07.669Z] [LOG]       Actual Earned (until NOW): Rs.21567.74
[2025-10-23T15:38:07.670Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:07.670Z] [LOG]       Attendance Deduction: Rs.52250.01
[2025-10-23T15:38:07.670Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:38:07.670Z] [LOG]       📉 Shortfall: 97.50 hours (70.78% of expected)
[2025-10-23T15:38:07.671Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:38:07.671Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:38:07.671Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T15:38:07.672Z] [LOG]    Actual Earned Base: Rs.21567.74
[2025-10-23T15:38:07.672Z] [LOG]    Attendance Shortfall: Rs.52250.01
[2025-10-23T15:38:07.672Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:38:07.672Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:38:07.673Z] [LOG]    Gross Salary: 21567.735416666666
[2025-10-23T15:38:07.673Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:38:07.673Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:38:07.673Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.673Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:38:07.674Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.674Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:38:07.674Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.674Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:38:07.674Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.674Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:38:07.674Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.674Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:38:07.674Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.675Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:38:07.675Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.675Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:38:07.675Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.675Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:38:07.675Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.675Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:38:07.675Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.675Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:38:07.675Z] [LOG]    EPF/ETF calculated on: Rs.21567.74
[2025-10-23T15:38:07.675Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:38:07.675Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:38:07.675Z] [LOG] 💰 GROSS CALCULATION for Uthpala null:
[2025-10-23T15:38:07.676Z] [LOG]    Base Salary: 100000
[2025-10-23T15:38:07.676Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:38:07.676Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:38:07.676Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.676Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:38:07.676Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.676Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:38:07.676Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:07.879Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:38:07.879Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:07.880Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:38:07.880Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:38:07.881Z] [LOG]    Actual Earned Base: Rs.21567.74
[2025-10-23T15:38:07.881Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:38:07.882Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:38:07.883Z] [LOG]    = Gross Salary: Rs.21567.74
[2025-10-23T15:38:07.883Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:38:07.884Z] [LOG]    Attendance Shortfall (Info): Rs.52250.01
[2025-10-23T15:38:07.884Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:38:07.884Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:07.884Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:38:07.884Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:38:07.884Z] [LOG]    Gross Salary: Rs.21567.74
[2025-10-23T15:38:07.884Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:38:07.885Z] [LOG]    = NET SALARY: Rs.21567.74
[2025-10-23T15:38:07.885Z] [LOG] 
💾 Database Update:
[2025-10-23T15:38:07.887Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:38:07.888Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:38:08.121Z] [LOG] 
📝 Components to save:
[2025-10-23T15:38:08.121Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:38:08.121Z] [LOG]    Deduction components: 1
[2025-10-23T15:38:08.121Z] [LOG] Creating components for record 82815bbc-4a12-4255-9dbf-612d290aff55: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:38:08.122Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 21567.735416666666
}
[2025-10-23T15:38:08.311Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:38:08.522Z] [LOG] Created payroll_record_component: 9ddfed1f-daf6-423d-aee9-48bfc32d10d6 for Base Salary
[2025-10-23T15:38:08.522Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 52250.01000000001
}
[2025-10-23T15:38:08.739Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:38:08.952Z] [LOG] Created payroll_record_component: 3c23e05e-8c68-4a5e-8860-1f43538130fa for Attendance Shortfall (Info)
[2025-10-23T15:38:09.351Z] [LOG] ✅ Financial balances updated successfully for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:09.351Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:38:09.351Z] [LOG] 
======================================================================
[2025-10-23T15:38:09.352Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Uthpala null
[2025-10-23T15:38:09.352Z] [LOG] ======================================================================
[2025-10-23T15:38:09.352Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T15:38:09.352Z] [LOG]    Actual Earned Base (Attendance-based): Rs.21567.74
[2025-10-23T15:38:09.352Z] [LOG]    Attendance Shortfall: Rs.52250.01
[2025-10-23T15:38:09.352Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:09.352Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:09.353Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:38:09.353Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:09.353Z] [LOG]    GROSS SALARY: Rs.21567.74
[2025-10-23T15:38:09.353Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:09.353Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:38:09.353Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:38:09.353Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:38:09.354Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:38:09.354Z] [LOG]       - Attendance Shortfall (Info): Rs.52250.01
[2025-10-23T15:38:09.354Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:09.354Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:09.354Z] [LOG]    NET SALARY: Rs.21567.74
[2025-10-23T15:38:09.354Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:38:09.355Z] [LOG] ======================================================================

[2025-10-23T15:38:09.355Z] [LOG] ✅ Uthpala null: Calculation completed successfully
[2025-10-23T15:38:09.355Z] [LOG] 📊 Progress: 18/34 (52.9%)
[2025-10-23T15:38:09.355Z] [LOG] 
🧮 Processing: Ammaar Ilham (EMP000023)
[2025-10-23T15:38:09.355Z] [LOG] 📋 Record ID: 8337f8fa-a2cb-4acb-a7e5-d602614ff27c
[2025-10-23T15:38:09.355Z] [LOG] 
======================================================================
[2025-10-23T15:38:09.355Z] [LOG] 🧮 CALCULATING PAYROLL: Ammaar Ilham (EMP000023)
[2025-10-23T15:38:09.355Z] [LOG] ======================================================================
[2025-10-23T15:38:10.200Z] [LOG] 🔍 Component filtering for employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-23T15:38:10.200Z] [LOG]    Total components: 13
[2025-10-23T15:38:10.200Z] [LOG]    Applicable components: 13
[2025-10-23T15:38:10.201Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T15:38:11.400Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:38:11.401Z] [LOG] 🔄 Processing financial records for employee 0143de00-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:38:11.632Z] [LOG] 📊 Found 0 active loans for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:11.858Z] [LOG] 📊 Found 0 active advances for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:12.071Z] [LOG] 📊 Found 0 approved bonuses for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:12.072Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:38:12.072Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:38:12.282Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:38:12.282Z] [LOG]    Employee ID: 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:12.282Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:38:12.283Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:38:12.283Z] [LOG]    Base Salary (Full Month): Rs.70000.00
[2025-10-23T15:38:12.490Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:38:12.491Z] [LOG]       Daily Salary: Rs.2800.00
[2025-10-23T15:38:12.491Z] [LOG]       Weekday Hourly Rate: Rs.329.41
[2025-10-23T15:38:12.491Z] [LOG]       Saturday Hourly Rate: Rs.622.22
[2025-10-23T15:38:12.492Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:38:12.492Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:38:12.492Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:38:13.112Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:38:13.113Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:38:13.323Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:38:13.324Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:38:13.324Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:38:13.324Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:38:13.324Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:38:13.325Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:38:13.325Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:38:13.325Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:38:13.547Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:38:13.547Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:38:13.548Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:38:13.548Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:38:13.761Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:38:13.762Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:38:13.762Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:38:13.763Z] [LOG]       Current Time: 21:08:13
[2025-10-23T15:38:13.763Z] [LOG]       Expected Hours (scheduled → now): 12.64h
[2025-10-23T15:38:13.763Z] [LOG]       Actual Hours (check-in → now): 12.64h
[2025-10-23T15:38:13.763Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:38:13.764Z] [LOG]       Weekday: 131.64h
[2025-10-23T15:38:13.764Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:38:13.764Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:13.764Z] [LOG]       Total Expected: 145.14h
[2025-10-23T15:38:13.765Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:38:13.765Z] [LOG]       Weekday: 38.14h (includes 12.64h live)
[2025-10-23T15:38:13.765Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:38:13.765Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:13.765Z] [LOG]       Total Actual: 42.64h
[2025-10-23T15:38:13.766Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:38:13.766Z] [LOG]       Weekday: 131.64h × Rs.329.41 = Rs.43362.60
[2025-10-23T15:38:13.766Z] [LOG]       Saturday: 13.50h × Rs.622.22 = Rs.8399.97
[2025-10-23T15:38:13.766Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:13.767Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:13.767Z] [LOG]       Total Expected Earned: Rs.51762.57
[2025-10-23T15:38:13.767Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:38:13.767Z] [LOG]       Weekday: 38.14h × Rs.329.41 = Rs.12562.76
[2025-10-23T15:38:13.767Z] [LOG]       Saturday: 4.50h × Rs.622.22 = Rs.2799.99
[2025-10-23T15:38:13.767Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:13.768Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:13.768Z] [LOG]       Total Actual Earned: Rs.15362.75
[2025-10-23T15:38:13.768Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:38:13.768Z] [LOG]       Calculated At: Oct 23, 2025, 21:08:13
[2025-10-23T15:38:13.768Z] [LOG]       Expected Earned (until NOW): Rs.51762.57
[2025-10-23T15:38:13.768Z] [LOG]       Actual Earned (until NOW): Rs.15362.75
[2025-10-23T15:38:13.768Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:13.769Z] [LOG]       Attendance Deduction: Rs.36399.82
[2025-10-23T15:38:13.769Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:38:13.769Z] [LOG]       📉 Shortfall: 102.50 hours (70.32% of expected)
[2025-10-23T15:38:13.769Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:38:13.770Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:38:13.770Z] [LOG]    Base Salary (Full): Rs.70000.00
[2025-10-23T15:38:13.770Z] [LOG]    Actual Earned Base: Rs.15362.75
[2025-10-23T15:38:13.770Z] [LOG]    Attendance Shortfall: Rs.36399.82
[2025-10-23T15:38:13.770Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:38:13.771Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:38:13.771Z] [LOG]    Gross Salary: 15362.750503058332
[2025-10-23T15:38:13.771Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:38:13.772Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:38:13.772Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.772Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:38:13.773Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.773Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:38:13.773Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.773Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:38:13.773Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.773Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:38:13.773Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.774Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:38:13.774Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.774Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:38:13.774Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.774Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:38:13.774Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.774Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:38:13.774Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.774Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:38:13.774Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.774Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:38:13.775Z] [LOG]    EPF/ETF calculated on: Rs.15362.75
[2025-10-23T15:38:13.775Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:38:13.775Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:38:13.775Z] [LOG] 💰 GROSS CALCULATION for Ammaar Ilham:
[2025-10-23T15:38:13.775Z] [LOG]    Base Salary: 70000
[2025-10-23T15:38:13.775Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:38:13.775Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:38:13.775Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.775Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:38:13.775Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.776Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:38:13.776Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:13.971Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:38:13.972Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:13.972Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:38:13.972Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:38:13.972Z] [LOG]    Actual Earned Base: Rs.15362.75
[2025-10-23T15:38:13.973Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:38:13.973Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:38:13.973Z] [LOG]    = Gross Salary: Rs.15362.75
[2025-10-23T15:38:13.973Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:38:13.974Z] [LOG]    Attendance Shortfall (Info): Rs.36399.82
[2025-10-23T15:38:13.974Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:38:13.974Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:13.974Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:38:13.975Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:38:13.975Z] [LOG]    Gross Salary: Rs.15362.75
[2025-10-23T15:38:13.975Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:38:13.975Z] [LOG]    = NET SALARY: Rs.15362.75
[2025-10-23T15:38:13.976Z] [LOG] 
💾 Database Update:
[2025-10-23T15:38:13.976Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:38:13.976Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:38:14.181Z] [LOG] 
📝 Components to save:
[2025-10-23T15:38:14.181Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:38:14.182Z] [LOG]    Deduction components: 1
[2025-10-23T15:38:14.182Z] [LOG] Creating components for record 8337f8fa-a2cb-4acb-a7e5-d602614ff27c: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:38:14.182Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 15362.750503058332
}
[2025-10-23T15:38:14.371Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:38:14.580Z] [LOG] Created payroll_record_component: 3cea9610-19db-4f7d-9683-c329691eeec8 for Base Salary
[2025-10-23T15:38:14.580Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 36399.815
}
[2025-10-23T15:38:14.771Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:38:14.985Z] [LOG] Created payroll_record_component: 72a3e436-3bc0-44b4-8eb5-417181ab8157 for Attendance Shortfall (Info)
[2025-10-23T15:38:15.372Z] [LOG] ✅ Financial balances updated successfully for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:15.372Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:38:15.372Z] [LOG] 
======================================================================
[2025-10-23T15:38:15.373Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Ammaar Ilham
[2025-10-23T15:38:15.373Z] [LOG] ======================================================================
[2025-10-23T15:38:15.373Z] [LOG]    Base Salary (Full): Rs.70000.00
[2025-10-23T15:38:15.373Z] [LOG]    Actual Earned Base (Attendance-based): Rs.15362.75
[2025-10-23T15:38:15.374Z] [LOG]    Attendance Shortfall: Rs.36399.82
[2025-10-23T15:38:15.374Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:15.374Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:15.374Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:38:15.374Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:15.374Z] [LOG]    GROSS SALARY: Rs.15362.75
[2025-10-23T15:38:15.375Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:15.375Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:38:15.375Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:38:15.375Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:38:15.375Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:38:15.375Z] [LOG]       - Attendance Shortfall (Info): Rs.36399.82
[2025-10-23T15:38:15.376Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:15.376Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:15.376Z] [LOG]    NET SALARY: Rs.15362.75
[2025-10-23T15:38:15.376Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:38:15.376Z] [LOG] ======================================================================

[2025-10-23T15:38:15.376Z] [LOG] ✅ Ammaar Ilham: Calculation completed successfully
[2025-10-23T15:38:15.377Z] [LOG] 📊 Progress: 19/34 (55.9%)
[2025-10-23T15:38:15.377Z] [LOG] 
🧮 Processing: Nimdiya Ranasinghe null (EMP000045)
[2025-10-23T15:38:15.377Z] [LOG] 📋 Record ID: 87bfd23a-05b2-468f-8678-698645d7c579
[2025-10-23T15:38:15.377Z] [LOG] 
======================================================================
[2025-10-23T15:38:15.377Z] [LOG] 🧮 CALCULATING PAYROLL: Nimdiya Ranasinghe null (EMP000045)
[2025-10-23T15:38:15.377Z] [LOG] ======================================================================
[2025-10-23T15:38:16.208Z] [LOG] 🔍 Component filtering for employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-23T15:38:16.209Z] [LOG]    Total components: 13
[2025-10-23T15:38:16.209Z] [LOG]    Applicable components: 13
[2025-10-23T15:38:16.209Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T15:38:17.471Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:38:17.471Z] [LOG] 🔄 Processing financial records for employee 01444074-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:38:17.682Z] [LOG] 📊 Found 0 active loans for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:17.871Z] [LOG] 📊 Found 0 active advances for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:18.095Z] [LOG] 📊 Found 0 approved bonuses for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:18.096Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:38:18.096Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:38:18.300Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:38:18.300Z] [LOG]    Employee ID: 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:18.300Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:38:18.301Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:38:18.301Z] [LOG]    Base Salary (Full Month): Rs.35000.00
[2025-10-23T15:38:18.514Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:38:18.515Z] [LOG]       Daily Salary: Rs.1400.00
[2025-10-23T15:38:18.515Z] [LOG]       Weekday Hourly Rate: Rs.164.71
[2025-10-23T15:38:18.515Z] [LOG]       Saturday Hourly Rate: Rs.311.11
[2025-10-23T15:38:18.515Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:38:18.516Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:38:18.516Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:38:19.150Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:38:19.151Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:38:19.359Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:38:19.360Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:38:19.360Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:38:19.360Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:38:19.361Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:38:19.361Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:38:19.361Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:38:19.361Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:38:19.552Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:38:19.552Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:38:19.553Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:38:19.553Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:38:19.752Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:38:19.752Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:38:19.752Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:38:19.753Z] [LOG]       Current Time: 21:08:19
[2025-10-23T15:38:19.753Z] [LOG]       Expected Hours (scheduled → now): 12.64h
[2025-10-23T15:38:19.753Z] [LOG]       Actual Hours (check-in → now): 12.64h
[2025-10-23T15:38:19.754Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:38:19.754Z] [LOG]       Weekday: 131.64h
[2025-10-23T15:38:19.754Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:38:19.754Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:19.754Z] [LOG]       Total Expected: 145.14h
[2025-10-23T15:38:19.754Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:38:19.755Z] [LOG]       Weekday: 38.14h (includes 12.64h live)
[2025-10-23T15:38:19.755Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:38:19.755Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:19.755Z] [LOG]       Total Actual: 42.64h
[2025-10-23T15:38:19.756Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:38:19.756Z] [LOG]       Weekday: 131.64h × Rs.164.71 = Rs.21682.23
[2025-10-23T15:38:19.756Z] [LOG]       Saturday: 13.50h × Rs.311.11 = Rs.4199.99
[2025-10-23T15:38:19.756Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:19.756Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:19.757Z] [LOG]       Total Expected Earned: Rs.25882.22
[2025-10-23T15:38:19.757Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:38:19.757Z] [LOG]       Weekday: 38.14h × Rs.164.71 = Rs.6281.85
[2025-10-23T15:38:19.757Z] [LOG]       Saturday: 4.50h × Rs.311.11 = Rs.1400.00
[2025-10-23T15:38:19.757Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:19.757Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:19.758Z] [LOG]       Total Actual Earned: Rs.7681.84
[2025-10-23T15:38:19.758Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:38:19.758Z] [LOG]       Calculated At: Oct 23, 2025, 21:08:19
[2025-10-23T15:38:19.758Z] [LOG]       Expected Earned (until NOW): Rs.25882.22
[2025-10-23T15:38:19.759Z] [LOG]       Actual Earned (until NOW): Rs.7681.84
[2025-10-23T15:38:19.759Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:19.759Z] [LOG]       Attendance Deduction: Rs.18200.38
[2025-10-23T15:38:19.759Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:38:19.759Z] [LOG]       📉 Shortfall: 102.50 hours (70.32% of expected)
[2025-10-23T15:38:19.759Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:38:19.760Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:38:19.760Z] [LOG]    Base Salary (Full): Rs.35000.00
[2025-10-23T15:38:19.760Z] [LOG]    Actual Earned Base: Rs.7681.84
[2025-10-23T15:38:19.760Z] [LOG]    Attendance Shortfall: Rs.18200.38
[2025-10-23T15:38:19.760Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:38:19.760Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:38:19.760Z] [LOG]    Gross Salary: 7681.8400422
[2025-10-23T15:38:19.760Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:38:19.760Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:38:19.761Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.761Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:38:19.761Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.761Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:38:19.761Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.761Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:38:19.761Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.761Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:38:19.761Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.761Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:38:19.761Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.761Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:38:19.762Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.762Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:38:19.762Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.762Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:38:19.762Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.762Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:38:19.762Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.762Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:38:19.762Z] [LOG]    EPF/ETF calculated on: Rs.7681.84
[2025-10-23T15:38:19.762Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:38:19.762Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:38:19.762Z] [LOG] 💰 GROSS CALCULATION for Nimdiya Ranasinghe null:
[2025-10-23T15:38:19.762Z] [LOG]    Base Salary: 35000
[2025-10-23T15:38:19.762Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:38:19.763Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:38:19.763Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.763Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:38:19.763Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.763Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:38:19.763Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:19.958Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:38:19.958Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:19.959Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:38:19.959Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:38:19.959Z] [LOG]    Actual Earned Base: Rs.7681.84
[2025-10-23T15:38:19.959Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:38:19.960Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:38:19.960Z] [LOG]    = Gross Salary: Rs.7681.84
[2025-10-23T15:38:19.960Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:38:19.960Z] [LOG]    Attendance Shortfall (Info): Rs.18200.38
[2025-10-23T15:38:19.961Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:38:19.961Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:19.961Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:38:19.961Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:38:19.962Z] [LOG]    Gross Salary: Rs.7681.84
[2025-10-23T15:38:19.962Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:38:19.962Z] [LOG]    = NET SALARY: Rs.7681.84
[2025-10-23T15:38:19.962Z] [LOG] 
💾 Database Update:
[2025-10-23T15:38:19.963Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:38:19.963Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:38:20.161Z] [LOG] 
📝 Components to save:
[2025-10-23T15:38:20.161Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:38:20.161Z] [LOG]    Deduction components: 1
[2025-10-23T15:38:20.162Z] [LOG] Creating components for record 87bfd23a-05b2-468f-8678-698645d7c579: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:38:20.162Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 7681.8400422
}
[2025-10-23T15:38:20.361Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:38:20.569Z] [LOG] Created payroll_record_component: 65061e06-5448-4736-b9db-641b13b82e65 for Base Salary
[2025-10-23T15:38:20.570Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 18200.375000000004
}
[2025-10-23T15:38:20.773Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:38:20.982Z] [LOG] Created payroll_record_component: 9de86370-3873-4c9f-8059-30b7c87cc49f for Attendance Shortfall (Info)
[2025-10-23T15:38:21.373Z] [LOG] ✅ Financial balances updated successfully for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:21.374Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:38:21.374Z] [LOG] 
======================================================================
[2025-10-23T15:38:21.375Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Nimdiya Ranasinghe null
[2025-10-23T15:38:21.375Z] [LOG] ======================================================================
[2025-10-23T15:38:21.375Z] [LOG]    Base Salary (Full): Rs.35000.00
[2025-10-23T15:38:21.375Z] [LOG]    Actual Earned Base (Attendance-based): Rs.7681.84
[2025-10-23T15:38:21.375Z] [LOG]    Attendance Shortfall: Rs.18200.38
[2025-10-23T15:38:21.376Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:21.376Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:21.376Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:38:21.376Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:21.376Z] [LOG]    GROSS SALARY: Rs.7681.84
[2025-10-23T15:38:21.376Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:21.377Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:38:21.377Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:38:21.377Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:38:21.377Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:38:21.377Z] [LOG]       - Attendance Shortfall (Info): Rs.18200.38
[2025-10-23T15:38:21.378Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:21.378Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:21.378Z] [LOG]    NET SALARY: Rs.7681.84
[2025-10-23T15:38:21.378Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:38:21.378Z] [LOG] ======================================================================

[2025-10-23T15:38:21.378Z] [LOG] ✅ Nimdiya Ranasinghe null: Calculation completed successfully
[2025-10-23T15:38:21.378Z] [LOG] 📊 Progress: 20/34 (58.8%)
[2025-10-23T15:38:21.378Z] [LOG] 
🧮 Processing: Office Team null (EMP000041)
[2025-10-23T15:38:21.378Z] [LOG] 📋 Record ID: 9127dcc0-df28-475e-9ad0-755fe042c003
[2025-10-23T15:38:21.378Z] [LOG] 
======================================================================
[2025-10-23T15:38:21.378Z] [LOG] 🧮 CALCULATING PAYROLL: Office Team null (EMP000041)
[2025-10-23T15:38:21.378Z] [LOG] ======================================================================
[2025-10-23T15:38:22.201Z] [LOG] 🔍 Component filtering for employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-23T15:38:22.201Z] [LOG]    Total components: 13
[2025-10-23T15:38:22.202Z] [LOG]    Applicable components: 13
[2025-10-23T15:38:22.202Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T15:38:23.471Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:38:23.471Z] [LOG] 🔄 Processing financial records for employee 01442b21-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:38:23.687Z] [LOG] 📊 Found 0 active loans for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:23.900Z] [LOG] 📊 Found 0 active advances for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:24.100Z] [LOG] 📊 Found 0 approved bonuses for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:24.101Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:38:24.101Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:38:24.293Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:38:24.294Z] [LOG]    Employee ID: 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:24.294Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:38:24.294Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:38:24.295Z] [LOG]    Base Salary (Full Month): Rs.1.00
[2025-10-23T15:38:24.508Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:38:24.509Z] [LOG]       Daily Salary: Rs.0.04
[2025-10-23T15:38:24.509Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T15:38:24.509Z] [LOG]       Saturday Hourly Rate: Rs.0.01
[2025-10-23T15:38:24.509Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:38:24.509Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:38:24.510Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:38:25.113Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:38:25.113Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:38:25.320Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:38:25.321Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:38:25.321Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:38:25.321Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:38:25.321Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:38:25.321Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:38:25.322Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:38:25.322Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:38:25.512Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:38:25.512Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:38:25.513Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:38:25.513Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:38:25.712Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:38:25.713Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:38:25.713Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:38:25.713Z] [LOG]       Current Time: 21:08:25
[2025-10-23T15:38:25.713Z] [LOG]       Expected Hours (scheduled → now): 12.64h
[2025-10-23T15:38:25.713Z] [LOG]       Actual Hours (check-in → now): 12.64h
[2025-10-23T15:38:25.714Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:38:25.714Z] [LOG]       Weekday: 131.64h
[2025-10-23T15:38:25.714Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:38:25.714Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:25.714Z] [LOG]       Total Expected: 145.14h
[2025-10-23T15:38:25.714Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:38:25.714Z] [LOG]       Weekday: 38.14h (includes 12.64h live)
[2025-10-23T15:38:25.714Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:38:25.715Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:25.715Z] [LOG]       Total Actual: 42.64h
[2025-10-23T15:38:25.715Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:38:25.715Z] [LOG]       Weekday: 131.64h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:25.715Z] [LOG]       Saturday: 13.50h × Rs.0.01 = Rs.0.14
[2025-10-23T15:38:25.715Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:25.715Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:25.715Z] [LOG]       Total Expected Earned: Rs.0.14
[2025-10-23T15:38:25.715Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:38:25.716Z] [LOG]       Weekday: 38.14h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:25.716Z] [LOG]       Saturday: 4.50h × Rs.0.01 = Rs.0.04
[2025-10-23T15:38:25.716Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:25.716Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:25.716Z] [LOG]       Total Actual Earned: Rs.0.04
[2025-10-23T15:38:25.716Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:38:25.716Z] [LOG]       Calculated At: Oct 23, 2025, 21:08:25
[2025-10-23T15:38:25.716Z] [LOG]       Expected Earned (until NOW): Rs.0.14
[2025-10-23T15:38:25.716Z] [LOG]       Actual Earned (until NOW): Rs.0.04
[2025-10-23T15:38:25.716Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:25.716Z] [LOG]       Attendance Deduction: Rs.0.09
[2025-10-23T15:38:25.717Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:38:25.717Z] [LOG]       📉 Shortfall: 102.50 hours (66.67% of expected)
[2025-10-23T15:38:25.717Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:38:25.717Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:38:25.717Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T15:38:25.717Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T15:38:25.717Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T15:38:25.717Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:38:25.717Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:38:25.717Z] [LOG]    Gross Salary: 0.045
[2025-10-23T15:38:25.717Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:38:25.717Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:38:25.717Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.717Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:38:25.718Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.718Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:38:25.718Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.718Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:38:25.718Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.718Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:38:25.718Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.718Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:38:25.718Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.718Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:38:25.719Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.719Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:38:25.719Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.719Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:38:25.719Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.719Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:38:25.719Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.719Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:38:25.719Z] [LOG]    EPF/ETF calculated on: Rs.0.04
[2025-10-23T15:38:25.719Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:38:25.719Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:38:25.719Z] [LOG] 💰 GROSS CALCULATION for Office Team null:
[2025-10-23T15:38:25.720Z] [LOG]    Base Salary: 1
[2025-10-23T15:38:25.720Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:38:25.720Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:38:25.720Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.720Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:38:25.720Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.720Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:38:25.720Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:25.912Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:38:25.912Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:25.913Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:38:25.913Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:38:25.913Z] [LOG]    Actual Earned Base: Rs.0.04
[2025-10-23T15:38:25.913Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:38:25.913Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:38:25.913Z] [LOG]    = Gross Salary: Rs.0.04
[2025-10-23T15:38:25.913Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:38:25.914Z] [LOG]    Attendance Shortfall (Info): Rs.0.09
[2025-10-23T15:38:25.914Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:38:25.914Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:25.914Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:38:25.914Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:38:25.914Z] [LOG]    Gross Salary: Rs.0.04
[2025-10-23T15:38:25.914Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:38:25.915Z] [LOG]    = NET SALARY: Rs.0.04
[2025-10-23T15:38:25.915Z] [LOG] 
💾 Database Update:
[2025-10-23T15:38:25.915Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:38:25.915Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:38:26.125Z] [LOG] 
📝 Components to save:
[2025-10-23T15:38:26.125Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:38:26.126Z] [LOG]    Deduction components: 1
[2025-10-23T15:38:26.126Z] [LOG] Creating components for record 9127dcc0-df28-475e-9ad0-755fe042c003: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:38:26.126Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 0.045
}
[2025-10-23T15:38:26.339Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:38:26.558Z] [LOG] Created payroll_record_component: fe5cd3b7-a61b-462b-b14b-590163cfe4e7 for Base Salary
[2025-10-23T15:38:26.558Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 0.09000000000000001
}
[2025-10-23T15:38:26.751Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:38:26.978Z] [LOG] Created payroll_record_component: d47137f6-ea05-40c5-90e2-861617a4fae9 for Attendance Shortfall (Info)
[2025-10-23T15:38:27.371Z] [LOG] ✅ Financial balances updated successfully for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:27.371Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:38:27.372Z] [LOG] 
======================================================================
[2025-10-23T15:38:27.372Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Office Team null
[2025-10-23T15:38:27.372Z] [LOG] ======================================================================
[2025-10-23T15:38:27.372Z] [LOG]    Base Salary (Full): Rs.1.00
[2025-10-23T15:38:27.372Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.04
[2025-10-23T15:38:27.373Z] [LOG]    Attendance Shortfall: Rs.0.09
[2025-10-23T15:38:27.373Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:27.373Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:27.373Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:38:27.373Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:27.374Z] [LOG]    GROSS SALARY: Rs.0.04
[2025-10-23T15:38:27.374Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:27.374Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:38:27.374Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:38:27.374Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:38:27.374Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:38:27.375Z] [LOG]       - Attendance Shortfall (Info): Rs.0.09
[2025-10-23T15:38:27.375Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:27.375Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:27.375Z] [LOG]    NET SALARY: Rs.0.04
[2025-10-23T15:38:27.375Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:38:27.375Z] [LOG] ======================================================================

[2025-10-23T15:38:27.376Z] [LOG] ✅ Office Team null: Calculation completed successfully
[2025-10-23T15:38:27.376Z] [LOG] 📊 Progress: 21/34 (61.8%)
[2025-10-23T15:38:27.376Z] [LOG] 
🧮 Processing: Chemil null (EMP000040)
[2025-10-23T15:38:27.376Z] [LOG] 📋 Record ID: 942c79be-3f1f-43ff-8a52-a9fa7642334c
[2025-10-23T15:38:27.376Z] [LOG] 
======================================================================
[2025-10-23T15:38:27.376Z] [LOG] 🧮 CALCULATING PAYROLL: Chemil null (EMP000040)
[2025-10-23T15:38:27.376Z] [LOG] ======================================================================
[2025-10-23T15:38:28.188Z] [LOG] 🔍 Component filtering for employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-23T15:38:28.189Z] [LOG]    Total components: 13
[2025-10-23T15:38:28.189Z] [LOG]    Applicable components: 13
[2025-10-23T15:38:28.189Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T15:38:29.480Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:38:29.481Z] [LOG] 🔄 Processing financial records for employee 01442599-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:38:29.688Z] [LOG] 📊 Found 0 active loans for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:29.901Z] [LOG] 📊 Found 0 active advances for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:30.100Z] [LOG] 📊 Found 0 approved bonuses for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:30.101Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:38:30.101Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:38:30.292Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:38:30.292Z] [LOG]    Employee ID: 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:30.293Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:38:30.293Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:38:30.293Z] [LOG]    Base Salary (Full Month): Rs.250000.00
[2025-10-23T15:38:30.501Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:38:30.501Z] [LOG]       Daily Salary: Rs.10000.00
[2025-10-23T15:38:30.502Z] [LOG]       Weekday Hourly Rate: Rs.1176.47
[2025-10-23T15:38:30.502Z] [LOG]       Saturday Hourly Rate: Rs.2222.22
[2025-10-23T15:38:30.502Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:38:30.502Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:38:30.502Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:38:31.129Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:38:31.129Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:38:31.324Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:38:31.324Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:38:31.324Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:38:31.324Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:38:31.325Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:38:31.325Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:38:31.325Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:38:31.325Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:38:31.533Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:38:31.534Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:38:31.534Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:38:31.534Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:38:31.723Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:38:31.723Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:38:31.724Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:38:31.724Z] [LOG]       Current Time: 21:08:31
[2025-10-23T15:38:31.724Z] [LOG]       Expected Hours (scheduled → now): 12.64h
[2025-10-23T15:38:31.724Z] [LOG]       Actual Hours (check-in → now): 12.64h
[2025-10-23T15:38:31.725Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:38:31.725Z] [LOG]       Weekday: 131.64h
[2025-10-23T15:38:31.725Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:38:31.725Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:31.725Z] [LOG]       Total Expected: 145.14h
[2025-10-23T15:38:31.725Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:38:31.725Z] [LOG]       Weekday: 38.14h (includes 12.64h live)
[2025-10-23T15:38:31.725Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:38:31.726Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:31.726Z] [LOG]       Total Actual: 42.64h
[2025-10-23T15:38:31.726Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:38:31.726Z] [LOG]       Weekday: 131.64h × Rs.1176.47 = Rs.154873.03
[2025-10-23T15:38:31.726Z] [LOG]       Saturday: 13.50h × Rs.2222.22 = Rs.29999.97
[2025-10-23T15:38:31.726Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:31.726Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:31.726Z] [LOG]       Total Expected Earned: Rs.184873.00
[2025-10-23T15:38:31.726Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:38:31.726Z] [LOG]       Weekday: 38.14h × Rs.1176.47 = Rs.44873.09
[2025-10-23T15:38:31.726Z] [LOG]       Saturday: 4.50h × Rs.2222.22 = Rs.9999.99
[2025-10-23T15:38:31.726Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:31.727Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:31.727Z] [LOG]       Total Actual Earned: Rs.54873.08
[2025-10-23T15:38:31.727Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:38:31.727Z] [LOG]       Calculated At: Oct 23, 2025, 21:08:31
[2025-10-23T15:38:31.727Z] [LOG]       Expected Earned (until NOW): Rs.184873.00
[2025-10-23T15:38:31.727Z] [LOG]       Actual Earned (until NOW): Rs.54873.08
[2025-10-23T15:38:31.727Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:31.727Z] [LOG]       Attendance Deduction: Rs.129999.93
[2025-10-23T15:38:31.727Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:38:31.727Z] [LOG]       📉 Shortfall: 102.50 hours (70.32% of expected)
[2025-10-23T15:38:31.727Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:38:31.727Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:38:31.728Z] [LOG]    Base Salary (Full): Rs.250000.00
[2025-10-23T15:38:31.728Z] [LOG]    Actual Earned Base: Rs.54873.08
[2025-10-23T15:38:31.728Z] [LOG]    Attendance Shortfall: Rs.129999.93
[2025-10-23T15:38:31.728Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:38:31.728Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:38:31.728Z] [LOG]    Gross Salary: 54873.07965494722
[2025-10-23T15:38:31.728Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:38:31.728Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:38:31.728Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.728Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:38:31.728Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.728Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:38:31.729Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.729Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:38:31.729Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.729Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:38:31.729Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.729Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:38:31.729Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.729Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:38:31.729Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.729Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:38:31.729Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.729Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:38:31.730Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.730Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:38:31.730Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.730Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:38:31.730Z] [LOG]    EPF/ETF calculated on: Rs.54873.08
[2025-10-23T15:38:31.730Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:38:31.730Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:38:31.730Z] [LOG] 💰 GROSS CALCULATION for Chemil null:
[2025-10-23T15:38:31.730Z] [LOG]    Base Salary: 250000
[2025-10-23T15:38:31.730Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:38:31.731Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:38:31.731Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.731Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:38:31.731Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.731Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:38:31.731Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:31.920Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:38:31.920Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:31.921Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:38:31.921Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:38:31.921Z] [LOG]    Actual Earned Base: Rs.54873.08
[2025-10-23T15:38:31.921Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:38:31.921Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:38:31.922Z] [LOG]    = Gross Salary: Rs.54873.08
[2025-10-23T15:38:31.922Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:38:31.922Z] [LOG]    Attendance Shortfall (Info): Rs.129999.93
[2025-10-23T15:38:31.922Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:38:31.922Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:31.922Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:38:31.922Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:38:31.923Z] [LOG]    Gross Salary: Rs.54873.08
[2025-10-23T15:38:31.923Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:38:31.923Z] [LOG]    = NET SALARY: Rs.54873.08
[2025-10-23T15:38:31.923Z] [LOG] 
💾 Database Update:
[2025-10-23T15:38:31.923Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:38:31.924Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:38:32.117Z] [LOG] 
📝 Components to save:
[2025-10-23T15:38:32.118Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:38:32.118Z] [LOG]    Deduction components: 1
[2025-10-23T15:38:32.118Z] [LOG] Creating components for record 942c79be-3f1f-43ff-8a52-a9fa7642334c: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:38:32.119Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 54873.07965494722
}
[2025-10-23T15:38:32.313Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:38:32.511Z] [LOG] Created payroll_record_component: b0fd4294-8951-43c2-a6ad-5ff6dbbc033e for Base Salary
[2025-10-23T15:38:32.512Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 129999.92500000002
}
[2025-10-23T15:38:32.712Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:38:32.943Z] [LOG] Created payroll_record_component: 89ed57cc-3c7d-4744-81cc-c288a4f9e70d for Attendance Shortfall (Info)
[2025-10-23T15:38:33.373Z] [LOG] ✅ Financial balances updated successfully for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:33.373Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:38:33.373Z] [LOG] 
======================================================================
[2025-10-23T15:38:33.373Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Chemil null
[2025-10-23T15:38:33.374Z] [LOG] ======================================================================
[2025-10-23T15:38:33.374Z] [LOG]    Base Salary (Full): Rs.250000.00
[2025-10-23T15:38:33.374Z] [LOG]    Actual Earned Base (Attendance-based): Rs.54873.08
[2025-10-23T15:38:33.374Z] [LOG]    Attendance Shortfall: Rs.129999.93
[2025-10-23T15:38:33.375Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:33.375Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:33.375Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:38:33.375Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:33.375Z] [LOG]    GROSS SALARY: Rs.54873.08
[2025-10-23T15:38:33.376Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:33.376Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:38:33.376Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:38:33.376Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:38:33.376Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:38:33.376Z] [LOG]       - Attendance Shortfall (Info): Rs.129999.93
[2025-10-23T15:38:33.377Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:33.377Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:33.377Z] [LOG]    NET SALARY: Rs.54873.08
[2025-10-23T15:38:33.378Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:38:33.378Z] [LOG] ======================================================================

[2025-10-23T15:38:33.378Z] [LOG] ✅ Chemil null: Calculation completed successfully
[2025-10-23T15:38:33.378Z] [LOG] 📊 Progress: 22/34 (64.7%)
[2025-10-23T15:38:33.378Z] [LOG] 
🧮 Processing: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-23T15:38:33.379Z] [LOG] 📋 Record ID: 9d548fa5-a4f8-4f10-969f-841897a15964
[2025-10-23T15:38:33.379Z] [LOG] 
======================================================================
[2025-10-23T15:38:33.379Z] [LOG] 🧮 CALCULATING PAYROLL: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-23T15:38:33.379Z] [LOG] ======================================================================
[2025-10-23T15:38:34.169Z] [LOG] 🔍 Component filtering for employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-23T15:38:34.170Z] [LOG]    Total components: 13
[2025-10-23T15:38:34.170Z] [LOG]    Applicable components: 13
[2025-10-23T15:38:34.170Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-23T15:38:35.772Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:38:35.772Z] [LOG] 🔄 Processing financial records for employee 0144315c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:38:35.991Z] [LOG] 📊 Found 0 active loans for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:36.209Z] [LOG] 📊 Found 0 active advances for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:36.466Z] [LOG] 📊 Found 0 approved bonuses for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:36.467Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:38:36.467Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:38:36.675Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:38:36.675Z] [LOG]    Employee ID: 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:36.675Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:38:36.676Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:38:36.676Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:38:36.889Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:38:36.889Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:38:36.889Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:38:36.889Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:38:36.890Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:38:36.890Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:38:36.890Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:38:37.522Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:38:37.523Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:38:37.736Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:38:37.736Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:38:37.736Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:38:37.736Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:38:37.737Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:38:37.737Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:38:37.737Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:38:37.737Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:38:37.961Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:38:37.961Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:38:37.961Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:38:37.961Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:38:38.172Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:38:38.173Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:38:38.173Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:38:38.174Z] [LOG]       Current Time: 21:08:38
[2025-10-23T15:38:38.174Z] [LOG]       Expected Hours (scheduled → now): 12.64h
[2025-10-23T15:38:38.174Z] [LOG]       Actual Hours (check-in → now): 12.64h
[2025-10-23T15:38:38.174Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:38:38.175Z] [LOG]       Weekday: 131.64h
[2025-10-23T15:38:38.175Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:38:38.175Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:38.175Z] [LOG]       Total Expected: 145.14h
[2025-10-23T15:38:38.175Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:38:38.176Z] [LOG]       Weekday: 38.14h (includes 12.64h live)
[2025-10-23T15:38:38.176Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:38:38.176Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:38.176Z] [LOG]       Total Actual: 42.64h
[2025-10-23T15:38:38.176Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:38:38.177Z] [LOG]       Weekday: 131.64h × Rs.235.29 = Rs.30974.50
[2025-10-23T15:38:38.177Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:38:38.177Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:38.177Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:38.177Z] [LOG]       Total Expected Earned: Rs.36974.44
[2025-10-23T15:38:38.178Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:38:38.178Z] [LOG]       Weekday: 38.14h × Rs.235.29 = Rs.8974.89
[2025-10-23T15:38:38.178Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:38:38.178Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:38.178Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:38.178Z] [LOG]       Total Actual Earned: Rs.10974.87
[2025-10-23T15:38:38.178Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:38:38.179Z] [LOG]       Calculated At: Oct 23, 2025, 21:08:38
[2025-10-23T15:38:38.179Z] [LOG]       Expected Earned (until NOW): Rs.36974.44
[2025-10-23T15:38:38.179Z] [LOG]       Actual Earned (until NOW): Rs.10974.87
[2025-10-23T15:38:38.179Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:38.179Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T15:38:38.179Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:38:38.179Z] [LOG]       📉 Shortfall: 102.50 hours (70.32% of expected)
[2025-10-23T15:38:38.179Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:38:38.179Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:38:38.180Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:38:38.180Z] [LOG]    Actual Earned Base: Rs.10974.87
[2025-10-23T15:38:38.180Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:38:38.180Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:38:38.180Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:38:38.180Z] [LOG]    Gross Salary: 10974.8668583
[2025-10-23T15:38:38.180Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:38:38.180Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:38:38.180Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.181Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:38:38.181Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.181Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:38:38.181Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.181Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:38:38.181Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.181Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:38:38.181Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.181Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:38:38.181Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.181Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:38:38.182Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.182Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:38:38.182Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.182Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:38:38.182Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.182Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:38:38.182Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.183Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:38:38.183Z] [LOG]    EPF/ETF calculated on: Rs.10974.87
[2025-10-23T15:38:38.183Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:38:38.183Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:38:38.183Z] [LOG] 💰 GROSS CALCULATION for G.M Supathala Sadaru Madhushan null:
[2025-10-23T15:38:38.183Z] [LOG]    Base Salary: 50000
[2025-10-23T15:38:38.183Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:38:38.183Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:38:38.183Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.183Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:38:38.183Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.184Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:38:38.184Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:38.376Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:38:38.376Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:38.377Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:38:38.377Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:38:38.377Z] [LOG]    Actual Earned Base: Rs.10974.87
[2025-10-23T15:38:38.377Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:38:38.377Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:38:38.377Z] [LOG]    = Gross Salary: Rs.10974.87
[2025-10-23T15:38:38.378Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:38:38.378Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:38:38.378Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:38:38.378Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:38.378Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:38:38.379Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:38:38.379Z] [LOG]    Gross Salary: Rs.10974.87
[2025-10-23T15:38:38.379Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:38:38.379Z] [LOG]    = NET SALARY: Rs.10974.87
[2025-10-23T15:38:38.379Z] [LOG] 
💾 Database Update:
[2025-10-23T15:38:38.379Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:38:38.380Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:38:38.573Z] [LOG] 
📝 Components to save:
[2025-10-23T15:38:38.574Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:38:38.574Z] [LOG]    Deduction components: 1
[2025-10-23T15:38:38.574Z] [LOG] Creating components for record 9d548fa5-a4f8-4f10-969f-841897a15964: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:38:38.575Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10974.8668583
}
[2025-10-23T15:38:38.772Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:38:38.996Z] [LOG] Created payroll_record_component: 6069d6c3-195a-4558-8337-f2f0d4bbabaf for Base Salary
[2025-10-23T15:38:38.997Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T15:38:39.213Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:38:39.406Z] [LOG] Created payroll_record_component: 3c7b4dba-07c4-4097-b9a9-8de174ad9ec1 for Attendance Shortfall (Info)
[2025-10-23T15:38:39.783Z] [LOG] ✅ Financial balances updated successfully for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:39.784Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:38:39.784Z] [LOG] 
======================================================================
[2025-10-23T15:38:39.785Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: G.M Supathala Sadaru Madhushan null
[2025-10-23T15:38:39.785Z] [LOG] ======================================================================
[2025-10-23T15:38:39.785Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:38:39.786Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10974.87
[2025-10-23T15:38:39.786Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:38:39.786Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:39.786Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:39.787Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:38:39.787Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:39.787Z] [LOG]    GROSS SALARY: Rs.10974.87
[2025-10-23T15:38:39.788Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:39.788Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:38:39.788Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:38:39.789Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:38:39.789Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:38:39.789Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:38:39.790Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:39.790Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:39.790Z] [LOG]    NET SALARY: Rs.10974.87
[2025-10-23T15:38:39.790Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:38:39.791Z] [LOG] ======================================================================

[2025-10-23T15:38:39.791Z] [LOG] ✅ G.M Supathala Sadaru Madhushan null: Calculation completed successfully
[2025-10-23T15:38:39.791Z] [LOG] 📊 Progress: 23/34 (67.6%)
[2025-10-23T15:38:39.792Z] [LOG] 
🧮 Processing: Sumaiya null (EMP000016)
[2025-10-23T15:38:39.792Z] [LOG] 📋 Record ID: a9a4e10d-1050-423e-ae1b-9653c0b7bb60
[2025-10-23T15:38:39.792Z] [LOG] 
======================================================================
[2025-10-23T15:38:39.792Z] [LOG] 🧮 CALCULATING PAYROLL: Sumaiya null (EMP000016)
[2025-10-23T15:38:39.793Z] [LOG] ======================================================================
[2025-10-23T15:38:40.578Z] [LOG] 🔍 Component filtering for employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-23T15:38:40.578Z] [LOG]    Total components: 13
[2025-10-23T15:38:40.578Z] [LOG]    Applicable components: 13
[2025-10-23T15:38:40.579Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T15:38:41.794Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:38:41.794Z] [LOG] 🔄 Processing financial records for employee 0143b22f-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:38:42.009Z] [LOG] 📊 Found 0 active loans for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:42.213Z] [LOG] 📊 Found 0 active advances for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:42.413Z] [LOG] 📊 Found 0 approved bonuses for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:42.413Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:38:42.414Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:38:42.620Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:38:42.621Z] [LOG]    Employee ID: 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:42.621Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:38:42.621Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:38:42.621Z] [LOG]    Base Salary (Full Month): Rs.60000.00
[2025-10-23T15:38:42.836Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:38:42.837Z] [LOG]       Daily Salary: Rs.2400.00
[2025-10-23T15:38:42.837Z] [LOG]       Weekday Hourly Rate: Rs.282.35
[2025-10-23T15:38:42.837Z] [LOG]       Saturday Hourly Rate: Rs.533.33
[2025-10-23T15:38:42.837Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:38:42.837Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:38:42.838Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:38:43.481Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:38:43.482Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:38:43.696Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:38:43.696Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:38:43.697Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:38:43.697Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:38:43.697Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:38:43.697Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:38:43.698Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:38:43.698Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:38:43.892Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:38:43.893Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:38:43.893Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:38:43.893Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:38:44.092Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:38:44.093Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:38:44.093Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:38:44.094Z] [LOG]       Current Time: 21:08:44
[2025-10-23T15:38:44.094Z] [LOG]       Expected Hours (scheduled → now): 12.65h
[2025-10-23T15:38:44.094Z] [LOG]       Actual Hours (check-in → now): 12.65h
[2025-10-23T15:38:44.095Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:38:44.095Z] [LOG]       Weekday: 131.65h
[2025-10-23T15:38:44.095Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:38:44.095Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:44.096Z] [LOG]       Total Expected: 145.15h
[2025-10-23T15:38:44.096Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:38:44.096Z] [LOG]       Weekday: 38.15h (includes 12.65h live)
[2025-10-23T15:38:44.096Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:38:44.097Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:44.097Z] [LOG]       Total Actual: 42.65h
[2025-10-23T15:38:44.097Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:38:44.097Z] [LOG]       Weekday: 131.65h × Rs.282.35 = Rs.37170.13
[2025-10-23T15:38:44.098Z] [LOG]       Saturday: 13.50h × Rs.533.33 = Rs.7199.96
[2025-10-23T15:38:44.098Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:44.098Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:44.098Z] [LOG]       Total Expected Earned: Rs.44370.08
[2025-10-23T15:38:44.099Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:38:44.099Z] [LOG]       Weekday: 38.15h × Rs.282.35 = Rs.10770.40
[2025-10-23T15:38:44.099Z] [LOG]       Saturday: 4.50h × Rs.533.33 = Rs.2399.99
[2025-10-23T15:38:44.099Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:44.099Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:44.099Z] [LOG]       Total Actual Earned: Rs.13170.39
[2025-10-23T15:38:44.100Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:38:44.100Z] [LOG]       Calculated At: Oct 23, 2025, 21:08:44
[2025-10-23T15:38:44.100Z] [LOG]       Expected Earned (until NOW): Rs.44370.08
[2025-10-23T15:38:44.100Z] [LOG]       Actual Earned (until NOW): Rs.13170.39
[2025-10-23T15:38:44.100Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:44.100Z] [LOG]       Attendance Deduction: Rs.31199.69
[2025-10-23T15:38:44.100Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:38:44.100Z] [LOG]       📉 Shortfall: 102.50 hours (70.32% of expected)
[2025-10-23T15:38:44.100Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:38:44.101Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:38:44.101Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T15:38:44.101Z] [LOG]    Actual Earned Base: Rs.13170.39
[2025-10-23T15:38:44.101Z] [LOG]    Attendance Shortfall: Rs.31199.69
[2025-10-23T15:38:44.101Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:38:44.101Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:38:44.101Z] [LOG]    Gross Salary: 13170.389826722225
[2025-10-23T15:38:44.101Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:38:44.102Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:38:44.102Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.102Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:38:44.102Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.102Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:38:44.102Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.102Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:38:44.102Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.103Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:38:44.103Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.103Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:38:44.103Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.103Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:38:44.103Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.103Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:38:44.103Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.103Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:38:44.103Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.104Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:38:44.104Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.104Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:38:44.104Z] [LOG]    EPF/ETF calculated on: Rs.13170.39
[2025-10-23T15:38:44.104Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:38:44.104Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:38:44.104Z] [LOG] 💰 GROSS CALCULATION for Sumaiya null:
[2025-10-23T15:38:44.104Z] [LOG]    Base Salary: 60000
[2025-10-23T15:38:44.104Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:38:44.104Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:38:44.104Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.105Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:38:44.105Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.105Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:38:44.105Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:44.313Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:38:44.313Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:44.314Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:38:44.314Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:38:44.314Z] [LOG]    Actual Earned Base: Rs.13170.39
[2025-10-23T15:38:44.314Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:38:44.314Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:38:44.315Z] [LOG]    = Gross Salary: Rs.13170.39
[2025-10-23T15:38:44.315Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:38:44.315Z] [LOG]    Attendance Shortfall (Info): Rs.31199.69
[2025-10-23T15:38:44.315Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:38:44.315Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:44.315Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:38:44.316Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:38:44.316Z] [LOG]    Gross Salary: Rs.13170.39
[2025-10-23T15:38:44.316Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:38:44.316Z] [LOG]    = NET SALARY: Rs.13170.39
[2025-10-23T15:38:44.316Z] [LOG] 
💾 Database Update:
[2025-10-23T15:38:44.316Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:38:44.317Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:38:44.515Z] [LOG] 
📝 Components to save:
[2025-10-23T15:38:44.515Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:38:44.515Z] [LOG]    Deduction components: 1
[2025-10-23T15:38:44.515Z] [LOG] Creating components for record a9a4e10d-1050-423e-ae1b-9653c0b7bb60: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:38:44.516Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 13170.389826722225
}
[2025-10-23T15:38:44.734Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:38:44.936Z] [LOG] Created payroll_record_component: 83bcbfe8-584a-426a-9a53-27ab76fbfbe3 for Base Salary
[2025-10-23T15:38:44.936Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 31199.695
}
[2025-10-23T15:38:45.160Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:38:45.396Z] [LOG] Created payroll_record_component: c262b62e-0f29-49cf-88ec-fc5ee64c33a3 for Attendance Shortfall (Info)
[2025-10-23T15:38:45.792Z] [LOG] ✅ Financial balances updated successfully for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:45.793Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:38:45.793Z] [LOG] 
======================================================================
[2025-10-23T15:38:45.793Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Sumaiya null
[2025-10-23T15:38:45.793Z] [LOG] ======================================================================
[2025-10-23T15:38:45.794Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T15:38:45.794Z] [LOG]    Actual Earned Base (Attendance-based): Rs.13170.39
[2025-10-23T15:38:45.794Z] [LOG]    Attendance Shortfall: Rs.31199.69
[2025-10-23T15:38:45.795Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:45.795Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:45.795Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:38:45.796Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:45.796Z] [LOG]    GROSS SALARY: Rs.13170.39
[2025-10-23T15:38:45.796Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:45.797Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:38:45.797Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:38:45.797Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:38:45.798Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:38:45.798Z] [LOG]       - Attendance Shortfall (Info): Rs.31199.69
[2025-10-23T15:38:45.798Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:45.798Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:45.798Z] [LOG]    NET SALARY: Rs.13170.39
[2025-10-23T15:38:45.799Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:38:45.799Z] [LOG] ======================================================================

[2025-10-23T15:38:45.799Z] [LOG] ✅ Sumaiya null: Calculation completed successfully
[2025-10-23T15:38:45.799Z] [LOG] 📊 Progress: 24/34 (70.6%)
[2025-10-23T15:38:45.799Z] [LOG] 
🧮 Processing: customer null (EMP000036)
[2025-10-23T15:38:45.800Z] [LOG] 📋 Record ID: b347b4aa-492c-4d97-a8eb-70093ac4b2a6
[2025-10-23T15:38:45.800Z] [LOG] 
======================================================================
[2025-10-23T15:38:45.800Z] [LOG] 🧮 CALCULATING PAYROLL: customer null (EMP000036)
[2025-10-23T15:38:45.800Z] [LOG] ======================================================================
[2025-10-23T15:38:46.613Z] [LOG] 🔍 Component filtering for employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-23T15:38:46.614Z] [LOG]    Total components: 13
[2025-10-23T15:38:46.614Z] [LOG]    Applicable components: 13
[2025-10-23T15:38:46.614Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T15:38:47.872Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:38:47.873Z] [LOG] 🔄 Processing financial records for employee 014409a2-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:38:48.089Z] [LOG] 📊 Found 0 active loans for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:48.296Z] [LOG] 📊 Found 0 active advances for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:48.484Z] [LOG] 📊 Found 0 approved bonuses for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:48.485Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:38:48.485Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:38:48.673Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:38:48.674Z] [LOG]    Employee ID: 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:48.674Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:38:48.674Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:38:48.675Z] [LOG]    Base Salary (Full Month): Rs.0.00
[2025-10-23T15:38:48.884Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:38:48.884Z] [LOG]       Daily Salary: Rs.0.00
[2025-10-23T15:38:48.884Z] [LOG]       Weekday Hourly Rate: Rs.0.00
[2025-10-23T15:38:48.884Z] [LOG]       Saturday Hourly Rate: Rs.0.00
[2025-10-23T15:38:48.885Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:38:48.885Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:38:48.885Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:38:49.482Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:38:49.483Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:38:49.707Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:38:49.707Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:38:49.707Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:38:49.708Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:38:49.708Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:38:49.708Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:38:49.708Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:38:49.708Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:38:49.904Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:38:49.904Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:38:49.904Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:38:49.904Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:38:50.104Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:38:50.104Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:38:50.104Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:38:50.105Z] [LOG]       Current Time: 21:08:50
[2025-10-23T15:38:50.105Z] [LOG]       Expected Hours (scheduled → now): 12.65h
[2025-10-23T15:38:50.106Z] [LOG]       Actual Hours (check-in → now): 12.65h
[2025-10-23T15:38:50.106Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:38:50.106Z] [LOG]       Weekday: 131.65h
[2025-10-23T15:38:50.106Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:38:50.106Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:50.107Z] [LOG]       Total Expected: 145.15h
[2025-10-23T15:38:50.107Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:38:50.107Z] [LOG]       Weekday: 38.15h (includes 12.65h live)
[2025-10-23T15:38:50.107Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:38:50.107Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:50.107Z] [LOG]       Total Actual: 42.65h
[2025-10-23T15:38:50.107Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:38:50.108Z] [LOG]       Weekday: 131.65h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:50.108Z] [LOG]       Saturday: 13.50h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:50.108Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:50.108Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:50.108Z] [LOG]       Total Expected Earned: Rs.0.00
[2025-10-23T15:38:50.108Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:38:50.109Z] [LOG]       Weekday: 38.15h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:50.109Z] [LOG]       Saturday: 4.50h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:50.109Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:50.109Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:50.109Z] [LOG]       Total Actual Earned: Rs.0.00
[2025-10-23T15:38:50.110Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:38:50.110Z] [LOG]       Calculated At: Oct 23, 2025, 21:08:50
[2025-10-23T15:38:50.110Z] [LOG]       Expected Earned (until NOW): Rs.0.00
[2025-10-23T15:38:50.110Z] [LOG]       Actual Earned (until NOW): Rs.0.00
[2025-10-23T15:38:50.110Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:50.111Z] [LOG]       Attendance Deduction: Rs.0.00
[2025-10-23T15:38:50.111Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:38:50.111Z] [LOG]       ✅ No deduction - Employee worked all expected hours!
[2025-10-23T15:38:50.111Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:38:50.111Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:38:50.111Z] [LOG]    Base Salary (Full): Rs.NaN
[2025-10-23T15:38:50.111Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T15:38:50.111Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T15:38:50.111Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:38:50.112Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:38:50.112Z] [LOG]    Gross Salary: 0
[2025-10-23T15:38:50.112Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:38:50.112Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:38:50.112Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.112Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:38:50.112Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.113Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:38:50.113Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.113Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:38:50.113Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.113Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:38:50.113Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.114Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:38:50.114Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.114Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:38:50.114Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.114Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:38:50.114Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.115Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:38:50.115Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.115Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:38:50.115Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.115Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:38:50.115Z] [LOG]    EPF/ETF calculated on: Rs.0.00
[2025-10-23T15:38:50.115Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:38:50.115Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:38:50.115Z] [LOG] 💰 GROSS CALCULATION for customer null:
[2025-10-23T15:38:50.115Z] [LOG]    Base Salary: 0
[2025-10-23T15:38:50.116Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:38:50.116Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:38:50.116Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.116Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:38:50.116Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.116Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:38:50.116Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:50.313Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:38:50.313Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:50.314Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:38:50.314Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:38:50.314Z] [LOG]    Actual Earned Base: Rs.0.00
[2025-10-23T15:38:50.314Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:38:50.315Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:38:50.315Z] [LOG]    = Gross Salary: Rs.0.00
[2025-10-23T15:38:50.315Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:38:50.316Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:38:50.316Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:50.316Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:38:50.317Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:38:50.317Z] [LOG]    Gross Salary: Rs.0.00
[2025-10-23T15:38:50.317Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:38:50.317Z] [LOG]    = NET SALARY: Rs.0.00
[2025-10-23T15:38:50.318Z] [LOG] 
💾 Database Update:
[2025-10-23T15:38:50.318Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:38:50.318Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:38:50.517Z] [LOG] 
📝 Components to save:
[2025-10-23T15:38:50.517Z] [LOG]    Gross/Earnings components: 0
[2025-10-23T15:38:50.517Z] [LOG]    Deduction components: 0
[2025-10-23T15:38:50.518Z] [LOG] Creating components for record b347b4aa-492c-4d97-a8eb-70093ac4b2a6: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 0,
  "taxComponentsCount": 0
}
[2025-10-23T15:38:50.909Z] [LOG] ✅ Financial balances updated successfully for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:50.910Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:38:50.910Z] [LOG] 
======================================================================
[2025-10-23T15:38:50.911Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: customer null
[2025-10-23T15:38:50.911Z] [LOG] ======================================================================
[2025-10-23T15:38:50.911Z] [LOG]    Base Salary (Full): Rs.0.00
[2025-10-23T15:38:50.911Z] [LOG]    Actual Earned Base (Attendance-based): Rs.0.00
[2025-10-23T15:38:50.912Z] [LOG]    Attendance Shortfall: Rs.0.00
[2025-10-23T15:38:50.912Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:50.912Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:50.912Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:38:50.913Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:50.913Z] [LOG]    GROSS SALARY: Rs.0.00
[2025-10-23T15:38:50.913Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:50.913Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:38:50.914Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:38:50.914Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:38:50.914Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:38:50.915Z] [LOG]       - Attendance Shortfall (Info): Rs.0.00
[2025-10-23T15:38:50.915Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:50.915Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:50.915Z] [LOG]    NET SALARY: Rs.0.00
[2025-10-23T15:38:50.915Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:38:50.915Z] [LOG] ======================================================================

[2025-10-23T15:38:50.916Z] [LOG] ✅ customer null: Calculation completed successfully
[2025-10-23T15:38:50.916Z] [LOG] 📊 Progress: 25/34 (73.5%)
[2025-10-23T15:38:50.916Z] [LOG] 
🧮 Processing: Hari null (EMP000017)
[2025-10-23T15:38:50.916Z] [LOG] 📋 Record ID: bf0c58c8-cafe-40e8-80f0-9df9a18be6b5
[2025-10-23T15:38:50.916Z] [LOG] 
======================================================================
[2025-10-23T15:38:50.916Z] [LOG] 🧮 CALCULATING PAYROLL: Hari null (EMP000017)
[2025-10-23T15:38:50.916Z] [LOG] ======================================================================
[2025-10-23T15:38:51.676Z] [LOG] 🔍 Component filtering for employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-23T15:38:51.677Z] [LOG]    Total components: 13
[2025-10-23T15:38:51.677Z] [LOG]    Applicable components: 13
[2025-10-23T15:38:51.678Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T15:38:52.882Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:38:52.882Z] [LOG] 🔄 Processing financial records for employee 0143bc58-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:38:53.080Z] [LOG] 📊 Found 0 active loans for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:53.281Z] [LOG] 📊 Found 0 active advances for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:53.482Z] [LOG] 📊 Found 0 approved bonuses for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:53.482Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:38:53.483Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:38:53.678Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:38:53.678Z] [LOG]    Employee ID: 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:53.679Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:38:53.679Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:38:53.679Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:38:53.879Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:38:53.880Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:38:53.880Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:38:53.880Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:38:53.881Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:38:53.881Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:38:53.881Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:38:54.473Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:38:54.473Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:38:54.679Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:38:54.679Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:38:54.680Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:38:54.680Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:38:54.680Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:38:54.681Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:38:54.681Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:38:54.681Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:38:54.881Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:38:54.881Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:38:54.882Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:38:54.882Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:38:55.110Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:38:55.111Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:38:55.111Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:38:55.112Z] [LOG]       Current Time: 21:08:55
[2025-10-23T15:38:55.112Z] [LOG]       Expected Hours (scheduled → now): 12.65h
[2025-10-23T15:38:55.113Z] [LOG]       Actual Hours (check-in → now): 12.65h
[2025-10-23T15:38:55.113Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:38:55.113Z] [LOG]       Weekday: 131.65h
[2025-10-23T15:38:55.114Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:38:55.114Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:55.114Z] [LOG]       Total Expected: 145.15h
[2025-10-23T15:38:55.115Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:38:55.115Z] [LOG]       Weekday: 38.15h (includes 12.65h live)
[2025-10-23T15:38:55.115Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:38:55.116Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:38:55.116Z] [LOG]       Total Actual: 42.65h
[2025-10-23T15:38:55.116Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:38:55.117Z] [LOG]       Weekday: 131.65h × Rs.235.29 = Rs.30975.61
[2025-10-23T15:38:55.117Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:38:55.117Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:55.118Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:55.118Z] [LOG]       Total Expected Earned: Rs.36975.55
[2025-10-23T15:38:55.118Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:38:55.119Z] [LOG]       Weekday: 38.15h × Rs.235.29 = Rs.8975.99
[2025-10-23T15:38:55.119Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:38:55.119Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:38:55.120Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:55.120Z] [LOG]       Total Actual Earned: Rs.10975.97
[2025-10-23T15:38:55.121Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:38:55.121Z] [LOG]       Calculated At: Oct 23, 2025, 21:08:55
[2025-10-23T15:38:55.121Z] [LOG]       Expected Earned (until NOW): Rs.36975.55
[2025-10-23T15:38:55.121Z] [LOG]       Actual Earned (until NOW): Rs.10975.97
[2025-10-23T15:38:55.122Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:38:55.122Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T15:38:55.122Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:38:55.122Z] [LOG]       📉 Shortfall: 102.50 hours (70.32% of expected)
[2025-10-23T15:38:55.122Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:38:55.123Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:38:55.123Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:38:55.123Z] [LOG]    Actual Earned Base: Rs.10975.97
[2025-10-23T15:38:55.123Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:38:55.124Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:38:55.124Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:38:55.124Z] [LOG]    Gross Salary: 10975.973897749998
[2025-10-23T15:38:55.124Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:38:55.124Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:38:55.125Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.125Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:38:55.125Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.125Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:38:55.125Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.125Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:38:55.125Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.126Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:38:55.126Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.126Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:38:55.126Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.126Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:38:55.126Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.126Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:38:55.126Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.126Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:38:55.126Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.126Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:38:55.126Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.126Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:38:55.126Z] [LOG]    EPF/ETF calculated on: Rs.10975.97
[2025-10-23T15:38:55.126Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:38:55.126Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:38:55.127Z] [LOG] 💰 GROSS CALCULATION for Hari null:
[2025-10-23T15:38:55.127Z] [LOG]    Base Salary: 50000
[2025-10-23T15:38:55.127Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:38:55.127Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:38:55.127Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.127Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:38:55.127Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.127Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:38:55.127Z] [LOG]    Fixed amount: 0
[2025-10-23T15:38:55.360Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:38:55.361Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:55.361Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:38:55.361Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:38:55.362Z] [LOG]    Actual Earned Base: Rs.10975.97
[2025-10-23T15:38:55.362Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:38:55.362Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:38:55.363Z] [LOG]    = Gross Salary: Rs.10975.97
[2025-10-23T15:38:55.363Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:38:55.363Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:38:55.363Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:38:55.364Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:55.364Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:38:55.364Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:38:55.365Z] [LOG]    Gross Salary: Rs.10975.97
[2025-10-23T15:38:55.365Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:38:55.365Z] [LOG]    = NET SALARY: Rs.10975.97
[2025-10-23T15:38:55.365Z] [LOG] 
💾 Database Update:
[2025-10-23T15:38:55.366Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:38:55.366Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:38:55.583Z] [LOG] 
📝 Components to save:
[2025-10-23T15:38:55.583Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:38:55.584Z] [LOG]    Deduction components: 1
[2025-10-23T15:38:55.584Z] [LOG] Creating components for record bf0c58c8-cafe-40e8-80f0-9df9a18be6b5: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:38:55.584Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10975.973897749998
}
[2025-10-23T15:38:55.776Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:38:55.982Z] [LOG] Created payroll_record_component: 8fd21be0-a9f7-49e5-acda-48acb3b986b3 for Base Salary
[2025-10-23T15:38:55.982Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575
}
[2025-10-23T15:38:56.193Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:38:56.403Z] [LOG] Created payroll_record_component: 573f2846-7a83-42f6-87d5-03bf3ac2f16d for Attendance Shortfall (Info)
[2025-10-23T15:38:56.793Z] [LOG] ✅ Financial balances updated successfully for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:56.794Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:38:56.794Z] [LOG] 
======================================================================
[2025-10-23T15:38:56.794Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Hari null
[2025-10-23T15:38:56.795Z] [LOG] ======================================================================
[2025-10-23T15:38:56.795Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:38:56.795Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10975.97
[2025-10-23T15:38:56.796Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:38:56.796Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:56.796Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:38:56.797Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:38:56.797Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:56.797Z] [LOG]    GROSS SALARY: Rs.10975.97
[2025-10-23T15:38:56.798Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:56.798Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:38:56.798Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:38:56.799Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:38:56.799Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:38:56.799Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:38:56.800Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:38:56.800Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:38:56.800Z] [LOG]    NET SALARY: Rs.10975.97
[2025-10-23T15:38:56.801Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:38:56.801Z] [LOG] ======================================================================

[2025-10-23T15:38:56.801Z] [LOG] ✅ Hari null: Calculation completed successfully
[2025-10-23T15:38:56.802Z] [LOG] 📊 Progress: 26/34 (76.5%)
[2025-10-23T15:38:56.802Z] [LOG] 
🧮 Processing: Safna Nawas null (EMP000021)
[2025-10-23T15:38:56.802Z] [LOG] 📋 Record ID: c29bb3a7-f6c9-4be4-91e9-feff995d4e71
[2025-10-23T15:38:56.803Z] [LOG] 
======================================================================
[2025-10-23T15:38:56.803Z] [LOG] 🧮 CALCULATING PAYROLL: Safna Nawas null (EMP000021)
[2025-10-23T15:38:56.803Z] [LOG] ======================================================================
[2025-10-23T15:38:57.601Z] [LOG] 🔍 Component filtering for employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-23T15:38:57.601Z] [LOG]    Total components: 13
[2025-10-23T15:38:57.602Z] [LOG]    Applicable components: 13
[2025-10-23T15:38:57.602Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T15:38:58.821Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:38:58.821Z] [LOG] 🔄 Processing financial records for employee 0143c977-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:38:59.022Z] [LOG] 📊 Found 0 active loans for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:59.221Z] [LOG] 📊 Found 0 active advances for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:59.422Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:59.422Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:38:59.422Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:38:59.613Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:38:59.613Z] [LOG]    Employee ID: 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T15:38:59.613Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:38:59.613Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:38:59.614Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:38:59.813Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:38:59.813Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:38:59.814Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:38:59.814Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:38:59.814Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:38:59.814Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:38:59.815Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:39:00.460Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:39:00.461Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:39:00.673Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:39:00.674Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:39:00.674Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:39:00.674Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:39:00.674Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:39:00.674Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:39:00.674Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:39:00.674Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:39:00.872Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:39:00.872Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:39:00.872Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:39:00.873Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:39:01.073Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:39:01.073Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:39:01.073Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:39:01.074Z] [LOG]       Current Time: 21:09:01
[2025-10-23T15:39:01.074Z] [LOG]       Expected Hours (scheduled → now): 12.65h
[2025-10-23T15:39:01.074Z] [LOG]       Actual Hours (check-in → now): 12.65h
[2025-10-23T15:39:01.074Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:39:01.074Z] [LOG]       Weekday: 131.65h
[2025-10-23T15:39:01.074Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:39:01.074Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:01.075Z] [LOG]       Total Expected: 145.15h
[2025-10-23T15:39:01.075Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:39:01.075Z] [LOG]       Weekday: 38.15h (includes 12.65h live)
[2025-10-23T15:39:01.075Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:39:01.075Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:01.075Z] [LOG]       Total Actual: 42.65h
[2025-10-23T15:39:01.075Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:39:01.075Z] [LOG]       Weekday: 131.65h × Rs.235.29 = Rs.30976.00
[2025-10-23T15:39:01.075Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:39:01.075Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:01.076Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:01.076Z] [LOG]       Total Expected Earned: Rs.36975.94
[2025-10-23T15:39:01.076Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:39:01.076Z] [LOG]       Weekday: 38.15h × Rs.235.29 = Rs.8976.38
[2025-10-23T15:39:01.076Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:39:01.076Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:01.076Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:01.076Z] [LOG]       Total Actual Earned: Rs.10976.36
[2025-10-23T15:39:01.076Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:39:01.077Z] [LOG]       Calculated At: Oct 23, 2025, 21:09:01
[2025-10-23T15:39:01.077Z] [LOG]       Expected Earned (until NOW): Rs.36975.94
[2025-10-23T15:39:01.077Z] [LOG]       Actual Earned (until NOW): Rs.10976.36
[2025-10-23T15:39:01.077Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:01.077Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T15:39:01.077Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:39:01.077Z] [LOG]       📉 Shortfall: 102.50 hours (70.31% of expected)
[2025-10-23T15:39:01.077Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:39:01.077Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:39:01.077Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:39:01.077Z] [LOG]    Actual Earned Base: Rs.10976.36
[2025-10-23T15:39:01.078Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:39:01.078Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:39:01.078Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:39:01.078Z] [LOG]    Gross Salary: 10976.363629491665
[2025-10-23T15:39:01.078Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:39:01.078Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:39:01.078Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.078Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:39:01.078Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.078Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:39:01.079Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.079Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:39:01.079Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.079Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:39:01.080Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.080Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:39:01.081Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.081Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:39:01.081Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.081Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:39:01.081Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.082Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:39:01.082Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.082Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:39:01.083Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.083Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:39:01.083Z] [LOG]    EPF/ETF calculated on: Rs.10976.36
[2025-10-23T15:39:01.083Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:39:01.084Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:39:01.085Z] [LOG] 💰 GROSS CALCULATION for Safna Nawas null:
[2025-10-23T15:39:01.085Z] [LOG]    Base Salary: 50000
[2025-10-23T15:39:01.085Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:39:01.085Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:39:01.085Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.086Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:39:01.086Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.086Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:39:01.086Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:01.273Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:39:01.273Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:01.273Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:39:01.274Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:39:01.274Z] [LOG]    Actual Earned Base: Rs.10976.36
[2025-10-23T15:39:01.274Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:39:01.274Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:39:01.274Z] [LOG]    = Gross Salary: Rs.10976.36
[2025-10-23T15:39:01.274Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:39:01.274Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:39:01.274Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:39:01.275Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:01.275Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:39:01.275Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:39:01.275Z] [LOG]    Gross Salary: Rs.10976.36
[2025-10-23T15:39:01.275Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:39:01.275Z] [LOG]    = NET SALARY: Rs.10976.36
[2025-10-23T15:39:01.275Z] [LOG] 
💾 Database Update:
[2025-10-23T15:39:01.275Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:39:01.275Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:39:01.491Z] [LOG] 
📝 Components to save:
[2025-10-23T15:39:01.492Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:39:01.492Z] [LOG]    Deduction components: 1
[2025-10-23T15:39:01.492Z] [LOG] Creating components for record c29bb3a7-f6c9-4be4-91e9-feff995d4e71: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:39:01.493Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10976.363629491665
}
[2025-10-23T15:39:01.692Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:39:01.903Z] [LOG] Created payroll_record_component: 664f1e62-f905-4b48-8033-bda42ae135d0 for Base Salary
[2025-10-23T15:39:01.903Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T15:39:02.110Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:39:02.321Z] [LOG] Created payroll_record_component: 68c3cd44-2214-4f6b-8732-d18039346275 for Attendance Shortfall (Info)
[2025-10-23T15:39:02.713Z] [LOG] ✅ Financial balances updated successfully for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:02.713Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:39:02.713Z] [LOG] 
======================================================================
[2025-10-23T15:39:02.714Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Safna Nawas null
[2025-10-23T15:39:02.714Z] [LOG] ======================================================================
[2025-10-23T15:39:02.714Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:39:02.715Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10976.36
[2025-10-23T15:39:02.715Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:39:02.715Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:02.715Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:02.716Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:39:02.716Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:02.716Z] [LOG]    GROSS SALARY: Rs.10976.36
[2025-10-23T15:39:02.717Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:02.717Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:39:02.717Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:39:02.717Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:39:02.717Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:39:02.718Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:39:02.718Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:02.718Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:02.718Z] [LOG]    NET SALARY: Rs.10976.36
[2025-10-23T15:39:02.718Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:39:02.718Z] [LOG] ======================================================================

[2025-10-23T15:39:02.718Z] [LOG] ✅ Safna Nawas null: Calculation completed successfully
[2025-10-23T15:39:02.719Z] [LOG] 📊 Progress: 27/34 (79.4%)
[2025-10-23T15:39:02.719Z] [LOG] 
🧮 Processing: Saru null (EMP000022)
[2025-10-23T15:39:02.719Z] [LOG] 📋 Record ID: c6af06f3-f95e-420e-a25f-a8bdf9196516
[2025-10-23T15:39:02.719Z] [LOG] 
======================================================================
[2025-10-23T15:39:02.719Z] [LOG] 🧮 CALCULATING PAYROLL: Saru null (EMP000022)
[2025-10-23T15:39:02.719Z] [LOG] ======================================================================
[2025-10-23T15:39:03.514Z] [LOG] 🔍 Component filtering for employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-23T15:39:03.514Z] [LOG]    Total components: 13
[2025-10-23T15:39:03.514Z] [LOG]    Applicable components: 13
[2025-10-23T15:39:03.514Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T15:39:04.782Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:39:04.783Z] [LOG] 🔄 Processing financial records for employee 0143cc7e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:39:04.993Z] [LOG] 📊 Found 0 active loans for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:05.210Z] [LOG] 📊 Found 0 active advances for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:05.430Z] [LOG] 📊 Found 0 approved bonuses for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:05.430Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:39:05.431Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:39:05.634Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:39:05.634Z] [LOG]    Employee ID: 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:05.635Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:39:05.635Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:39:05.636Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:39:05.881Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:39:05.882Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:39:05.882Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:39:05.882Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:39:05.882Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:39:05.882Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:39:05.882Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:39:06.558Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:39:06.558Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:39:06.774Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:39:06.774Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:39:06.774Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:39:06.775Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:39:06.775Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:39:06.775Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:39:06.776Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:39:06.776Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:39:06.989Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:39:06.989Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:39:06.990Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:39:06.990Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:39:07.193Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:39:07.194Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:39:07.194Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:39:07.194Z] [LOG]       Current Time: 21:09:07
[2025-10-23T15:39:07.195Z] [LOG]       Expected Hours (scheduled → now): 12.65h
[2025-10-23T15:39:07.195Z] [LOG]       Actual Hours (check-in → now): 12.65h
[2025-10-23T15:39:07.195Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:39:07.195Z] [LOG]       Weekday: 131.65h
[2025-10-23T15:39:07.195Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:39:07.195Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:07.195Z] [LOG]       Total Expected: 145.15h
[2025-10-23T15:39:07.196Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:39:07.196Z] [LOG]       Weekday: 38.15h (includes 12.65h live)
[2025-10-23T15:39:07.196Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:39:07.196Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:07.196Z] [LOG]       Total Actual: 42.65h
[2025-10-23T15:39:07.196Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:39:07.196Z] [LOG]       Weekday: 131.65h × Rs.235.29 = Rs.30976.40
[2025-10-23T15:39:07.196Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:39:07.196Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:07.196Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:07.196Z] [LOG]       Total Expected Earned: Rs.36976.34
[2025-10-23T15:39:07.197Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:39:07.197Z] [LOG]       Weekday: 38.15h × Rs.235.29 = Rs.8976.78
[2025-10-23T15:39:07.197Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:39:07.197Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:07.197Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:07.197Z] [LOG]       Total Actual Earned: Rs.10976.76
[2025-10-23T15:39:07.197Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:39:07.197Z] [LOG]       Calculated At: Oct 23, 2025, 21:09:07
[2025-10-23T15:39:07.197Z] [LOG]       Expected Earned (until NOW): Rs.36976.34
[2025-10-23T15:39:07.197Z] [LOG]       Actual Earned (until NOW): Rs.10976.76
[2025-10-23T15:39:07.197Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:07.197Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T15:39:07.197Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:39:07.197Z] [LOG]       📉 Shortfall: 102.50 hours (70.31% of expected)
[2025-10-23T15:39:07.198Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:39:07.198Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:39:07.198Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:39:07.198Z] [LOG]    Actual Earned Base: Rs.10976.76
[2025-10-23T15:39:07.198Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:39:07.198Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:39:07.198Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:39:07.198Z] [LOG]    Gross Salary: 10976.763622491666
[2025-10-23T15:39:07.198Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:39:07.198Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:39:07.198Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.198Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:39:07.198Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.198Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:39:07.198Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.198Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:39:07.198Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.199Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:39:07.199Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.199Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:39:07.199Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.199Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:39:07.199Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.199Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:39:07.199Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.199Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:39:07.199Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.199Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:39:07.199Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.199Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:39:07.199Z] [LOG]    EPF/ETF calculated on: Rs.10976.76
[2025-10-23T15:39:07.199Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:39:07.199Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:39:07.200Z] [LOG] 💰 GROSS CALCULATION for Saru null:
[2025-10-23T15:39:07.200Z] [LOG]    Base Salary: 50000
[2025-10-23T15:39:07.200Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:39:07.200Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:39:07.200Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.200Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:39:07.200Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.200Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:39:07.200Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:07.412Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:39:07.412Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:07.413Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:39:07.413Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:39:07.413Z] [LOG]    Actual Earned Base: Rs.10976.76
[2025-10-23T15:39:07.413Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:39:07.413Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:39:07.413Z] [LOG]    = Gross Salary: Rs.10976.76
[2025-10-23T15:39:07.414Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:39:07.414Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:39:07.414Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:39:07.414Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:07.415Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:39:07.415Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:39:07.415Z] [LOG]    Gross Salary: Rs.10976.76
[2025-10-23T15:39:07.415Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:39:07.415Z] [LOG]    = NET SALARY: Rs.10976.76
[2025-10-23T15:39:07.415Z] [LOG] 
💾 Database Update:
[2025-10-23T15:39:07.416Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:39:07.416Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:39:07.613Z] [LOG] 
📝 Components to save:
[2025-10-23T15:39:07.614Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:39:07.614Z] [LOG]    Deduction components: 1
[2025-10-23T15:39:07.614Z] [LOG] Creating components for record c6af06f3-f95e-420e-a25f-a8bdf9196516: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:39:07.615Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10976.763622491666
}
[2025-10-23T15:39:07.813Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:39:08.032Z] [LOG] Created payroll_record_component: 499035c4-2d8b-4412-8136-cec3e02393ab for Base Salary
[2025-10-23T15:39:08.032Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T15:39:08.260Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:39:08.493Z] [LOG] Created payroll_record_component: 2e75c338-11dd-4a6c-a485-4b147e8a0ba1 for Attendance Shortfall (Info)
[2025-10-23T15:39:08.894Z] [LOG] ✅ Financial balances updated successfully for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:08.894Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:39:08.894Z] [LOG] 
======================================================================
[2025-10-23T15:39:08.895Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Saru null
[2025-10-23T15:39:08.895Z] [LOG] ======================================================================
[2025-10-23T15:39:08.896Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:39:08.896Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10976.76
[2025-10-23T15:39:08.896Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:39:08.897Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:08.897Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:08.897Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:39:08.898Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:08.898Z] [LOG]    GROSS SALARY: Rs.10976.76
[2025-10-23T15:39:08.898Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:08.898Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:39:08.899Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:39:08.899Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:39:08.899Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:39:08.899Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:39:08.900Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:08.900Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:08.900Z] [LOG]    NET SALARY: Rs.10976.76
[2025-10-23T15:39:08.900Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:39:08.900Z] [LOG] ======================================================================

[2025-10-23T15:39:08.900Z] [LOG] ✅ Saru null: Calculation completed successfully
[2025-10-23T15:39:08.901Z] [LOG] 📊 Progress: 28/34 (82.4%)
[2025-10-23T15:39:08.901Z] [LOG] 
🧮 Processing: Anoj null (EMP000014)
[2025-10-23T15:39:08.901Z] [LOG] 📋 Record ID: da148ce7-04fa-47c2-a116-3d6938b16dee
[2025-10-23T15:39:08.901Z] [LOG] 
======================================================================
[2025-10-23T15:39:08.901Z] [LOG] 🧮 CALCULATING PAYROLL: Anoj null (EMP000014)
[2025-10-23T15:39:08.901Z] [LOG] ======================================================================
[2025-10-23T15:39:09.717Z] [LOG] 🔍 Component filtering for employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-23T15:39:09.717Z] [LOG]    Total components: 13
[2025-10-23T15:39:09.717Z] [LOG]    Applicable components: 13
[2025-10-23T15:39:09.718Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T15:39:10.997Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:39:10.998Z] [LOG] 🔄 Processing financial records for employee 0143afc6-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:39:11.218Z] [LOG] 📊 Found 0 active loans for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:11.428Z] [LOG] 📊 Found 0 active advances for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:11.640Z] [LOG] 📊 Found 0 approved bonuses for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:11.640Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:39:11.641Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:39:11.861Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:39:11.861Z] [LOG]    Employee ID: 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:11.861Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:39:11.862Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:39:11.862Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:39:12.078Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:39:12.078Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:39:12.078Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:39:12.078Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:39:12.078Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:39:12.078Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:39:12.078Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:39:12.714Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:39:12.714Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:39:12.920Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:39:12.921Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:39:12.921Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:39:12.921Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:39:12.921Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:39:12.921Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:39:12.921Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:39:12.921Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:39:13.113Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:39:13.113Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:39:13.113Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:39:13.113Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:39:13.314Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:39:13.314Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:39:13.315Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:39:13.315Z] [LOG]       Current Time: 21:09:13
[2025-10-23T15:39:13.315Z] [LOG]       Expected Hours (scheduled → now): 12.65h
[2025-10-23T15:39:13.316Z] [LOG]       Actual Hours (check-in → now): 12.65h
[2025-10-23T15:39:13.316Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:39:13.316Z] [LOG]       Weekday: 131.65h
[2025-10-23T15:39:13.317Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:39:13.317Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:13.317Z] [LOG]       Total Expected: 145.15h
[2025-10-23T15:39:13.317Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:39:13.317Z] [LOG]       Weekday: 38.15h (includes 12.65h live)
[2025-10-23T15:39:13.318Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:39:13.318Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:13.318Z] [LOG]       Total Actual: 42.65h
[2025-10-23T15:39:13.318Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:39:13.319Z] [LOG]       Weekday: 131.65h × Rs.235.29 = Rs.30976.80
[2025-10-23T15:39:13.319Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:39:13.319Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:13.319Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:13.319Z] [LOG]       Total Expected Earned: Rs.36976.74
[2025-10-23T15:39:13.320Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:39:13.320Z] [LOG]       Weekday: 38.15h × Rs.235.29 = Rs.8977.18
[2025-10-23T15:39:13.320Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:39:13.320Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:13.320Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:13.320Z] [LOG]       Total Actual Earned: Rs.10977.16
[2025-10-23T15:39:13.321Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:39:13.321Z] [LOG]       Calculated At: Oct 23, 2025, 21:09:13
[2025-10-23T15:39:13.321Z] [LOG]       Expected Earned (until NOW): Rs.36976.74
[2025-10-23T15:39:13.321Z] [LOG]       Actual Earned (until NOW): Rs.10977.16
[2025-10-23T15:39:13.321Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:13.321Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T15:39:13.321Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:39:13.321Z] [LOG]       📉 Shortfall: 102.50 hours (70.31% of expected)
[2025-10-23T15:39:13.321Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:39:13.321Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:39:13.322Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:39:13.322Z] [LOG]    Actual Earned Base: Rs.10977.16
[2025-10-23T15:39:13.322Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:39:13.322Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:39:13.322Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:39:13.322Z] [LOG]    Gross Salary: 10977.163680849999
[2025-10-23T15:39:13.322Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:39:13.322Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:39:13.322Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.322Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:39:13.322Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.322Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:39:13.322Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.322Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:39:13.322Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.323Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:39:13.323Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.323Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:39:13.323Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.323Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:39:13.323Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.323Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:39:13.323Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.323Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:39:13.323Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.323Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:39:13.323Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.323Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:39:13.323Z] [LOG]    EPF/ETF calculated on: Rs.10977.16
[2025-10-23T15:39:13.323Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:39:13.323Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:39:13.323Z] [LOG] 💰 GROSS CALCULATION for Anoj null:
[2025-10-23T15:39:13.324Z] [LOG]    Base Salary: 50000
[2025-10-23T15:39:13.324Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:39:13.324Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:39:13.324Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.324Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:39:13.324Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.324Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:39:13.324Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:13.513Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:39:13.513Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:13.513Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:39:13.513Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:39:13.514Z] [LOG]    Actual Earned Base: Rs.10977.16
[2025-10-23T15:39:13.514Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:39:13.514Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:39:13.515Z] [LOG]    = Gross Salary: Rs.10977.16
[2025-10-23T15:39:13.515Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:39:13.515Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:39:13.515Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:39:13.515Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:13.515Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:39:13.515Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:39:13.516Z] [LOG]    Gross Salary: Rs.10977.16
[2025-10-23T15:39:13.516Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:39:13.516Z] [LOG]    = NET SALARY: Rs.10977.16
[2025-10-23T15:39:13.516Z] [LOG] 
💾 Database Update:
[2025-10-23T15:39:13.516Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:39:13.516Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:39:13.715Z] [LOG] 
📝 Components to save:
[2025-10-23T15:39:13.715Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:39:13.715Z] [LOG]    Deduction components: 1
[2025-10-23T15:39:13.715Z] [LOG] Creating components for record da148ce7-04fa-47c2-a116-3d6938b16dee: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:39:13.716Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10977.163680849999
}
[2025-10-23T15:39:13.920Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:39:14.122Z] [LOG] Created payroll_record_component: da3c764d-bead-450b-aeaf-8f4058fdfc63 for Base Salary
[2025-10-23T15:39:14.123Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T15:39:14.316Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:39:14.524Z] [LOG] Created payroll_record_component: 6abef3de-eed4-411f-b9bf-6e7844c8b955 for Attendance Shortfall (Info)
[2025-10-23T15:39:14.922Z] [LOG] ✅ Financial balances updated successfully for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:14.922Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:39:14.923Z] [LOG] 
======================================================================
[2025-10-23T15:39:14.923Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Anoj null
[2025-10-23T15:39:14.923Z] [LOG] ======================================================================
[2025-10-23T15:39:14.924Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:39:14.924Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10977.16
[2025-10-23T15:39:14.924Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:39:14.925Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:14.925Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:14.925Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:39:14.926Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:14.926Z] [LOG]    GROSS SALARY: Rs.10977.16
[2025-10-23T15:39:14.926Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:14.926Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:39:14.927Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:39:14.927Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:39:14.927Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:39:14.928Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:39:14.928Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:14.928Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:14.929Z] [LOG]    NET SALARY: Rs.10977.16
[2025-10-23T15:39:14.929Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:39:14.929Z] [LOG] ======================================================================

[2025-10-23T15:39:14.930Z] [LOG] ✅ Anoj null: Calculation completed successfully
[2025-10-23T15:39:14.930Z] [LOG] 📊 Progress: 29/34 (85.3%)
[2025-10-23T15:39:14.930Z] [LOG] 
🧮 Processing: Shandeep null (EMP000034)
[2025-10-23T15:39:14.930Z] [LOG] 📋 Record ID: db671945-0d90-4dc3-bc69-10b843a53654
[2025-10-23T15:39:14.931Z] [LOG] 
======================================================================
[2025-10-23T15:39:14.931Z] [LOG] 🧮 CALCULATING PAYROLL: Shandeep null (EMP000034)
[2025-10-23T15:39:14.931Z] [LOG] ======================================================================
[2025-10-23T15:39:15.772Z] [LOG] 🔍 Component filtering for employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-23T15:39:15.773Z] [LOG]    Total components: 13
[2025-10-23T15:39:15.773Z] [LOG]    Applicable components: 13
[2025-10-23T15:39:15.773Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-23T15:39:17.002Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:39:17.002Z] [LOG] 🔄 Processing financial records for employee 0143fc5a-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:39:17.261Z] [LOG] 📊 Found 0 active loans for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:17.473Z] [LOG] 📊 Found 0 active advances for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:17.681Z] [LOG] 📊 Found 0 approved bonuses for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:17.681Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:39:17.681Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:39:17.881Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:39:17.881Z] [LOG]    Employee ID: 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:17.882Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:39:17.882Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:39:17.882Z] [LOG]    Base Salary (Full Month): Rs.80000.00
[2025-10-23T15:39:18.081Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:39:18.082Z] [LOG]       Daily Salary: Rs.3200.00
[2025-10-23T15:39:18.082Z] [LOG]       Weekday Hourly Rate: Rs.376.47
[2025-10-23T15:39:18.082Z] [LOG]       Saturday Hourly Rate: Rs.711.11
[2025-10-23T15:39:18.083Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:39:18.083Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:39:18.083Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:39:18.715Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:39:18.716Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:39:18.921Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:39:18.922Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:39:18.922Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:39:18.922Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:39:18.923Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:39:18.923Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:39:18.923Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:39:18.923Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:39:19.135Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:39:19.135Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:39:19.135Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:39:19.135Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:39:19.323Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:39:19.323Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:39:19.324Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:39:19.325Z] [LOG]       Current Time: 21:09:19
[2025-10-23T15:39:19.325Z] [LOG]       Expected Hours (scheduled → now): 12.66h
[2025-10-23T15:39:19.325Z] [LOG]       Actual Hours (check-in → now): 12.66h
[2025-10-23T15:39:19.326Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:39:19.326Z] [LOG]       Weekday: 131.66h
[2025-10-23T15:39:19.326Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:39:19.327Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:19.327Z] [LOG]       Total Expected: 145.16h
[2025-10-23T15:39:19.327Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:39:19.327Z] [LOG]       Weekday: 38.16h (includes 12.66h live)
[2025-10-23T15:39:19.328Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:39:19.328Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:19.328Z] [LOG]       Total Actual: 42.66h
[2025-10-23T15:39:19.328Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:39:19.329Z] [LOG]       Weekday: 131.66h × Rs.376.47 = Rs.49564.30
[2025-10-23T15:39:19.329Z] [LOG]       Saturday: 13.50h × Rs.711.11 = Rs.9599.99
[2025-10-23T15:39:19.329Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:19.329Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:19.329Z] [LOG]       Total Expected Earned: Rs.59164.28
[2025-10-23T15:39:19.330Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:39:19.330Z] [LOG]       Weekday: 38.16h × Rs.376.47 = Rs.14364.35
[2025-10-23T15:39:19.330Z] [LOG]       Saturday: 4.50h × Rs.711.11 = Rs.3199.99
[2025-10-23T15:39:19.330Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:19.330Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:19.330Z] [LOG]       Total Actual Earned: Rs.17564.35
[2025-10-23T15:39:19.330Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:39:19.331Z] [LOG]       Calculated At: Oct 23, 2025, 21:09:19
[2025-10-23T15:39:19.331Z] [LOG]       Expected Earned (until NOW): Rs.59164.28
[2025-10-23T15:39:19.331Z] [LOG]       Actual Earned (until NOW): Rs.17564.35
[2025-10-23T15:39:19.331Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:19.331Z] [LOG]       Attendance Deduction: Rs.41599.94
[2025-10-23T15:39:19.331Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:39:19.331Z] [LOG]       📉 Shortfall: 102.50 hours (70.31% of expected)
[2025-10-23T15:39:19.331Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:39:19.331Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:39:19.332Z] [LOG]    Base Salary (Full): Rs.80000.00
[2025-10-23T15:39:19.332Z] [LOG]    Actual Earned Base: Rs.17564.35
[2025-10-23T15:39:19.332Z] [LOG]    Attendance Shortfall: Rs.41599.94
[2025-10-23T15:39:19.332Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:39:19.332Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:39:19.332Z] [LOG]    Gross Salary: 17564.346202725
[2025-10-23T15:39:19.332Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:39:19.332Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:39:19.332Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.332Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:39:19.332Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.332Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:39:19.332Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.332Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:39:19.332Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.332Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:39:19.332Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.332Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:39:19.333Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.333Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:39:19.333Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.333Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:39:19.333Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.333Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:39:19.333Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.333Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:39:19.333Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.333Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:39:19.334Z] [LOG]    EPF/ETF calculated on: Rs.17564.35
[2025-10-23T15:39:19.334Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:39:19.334Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:39:19.334Z] [LOG] 💰 GROSS CALCULATION for Shandeep null:
[2025-10-23T15:39:19.334Z] [LOG]    Base Salary: 80000
[2025-10-23T15:39:19.334Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:39:19.334Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:39:19.334Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.334Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:39:19.334Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.334Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:39:19.334Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:19.534Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:39:19.535Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:19.535Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:39:19.535Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:39:19.536Z] [LOG]    Actual Earned Base: Rs.17564.35
[2025-10-23T15:39:19.536Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:39:19.536Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:39:19.536Z] [LOG]    = Gross Salary: Rs.17564.35
[2025-10-23T15:39:19.537Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:39:19.537Z] [LOG]    Attendance Shortfall (Info): Rs.41599.94
[2025-10-23T15:39:19.537Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:39:19.538Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:19.538Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:39:19.538Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:39:19.538Z] [LOG]    Gross Salary: Rs.17564.35
[2025-10-23T15:39:19.539Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:39:19.539Z] [LOG]    = NET SALARY: Rs.17564.35
[2025-10-23T15:39:19.539Z] [LOG] 
💾 Database Update:
[2025-10-23T15:39:19.539Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:39:19.539Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:39:19.746Z] [LOG] 
📝 Components to save:
[2025-10-23T15:39:19.746Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:39:19.746Z] [LOG]    Deduction components: 1
[2025-10-23T15:39:19.747Z] [LOG] Creating components for record db671945-0d90-4dc3-bc69-10b843a53654: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:39:19.747Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 17564.346202725
}
[2025-10-23T15:39:19.983Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:39:20.203Z] [LOG] Created payroll_record_component: e3981e55-e8fa-4118-920e-65e976830d9c for Base Salary
[2025-10-23T15:39:20.203Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 41599.93500000001
}
[2025-10-23T15:39:20.393Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:39:20.603Z] [LOG] Created payroll_record_component: 41fbc876-84e1-4963-b4b5-8c093239473a for Attendance Shortfall (Info)
[2025-10-23T15:39:21.001Z] [LOG] ✅ Financial balances updated successfully for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:21.001Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:39:21.002Z] [LOG] 
======================================================================
[2025-10-23T15:39:21.002Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Shandeep null
[2025-10-23T15:39:21.002Z] [LOG] ======================================================================
[2025-10-23T15:39:21.002Z] [LOG]    Base Salary (Full): Rs.80000.00
[2025-10-23T15:39:21.003Z] [LOG]    Actual Earned Base (Attendance-based): Rs.17564.35
[2025-10-23T15:39:21.003Z] [LOG]    Attendance Shortfall: Rs.41599.94
[2025-10-23T15:39:21.003Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:21.003Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:21.004Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:39:21.004Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:21.004Z] [LOG]    GROSS SALARY: Rs.17564.35
[2025-10-23T15:39:21.004Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:21.005Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:39:21.005Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:39:21.005Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:39:21.005Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:39:21.005Z] [LOG]       - Attendance Shortfall (Info): Rs.41599.94
[2025-10-23T15:39:21.006Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:21.006Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:21.006Z] [LOG]    NET SALARY: Rs.17564.35
[2025-10-23T15:39:21.006Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:39:21.006Z] [LOG] ======================================================================

[2025-10-23T15:39:21.006Z] [LOG] ✅ Shandeep null: Calculation completed successfully
[2025-10-23T15:39:21.006Z] [LOG] 📊 Progress: 30/34 (88.2%)
[2025-10-23T15:39:21.007Z] [LOG] 
🧮 Processing: Dharshika null (EMP000009)
[2025-10-23T15:39:21.007Z] [LOG] 📋 Record ID: dc9b61cd-badb-4d40-beec-c2880c18e427
[2025-10-23T15:39:21.007Z] [LOG] 
======================================================================
[2025-10-23T15:39:21.007Z] [LOG] 🧮 CALCULATING PAYROLL: Dharshika null (EMP000009)
[2025-10-23T15:39:21.007Z] [LOG] ======================================================================
[2025-10-23T15:39:21.811Z] [LOG] 🔍 Component filtering for employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-23T15:39:21.812Z] [LOG]    Total components: 13
[2025-10-23T15:39:21.812Z] [LOG]    Applicable components: 13
[2025-10-23T15:39:21.812Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T15:39:22.974Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:39:22.974Z] [LOG] 🔄 Processing financial records for employee 0143a994-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:39:23.182Z] [LOG] 📊 Found 0 active loans for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:23.374Z] [LOG] 📊 Found 0 active advances for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:23.573Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:23.573Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:39:23.574Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:39:23.771Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:39:23.771Z] [LOG]    Employee ID: 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:23.771Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:39:23.772Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:39:23.772Z] [LOG]    Base Salary (Full Month): Rs.100000.00
[2025-10-23T15:39:23.969Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:39:23.969Z] [LOG]       Daily Salary: Rs.4000.00
[2025-10-23T15:39:23.970Z] [LOG]       Weekday Hourly Rate: Rs.470.59
[2025-10-23T15:39:23.970Z] [LOG]       Saturday Hourly Rate: Rs.888.89
[2025-10-23T15:39:23.970Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:39:23.970Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:39:23.971Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:39:24.574Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:39:24.574Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:39:24.773Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:39:24.773Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:39:24.774Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:39:24.774Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:39:24.774Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:39:24.774Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:39:24.774Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:39:24.774Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:39:24.975Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:39:24.975Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:39:24.975Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:39:24.976Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:39:25.182Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:39:25.182Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:39:25.182Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:39:25.182Z] [LOG]       Current Time: 21:09:25
[2025-10-23T15:39:25.183Z] [LOG]       Expected Hours (scheduled → now): 12.66h
[2025-10-23T15:39:25.183Z] [LOG]       Actual Hours (check-in → now): 12.66h
[2025-10-23T15:39:25.183Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:39:25.183Z] [LOG]       Weekday: 131.66h
[2025-10-23T15:39:25.183Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:39:25.183Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:25.183Z] [LOG]       Total Expected: 145.16h
[2025-10-23T15:39:25.183Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:39:25.183Z] [LOG]       Weekday: 38.16h (includes 12.66h live)
[2025-10-23T15:39:25.184Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:39:25.184Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:25.184Z] [LOG]       Total Actual: 42.66h
[2025-10-23T15:39:25.184Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:39:25.184Z] [LOG]       Weekday: 131.66h × Rs.470.59 = Rs.61956.47
[2025-10-23T15:39:25.184Z] [LOG]       Saturday: 13.50h × Rs.888.89 = Rs.12000.01
[2025-10-23T15:39:25.184Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:25.185Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:25.185Z] [LOG]       Total Expected Earned: Rs.73956.48
[2025-10-23T15:39:25.185Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:39:25.185Z] [LOG]       Weekday: 38.16h × Rs.470.59 = Rs.17956.30
[2025-10-23T15:39:25.185Z] [LOG]       Saturday: 4.50h × Rs.888.89 = Rs.4000.01
[2025-10-23T15:39:25.185Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:25.185Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:25.185Z] [LOG]       Total Actual Earned: Rs.21956.31
[2025-10-23T15:39:25.186Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:39:25.186Z] [LOG]       Calculated At: Oct 23, 2025, 21:09:25
[2025-10-23T15:39:25.186Z] [LOG]       Expected Earned (until NOW): Rs.73956.48
[2025-10-23T15:39:25.186Z] [LOG]       Actual Earned (until NOW): Rs.21956.31
[2025-10-23T15:39:25.186Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:25.186Z] [LOG]       Attendance Deduction: Rs.52000.17
[2025-10-23T15:39:25.186Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:39:25.187Z] [LOG]       📉 Shortfall: 102.50 hours (70.31% of expected)
[2025-10-23T15:39:25.187Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:39:25.187Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:39:25.187Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T15:39:25.187Z] [LOG]    Actual Earned Base: Rs.21956.31
[2025-10-23T15:39:25.187Z] [LOG]    Attendance Shortfall: Rs.52000.17
[2025-10-23T15:39:25.187Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:39:25.187Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:39:25.188Z] [LOG]    Gross Salary: 21956.30527705
[2025-10-23T15:39:25.188Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:39:25.188Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:39:25.188Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.188Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:39:25.188Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.188Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:39:25.188Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.188Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:39:25.188Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.188Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:39:25.189Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.189Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:39:25.189Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.189Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:39:25.189Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.189Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:39:25.189Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.189Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:39:25.189Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.189Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:39:25.189Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.189Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:39:25.189Z] [LOG]    EPF/ETF calculated on: Rs.21956.31
[2025-10-23T15:39:25.190Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:39:25.190Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:39:25.190Z] [LOG] 💰 GROSS CALCULATION for Dharshika null:
[2025-10-23T15:39:25.190Z] [LOG]    Base Salary: 100000
[2025-10-23T15:39:25.190Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:39:25.190Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:39:25.190Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.190Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:39:25.190Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.190Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:39:25.190Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:25.402Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:39:25.402Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:25.402Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:39:25.403Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:39:25.403Z] [LOG]    Actual Earned Base: Rs.21956.31
[2025-10-23T15:39:25.404Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:39:25.404Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:39:25.404Z] [LOG]    = Gross Salary: Rs.21956.31
[2025-10-23T15:39:25.404Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:39:25.405Z] [LOG]    Attendance Shortfall (Info): Rs.52000.17
[2025-10-23T15:39:25.405Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:39:25.405Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:25.405Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:39:25.406Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:39:25.406Z] [LOG]    Gross Salary: Rs.21956.31
[2025-10-23T15:39:25.406Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:39:25.406Z] [LOG]    = NET SALARY: Rs.21956.31
[2025-10-23T15:39:25.407Z] [LOG] 
💾 Database Update:
[2025-10-23T15:39:25.407Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:39:25.407Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:39:25.623Z] [LOG] 
📝 Components to save:
[2025-10-23T15:39:25.623Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:39:25.624Z] [LOG]    Deduction components: 1
[2025-10-23T15:39:25.624Z] [LOG] Creating components for record dc9b61cd-badb-4d40-beec-c2880c18e427: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:39:25.624Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 21956.30527705
}
[2025-10-23T15:39:25.814Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:39:26.036Z] [LOG] Created payroll_record_component: 9dc9f780-834c-411b-aa36-ba9752896eaa for Base Salary
[2025-10-23T15:39:26.037Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 52000.174999999996
}
[2025-10-23T15:39:26.261Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:39:26.482Z] [LOG] Created payroll_record_component: 44305014-03d6-48f7-8f62-03b58d7eeaac for Attendance Shortfall (Info)
[2025-10-23T15:39:26.893Z] [LOG] ✅ Financial balances updated successfully for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:26.893Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:39:26.894Z] [LOG] 
======================================================================
[2025-10-23T15:39:26.894Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Dharshika null
[2025-10-23T15:39:26.895Z] [LOG] ======================================================================
[2025-10-23T15:39:26.895Z] [LOG]    Base Salary (Full): Rs.100000.00
[2025-10-23T15:39:26.895Z] [LOG]    Actual Earned Base (Attendance-based): Rs.21956.31
[2025-10-23T15:39:26.895Z] [LOG]    Attendance Shortfall: Rs.52000.17
[2025-10-23T15:39:26.896Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:26.896Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:26.896Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:39:26.896Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:26.897Z] [LOG]    GROSS SALARY: Rs.21956.31
[2025-10-23T15:39:26.897Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:26.897Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:39:26.897Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:39:26.898Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:39:26.898Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:39:26.898Z] [LOG]       - Attendance Shortfall (Info): Rs.52000.17
[2025-10-23T15:39:26.898Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:26.899Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:26.899Z] [LOG]    NET SALARY: Rs.21956.31
[2025-10-23T15:39:26.899Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:39:26.899Z] [LOG] ======================================================================

[2025-10-23T15:39:26.900Z] [LOG] ✅ Dharshika null: Calculation completed successfully
[2025-10-23T15:39:26.900Z] [LOG] 📊 Progress: 31/34 (91.2%)
[2025-10-23T15:39:26.900Z] [LOG] 
🧮 Processing: Jessie null (EMP000013)
[2025-10-23T15:39:26.900Z] [LOG] 📋 Record ID: eaa45309-3e10-4443-b00f-d53cd29ba97d
[2025-10-23T15:39:26.900Z] [LOG] 
======================================================================
[2025-10-23T15:39:26.901Z] [LOG] 🧮 CALCULATING PAYROLL: Jessie null (EMP000013)
[2025-10-23T15:39:26.901Z] [LOG] ======================================================================
[2025-10-23T15:39:27.694Z] [LOG] 🔍 Component filtering for employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-23T15:39:27.694Z] [LOG]    Total components: 13
[2025-10-23T15:39:27.695Z] [LOG]    Applicable components: 13
[2025-10-23T15:39:27.695Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-23T15:39:28.961Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:39:28.961Z] [LOG] 🔄 Processing financial records for employee 0143ae6e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:39:29.161Z] [LOG] 📊 Found 0 active loans for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:29.361Z] [LOG] 📊 Found 0 active advances for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:29.568Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:29.568Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:39:29.568Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:39:29.756Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:39:29.756Z] [LOG]    Employee ID: 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:29.757Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:39:29.757Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:39:29.757Z] [LOG]    Base Salary (Full Month): Rs.60000.00
[2025-10-23T15:39:29.990Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:39:29.991Z] [LOG]       Daily Salary: Rs.2400.00
[2025-10-23T15:39:29.991Z] [LOG]       Weekday Hourly Rate: Rs.282.35
[2025-10-23T15:39:29.991Z] [LOG]       Saturday Hourly Rate: Rs.533.33
[2025-10-23T15:39:29.992Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:39:29.992Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:39:29.992Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:39:30.578Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:39:30.578Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:39:30.784Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:39:30.784Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:39:30.784Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:39:30.785Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:39:30.785Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:39:30.785Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:39:30.786Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:39:30.786Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:39:30.972Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:39:30.972Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:39:30.972Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:39:30.973Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:39:31.169Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:39:31.170Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:39:31.170Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:39:31.171Z] [LOG]       Current Time: 21:09:31
[2025-10-23T15:39:31.171Z] [LOG]       Expected Hours (scheduled → now): 12.66h
[2025-10-23T15:39:31.172Z] [LOG]       Actual Hours (check-in → now): 12.66h
[2025-10-23T15:39:31.172Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:39:31.172Z] [LOG]       Weekday: 131.66h
[2025-10-23T15:39:31.173Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:39:31.173Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:31.173Z] [LOG]       Total Expected: 145.16h
[2025-10-23T15:39:31.173Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:39:31.174Z] [LOG]       Weekday: 38.16h (includes 12.66h live)
[2025-10-23T15:39:31.174Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:39:31.174Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:31.175Z] [LOG]       Total Actual: 42.66h
[2025-10-23T15:39:31.175Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:39:31.175Z] [LOG]       Weekday: 131.66h × Rs.282.35 = Rs.37173.82
[2025-10-23T15:39:31.176Z] [LOG]       Saturday: 13.50h × Rs.533.33 = Rs.7199.96
[2025-10-23T15:39:31.176Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:31.176Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:31.177Z] [LOG]       Total Expected Earned: Rs.44373.78
[2025-10-23T15:39:31.177Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:39:31.177Z] [LOG]       Weekday: 38.16h × Rs.282.35 = Rs.10774.10
[2025-10-23T15:39:31.177Z] [LOG]       Saturday: 4.50h × Rs.533.33 = Rs.2399.99
[2025-10-23T15:39:31.178Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:31.178Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:31.178Z] [LOG]       Total Actual Earned: Rs.13174.08
[2025-10-23T15:39:31.179Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:39:31.179Z] [LOG]       Calculated At: Oct 23, 2025, 21:09:31
[2025-10-23T15:39:31.179Z] [LOG]       Expected Earned (until NOW): Rs.44373.78
[2025-10-23T15:39:31.180Z] [LOG]       Actual Earned (until NOW): Rs.13174.08
[2025-10-23T15:39:31.180Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:31.180Z] [LOG]       Attendance Deduction: Rs.31199.70
[2025-10-23T15:39:31.180Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:39:31.180Z] [LOG]       📉 Shortfall: 102.50 hours (70.31% of expected)
[2025-10-23T15:39:31.181Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:39:31.181Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:39:31.181Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T15:39:31.181Z] [LOG]    Actual Earned Base: Rs.13174.08
[2025-10-23T15:39:31.181Z] [LOG]    Attendance Shortfall: Rs.31199.70
[2025-10-23T15:39:31.182Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:39:31.182Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:39:31.182Z] [LOG]    Gross Salary: 13174.082101986112
[2025-10-23T15:39:31.183Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:39:31.183Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:39:31.183Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.183Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:39:31.183Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.183Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:39:31.184Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.184Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:39:31.184Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.184Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:39:31.184Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.185Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:39:31.185Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.185Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:39:31.185Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.185Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:39:31.185Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.185Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:39:31.185Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.185Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:39:31.186Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.186Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:39:31.186Z] [LOG]    EPF/ETF calculated on: Rs.13174.08
[2025-10-23T15:39:31.186Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:39:31.186Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:39:31.187Z] [LOG] 💰 GROSS CALCULATION for Jessie null:
[2025-10-23T15:39:31.187Z] [LOG]    Base Salary: 60000
[2025-10-23T15:39:31.187Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:39:31.187Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:39:31.187Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.188Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:39:31.188Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.188Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:39:31.188Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:31.393Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:39:31.393Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:31.394Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:39:31.394Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:39:31.394Z] [LOG]    Actual Earned Base: Rs.13174.08
[2025-10-23T15:39:31.394Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:39:31.394Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:39:31.395Z] [LOG]    = Gross Salary: Rs.13174.08
[2025-10-23T15:39:31.395Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:39:31.395Z] [LOG]    Attendance Shortfall (Info): Rs.31199.70
[2025-10-23T15:39:31.395Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:39:31.395Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:31.396Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:39:31.396Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:39:31.396Z] [LOG]    Gross Salary: Rs.13174.08
[2025-10-23T15:39:31.396Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:39:31.396Z] [LOG]    = NET SALARY: Rs.13174.08
[2025-10-23T15:39:31.396Z] [LOG] 
💾 Database Update:
[2025-10-23T15:39:31.397Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:39:31.397Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:39:31.608Z] [LOG] 
📝 Components to save:
[2025-10-23T15:39:31.608Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:39:31.609Z] [LOG]    Deduction components: 1
[2025-10-23T15:39:31.609Z] [LOG] Creating components for record eaa45309-3e10-4443-b00f-d53cd29ba97d: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:39:31.609Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 13174.082101986112
}
[2025-10-23T15:39:31.797Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:39:31.995Z] [LOG] Created payroll_record_component: 9977c3c8-14a7-4f6b-8785-4f6dae7cc4fa for Base Salary
[2025-10-23T15:39:31.996Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 31199.695000000007
}
[2025-10-23T15:39:32.186Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:39:32.394Z] [LOG] Created payroll_record_component: a2566227-79a1-4fa5-821f-e06d083a7f28 for Attendance Shortfall (Info)
[2025-10-23T15:39:32.787Z] [LOG] ✅ Financial balances updated successfully for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:32.787Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:39:32.788Z] [LOG] 
======================================================================
[2025-10-23T15:39:32.788Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Jessie null
[2025-10-23T15:39:32.788Z] [LOG] ======================================================================
[2025-10-23T15:39:32.789Z] [LOG]    Base Salary (Full): Rs.60000.00
[2025-10-23T15:39:32.789Z] [LOG]    Actual Earned Base (Attendance-based): Rs.13174.08
[2025-10-23T15:39:32.789Z] [LOG]    Attendance Shortfall: Rs.31199.70
[2025-10-23T15:39:32.789Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:32.790Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:32.790Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:39:32.790Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:32.791Z] [LOG]    GROSS SALARY: Rs.13174.08
[2025-10-23T15:39:32.791Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:32.791Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:39:32.791Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:39:32.792Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:39:32.792Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:39:32.792Z] [LOG]       - Attendance Shortfall (Info): Rs.31199.70
[2025-10-23T15:39:32.792Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:32.792Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:32.792Z] [LOG]    NET SALARY: Rs.13174.08
[2025-10-23T15:39:32.792Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:39:32.792Z] [LOG] ======================================================================

[2025-10-23T15:39:32.792Z] [LOG] ✅ Jessie null: Calculation completed successfully
[2025-10-23T15:39:32.793Z] [LOG] 📊 Progress: 32/34 (94.1%)
[2025-10-23T15:39:32.793Z] [LOG] 
🧮 Processing: P.D.P Dilini Madushani null (EMP000043)
[2025-10-23T15:39:32.793Z] [LOG] 📋 Record ID: f1396049-a9ba-4383-9fef-488f89765da0
[2025-10-23T15:39:32.793Z] [LOG] 
======================================================================
[2025-10-23T15:39:32.793Z] [LOG] 🧮 CALCULATING PAYROLL: P.D.P Dilini Madushani null (EMP000043)
[2025-10-23T15:39:32.793Z] [LOG] ======================================================================
[2025-10-23T15:39:33.620Z] [LOG] 🔍 Component filtering for employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-23T15:39:33.621Z] [LOG]    Total components: 13
[2025-10-23T15:39:33.621Z] [LOG]    Applicable components: 13
[2025-10-23T15:39:33.622Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-23T15:39:34.893Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:39:34.894Z] [LOG] 🔄 Processing financial records for employee 014435dc-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:39:35.097Z] [LOG] 📊 Found 0 active loans for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:35.293Z] [LOG] 📊 Found 0 active advances for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:35.498Z] [LOG] 📊 Found 0 approved bonuses for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:35.498Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:39:35.499Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:39:35.693Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:39:35.693Z] [LOG]    Employee ID: 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:35.693Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:39:35.694Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:39:35.694Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:39:35.937Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:39:35.937Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:39:35.937Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:39:35.938Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:39:35.938Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:39:35.938Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:39:35.938Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:39:36.597Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:39:36.597Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:39:36.801Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:39:36.802Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:39:36.802Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:39:36.802Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:39:36.803Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:39:36.803Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:39:36.803Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:39:36.804Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:39:36.990Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:39:36.991Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:39:36.991Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:39:36.992Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:39:37.219Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:39:37.219Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:39:37.220Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:39:37.220Z] [LOG]       Current Time: 21:09:37
[2025-10-23T15:39:37.221Z] [LOG]       Expected Hours (scheduled → now): 12.66h
[2025-10-23T15:39:37.221Z] [LOG]       Actual Hours (check-in → now): 12.66h
[2025-10-23T15:39:37.221Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:39:37.222Z] [LOG]       Weekday: 131.66h
[2025-10-23T15:39:37.222Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:39:37.222Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:37.223Z] [LOG]       Total Expected: 145.16h
[2025-10-23T15:39:37.223Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:39:37.223Z] [LOG]       Weekday: 38.16h (includes 12.66h live)
[2025-10-23T15:39:37.224Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:39:37.224Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:37.224Z] [LOG]       Total Actual: 42.66h
[2025-10-23T15:39:37.225Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:39:37.225Z] [LOG]       Weekday: 131.66h × Rs.235.29 = Rs.30978.36
[2025-10-23T15:39:37.225Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:39:37.226Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:37.226Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:37.226Z] [LOG]       Total Expected Earned: Rs.36978.30
[2025-10-23T15:39:37.226Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:39:37.227Z] [LOG]       Weekday: 38.16h × Rs.235.29 = Rs.8978.75
[2025-10-23T15:39:37.227Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:39:37.227Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:37.228Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:37.228Z] [LOG]       Total Actual Earned: Rs.10978.73
[2025-10-23T15:39:37.229Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:39:37.229Z] [LOG]       Calculated At: Oct 23, 2025, 21:09:37
[2025-10-23T15:39:37.229Z] [LOG]       Expected Earned (until NOW): Rs.36978.30
[2025-10-23T15:39:37.229Z] [LOG]       Actual Earned (until NOW): Rs.10978.73
[2025-10-23T15:39:37.230Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:37.230Z] [LOG]       Attendance Deduction: Rs.25999.57
[2025-10-23T15:39:37.230Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:39:37.231Z] [LOG]       📉 Shortfall: 102.50 hours (70.31% of expected)
[2025-10-23T15:39:37.231Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:39:37.232Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:39:37.232Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:39:37.232Z] [LOG]    Actual Earned Base: Rs.10978.73
[2025-10-23T15:39:37.232Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:39:37.232Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:39:37.232Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:39:37.232Z] [LOG]    Gross Salary: 10978.726071808334
[2025-10-23T15:39:37.233Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:39:37.233Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:39:37.233Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.233Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:39:37.233Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.233Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:39:37.233Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.233Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:39:37.234Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.234Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:39:37.234Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.234Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:39:37.234Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.234Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:39:37.234Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.234Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:39:37.234Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.235Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:39:37.235Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.235Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:39:37.235Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.235Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:39:37.235Z] [LOG]    EPF/ETF calculated on: Rs.10978.73
[2025-10-23T15:39:37.236Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:39:37.236Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:39:37.236Z] [LOG] 💰 GROSS CALCULATION for P.D.P Dilini Madushani null:
[2025-10-23T15:39:37.236Z] [LOG]    Base Salary: 50000
[2025-10-23T15:39:37.236Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:39:37.236Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:39:37.236Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.236Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:39:37.236Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.236Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:39:37.237Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:37.432Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:39:37.433Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:37.433Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:39:37.434Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:39:37.434Z] [LOG]    Actual Earned Base: Rs.10978.73
[2025-10-23T15:39:37.434Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:39:37.434Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:39:37.435Z] [LOG]    = Gross Salary: Rs.10978.73
[2025-10-23T15:39:37.435Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:39:37.436Z] [LOG]    Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:39:37.436Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:39:37.436Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:37.436Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:39:37.437Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:39:37.437Z] [LOG]    Gross Salary: Rs.10978.73
[2025-10-23T15:39:37.437Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:39:37.438Z] [LOG]    = NET SALARY: Rs.10978.73
[2025-10-23T15:39:37.438Z] [LOG] 
💾 Database Update:
[2025-10-23T15:39:37.438Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:39:37.439Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:39:37.661Z] [LOG] 
📝 Components to save:
[2025-10-23T15:39:37.662Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:39:37.662Z] [LOG]    Deduction components: 1
[2025-10-23T15:39:37.663Z] [LOG] Creating components for record f1396049-a9ba-4383-9fef-488f89765da0: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:39:37.663Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10978.726071808334
}
[2025-10-23T15:39:37.878Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:39:38.102Z] [LOG] Created payroll_record_component: 41c001c6-5d00-46a9-bc6f-70514823a3dc for Base Salary
[2025-10-23T15:39:38.102Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.574999999997
}
[2025-10-23T15:39:38.293Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:39:38.496Z] [LOG] Created payroll_record_component: 7af52559-1115-4a5c-95e2-1b1d2aa9092d for Attendance Shortfall (Info)
[2025-10-23T15:39:38.892Z] [LOG] ✅ Financial balances updated successfully for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:38.892Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:39:38.892Z] [LOG] 
======================================================================
[2025-10-23T15:39:38.893Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: P.D.P Dilini Madushani null
[2025-10-23T15:39:38.893Z] [LOG] ======================================================================
[2025-10-23T15:39:38.893Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:39:38.894Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10978.73
[2025-10-23T15:39:38.894Z] [LOG]    Attendance Shortfall: Rs.25999.57
[2025-10-23T15:39:38.894Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:38.894Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:38.895Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:39:38.895Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:38.895Z] [LOG]    GROSS SALARY: Rs.10978.73
[2025-10-23T15:39:38.896Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:38.896Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:39:38.896Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:39:38.896Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:39:38.897Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:39:38.897Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.57
[2025-10-23T15:39:38.897Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:38.897Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:38.898Z] [LOG]    NET SALARY: Rs.10978.73
[2025-10-23T15:39:38.898Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:39:38.898Z] [LOG] ======================================================================

[2025-10-23T15:39:38.898Z] [LOG] ✅ P.D.P Dilini Madushani null: Calculation completed successfully
[2025-10-23T15:39:38.898Z] [LOG] 📊 Progress: 33/34 (97.1%)
[2025-10-23T15:39:38.898Z] [LOG] 
🧮 Processing: Franklin null (EMP000018)
[2025-10-23T15:39:38.898Z] [LOG] 📋 Record ID: fff254c9-b43b-4ef1-b83f-818c3e10628a
[2025-10-23T15:39:38.898Z] [LOG] 
======================================================================
[2025-10-23T15:39:38.899Z] [LOG] 🧮 CALCULATING PAYROLL: Franklin null (EMP000018)
[2025-10-23T15:39:38.899Z] [LOG] ======================================================================
[2025-10-23T15:39:39.681Z] [LOG] 🔍 Component filtering for employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-23T15:39:39.682Z] [LOG]    Total components: 13
[2025-10-23T15:39:39.682Z] [LOG]    Applicable components: 13
[2025-10-23T15:39:39.683Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-23T15:39:40.861Z] [LOG] 
🔄 Processing financial records...
[2025-10-23T15:39:40.862Z] [LOG] 🔄 Processing financial records for employee 0143c037-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-23T15:39:41.068Z] [LOG] 📊 Found 0 active loans for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:41.274Z] [LOG] 📊 Found 0 active advances for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:41.473Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:41.474Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-23T15:39:41.474Z] [LOG] 
💰 Step 1: Calculating actual earned base salary (attendance-based)...
[2025-10-23T15:39:41.672Z] [LOG] 
💰 CALCULATING ATTENDANCE DEDUCTION (CORRECTED APPROACH)
[2025-10-23T15:39:41.672Z] [LOG]    Employee ID: 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:41.673Z] [LOG]    📅 Full Period: 2025-10-01 to 2025-10-31
[2025-10-23T15:39:41.673Z] [LOG]    📅 Calculation Until: 2025-10-22 (PARTIAL - Until Today)
[2025-10-23T15:39:41.673Z] [LOG]    Base Salary (Full Month): Rs.50000.00
[2025-10-23T15:39:41.863Z] [LOG] 
   💵 Pre-calculated Rates (from payroll_records):
[2025-10-23T15:39:41.863Z] [LOG]       Daily Salary: Rs.2000.00
[2025-10-23T15:39:41.863Z] [LOG]       Weekday Hourly Rate: Rs.235.29
[2025-10-23T15:39:41.864Z] [LOG]       Saturday Hourly Rate: Rs.444.44
[2025-10-23T15:39:41.864Z] [LOG]       Sunday Hourly Rate: Rs.0.00
[2025-10-23T15:39:41.864Z] [LOG] 
   📊 Full Period Working Days:
[2025-10-23T15:39:41.865Z] [LOG]       Weekdays: 21, Saturdays: 4, Sundays: 0
[2025-10-23T15:39:42.462Z] [LOG] 
   📊 Working Days Until Yesterday:
[2025-10-23T15:39:42.462Z] [LOG]       Weekdays: 14, Saturdays: 3, Sundays: 0
[2025-10-23T15:39:42.650Z] [LOG] 
   ⏰ Calculating Completed Hours (Until Yesterday):
[2025-10-23T15:39:42.651Z] [LOG]       Period: 2025-10-01 to 2025-10-22
[2025-10-23T15:39:42.651Z] [LOG]       Total completed sessions found: 4
[2025-10-23T15:39:42.651Z] [LOG] 
      📋 Breakdown by attendance record:
[2025-10-23T15:39:42.652Z] [LOG]          1. 2025-10-11 (Saturday): 4.50h
[2025-10-23T15:39:42.652Z] [LOG]          2. 2025-10-15 (Weekday): 8.50h
[2025-10-23T15:39:42.652Z] [LOG]          3. 2025-10-16 (Weekday): 8.50h
[2025-10-23T15:39:42.652Z] [LOG]          4. 2025-10-22 (Weekday): 8.50h
[2025-10-23T15:39:42.840Z] [LOG] 
      📊 Aggregated Totals:
[2025-10-23T15:39:42.841Z] [LOG]          Weekday: 25.50h
[2025-10-23T15:39:42.841Z] [LOG]          Saturday: 4.50h
[2025-10-23T15:39:42.842Z] [LOG]          Sunday: 0.00h
[2025-10-23T15:39:43.061Z] [LOG] 
   🔴 LIVE SESSION TODAY (WEEKDAY):
[2025-10-23T15:39:43.061Z] [LOG]       Scheduled Start: 08:30:00
[2025-10-23T15:39:43.061Z] [LOG]       Check-in Time: 08:30:00
[2025-10-23T15:39:43.062Z] [LOG]       Current Time: 21:09:43
[2025-10-23T15:39:43.063Z] [LOG]       Expected Hours (scheduled → now): 12.66h
[2025-10-23T15:39:43.063Z] [LOG]       Actual Hours (check-in → now): 12.66h
[2025-10-23T15:39:43.063Z] [LOG] 
   ⏰ TOTAL EXPECTED Hours (until NOW):
[2025-10-23T15:39:43.064Z] [LOG]       Weekday: 131.66h
[2025-10-23T15:39:43.064Z] [LOG]       Saturday: 13.50h
[2025-10-23T15:39:43.064Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:43.065Z] [LOG]       Total Expected: 145.16h
[2025-10-23T15:39:43.065Z] [LOG] 
   ⏰ TOTAL ACTUAL Hours (including live session):
[2025-10-23T15:39:43.065Z] [LOG]       Weekday: 38.16h (includes 12.66h live)
[2025-10-23T15:39:43.066Z] [LOG]       Saturday: 4.50h
[2025-10-23T15:39:43.066Z] [LOG]       Sunday: 0.00h
[2025-10-23T15:39:43.066Z] [LOG]       Total Actual: 42.66h
[2025-10-23T15:39:43.067Z] [LOG] 
   💵 EXPECTED Earned Salary (until NOW):
[2025-10-23T15:39:43.067Z] [LOG]       Weekday: 131.66h × Rs.235.29 = Rs.30978.74
[2025-10-23T15:39:43.067Z] [LOG]       Saturday: 13.50h × Rs.444.44 = Rs.5999.94
[2025-10-23T15:39:43.067Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:43.068Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:43.068Z] [LOG]       Total Expected Earned: Rs.36978.68
[2025-10-23T15:39:43.068Z] [LOG] 
   💵 ACTUAL Earned Salary (including live session):
[2025-10-23T15:39:43.069Z] [LOG]       Weekday: 38.16h × Rs.235.29 = Rs.8979.13
[2025-10-23T15:39:43.069Z] [LOG]       Saturday: 4.50h × Rs.444.44 = Rs.1999.98
[2025-10-23T15:39:43.069Z] [LOG]       Sunday: 0.00h × Rs.0.00 = Rs.0.00
[2025-10-23T15:39:43.069Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:43.070Z] [LOG]       Total Actual Earned: Rs.10979.11
[2025-10-23T15:39:43.070Z] [LOG] 
   📊 FINAL CALCULATION (REAL-TIME):
[2025-10-23T15:39:43.071Z] [LOG]       Calculated At: Oct 23, 2025, 21:09:43
[2025-10-23T15:39:43.071Z] [LOG]       Expected Earned (until NOW): Rs.36978.68
[2025-10-23T15:39:43.071Z] [LOG]       Actual Earned (until NOW): Rs.10979.11
[2025-10-23T15:39:43.071Z] [LOG]       ─────────────────────────────────────────────────────
[2025-10-23T15:39:43.071Z] [LOG]       Attendance Deduction: Rs.25999.58
[2025-10-23T15:39:43.071Z] [LOG]       (Formula: Expected - Actual, NOT Base Salary - Actual)
[2025-10-23T15:39:43.072Z] [LOG]       📉 Shortfall: 102.50 hours (70.31% of expected)
[2025-10-23T15:39:43.072Z] [LOG] 
   ⚠️  NOTE: Employee is currently checked in. Running this calculation
[2025-10-23T15:39:43.072Z] [LOG]       again later will produce a different result as time progresses.
[2025-10-23T15:39:43.073Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:39:43.073Z] [LOG]    Actual Earned Base: Rs.10979.11
[2025-10-23T15:39:43.073Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:39:43.073Z] [LOG] 
💸 Step 2: Calculating statutory deductions (EPF/ETF) on actual earned base...
[2025-10-23T15:39:43.073Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-23T15:39:43.073Z] [LOG]    Gross Salary: 10979.107895191666
[2025-10-23T15:39:43.073Z] [LOG]    📋 Processing 10 configured deduction components
[2025-10-23T15:39:43.073Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-23T15:39:43.074Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.074Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-23T15:39:43.074Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.074Z] [LOG] 🧮 Calculating component: Attendance Deduction (fixed)
[2025-10-23T15:39:43.074Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.074Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-23T15:39:43.074Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.075Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-23T15:39:43.075Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.075Z] [LOG] 🧮 Calculating component: INCOME TAX (fixed)
[2025-10-23T15:39:43.075Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.075Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-23T15:39:43.075Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.075Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-23T15:39:43.075Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.075Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-23T15:39:43.075Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.076Z] [LOG] 🧮 Calculating component: Attendance Shortfall (Info) (fixed)
[2025-10-23T15:39:43.076Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.076Z] [LOG]    📊 Total Deductions: 0
[2025-10-23T15:39:43.076Z] [LOG]    EPF/ETF calculated on: Rs.10979.11
[2025-10-23T15:39:43.076Z] [LOG]    Total EPF/ETF: Rs.0.00
[2025-10-23T15:39:43.076Z] [LOG] 
🎁 Step 3: Adding full allowances and bonuses (not prorated)...
[2025-10-23T15:39:43.076Z] [LOG] 💰 GROSS CALCULATION for Franklin null:
[2025-10-23T15:39:43.076Z] [LOG]    Base Salary: 50000
[2025-10-23T15:39:43.076Z] [LOG]    📋 Processing 3 configured earning components
[2025-10-23T15:39:43.076Z] [LOG] 🧮 Calculating component: Financial Bonuses (fixed)
[2025-10-23T15:39:43.076Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.076Z] [LOG] 🧮 Calculating component: Base Salary (Attendance-based) (fixed)
[2025-10-23T15:39:43.076Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.076Z] [LOG] 🧮 Calculating component: Base Salary (fixed)
[2025-10-23T15:39:43.077Z] [LOG]    Fixed amount: 0
[2025-10-23T15:39:43.274Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-23T15:39:43.274Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:43.275Z] [LOG]    Financial Bonuses: Rs.0.00
[2025-10-23T15:39:43.275Z] [LOG] 
📊 Step 4: Gross Salary Calculation:
[2025-10-23T15:39:43.275Z] [LOG]    Actual Earned Base: Rs.10979.11
[2025-10-23T15:39:43.276Z] [LOG]    + Full Allowances: Rs.0.00
[2025-10-23T15:39:43.276Z] [LOG]    + Bonuses: Rs.0.00
[2025-10-23T15:39:43.276Z] [LOG]    = Gross Salary: Rs.10979.11
[2025-10-23T15:39:43.276Z] [LOG] 
💳 Step 5: Combining all deductions...
[2025-10-23T15:39:43.277Z] [LOG]    Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:39:43.277Z] [LOG]    ─────────────────────────────────────────────────────
[2025-10-23T15:39:43.277Z] [LOG]    Total Deductions (EPF/ETF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:43.278Z] [LOG]    Note: Attendance shortfall shown for info only, not deducted from net salary
[2025-10-23T15:39:43.278Z] [LOG] 
✅ Step 6: Net Salary Calculation:
[2025-10-23T15:39:43.278Z] [LOG]    Gross Salary: Rs.10979.11
[2025-10-23T15:39:43.279Z] [LOG]    - Total Deductions: Rs.0.00
[2025-10-23T15:39:43.279Z] [LOG]    = NET SALARY: Rs.10979.11
[2025-10-23T15:39:43.279Z] [LOG] 
💾 Database Update:
[2025-10-23T15:39:43.280Z] [LOG]    Total Earnings (Allowances + Bonuses): Rs.0.00 (Allowances: 0.00 + Bonuses: 0.00)
[2025-10-23T15:39:43.280Z] [LOG]    Total Deductions: Rs.0.00 (EPF/ETF: 0.00 + Loans: 0.00 + Advances: 0.00)
[2025-10-23T15:39:43.472Z] [LOG] 
📝 Components to save:
[2025-10-23T15:39:43.472Z] [LOG]    Gross/Earnings components: 1
[2025-10-23T15:39:43.473Z] [LOG]    Deduction components: 1
[2025-10-23T15:39:43.473Z] [LOG] Creating components for record fff254c9-b43b-4ef1-b83f-818c3e10628a: {
  "grossComponentsCount": 1,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-23T15:39:43.474Z] [LOG] Processing component: {
  "name": "Base Salary",
  "type": "earning",
  "amount": 10979.107895191666
}
[2025-10-23T15:39:43.663Z] [LOG] Using existing component ID: f967c9ea-0dd2-4bae-a66b-df480e646abc
[2025-10-23T15:39:43.856Z] [LOG] Created payroll_record_component: 0e0ede0e-c33f-48f8-9e78-bff05b927269 for Base Salary
[2025-10-23T15:39:43.856Z] [LOG] Processing component: {
  "name": "Attendance Shortfall (Info)",
  "type": "deduction",
  "amount": 25999.575000000004
}
[2025-10-23T15:39:44.053Z] [LOG] Using existing component ID: da98d015-c1d3-4dc8-a548-b83cbab17df4
[2025-10-23T15:39:44.283Z] [LOG] Created payroll_record_component: 6afa062a-ba8e-4130-9d54-8101dbaaa250 for Attendance Shortfall (Info)
[2025-10-23T15:39:44.693Z] [LOG] ✅ Financial balances updated successfully for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-23T15:39:44.694Z] [LOG] ✅ Financial balances updated successfully
[2025-10-23T15:39:44.694Z] [LOG] 
======================================================================
[2025-10-23T15:39:44.694Z] [LOG] 📊 PAYROLL CALCULATION SUMMARY: Franklin null
[2025-10-23T15:39:44.695Z] [LOG] ======================================================================
[2025-10-23T15:39:44.695Z] [LOG]    Base Salary (Full): Rs.50000.00
[2025-10-23T15:39:44.695Z] [LOG]    Actual Earned Base (Attendance-based): Rs.10979.11
[2025-10-23T15:39:44.695Z] [LOG]    Attendance Shortfall: Rs.25999.58
[2025-10-23T15:39:44.696Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:44.696Z] [LOG]    Full Allowances: Rs.0.00
[2025-10-23T15:39:44.696Z] [LOG]    Bonuses: Rs.0.00
[2025-10-23T15:39:44.696Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:44.696Z] [LOG]    GROSS SALARY: Rs.10979.11
[2025-10-23T15:39:44.697Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:44.697Z] [LOG]    Deductions Breakdown:
[2025-10-23T15:39:44.697Z] [LOG]       - EPF/ETF (on Actual Earned Base): Rs.0.00
[2025-10-23T15:39:44.697Z] [LOG]       - Loan Deductions: Rs.0.00
[2025-10-23T15:39:44.697Z] [LOG]       - Advance Deductions: Rs.0.00
[2025-10-23T15:39:44.697Z] [LOG]       - Attendance Shortfall (Info): Rs.25999.58
[2025-10-23T15:39:44.698Z] [LOG]    Total Actual Deductions (EPF/Loans/Advances): Rs.0.00
[2025-10-23T15:39:44.698Z] [LOG]    ─────────────────────────────────────────────────────────────────────
[2025-10-23T15:39:44.698Z] [LOG]    NET SALARY: Rs.10979.11
[2025-10-23T15:39:44.698Z] [LOG]    Note: Attendance shortfall is shown for information only
[2025-10-23T15:39:44.698Z] [LOG] ======================================================================

[2025-10-23T15:39:44.698Z] [LOG] ✅ Franklin null: Calculation completed successfully
[2025-10-23T15:39:44.699Z] [LOG] 📊 Progress: 34/34 (100.0%)
[2025-10-23T15:39:44.699Z] [LOG] 
============================================================
[2025-10-23T15:39:44.699Z] [LOG] 📈 Processing Summary: 34 successful, 0 failed
[2025-10-23T15:39:46.451Z] [LOG] 🎉 Payroll calculation completed successfully!
[2025-10-23T15:39:46.452Z] [LOG] 📊 Final Summary: 34 processed, 0 errors
[2025-10-23T15:39:46.453Z] [INFO] ================================================================================
[2025-10-23T15:39:46.453Z] [INFO] ⏰ Completed at: 2025-10-23T15:39:46.453Z
[2025-10-23T15:39:46.453Z] [INFO] 📊 Total log entries: 5977