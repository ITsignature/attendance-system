[2025-10-08T03:37:14.043Z] [INFO] 🚀 Payroll calculation logging started for run: bdef0459-e95c-4209-8210-004d5722853e
[2025-10-08T03:37:14.043Z] [INFO] 📁 Log file: E:\smart_attendance_system\BackEnd\logs\payroll-run-bdef0459-e95c-4209-8210-004d5722853e-2025-10-08T03-37-14-043Z.txt
[2025-10-08T03:37:14.043Z] [INFO] ⏰ Started at: 2025-10-08T03:37:14.043Z
[2025-10-08T03:37:14.043Z] [INFO] ================================================================================
[2025-10-08T03:37:14.044Z] [LOG] 🚀 Starting payroll calculation for run: bdef0459-e95c-4209-8210-004d5722853e
[2025-10-08T03:37:14.044Z] [LOG] 👤 Client ID: it-signature, User ID: 059304ea-24a5-4d78-a290-cf09b9e53c4c
[2025-10-08T03:37:14.465Z] [LOG] ✅ Payroll run verified: October (MONTHLY_2025_10_REGULAR)
[2025-10-08T03:37:14.677Z] [LOG] 📊 Status updated to 'calculating'
[2025-10-08T03:37:14.994Z] [LOG] 👥 Processing 34 employee records:
[2025-10-08T03:37:15.004Z] [LOG] ============================================================
[2025-10-08T03:37:15.004Z] [LOG] 
🧮 Processing: Viruna Damsiha Cooray null (EMP000038)
[2025-10-08T03:37:15.005Z] [LOG] 📋 Record ID: 0abb8953-7bd1-4d46-8925-d408ce66a356
[2025-10-08T03:37:15.838Z] [LOG] 🔍 Component filtering for employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:15.839Z] [LOG]    Total components: 7
[2025-10-08T03:37:15.840Z] [LOG]    Applicable components: 7
[2025-10-08T03:37:15.842Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-08T03:37:17.159Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:17.364Z] [LOG] 🔍 Fetched 4 attendance records for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:17.577Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:37:18.005Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:18.673Z] [LOG] Employee 01441633-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:18.674Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:37:18.675Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:37:18.676Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:37:18.683Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:18.684Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:37:18.685Z] [LOG] ================================================================================
[2025-10-08T03:37:18.685Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:18.686Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:18.687Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:18.688Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:18.690Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:37:18.691Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:37:18.692Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:18.693Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:18.693Z] [LOG] ================================================================================
[2025-10-08T03:37:18.694Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:37:18.694Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:37:18.694Z] [LOG]    Expected hours: 34h
[2025-10-08T03:37:18.695Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:37:18.695Z] [LOG] ================================================================================
[2025-10-08T03:37:18.899Z] [LOG] 🔄 Processing financial records for employee 01441633-7105-11f0-a50f-98e743540430...
[2025-10-08T03:37:18.900Z] [LOG] 🔄 Processing financial records for employee 01441633-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:37:19.103Z] [LOG] 📊 Found 0 active loans for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:19.320Z] [LOG] 📊 Found 0 active advances for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:19.528Z] [LOG] 📊 Found 0 approved bonuses for employee 01441633-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:19.529Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:37:19.530Z] [LOG] 💰 GROSS CALCULATION for Viruna Damsiha Cooray null:
[2025-10-08T03:37:19.531Z] [LOG]    Base Salary: 50000
[2025-10-08T03:37:19.531Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:37:19.740Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:37:19.959Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:20.617Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:37:20.618Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:37:20.822Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:37:20.928Z] [LOG] Employee 01441633-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:20.928Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:37:20.929Z] [LOG] ============================================================
[2025-10-08T03:37:20.929Z] [LOG] 👤 Employee ID: 01441633-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:20.977Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:37:20.979Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:37:20.979Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:37:20.980Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:37:20.980Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:37:20.981Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:37:20.982Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:37:20.983Z] [LOG] 
[2025-10-08T03:37:20.983Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:37:20.983Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:37:20.983Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:37:20.983Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:37:20.983Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:37:20.983Z] [LOG] ============================================================
[2025-10-08T03:37:21.304Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:37:21.304Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:37:21.409Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:21.614Z] [LOG] 📅 Weekend absence check for employee 01441633-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:21.615Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:37:21.615Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:37:21.616Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:37:21.617Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:37:21.617Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:37:21.617Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:37:21.618Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:37:21.618Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:21.619Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:37:21.619Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:21.619Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:37:21.620Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:21.620Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:37:21.621Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:21.621Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:37:21.621Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:21.621Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:37:21.622Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:21.622Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:37:21.624Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:21.625Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:37:21.626Z] [LOG] Regular deductions for Viruna Damsiha Cooray null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:37:21.627Z] [LOG] Combined deductions for Viruna Damsiha Cooray null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:37:21.831Z] [LOG] Creating components for record 0abb8953-7bd1-4d46-8925-d408ce66a356: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:37:21.832Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:37:22.044Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:37:22.266Z] [LOG] Created payroll_record_component: 8faf6fcc-f0f2-4afa-8a1d-4b8e5c964cae for Working Hours Shortfall
[2025-10-08T03:37:22.684Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:22.686Z] [ERROR] ❌ Error updating financial balances for employee 01441633-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:22.687Z] [LOG] ✅ Viruna Damsiha Cooray null: Calculation completed successfully
[2025-10-08T03:37:22.687Z] [LOG] 📊 Progress: 1/34 (2.9%)
[2025-10-08T03:37:22.688Z] [LOG] 
🧮 Processing: Shandeep null (EMP000034)
[2025-10-08T03:37:22.688Z] [LOG] 📋 Record ID: 13d80bf5-f76f-4bd4-88b7-94087873b53a
[2025-10-08T03:37:23.110Z] [LOG] 🔍 Component filtering for employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:23.110Z] [LOG]    Total components: 7
[2025-10-08T03:37:23.111Z] [LOG]    Applicable components: 7
[2025-10-08T03:37:23.111Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-08T03:37:23.793Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:23.899Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:24.003Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:37:24.213Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:24.937Z] [LOG] Employee 0143fc5a-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:24.938Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:37:24.938Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:37:24.939Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:37:24.943Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:24.943Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:37:24.944Z] [LOG] ================================================================================
[2025-10-08T03:37:24.945Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:24.946Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:24.946Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:24.947Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:24.947Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:37:24.948Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:37:24.948Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:24.948Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:24.949Z] [LOG] ================================================================================
[2025-10-08T03:37:24.950Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:37:24.951Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:37:24.953Z] [LOG]    Expected hours: 34h
[2025-10-08T03:37:24.954Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:37:24.955Z] [LOG] ================================================================================
[2025-10-08T03:37:25.061Z] [LOG] 🔄 Processing financial records for employee 0143fc5a-7105-11f0-a50f-98e743540430...
[2025-10-08T03:37:25.061Z] [LOG] 🔄 Processing financial records for employee 0143fc5a-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:37:25.163Z] [LOG] 📊 Found 0 active loans for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:25.271Z] [LOG] 📊 Found 0 active advances for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:25.375Z] [LOG] 📊 Found 0 approved bonuses for employee 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:25.376Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:37:25.377Z] [LOG] 💰 GROSS CALCULATION for Shandeep null:
[2025-10-08T03:37:25.378Z] [LOG]    Base Salary: 80000
[2025-10-08T03:37:25.378Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:37:25.492Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:37:25.596Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:26.115Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:37:26.115Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:37:26.221Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:37:26.332Z] [LOG] Employee 0143fc5a-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:26.333Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:37:26.333Z] [LOG] ============================================================
[2025-10-08T03:37:26.334Z] [LOG] 👤 Employee ID: 0143fc5a-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:26.334Z] [LOG] 💰 Base Salary: 80,000
[2025-10-08T03:37:26.335Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:37:26.335Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:37:26.336Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:37:26.336Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:37:26.336Z] [LOG] 💵 Per-Day Salary: 3200.00 (80000 ÷ 25)
[2025-10-08T03:37:26.337Z] [LOG] ⏱️  Hourly Rate: 376.47 (3200.00 ÷ 8.5)
[2025-10-08T03:37:26.337Z] [LOG] 
[2025-10-08T03:37:26.338Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:37:26.338Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:37:26.339Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:37:26.341Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:37:26.341Z] [LOG]    💸 Shortfall Deduction: 8.5h × 376.47 = 3200.00
[2025-10-08T03:37:26.342Z] [LOG] ============================================================
[2025-10-08T03:37:26.562Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:37:26.563Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:37:26.667Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:26.775Z] [LOG] 📅 Weekend absence check for employee 0143fc5a-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:26.776Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:37:26.777Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:37:26.777Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:37:26.778Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:37:26.778Z] [LOG]    Gross Salary: 80000
[2025-10-08T03:37:26.778Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:37:26.779Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:37:26.779Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:26.780Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:37:26.780Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:26.780Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:37:26.781Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:26.781Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:37:26.783Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:26.784Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:37:26.784Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:26.785Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:37:26.785Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:26.785Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:37:26.785Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:26.786Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:37:26.786Z] [LOG] Regular deductions for Shandeep null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:37:26.787Z] [LOG] Combined deductions for Shandeep null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 3200,
      "details": "8.5 hours × 376.47"
    }
  ],
  "total": 3200
}
[2025-10-08T03:37:26.893Z] [LOG] Creating components for record 13d80bf5-f76f-4bd4-88b7-94087873b53a: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:37:26.894Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 3200
}
[2025-10-08T03:37:26.998Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:37:27.101Z] [LOG] Created payroll_record_component: 1b89cdef-5fb9-498a-89f6-47adfca17cb8 for Working Hours Shortfall
[2025-10-08T03:37:27.420Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:27.422Z] [ERROR] ❌ Error updating financial balances for employee 0143fc5a-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:27.425Z] [LOG] ✅ Shandeep null: Calculation completed successfully
[2025-10-08T03:37:27.426Z] [LOG] 📊 Progress: 2/34 (5.9%)
[2025-10-08T03:37:27.426Z] [LOG] 
🧮 Processing: Waruni null (EMP000024)
[2025-10-08T03:37:27.427Z] [LOG] 📋 Record ID: 14d72c74-1b0b-4768-9fef-d2495aabc61f
[2025-10-08T03:37:27.837Z] [LOG] 🔍 Component filtering for employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:27.838Z] [LOG]    Total components: 7
[2025-10-08T03:37:27.839Z] [LOG]    Applicable components: 7
[2025-10-08T03:37:27.839Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-08T03:37:28.502Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:28.608Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:28.719Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:37:28.934Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:29.245Z] [LOG] Employee 0143e40c-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:29.246Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:37:29.246Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:37:29.247Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:37:29.248Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:29.249Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:37:29.249Z] [LOG] ================================================================================
[2025-10-08T03:37:29.249Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:29.250Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:29.250Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:29.251Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:29.252Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:37:29.253Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:37:29.254Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:29.254Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:29.255Z] [LOG] ================================================================================
[2025-10-08T03:37:29.255Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:37:29.255Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:37:29.258Z] [LOG]    Expected hours: 34h
[2025-10-08T03:37:29.259Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:37:29.260Z] [LOG] ================================================================================
[2025-10-08T03:37:29.371Z] [LOG] 🔄 Processing financial records for employee 0143e40c-7105-11f0-a50f-98e743540430...
[2025-10-08T03:37:29.371Z] [LOG] 🔄 Processing financial records for employee 0143e40c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:37:29.478Z] [LOG] 📊 Found 0 active loans for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:29.595Z] [LOG] 📊 Found 0 active advances for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:29.702Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:29.702Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:37:29.703Z] [LOG] 💰 GROSS CALCULATION for Waruni null:
[2025-10-08T03:37:29.703Z] [LOG]    Base Salary: 50000
[2025-10-08T03:37:29.704Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:37:29.811Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:37:29.916Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:30.466Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:37:30.467Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:37:30.569Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:37:30.672Z] [LOG] Employee 0143e40c-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:30.676Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:37:30.676Z] [LOG] ============================================================
[2025-10-08T03:37:30.677Z] [LOG] 👤 Employee ID: 0143e40c-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:30.677Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:37:30.678Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:37:30.678Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:37:30.678Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:37:30.679Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:37:30.679Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:37:30.680Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:37:30.683Z] [LOG] 
[2025-10-08T03:37:30.683Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:37:30.684Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:37:30.685Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:37:30.689Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:37:30.690Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:37:30.691Z] [LOG] ============================================================
[2025-10-08T03:37:30.926Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:37:30.927Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:37:31.035Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:31.141Z] [LOG] 📅 Weekend absence check for employee 0143e40c-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:31.142Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:37:31.143Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:37:31.143Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:37:31.144Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:37:31.144Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:37:31.144Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:37:31.145Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:37:31.145Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:31.146Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:37:31.146Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:31.147Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:37:31.147Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:31.148Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:37:31.149Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:31.150Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:37:31.150Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:31.151Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:37:31.152Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:31.155Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:37:31.155Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:31.157Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:37:31.159Z] [LOG] Regular deductions for Waruni null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:37:31.161Z] [LOG] Combined deductions for Waruni null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:37:31.265Z] [LOG] Creating components for record 14d72c74-1b0b-4768-9fef-d2495aabc61f: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:37:31.266Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:37:31.694Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:37:31.797Z] [LOG] Created payroll_record_component: b8d20424-e041-4955-979b-17bbc5bcf397 for Working Hours Shortfall
[2025-10-08T03:37:32.103Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:32.105Z] [ERROR] ❌ Error updating financial balances for employee 0143e40c-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:32.106Z] [LOG] ✅ Waruni null: Calculation completed successfully
[2025-10-08T03:37:32.107Z] [LOG] 📊 Progress: 3/34 (8.8%)
[2025-10-08T03:37:32.108Z] [LOG] 
🧮 Processing: Ashen Nirmal Wadugodapitiya null (EMP000046)
[2025-10-08T03:37:32.108Z] [LOG] 📋 Record ID: 1750fa0d-1584-4703-999f-45fc50820cbc
[2025-10-08T03:37:32.519Z] [LOG] 🔍 Component filtering for employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:32.520Z] [LOG]    Total components: 7
[2025-10-08T03:37:32.520Z] [LOG]    Applicable components: 7
[2025-10-08T03:37:32.520Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-08T03:37:33.158Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:33.270Z] [LOG] 🔍 Fetched 4 attendance records for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:33.375Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:37:33.609Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:33.944Z] [LOG] Employee 0144461e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:33.944Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:37:33.945Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:37:33.945Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:37:33.946Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:33.947Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:37:33.947Z] [LOG] ================================================================================
[2025-10-08T03:37:33.948Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:33.948Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:33.949Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:33.949Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:33.950Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:37:33.950Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:37:33.952Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:33.953Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:33.953Z] [LOG] ================================================================================
[2025-10-08T03:37:33.953Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:37:33.954Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:37:33.954Z] [LOG]    Expected hours: 34h
[2025-10-08T03:37:33.954Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:37:33.955Z] [LOG] ================================================================================
[2025-10-08T03:37:34.061Z] [LOG] 🔄 Processing financial records for employee 0144461e-7105-11f0-a50f-98e743540430...
[2025-10-08T03:37:34.061Z] [LOG] 🔄 Processing financial records for employee 0144461e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:37:34.171Z] [LOG] 📊 Found 0 active loans for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:34.274Z] [LOG] 📊 Found 0 active advances for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:34.376Z] [LOG] 📊 Found 0 approved bonuses for employee 0144461e-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:34.377Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:37:34.378Z] [LOG] 💰 GROSS CALCULATION for Ashen Nirmal Wadugodapitiya null:
[2025-10-08T03:37:34.378Z] [LOG]    Base Salary: 50000
[2025-10-08T03:37:34.378Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:37:34.482Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:37:34.583Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:35.110Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:37:35.111Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:37:35.213Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:37:35.318Z] [LOG] Employee 0144461e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:35.319Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:37:35.320Z] [LOG] ============================================================
[2025-10-08T03:37:35.320Z] [LOG] 👤 Employee ID: 0144461e-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:35.320Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:37:35.321Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:37:35.321Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:37:35.321Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:37:35.322Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:37:35.322Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:37:35.323Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:37:35.325Z] [LOG] 
[2025-10-08T03:37:35.326Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:37:35.326Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:37:35.327Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:37:35.328Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:37:35.328Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:37:35.328Z] [LOG] ============================================================
[2025-10-08T03:37:35.535Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:37:35.536Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:37:35.641Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:35.748Z] [LOG] 📅 Weekend absence check for employee 0144461e-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:35.749Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:37:35.749Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:37:35.749Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:37:35.750Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:37:35.750Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:37:35.750Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:37:35.750Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:37:35.751Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:35.751Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:37:35.752Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:35.752Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:37:35.753Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:35.753Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:37:35.755Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:35.756Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:37:35.757Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:35.758Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:37:35.758Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:35.759Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:37:35.759Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:35.759Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:37:35.760Z] [LOG] Regular deductions for Ashen Nirmal Wadugodapitiya null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:37:35.760Z] [LOG] Combined deductions for Ashen Nirmal Wadugodapitiya null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:37:35.870Z] [LOG] Creating components for record 1750fa0d-1584-4703-999f-45fc50820cbc: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:37:35.870Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:37:35.977Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:37:36.078Z] [LOG] Created payroll_record_component: 9e07e312-d491-4fe2-8b0c-0da1bc7cd7fd for Working Hours Shortfall
[2025-10-08T03:37:36.390Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:36.393Z] [ERROR] ❌ Error updating financial balances for employee 0144461e-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:36.395Z] [LOG] ✅ Ashen Nirmal Wadugodapitiya null: Calculation completed successfully
[2025-10-08T03:37:36.395Z] [LOG] 📊 Progress: 4/34 (11.8%)
[2025-10-08T03:37:36.395Z] [LOG] 
🧮 Processing: Dharshika null (EMP000009)
[2025-10-08T03:37:36.396Z] [LOG] 📋 Record ID: 1cbb1830-ef93-4ae0-824c-bcec72108f4b
[2025-10-08T03:37:36.816Z] [LOG] 🔍 Component filtering for employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:36.817Z] [LOG]    Total components: 7
[2025-10-08T03:37:36.817Z] [LOG]    Applicable components: 7
[2025-10-08T03:37:36.818Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-08T03:37:37.432Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:37.536Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:37.645Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:37:37.865Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:38.176Z] [LOG] Employee 0143a994-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:38.177Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:37:38.177Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:37:38.178Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:37:38.179Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:38.179Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:37:38.180Z] [LOG] ================================================================================
[2025-10-08T03:37:38.180Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:38.181Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:38.181Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:38.181Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:38.182Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:37:38.182Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:37:38.183Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:38.183Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:38.185Z] [LOG] ================================================================================
[2025-10-08T03:37:38.185Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:37:38.186Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:37:38.186Z] [LOG]    Expected hours: 34h
[2025-10-08T03:37:38.187Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:37:38.188Z] [LOG] ================================================================================
[2025-10-08T03:37:38.298Z] [LOG] 🔄 Processing financial records for employee 0143a994-7105-11f0-a50f-98e743540430...
[2025-10-08T03:37:38.298Z] [LOG] 🔄 Processing financial records for employee 0143a994-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:37:38.401Z] [LOG] 📊 Found 0 active loans for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:38.504Z] [LOG] 📊 Found 0 active advances for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:38.608Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a994-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:38.609Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:37:38.610Z] [LOG] 💰 GROSS CALCULATION for Dharshika null:
[2025-10-08T03:37:38.610Z] [LOG]    Base Salary: 100000
[2025-10-08T03:37:38.611Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:37:38.714Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:37:38.832Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:39.364Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:37:39.364Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:37:39.469Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:37:39.573Z] [LOG] Employee 0143a994-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:39.576Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:37:39.576Z] [LOG] ============================================================
[2025-10-08T03:37:39.577Z] [LOG] 👤 Employee ID: 0143a994-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:39.577Z] [LOG] 💰 Base Salary: 100,000
[2025-10-08T03:37:39.577Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:37:39.578Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:37:39.578Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:37:39.579Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:37:39.579Z] [LOG] 💵 Per-Day Salary: 4000.00 (100000 ÷ 25)
[2025-10-08T03:37:39.580Z] [LOG] ⏱️  Hourly Rate: 470.59 (4000.00 ÷ 8.5)
[2025-10-08T03:37:39.580Z] [LOG] 
[2025-10-08T03:37:39.581Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:37:39.581Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:37:39.581Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:37:39.582Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:37:39.582Z] [LOG]    💸 Shortfall Deduction: 8.5h × 470.59 = 4000.00
[2025-10-08T03:37:39.583Z] [LOG] ============================================================
[2025-10-08T03:37:39.788Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:37:39.789Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:37:39.892Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:40.009Z] [LOG] 📅 Weekend absence check for employee 0143a994-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:40.010Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:37:40.010Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:37:40.011Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:37:40.011Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:37:40.012Z] [LOG]    Gross Salary: 100000
[2025-10-08T03:37:40.012Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:37:40.013Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:37:40.013Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:40.014Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:37:40.014Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:40.015Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:37:40.015Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:40.016Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:37:40.016Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:40.017Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:37:40.018Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:40.018Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:37:40.019Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:40.019Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:37:40.020Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:40.020Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:37:40.021Z] [LOG] Regular deductions for Dharshika null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:37:40.021Z] [LOG] Combined deductions for Dharshika null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 4000,
      "details": "8.5 hours × 470.59"
    }
  ],
  "total": 4000
}
[2025-10-08T03:37:40.125Z] [LOG] Creating components for record 1cbb1830-ef93-4ae0-824c-bcec72108f4b: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:37:40.126Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 4000
}
[2025-10-08T03:37:40.243Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:37:40.375Z] [LOG] Created payroll_record_component: 6042bfdf-bdaa-48e9-9a7a-474b88281114 for Working Hours Shortfall
[2025-10-08T03:37:40.696Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:40.698Z] [ERROR] ❌ Error updating financial balances for employee 0143a994-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:40.699Z] [LOG] ✅ Dharshika null: Calculation completed successfully
[2025-10-08T03:37:40.699Z] [LOG] 📊 Progress: 5/34 (14.7%)
[2025-10-08T03:37:40.700Z] [LOG] 
🧮 Processing: Uthpala null (EMP000006)
[2025-10-08T03:37:40.700Z] [LOG] 📋 Record ID: 217cd535-0a50-426e-92b4-befe1ed992ed
[2025-10-08T03:37:41.130Z] [LOG] 🔍 Component filtering for employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:41.130Z] [LOG]    Total components: 7
[2025-10-08T03:37:41.130Z] [LOG]    Applicable components: 7
[2025-10-08T03:37:41.131Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-08T03:37:41.746Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:41.950Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:42.155Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:42.369Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:42.504Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:42.613Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:37:42.825Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:43.135Z] [LOG] Employee 0143a539-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 09:30:00 - 17:30:00 = 8 hours
[2025-10-08T03:37:43.135Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8h = 32h
[2025-10-08T03:37:43.136Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:37:43.136Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:37:43.137Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:43.138Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:37:43.138Z] [LOG] ================================================================================
[2025-10-08T03:37:43.139Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 7.5h counted → OVERLAP 09:30-17:00 = 7.500h (attendance table)
[2025-10-08T03:37:43.139Z] [LOG]    ✅ Added to weekday total: 7.5h
[2025-10-08T03:37:43.141Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 7.5h counted → OVERLAP 09:30-17:00 = 7.500h (attendance table)
[2025-10-08T03:37:43.141Z] [LOG]    ✅ Added to weekday total: 7.5h
[2025-10-08T03:37:43.142Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:37:43.143Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:37:43.143Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 7.5h counted → OVERLAP 09:30-17:00 = 7.500h (attendance table)
[2025-10-08T03:37:43.143Z] [LOG]    ✅ Added to weekday total: 7.5h
[2025-10-08T03:37:43.144Z] [LOG] ================================================================================
[2025-10-08T03:37:43.144Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:37:43.144Z] [LOG]    Sum of all daily counted hours (rounded): 22.5h
[2025-10-08T03:37:43.145Z] [LOG]    Expected hours: 32h
[2025-10-08T03:37:43.145Z] [LOG]    Shortfall: 9.50h
[2025-10-08T03:37:43.145Z] [LOG] ================================================================================
[2025-10-08T03:37:43.248Z] [LOG] 🔄 Processing financial records for employee 0143a539-7105-11f0-a50f-98e743540430...
[2025-10-08T03:37:43.249Z] [LOG] 🔄 Processing financial records for employee 0143a539-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:37:43.352Z] [LOG] 📊 Found 0 active loans for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:43.455Z] [LOG] 📊 Found 0 active advances for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:43.561Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a539-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:43.562Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:37:43.564Z] [LOG] 💰 GROSS CALCULATION for Uthpala null:
[2025-10-08T03:37:43.564Z] [LOG]    Base Salary: 100000
[2025-10-08T03:37:43.566Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:37:43.670Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:37:43.774Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:44.297Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:37:44.297Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:37:44.398Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:37:44.500Z] [LOG] Employee 0143a539-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 09:30:00 - 17:30:00 = 8 hours
[2025-10-08T03:37:44.500Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:37:44.501Z] [LOG] ============================================================
[2025-10-08T03:37:44.501Z] [LOG] 👤 Employee ID: 0143a539-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:44.501Z] [LOG] 💰 Base Salary: 100,000
[2025-10-08T03:37:44.502Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:37:44.502Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:37:44.503Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:37:44.503Z] [LOG] ⏰ Employee Daily Hours: 8h/day
[2025-10-08T03:37:44.503Z] [LOG] 💵 Per-Day Salary: 4000.00 (100000 ÷ 25)
[2025-10-08T03:37:44.504Z] [LOG] ⏱️  Hourly Rate: 500.00 (4000.00 ÷ 8)
[2025-10-08T03:37:44.504Z] [LOG] 
[2025-10-08T03:37:44.505Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:37:44.505Z] [LOG]    Expected Hours (up to today): 32
[2025-10-08T03:37:44.505Z] [LOG]    Worked Hours: 22.5
[2025-10-08T03:37:44.506Z] [LOG]    ⚠️  Shortfall Hours: 9.5
[2025-10-08T03:37:44.507Z] [LOG]    💸 Shortfall Deduction: 9.5h × 500.00 = 4750.00
[2025-10-08T03:37:44.509Z] [LOG] ============================================================
[2025-10-08T03:37:44.729Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:37:44.730Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:37:44.833Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:44.934Z] [LOG] 📅 Weekend absence check for employee 0143a539-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:44.935Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:37:44.936Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:37:44.936Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:37:44.936Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:37:44.937Z] [LOG]    Gross Salary: 100000
[2025-10-08T03:37:44.937Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:37:44.937Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:37:44.938Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:44.938Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:37:44.939Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:44.939Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:37:44.940Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:44.942Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:37:44.943Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:44.944Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:37:44.944Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:44.944Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:37:44.945Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:44.945Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:37:44.945Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:44.946Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:37:44.946Z] [LOG] Regular deductions for Uthpala null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:37:44.947Z] [LOG] Combined deductions for Uthpala null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 4750,
      "details": "9.5 hours × 500.00"
    }
  ],
  "total": 4750
}
[2025-10-08T03:37:45.059Z] [LOG] Creating components for record 217cd535-0a50-426e-92b4-befe1ed992ed: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:37:45.059Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 4750
}
[2025-10-08T03:37:45.160Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:37:45.263Z] [LOG] Created payroll_record_component: 988d66d1-276d-4147-a620-530c8da3ed55 for Working Hours Shortfall
[2025-10-08T03:37:45.571Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:45.573Z] [ERROR] ❌ Error updating financial balances for employee 0143a539-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:45.576Z] [LOG] ✅ Uthpala null: Calculation completed successfully
[2025-10-08T03:37:45.577Z] [LOG] 📊 Progress: 6/34 (17.6%)
[2025-10-08T03:37:45.577Z] [LOG] 
🧮 Processing: R. D.A Kaushalya null (EMP000044)
[2025-10-08T03:37:45.577Z] [LOG] 📋 Record ID: 2555c260-305b-4d27-973b-7256c2d34003
[2025-10-08T03:37:46.002Z] [LOG] 🔍 Component filtering for employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:46.003Z] [LOG]    Total components: 7
[2025-10-08T03:37:46.003Z] [LOG]    Applicable components: 7
[2025-10-08T03:37:46.003Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-08T03:37:46.629Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:46.749Z] [LOG] 🔍 Fetched 4 attendance records for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:46.855Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:37:47.061Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:47.394Z] [LOG] Employee 01443963-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:47.395Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:37:47.395Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:37:47.396Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:37:47.397Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:47.397Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:37:47.398Z] [LOG] ================================================================================
[2025-10-08T03:37:47.398Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:47.399Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:47.399Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:47.399Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:47.400Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:37:47.400Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:37:47.401Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:47.403Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:47.403Z] [LOG] ================================================================================
[2025-10-08T03:37:47.404Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:37:47.404Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:37:47.404Z] [LOG]    Expected hours: 34h
[2025-10-08T03:37:47.405Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:37:47.405Z] [LOG] ================================================================================
[2025-10-08T03:37:47.620Z] [LOG] 🔄 Processing financial records for employee 01443963-7105-11f0-a50f-98e743540430...
[2025-10-08T03:37:47.621Z] [LOG] 🔄 Processing financial records for employee 01443963-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:37:47.753Z] [LOG] 📊 Found 0 active loans for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:47.855Z] [LOG] 📊 Found 0 active advances for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:47.962Z] [LOG] 📊 Found 0 approved bonuses for employee 01443963-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:47.962Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:37:47.963Z] [LOG] 💰 GROSS CALCULATION for R. D.A Kaushalya null:
[2025-10-08T03:37:47.963Z] [LOG]    Base Salary: 50000
[2025-10-08T03:37:47.964Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:37:48.074Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:37:48.175Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:48.687Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:37:48.687Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:37:48.789Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:37:48.893Z] [LOG] Employee 01443963-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:48.893Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:37:48.894Z] [LOG] ============================================================
[2025-10-08T03:37:48.894Z] [LOG] 👤 Employee ID: 01443963-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:48.896Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:37:48.896Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:37:48.897Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:37:48.898Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:37:48.898Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:37:48.899Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:37:48.899Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:37:48.899Z] [LOG] 
[2025-10-08T03:37:48.900Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:37:48.900Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:37:48.901Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:37:48.901Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:37:48.902Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:37:48.902Z] [LOG] ============================================================
[2025-10-08T03:37:49.114Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:37:49.114Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:37:49.219Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:49.322Z] [LOG] 📅 Weekend absence check for employee 01443963-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:49.324Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:37:49.324Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:37:49.325Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:37:49.325Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:37:49.326Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:37:49.326Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:37:49.327Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:37:49.327Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:49.327Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:37:49.328Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:49.328Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:37:49.329Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:49.329Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:37:49.330Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:49.331Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:37:49.331Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:49.332Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:37:49.332Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:49.332Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:37:49.333Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:49.333Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:37:49.333Z] [LOG] Regular deductions for R. D.A Kaushalya null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:37:49.334Z] [LOG] Combined deductions for R. D.A Kaushalya null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:37:49.440Z] [LOG] Creating components for record 2555c260-305b-4d27-973b-7256c2d34003: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:37:49.441Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:37:49.541Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:37:49.642Z] [LOG] Created payroll_record_component: 7c58f786-6c84-4a0a-8cd2-752d26264634 for Working Hours Shortfall
[2025-10-08T03:37:49.953Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:49.955Z] [ERROR] ❌ Error updating financial balances for employee 01443963-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:49.957Z] [LOG] ✅ R. D.A Kaushalya null: Calculation completed successfully
[2025-10-08T03:37:49.958Z] [LOG] 📊 Progress: 7/34 (20.6%)
[2025-10-08T03:37:49.959Z] [LOG] 
🧮 Processing: Sithira null (EMP000039)
[2025-10-08T03:37:49.960Z] [LOG] 📋 Record ID: 264be4cd-8926-43a1-8479-5719e7dfbc75
[2025-10-08T03:37:50.402Z] [LOG] 🔍 Component filtering for employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:50.402Z] [LOG]    Total components: 7
[2025-10-08T03:37:50.403Z] [LOG]    Applicable components: 7
[2025-10-08T03:37:50.403Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-08T03:37:51.033Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:51.136Z] [LOG] 🔍 Fetched 4 attendance records for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:51.236Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:37:51.442Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:51.747Z] [LOG] Employee 01441e19-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:51.748Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:37:51.749Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:37:51.750Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:37:51.750Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:51.751Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:37:51.751Z] [LOG] ================================================================================
[2025-10-08T03:37:51.752Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:51.752Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:51.752Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:51.753Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:51.753Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:37:51.754Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:37:51.754Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:51.757Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:51.758Z] [LOG] ================================================================================
[2025-10-08T03:37:51.758Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:37:51.759Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:37:51.759Z] [LOG]    Expected hours: 34h
[2025-10-08T03:37:51.760Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:37:51.760Z] [LOG] ================================================================================
[2025-10-08T03:37:51.862Z] [LOG] 🔄 Processing financial records for employee 01441e19-7105-11f0-a50f-98e743540430...
[2025-10-08T03:37:51.862Z] [LOG] 🔄 Processing financial records for employee 01441e19-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:37:52.033Z] [LOG] 📊 Found 0 active loans for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:52.160Z] [LOG] 📊 Found 0 active advances for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:52.270Z] [LOG] 📊 Found 0 approved bonuses for employee 01441e19-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:52.271Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:37:52.271Z] [LOG] 💰 GROSS CALCULATION for Sithira null:
[2025-10-08T03:37:52.271Z] [LOG]    Base Salary: 40000
[2025-10-08T03:37:52.272Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:37:52.375Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:37:52.483Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:53.028Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:37:53.028Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:37:53.134Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:37:53.234Z] [LOG] Employee 01441e19-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:53.236Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:37:53.237Z] [LOG] ============================================================
[2025-10-08T03:37:53.237Z] [LOG] 👤 Employee ID: 01441e19-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:53.238Z] [LOG] 💰 Base Salary: 40,000
[2025-10-08T03:37:53.238Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:37:53.239Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:37:53.239Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:37:53.241Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:37:53.242Z] [LOG] 💵 Per-Day Salary: 1600.00 (40000 ÷ 25)
[2025-10-08T03:37:53.242Z] [LOG] ⏱️  Hourly Rate: 188.24 (1600.00 ÷ 8.5)
[2025-10-08T03:37:53.242Z] [LOG] 
[2025-10-08T03:37:53.243Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:37:53.243Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:37:53.243Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:37:53.243Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:37:53.244Z] [LOG]    💸 Shortfall Deduction: 8.5h × 188.24 = 1600.00
[2025-10-08T03:37:53.244Z] [LOG] ============================================================
[2025-10-08T03:37:53.473Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:37:53.475Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:37:53.576Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:53.677Z] [LOG] 📅 Weekend absence check for employee 01441e19-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:53.677Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:37:53.678Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:37:53.678Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:37:53.678Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:37:53.679Z] [LOG]    Gross Salary: 40000
[2025-10-08T03:37:53.679Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:37:53.680Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:37:53.680Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:53.680Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:37:53.681Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:53.681Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:37:53.684Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:53.685Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:37:53.685Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:53.686Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:37:53.687Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:53.691Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:37:53.692Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:53.693Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:37:53.694Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:53.695Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:37:53.695Z] [LOG] Regular deductions for Sithira null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:37:53.696Z] [LOG] Combined deductions for Sithira null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 1600,
      "details": "8.5 hours × 188.24"
    }
  ],
  "total": 1600
}
[2025-10-08T03:37:53.799Z] [LOG] Creating components for record 264be4cd-8926-43a1-8479-5719e7dfbc75: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:37:53.800Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 1600
}
[2025-10-08T03:37:53.907Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:37:54.010Z] [LOG] Created payroll_record_component: 0485e739-3345-4152-a4c0-71c5f9761da7 for Working Hours Shortfall
[2025-10-08T03:37:54.335Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:54.336Z] [ERROR] ❌ Error updating financial balances for employee 01441e19-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:54.337Z] [LOG] ✅ Sithira null: Calculation completed successfully
[2025-10-08T03:37:54.338Z] [LOG] 📊 Progress: 8/34 (23.5%)
[2025-10-08T03:37:54.338Z] [LOG] 
🧮 Processing: Faizan Faizan (EMP000003)
[2025-10-08T03:37:54.339Z] [LOG] 📋 Record ID: 2c1adad8-a6a5-4088-946f-e83b96a88c22
[2025-10-08T03:37:54.765Z] [LOG] 🔍 Component filtering for employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:54.766Z] [LOG]    Total components: 7
[2025-10-08T03:37:54.766Z] [LOG]    Applicable components: 7
[2025-10-08T03:37:54.766Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-08T03:37:55.767Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:37:55.870Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:55.980Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:37:56.187Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:56.548Z] [LOG] Employee 0143a057-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:56.549Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:37:56.549Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:37:56.550Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:37:56.551Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:56.551Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:37:56.552Z] [LOG] ================================================================================
[2025-10-08T03:37:56.552Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:56.553Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:56.553Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:56.553Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:56.554Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:37:56.554Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:37:56.555Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:37:56.555Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:37:56.557Z] [LOG] ================================================================================
[2025-10-08T03:37:56.557Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:37:56.558Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:37:56.558Z] [LOG]    Expected hours: 34h
[2025-10-08T03:37:56.559Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:37:56.559Z] [LOG] ================================================================================
[2025-10-08T03:37:56.661Z] [LOG] 🔄 Processing financial records for employee 0143a057-7105-11f0-a50f-98e743540430...
[2025-10-08T03:37:56.661Z] [LOG] 🔄 Processing financial records for employee 0143a057-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:37:56.766Z] [LOG] 📊 Found 0 active loans for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:56.887Z] [LOG] 📊 Found 0 active advances for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:56.992Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a057-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:56.993Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:37:56.993Z] [LOG] 💰 GROSS CALCULATION for Faizan Faizan:
[2025-10-08T03:37:56.994Z] [LOG]    Base Salary: 50000
[2025-10-08T03:37:56.994Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:37:57.117Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:37:57.225Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:57.749Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:37:57.749Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:37:57.869Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:37:57.975Z] [LOG] Employee 0143a057-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:37:57.976Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:37:57.977Z] [LOG] ============================================================
[2025-10-08T03:37:57.977Z] [LOG] 👤 Employee ID: 0143a057-7105-11f0-a50f-98e743540430
[2025-10-08T03:37:57.978Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:37:57.979Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:37:57.979Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:37:57.979Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:37:57.980Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:37:57.980Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:37:57.981Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:37:57.981Z] [LOG] 
[2025-10-08T03:37:57.981Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:37:57.982Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:37:57.982Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:37:57.983Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:37:57.984Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:37:57.985Z] [LOG] ============================================================
[2025-10-08T03:37:58.199Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:37:58.199Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:37:58.303Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:37:58.404Z] [LOG] 📅 Weekend absence check for employee 0143a057-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:58.404Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:37:58.404Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:37:58.405Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:37:58.405Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:37:58.405Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:37:58.406Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:37:58.406Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:37:58.406Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:58.407Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:37:58.408Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:58.408Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:37:58.408Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:58.409Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:37:58.409Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:58.409Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:37:58.410Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:58.410Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:37:58.411Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:58.411Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:37:58.412Z] [LOG]    Fixed amount: 0
[2025-10-08T03:37:58.412Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:37:58.412Z] [LOG] Regular deductions for Faizan Faizan: {
  "components": [],
  "total": 0
}
[2025-10-08T03:37:58.413Z] [LOG] Combined deductions for Faizan Faizan: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:37:58.515Z] [LOG] Creating components for record 2c1adad8-a6a5-4088-946f-e83b96a88c22: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:37:58.516Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:37:58.621Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:37:58.724Z] [LOG] Created payroll_record_component: 051968cf-f950-4e9b-be24-7cb761f67d7d for Working Hours Shortfall
[2025-10-08T03:37:59.029Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:59.030Z] [ERROR] ❌ Error updating financial balances for employee 0143a057-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:37:59.032Z] [LOG] ✅ Faizan Faizan: Calculation completed successfully
[2025-10-08T03:37:59.032Z] [LOG] 📊 Progress: 9/34 (26.5%)
[2025-10-08T03:37:59.033Z] [LOG] 
🧮 Processing: Anoj null (EMP000014)
[2025-10-08T03:37:59.033Z] [LOG] 📋 Record ID: 3b668378-50b6-49a3-b5bb-0798441c22a9
[2025-10-08T03:37:59.460Z] [LOG] 🔍 Component filtering for employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-08T03:37:59.462Z] [LOG]    Total components: 7
[2025-10-08T03:37:59.462Z] [LOG]    Applicable components: 7
[2025-10-08T03:37:59.463Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-08T03:38:00.130Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:00.237Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:00.340Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:00.567Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:00.884Z] [LOG] Employee 0143afc6-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:00.884Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:00.884Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:00.885Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:00.887Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:00.888Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:00.889Z] [LOG] ================================================================================
[2025-10-08T03:38:00.891Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:00.893Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:00.893Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:00.894Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:00.894Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:00.895Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:00.895Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:00.896Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:00.897Z] [LOG] ================================================================================
[2025-10-08T03:38:00.898Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:00.899Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:00.899Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:00.899Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:00.900Z] [LOG] ================================================================================
[2025-10-08T03:38:01.008Z] [LOG] 🔄 Processing financial records for employee 0143afc6-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:01.009Z] [LOG] 🔄 Processing financial records for employee 0143afc6-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:01.111Z] [LOG] 📊 Found 0 active loans for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:01.220Z] [LOG] 📊 Found 0 active advances for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:01.331Z] [LOG] 📊 Found 0 approved bonuses for employee 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:01.333Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:01.334Z] [LOG] 💰 GROSS CALCULATION for Anoj null:
[2025-10-08T03:38:01.334Z] [LOG]    Base Salary: 50000
[2025-10-08T03:38:01.334Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:01.442Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:01.546Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:02.101Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:02.102Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:02.213Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:02.329Z] [LOG] Employee 0143afc6-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:02.330Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:02.331Z] [LOG] ============================================================
[2025-10-08T03:38:02.331Z] [LOG] 👤 Employee ID: 0143afc6-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:02.331Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:38:02.332Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:02.332Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:02.332Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:02.333Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:02.333Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:38:02.334Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:38:02.334Z] [LOG] 
[2025-10-08T03:38:02.335Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:02.337Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:02.337Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:02.337Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:02.338Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:38:02.338Z] [LOG] ============================================================
[2025-10-08T03:38:02.556Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:02.557Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:02.669Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:02.777Z] [LOG] 📅 Weekend absence check for employee 0143afc6-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:02.778Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:02.779Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:02.779Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:02.779Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:02.779Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:38:02.780Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:02.780Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:02.780Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:02.780Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:02.780Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:02.787Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:02.787Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:02.788Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:02.788Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:02.788Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:02.788Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:02.788Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:02.788Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:02.789Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:02.789Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:02.789Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:02.789Z] [LOG] Regular deductions for Anoj null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:02.790Z] [LOG] Combined deductions for Anoj null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:38:02.894Z] [LOG] Creating components for record 3b668378-50b6-49a3-b5bb-0798441c22a9: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:02.894Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:38:02.997Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:03.102Z] [LOG] Created payroll_record_component: 805bebbb-a508-44b3-9f62-223ad284efaf for Working Hours Shortfall
[2025-10-08T03:38:03.413Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:03.415Z] [ERROR] ❌ Error updating financial balances for employee 0143afc6-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:03.416Z] [LOG] ✅ Anoj null: Calculation completed successfully
[2025-10-08T03:38:03.416Z] [LOG] 📊 Progress: 10/34 (29.4%)
[2025-10-08T03:38:03.417Z] [LOG] 
🧮 Processing: Ratheeshanan null (EMP000047)
[2025-10-08T03:38:03.417Z] [LOG] 📋 Record ID: 4b533ef4-95a7-494c-9716-49a0d05d4d5f
[2025-10-08T03:38:03.880Z] [LOG] 🔍 Component filtering for employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:03.880Z] [LOG]    Total components: 7
[2025-10-08T03:38:03.881Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:03.881Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-08T03:38:04.638Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:04.742Z] [LOG] 🔍 Fetched 4 attendance records for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:04.846Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:05.054Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:05.388Z] [LOG] Employee 01444966-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:05.389Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:05.389Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:05.391Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:05.393Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:05.393Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:05.393Z] [LOG] ================================================================================
[2025-10-08T03:38:05.394Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:05.394Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:05.395Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:05.396Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:05.397Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:05.398Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:05.399Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:05.400Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:05.400Z] [LOG] ================================================================================
[2025-10-08T03:38:05.402Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:05.403Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:05.403Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:05.404Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:05.405Z] [LOG] ================================================================================
[2025-10-08T03:38:05.521Z] [LOG] 🔄 Processing financial records for employee 01444966-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:05.521Z] [LOG] 🔄 Processing financial records for employee 01444966-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:05.636Z] [LOG] 📊 Found 0 active loans for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:05.745Z] [LOG] 📊 Found 0 active advances for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:05.847Z] [LOG] 📊 Found 0 approved bonuses for employee 01444966-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:05.848Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:05.848Z] [LOG] 💰 GROSS CALCULATION for Ratheeshanan null:
[2025-10-08T03:38:05.848Z] [LOG]    Base Salary: 25000
[2025-10-08T03:38:05.849Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:05.949Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:06.051Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:06.584Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:06.584Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:06.706Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:06.817Z] [LOG] Employee 01444966-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:06.817Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:06.817Z] [LOG] ============================================================
[2025-10-08T03:38:06.818Z] [LOG] 👤 Employee ID: 01444966-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:06.818Z] [LOG] 💰 Base Salary: 25,000
[2025-10-08T03:38:06.818Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:06.819Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:06.819Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:06.819Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:06.819Z] [LOG] 💵 Per-Day Salary: 1000.00 (25000 ÷ 25)
[2025-10-08T03:38:06.820Z] [LOG] ⏱️  Hourly Rate: 117.65 (1000.00 ÷ 8.5)
[2025-10-08T03:38:06.820Z] [LOG] 
[2025-10-08T03:38:06.820Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:06.821Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:06.821Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:06.821Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:06.821Z] [LOG]    💸 Shortfall Deduction: 8.5h × 117.65 = 1000.00
[2025-10-08T03:38:06.822Z] [LOG] ============================================================
[2025-10-08T03:38:07.081Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:07.081Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:07.201Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:07.307Z] [LOG] 📅 Weekend absence check for employee 01444966-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:07.308Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:07.308Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:07.308Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:07.308Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:07.309Z] [LOG]    Gross Salary: 25000
[2025-10-08T03:38:07.309Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:07.309Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:07.309Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:07.309Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:07.310Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:07.310Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:07.310Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:07.310Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:07.310Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:07.310Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:07.311Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:07.311Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:07.311Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:07.311Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:07.311Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:07.311Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:07.311Z] [LOG] Regular deductions for Ratheeshanan null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:07.312Z] [LOG] Combined deductions for Ratheeshanan null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 1000,
      "details": "8.5 hours × 117.65"
    }
  ],
  "total": 1000
}
[2025-10-08T03:38:07.414Z] [LOG] Creating components for record 4b533ef4-95a7-494c-9716-49a0d05d4d5f: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:07.415Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 1000
}
[2025-10-08T03:38:07.528Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:07.630Z] [LOG] Created payroll_record_component: a8d97b37-da96-487b-8c07-f9fcc0cea8ce for Working Hours Shortfall
[2025-10-08T03:38:07.940Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:07.941Z] [ERROR] ❌ Error updating financial balances for employee 01444966-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:07.942Z] [LOG] ✅ Ratheeshanan null: Calculation completed successfully
[2025-10-08T03:38:07.943Z] [LOG] 📊 Progress: 11/34 (32.4%)
[2025-10-08T03:38:07.943Z] [LOG] 
🧮 Processing: Franklin null (EMP000018)
[2025-10-08T03:38:07.943Z] [LOG] 📋 Record ID: 4bfac7df-f577-47a8-9df7-785b239ffdd4
[2025-10-08T03:38:08.358Z] [LOG] 🔍 Component filtering for employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:08.358Z] [LOG]    Total components: 7
[2025-10-08T03:38:08.359Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:08.360Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-08T03:38:09.003Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:09.106Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:09.206Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:09.419Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:09.740Z] [LOG] Employee 0143c037-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:09.741Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:09.741Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:09.741Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:09.742Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:09.742Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:09.742Z] [LOG] ================================================================================
[2025-10-08T03:38:09.742Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:09.743Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:09.743Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:09.743Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:09.743Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:09.743Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:09.744Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:09.744Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:09.744Z] [LOG] ================================================================================
[2025-10-08T03:38:09.744Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:09.744Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:09.744Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:09.745Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:09.745Z] [LOG] ================================================================================
[2025-10-08T03:38:09.845Z] [LOG] 🔄 Processing financial records for employee 0143c037-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:09.846Z] [LOG] 🔄 Processing financial records for employee 0143c037-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:09.948Z] [LOG] 📊 Found 0 active loans for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:10.455Z] [LOG] 📊 Found 0 active advances for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:10.559Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c037-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:10.559Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:10.560Z] [LOG] 💰 GROSS CALCULATION for Franklin null:
[2025-10-08T03:38:10.560Z] [LOG]    Base Salary: 50000
[2025-10-08T03:38:10.560Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:10.666Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:10.775Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:11.288Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:11.289Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:11.394Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:11.495Z] [LOG] Employee 0143c037-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:11.496Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:11.496Z] [LOG] ============================================================
[2025-10-08T03:38:11.496Z] [LOG] 👤 Employee ID: 0143c037-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:11.496Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:38:11.496Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:11.497Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:11.497Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:11.497Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:11.497Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:38:11.497Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:38:11.497Z] [LOG] 
[2025-10-08T03:38:11.498Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:11.498Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:11.498Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:11.498Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:11.498Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:38:11.498Z] [LOG] ============================================================
[2025-10-08T03:38:11.704Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:11.704Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:11.807Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:11.915Z] [LOG] 📅 Weekend absence check for employee 0143c037-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:11.915Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:11.915Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:11.916Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:11.916Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:11.916Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:38:11.916Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:11.916Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:11.917Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:11.917Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:11.917Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:11.917Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:11.917Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:11.918Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:11.918Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:11.918Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:11.918Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:11.918Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:11.919Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:11.919Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:11.919Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:11.919Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:11.920Z] [LOG] Regular deductions for Franklin null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:11.920Z] [LOG] Combined deductions for Franklin null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:38:12.020Z] [LOG] Creating components for record 4bfac7df-f577-47a8-9df7-785b239ffdd4: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:12.021Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:38:12.132Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:12.232Z] [LOG] Created payroll_record_component: e508f5af-1239-4721-bafc-5d516bea8e13 for Working Hours Shortfall
[2025-10-08T03:38:12.533Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:12.535Z] [ERROR] ❌ Error updating financial balances for employee 0143c037-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:12.536Z] [LOG] ✅ Franklin null: Calculation completed successfully
[2025-10-08T03:38:12.536Z] [LOG] 📊 Progress: 12/34 (35.3%)
[2025-10-08T03:38:12.536Z] [LOG] 
🧮 Processing: Chamodi null (EMP000032)
[2025-10-08T03:38:12.537Z] [LOG] 📋 Record ID: 4ef4aeb3-a740-4c48-b1cf-b7f59b9b45b8
[2025-10-08T03:38:12.960Z] [LOG] 🔍 Component filtering for employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:12.961Z] [LOG]    Total components: 7
[2025-10-08T03:38:12.961Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:12.961Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-08T03:38:13.572Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:13.671Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:13.776Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:13.980Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:14.282Z] [LOG] Employee 0143f302-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:14.282Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:14.283Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:14.283Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:14.284Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:14.284Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:14.284Z] [LOG] ================================================================================
[2025-10-08T03:38:14.285Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:14.285Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:14.285Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:14.285Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:14.286Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:14.286Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:14.286Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:14.287Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:14.287Z] [LOG] ================================================================================
[2025-10-08T03:38:14.287Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:14.287Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:14.288Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:14.288Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:14.288Z] [LOG] ================================================================================
[2025-10-08T03:38:14.390Z] [LOG] 🔄 Processing financial records for employee 0143f302-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:14.390Z] [LOG] 🔄 Processing financial records for employee 0143f302-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:14.502Z] [LOG] 📊 Found 0 active loans for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:14.614Z] [LOG] 📊 Found 0 active advances for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:14.717Z] [LOG] 📊 Found 0 approved bonuses for employee 0143f302-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:14.717Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:14.718Z] [LOG] 💰 GROSS CALCULATION for Chamodi null:
[2025-10-08T03:38:14.718Z] [LOG]    Base Salary: 50000
[2025-10-08T03:38:14.718Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:14.819Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:14.922Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:15.442Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:15.442Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:15.544Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:15.653Z] [LOG] Employee 0143f302-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:15.653Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:15.654Z] [LOG] ============================================================
[2025-10-08T03:38:15.654Z] [LOG] 👤 Employee ID: 0143f302-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:15.654Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:38:15.655Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:15.655Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:15.655Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:15.656Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:15.656Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:38:15.657Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:38:15.657Z] [LOG] 
[2025-10-08T03:38:15.658Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:15.658Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:15.658Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:15.659Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:15.659Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:38:15.659Z] [LOG] ============================================================
[2025-10-08T03:38:15.863Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:15.863Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:15.967Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:16.069Z] [LOG] 📅 Weekend absence check for employee 0143f302-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:16.069Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:16.069Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:16.070Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:16.070Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:16.070Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:38:16.071Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:16.071Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:16.071Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:16.072Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:16.072Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:16.072Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:16.072Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:16.073Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:16.074Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:16.075Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:16.075Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:16.076Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:16.076Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:16.076Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:16.077Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:16.077Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:16.078Z] [LOG] Regular deductions for Chamodi null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:16.078Z] [LOG] Combined deductions for Chamodi null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:38:16.188Z] [LOG] Creating components for record 4ef4aeb3-a740-4c48-b1cf-b7f59b9b45b8: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:16.188Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:38:16.291Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:16.395Z] [LOG] Created payroll_record_component: 52e7f6e8-0a0b-4a34-b5d7-e7d5cf09687b for Working Hours Shortfall
[2025-10-08T03:38:16.706Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:16.708Z] [ERROR] ❌ Error updating financial balances for employee 0143f302-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:16.709Z] [LOG] ✅ Chamodi null: Calculation completed successfully
[2025-10-08T03:38:16.710Z] [LOG] 📊 Progress: 13/34 (38.2%)
[2025-10-08T03:38:16.710Z] [LOG] 
🧮 Processing: Sumaiya null (EMP000016)
[2025-10-08T03:38:16.710Z] [LOG] 📋 Record ID: 4ff708ca-2605-4d29-b903-f4197af0c0a3
[2025-10-08T03:38:17.131Z] [LOG] 🔍 Component filtering for employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:17.131Z] [LOG]    Total components: 7
[2025-10-08T03:38:17.131Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:17.131Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-08T03:38:17.744Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:17.849Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:17.952Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:18.168Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:18.481Z] [LOG] Employee 0143b22f-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:18.482Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:18.482Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:18.483Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:18.483Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:18.484Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:18.484Z] [LOG] ================================================================================
[2025-10-08T03:38:18.484Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:18.485Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:18.485Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:18.485Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:18.486Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:18.486Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:18.486Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:18.487Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:18.487Z] [LOG] ================================================================================
[2025-10-08T03:38:18.487Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:18.488Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:18.488Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:18.488Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:18.488Z] [LOG] ================================================================================
[2025-10-08T03:38:18.593Z] [LOG] 🔄 Processing financial records for employee 0143b22f-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:18.593Z] [LOG] 🔄 Processing financial records for employee 0143b22f-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:18.697Z] [LOG] 📊 Found 0 active loans for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:18.801Z] [LOG] 📊 Found 0 active advances for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:18.903Z] [LOG] 📊 Found 0 approved bonuses for employee 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:18.904Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:18.904Z] [LOG] 💰 GROSS CALCULATION for Sumaiya null:
[2025-10-08T03:38:18.905Z] [LOG]    Base Salary: 60000
[2025-10-08T03:38:18.905Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:19.005Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:19.120Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:19.632Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:19.632Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:19.738Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:19.843Z] [LOG] Employee 0143b22f-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:19.844Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:19.844Z] [LOG] ============================================================
[2025-10-08T03:38:19.844Z] [LOG] 👤 Employee ID: 0143b22f-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:19.845Z] [LOG] 💰 Base Salary: 60,000
[2025-10-08T03:38:19.845Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:19.845Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:19.845Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:19.846Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:19.846Z] [LOG] 💵 Per-Day Salary: 2400.00 (60000 ÷ 25)
[2025-10-08T03:38:19.846Z] [LOG] ⏱️  Hourly Rate: 282.35 (2400.00 ÷ 8.5)
[2025-10-08T03:38:19.847Z] [LOG] 
[2025-10-08T03:38:19.847Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:19.847Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:19.848Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:19.848Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:19.848Z] [LOG]    💸 Shortfall Deduction: 8.5h × 282.35 = 2400.00
[2025-10-08T03:38:19.848Z] [LOG] ============================================================
[2025-10-08T03:38:20.059Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:20.059Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:20.213Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:20.504Z] [LOG] 📅 Weekend absence check for employee 0143b22f-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:20.505Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:20.505Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:20.505Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:20.506Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:20.506Z] [LOG]    Gross Salary: 60000
[2025-10-08T03:38:20.506Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:20.507Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:20.508Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:20.508Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:20.509Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:20.509Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:20.509Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:20.509Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:20.509Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:20.509Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:20.510Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:20.510Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:20.510Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:20.510Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:20.510Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:20.511Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:20.511Z] [LOG] Regular deductions for Sumaiya null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:20.511Z] [LOG] Combined deductions for Sumaiya null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2400,
      "details": "8.5 hours × 282.35"
    }
  ],
  "total": 2400
}
[2025-10-08T03:38:20.736Z] [LOG] Creating components for record 4ff708ca-2605-4d29-b903-f4197af0c0a3: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:20.737Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2400
}
[2025-10-08T03:38:20.857Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:20.963Z] [LOG] Created payroll_record_component: 0437a7e1-d915-4ffa-bcc8-df219a4885b5 for Working Hours Shortfall
[2025-10-08T03:38:21.291Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:21.292Z] [ERROR] ❌ Error updating financial balances for employee 0143b22f-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:21.294Z] [LOG] ✅ Sumaiya null: Calculation completed successfully
[2025-10-08T03:38:21.294Z] [LOG] 📊 Progress: 14/34 (41.2%)
[2025-10-08T03:38:21.294Z] [LOG] 
🧮 Processing: Hari null (EMP000017)
[2025-10-08T03:38:21.295Z] [LOG] 📋 Record ID: 5df3abaa-0310-4b34-af78-2556db49521e
[2025-10-08T03:38:21.719Z] [LOG] 🔍 Component filtering for employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:21.719Z] [LOG]    Total components: 7
[2025-10-08T03:38:21.719Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:21.720Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-08T03:38:22.342Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:22.442Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:22.562Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:22.782Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:23.085Z] [LOG] Employee 0143bc58-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:23.086Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:23.086Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:23.087Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:23.088Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:23.088Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:23.088Z] [LOG] ================================================================================
[2025-10-08T03:38:23.089Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:23.089Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:23.090Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:23.091Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:23.091Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:23.092Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:23.092Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:23.093Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:23.093Z] [LOG] ================================================================================
[2025-10-08T03:38:23.093Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:23.093Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:23.093Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:23.094Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:23.094Z] [LOG] ================================================================================
[2025-10-08T03:38:23.501Z] [LOG] 🔄 Processing financial records for employee 0143bc58-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:23.502Z] [LOG] 🔄 Processing financial records for employee 0143bc58-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:23.600Z] [LOG] 📊 Found 0 active loans for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:23.710Z] [LOG] 📊 Found 0 active advances for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:23.811Z] [LOG] 📊 Found 0 approved bonuses for employee 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:23.812Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:23.812Z] [LOG] 💰 GROSS CALCULATION for Hari null:
[2025-10-08T03:38:23.812Z] [LOG]    Base Salary: 50000
[2025-10-08T03:38:23.813Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:23.913Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:24.014Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:24.537Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:24.538Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:24.650Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:24.810Z] [LOG] Employee 0143bc58-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:24.810Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:24.810Z] [LOG] ============================================================
[2025-10-08T03:38:24.810Z] [LOG] 👤 Employee ID: 0143bc58-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:24.811Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:38:24.811Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:24.811Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:24.811Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:24.811Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:24.811Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:38:24.811Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:38:24.812Z] [LOG] 
[2025-10-08T03:38:24.812Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:24.812Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:24.812Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:24.812Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:24.812Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:38:24.813Z] [LOG] ============================================================
[2025-10-08T03:38:25.021Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:25.022Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:25.128Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:25.231Z] [LOG] 📅 Weekend absence check for employee 0143bc58-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:25.231Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:25.231Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:25.231Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:25.232Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:25.232Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:38:25.232Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:25.233Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:25.233Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:25.233Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:25.234Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:25.234Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:25.234Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:25.234Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:25.235Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:25.235Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:25.235Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:25.235Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:25.236Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:25.236Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:25.236Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:25.236Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:25.237Z] [LOG] Regular deductions for Hari null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:25.237Z] [LOG] Combined deductions for Hari null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:38:25.346Z] [LOG] Creating components for record 5df3abaa-0310-4b34-af78-2556db49521e: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:25.347Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:38:25.450Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:25.550Z] [LOG] Created payroll_record_component: 632ffbbb-42dc-409b-aaef-38c286812770 for Working Hours Shortfall
[2025-10-08T03:38:25.858Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:25.860Z] [ERROR] ❌ Error updating financial balances for employee 0143bc58-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:25.861Z] [LOG] ✅ Hari null: Calculation completed successfully
[2025-10-08T03:38:25.862Z] [LOG] 📊 Progress: 15/34 (44.1%)
[2025-10-08T03:38:25.862Z] [LOG] 
🧮 Processing: Ruvindu Hewabandu null (EMP000027)
[2025-10-08T03:38:25.862Z] [LOG] 📋 Record ID: 61501f43-ca6a-45a2-bc78-25c81d8a6adb
[2025-10-08T03:38:26.592Z] [LOG] 🔍 Component filtering for employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:26.593Z] [LOG]    Total components: 7
[2025-10-08T03:38:26.593Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:26.593Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-08T03:38:27.334Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:27.436Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:27.541Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:27.746Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:28.184Z] [LOG] Employee 0143e915-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:28.184Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:28.184Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:28.184Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:28.185Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:28.185Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:28.185Z] [LOG] ================================================================================
[2025-10-08T03:38:28.186Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:28.186Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:28.186Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:28.186Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:28.186Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:28.186Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:28.187Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:28.187Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:28.187Z] [LOG] ================================================================================
[2025-10-08T03:38:28.187Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:28.187Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:28.187Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:28.188Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:28.188Z] [LOG] ================================================================================
[2025-10-08T03:38:28.290Z] [LOG] 🔄 Processing financial records for employee 0143e915-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:28.291Z] [LOG] 🔄 Processing financial records for employee 0143e915-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:28.393Z] [LOG] 📊 Found 0 active loans for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:28.498Z] [LOG] 📊 Found 0 active advances for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:28.602Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e915-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:28.602Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:28.603Z] [LOG] 💰 GROSS CALCULATION for Ruvindu Hewabandu null:
[2025-10-08T03:38:28.603Z] [LOG]    Base Salary: 0
[2025-10-08T03:38:28.603Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:28.708Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:28.829Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:29.363Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:29.363Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:29.465Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:29.568Z] [LOG] Employee 0143e915-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:29.568Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:29.568Z] [LOG] ============================================================
[2025-10-08T03:38:29.568Z] [LOG] 👤 Employee ID: 0143e915-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:29.569Z] [LOG] 💰 Base Salary: 0
[2025-10-08T03:38:29.569Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:29.569Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:29.569Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:29.569Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:29.569Z] [LOG] 💵 Per-Day Salary: 0.00 (0 ÷ 25)
[2025-10-08T03:38:29.569Z] [LOG] ⏱️  Hourly Rate: 0.00 (0.00 ÷ 8.5)
[2025-10-08T03:38:29.570Z] [LOG] 
[2025-10-08T03:38:29.570Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:29.570Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:29.570Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:29.570Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:29.570Z] [LOG]    💸 Shortfall Deduction: 8.5h × 0.00 = 0.00
[2025-10-08T03:38:29.570Z] [LOG] ============================================================
[2025-10-08T03:38:29.778Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:29.778Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:29.885Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:29.990Z] [LOG] 📅 Weekend absence check for employee 0143e915-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:29.991Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:29.992Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:29.992Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:29.992Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:29.993Z] [LOG]    Gross Salary: 0
[2025-10-08T03:38:29.993Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:29.993Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:29.993Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:29.994Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:29.994Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:29.994Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:29.995Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:29.995Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:29.995Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:29.995Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:29.996Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:29.996Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:29.996Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:29.996Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:29.997Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:29.998Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:29.998Z] [LOG] Regular deductions for Ruvindu Hewabandu null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:29.998Z] [LOG] Combined deductions for Ruvindu Hewabandu null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 0,
      "details": "8.5 hours × 0.00"
    }
  ],
  "total": 0
}
[2025-10-08T03:38:30.115Z] [LOG] Creating components for record 61501f43-ca6a-45a2-bc78-25c81d8a6adb: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:30.115Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 0
}
[2025-10-08T03:38:30.217Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:30.321Z] [LOG] Created payroll_record_component: e084dfa3-ef54-44dd-9a5a-5af49e5fc28c for Working Hours Shortfall
[2025-10-08T03:38:30.625Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:30.627Z] [ERROR] ❌ Error updating financial balances for employee 0143e915-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:30.628Z] [LOG] ✅ Ruvindu Hewabandu null: Calculation completed successfully
[2025-10-08T03:38:30.629Z] [LOG] 📊 Progress: 16/34 (47.1%)
[2025-10-08T03:38:30.629Z] [LOG] 
🧮 Processing: Maryam null (EMP000035)
[2025-10-08T03:38:30.629Z] [LOG] 📋 Record ID: 699980a5-bece-4c1d-9f4c-8b901f5601e7
[2025-10-08T03:38:31.037Z] [LOG] 🔍 Component filtering for employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:31.037Z] [LOG]    Total components: 7
[2025-10-08T03:38:31.037Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:31.037Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-08T03:38:31.665Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:31.769Z] [LOG] 🔍 Fetched 4 attendance records for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:31.871Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:32.083Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:32.396Z] [LOG] Employee 01440221-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:32.396Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:32.397Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:32.397Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:32.398Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:32.398Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:32.398Z] [LOG] ================================================================================
[2025-10-08T03:38:32.399Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:32.399Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:32.399Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:32.399Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:32.400Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:32.400Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:32.400Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:32.400Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:32.400Z] [LOG] ================================================================================
[2025-10-08T03:38:32.400Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:32.400Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:32.400Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:32.401Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:32.401Z] [LOG] ================================================================================
[2025-10-08T03:38:32.510Z] [LOG] 🔄 Processing financial records for employee 01440221-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:32.510Z] [LOG] 🔄 Processing financial records for employee 01440221-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:32.612Z] [LOG] 📊 Found 0 active loans for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:32.714Z] [LOG] 📊 Found 0 active advances for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:32.822Z] [LOG] 📊 Found 0 approved bonuses for employee 01440221-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:32.822Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:32.823Z] [LOG] 💰 GROSS CALCULATION for Maryam null:
[2025-10-08T03:38:32.824Z] [LOG]    Base Salary: 40000
[2025-10-08T03:38:32.824Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:32.929Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:33.043Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:33.935Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:33.935Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:34.054Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:34.155Z] [LOG] Employee 01440221-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:34.156Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:34.156Z] [LOG] ============================================================
[2025-10-08T03:38:34.156Z] [LOG] 👤 Employee ID: 01440221-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:34.156Z] [LOG] 💰 Base Salary: 40,000
[2025-10-08T03:38:34.158Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:34.158Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:34.158Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:34.158Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:34.159Z] [LOG] 💵 Per-Day Salary: 1600.00 (40000 ÷ 25)
[2025-10-08T03:38:34.159Z] [LOG] ⏱️  Hourly Rate: 188.24 (1600.00 ÷ 8.5)
[2025-10-08T03:38:34.159Z] [LOG] 
[2025-10-08T03:38:34.160Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:34.160Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:34.160Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:34.160Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:34.161Z] [LOG]    💸 Shortfall Deduction: 8.5h × 188.24 = 1600.00
[2025-10-08T03:38:34.161Z] [LOG] ============================================================
[2025-10-08T03:38:34.368Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:34.368Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:34.482Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:34.585Z] [LOG] 📅 Weekend absence check for employee 01440221-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:34.585Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:34.585Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:34.585Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:34.585Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:34.586Z] [LOG]    Gross Salary: 40000
[2025-10-08T03:38:34.586Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:34.586Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:34.586Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:34.586Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:34.586Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:34.586Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:34.586Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:34.587Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:34.587Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:34.587Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:34.587Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:34.587Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:34.587Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:34.587Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:34.588Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:34.588Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:34.588Z] [LOG] Regular deductions for Maryam null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:34.588Z] [LOG] Combined deductions for Maryam null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 1600,
      "details": "8.5 hours × 188.24"
    }
  ],
  "total": 1600
}
[2025-10-08T03:38:35.105Z] [LOG] Creating components for record 699980a5-bece-4c1d-9f4c-8b901f5601e7: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:35.106Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 1600
}
[2025-10-08T03:38:35.209Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:35.314Z] [LOG] Created payroll_record_component: 731fe560-6876-4b55-9ba3-b4ae5332fa72 for Working Hours Shortfall
[2025-10-08T03:38:35.672Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:35.673Z] [ERROR] ❌ Error updating financial balances for employee 01440221-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:35.676Z] [LOG] ✅ Maryam null: Calculation completed successfully
[2025-10-08T03:38:35.676Z] [LOG] 📊 Progress: 17/34 (50.0%)
[2025-10-08T03:38:35.677Z] [LOG] 
🧮 Processing: Office Team null (EMP000041)
[2025-10-08T03:38:35.677Z] [LOG] 📋 Record ID: 6aecf18b-aaea-42d4-9d44-af41897d2866
[2025-10-08T03:38:36.092Z] [LOG] 🔍 Component filtering for employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:36.093Z] [LOG]    Total components: 7
[2025-10-08T03:38:36.093Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:36.093Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-08T03:38:36.721Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:36.826Z] [LOG] 🔍 Fetched 4 attendance records for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:36.933Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:37.241Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:37.549Z] [LOG] Employee 01442b21-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:37.549Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:37.550Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:37.550Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:37.551Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:37.552Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:37.552Z] [LOG] ================================================================================
[2025-10-08T03:38:37.553Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:37.553Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:37.553Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:37.554Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:37.554Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:37.554Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:37.556Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:37.556Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:37.557Z] [LOG] ================================================================================
[2025-10-08T03:38:37.558Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:37.558Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:37.559Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:37.559Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:37.559Z] [LOG] ================================================================================
[2025-10-08T03:38:37.670Z] [LOG] 🔄 Processing financial records for employee 01442b21-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:37.671Z] [LOG] 🔄 Processing financial records for employee 01442b21-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:37.811Z] [LOG] 📊 Found 0 active loans for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:37.921Z] [LOG] 📊 Found 0 active advances for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:38.033Z] [LOG] 📊 Found 0 approved bonuses for employee 01442b21-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:38.033Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:38.034Z] [LOG] 💰 GROSS CALCULATION for Office Team null:
[2025-10-08T03:38:38.034Z] [LOG]    Base Salary: 1
[2025-10-08T03:38:38.035Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:38.140Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:38.245Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:38.765Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:38.766Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:38.871Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:38.977Z] [LOG] Employee 01442b21-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:38.978Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:38.978Z] [LOG] ============================================================
[2025-10-08T03:38:38.978Z] [LOG] 👤 Employee ID: 01442b21-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:38.979Z] [LOG] 💰 Base Salary: 1
[2025-10-08T03:38:38.979Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:38.980Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:38.980Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:38.980Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:38.981Z] [LOG] 💵 Per-Day Salary: 0.04 (1 ÷ 25)
[2025-10-08T03:38:38.981Z] [LOG] ⏱️  Hourly Rate: 0.00 (0.04 ÷ 8.5)
[2025-10-08T03:38:38.982Z] [LOG] 
[2025-10-08T03:38:38.982Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:38.982Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:38.983Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:38.983Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:38.984Z] [LOG]    💸 Shortfall Deduction: 8.5h × 0.00 = 0.04
[2025-10-08T03:38:38.985Z] [LOG] ============================================================
[2025-10-08T03:38:39.193Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:39.194Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:39.314Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:39.415Z] [LOG] 📅 Weekend absence check for employee 01442b21-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:39.415Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:39.416Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:39.417Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:39.417Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:39.417Z] [LOG]    Gross Salary: 1
[2025-10-08T03:38:39.418Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:39.418Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:39.419Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:39.420Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:39.421Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:39.421Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:39.422Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:39.422Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:39.422Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:39.423Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:39.424Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:39.425Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:39.425Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:39.425Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:39.426Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:39.426Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:39.427Z] [LOG] Regular deductions for Office Team null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:39.427Z] [LOG] Combined deductions for Office Team null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 0.04,
      "details": "8.5 hours × 0.00"
    }
  ],
  "total": 0.04
}
[2025-10-08T03:38:39.544Z] [LOG] Creating components for record 6aecf18b-aaea-42d4-9d44-af41897d2866: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:39.545Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 0.04
}
[2025-10-08T03:38:39.649Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:39.752Z] [LOG] Created payroll_record_component: 2165ed49-d112-49e5-be83-bc581d1c55e3 for Working Hours Shortfall
[2025-10-08T03:38:40.061Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:40.063Z] [ERROR] ❌ Error updating financial balances for employee 01442b21-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:40.064Z] [LOG] ✅ Office Team null: Calculation completed successfully
[2025-10-08T03:38:40.065Z] [LOG] 📊 Progress: 18/34 (52.9%)
[2025-10-08T03:38:40.065Z] [LOG] 
🧮 Processing: Ishara null (EMP000011)
[2025-10-08T03:38:40.065Z] [LOG] 📋 Record ID: 6c92b124-3b6e-4f98-997f-cbce5602e5e7
[2025-10-08T03:38:40.483Z] [LOG] 🔍 Component filtering for employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:40.484Z] [LOG]    Total components: 7
[2025-10-08T03:38:40.485Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:40.485Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-08T03:38:41.104Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:41.205Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:41.313Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:41.527Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:41.844Z] [LOG] Employee 0143ac0c-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:41.844Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:41.845Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:41.845Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:41.847Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:41.847Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:41.847Z] [LOG] ================================================================================
[2025-10-08T03:38:41.848Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:41.848Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:41.849Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:41.849Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:41.849Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:41.850Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:41.850Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:41.850Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:41.851Z] [LOG] ================================================================================
[2025-10-08T03:38:41.851Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:41.852Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:41.852Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:41.852Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:41.852Z] [LOG] ================================================================================
[2025-10-08T03:38:41.952Z] [LOG] 🔄 Processing financial records for employee 0143ac0c-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:41.953Z] [LOG] 🔄 Processing financial records for employee 0143ac0c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:42.060Z] [LOG] 📊 Found 0 active loans for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:42.161Z] [LOG] 📊 Found 0 active advances for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:42.263Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:42.263Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:42.264Z] [LOG] 💰 GROSS CALCULATION for Ishara null:
[2025-10-08T03:38:42.264Z] [LOG]    Base Salary: 50000
[2025-10-08T03:38:42.264Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:42.366Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:42.469Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:42.984Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:42.985Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:43.096Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:43.203Z] [LOG] Employee 0143ac0c-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:43.203Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:43.204Z] [LOG] ============================================================
[2025-10-08T03:38:43.204Z] [LOG] 👤 Employee ID: 0143ac0c-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:43.204Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:38:43.205Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:43.205Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:43.205Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:43.206Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:43.206Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:38:43.208Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:38:43.210Z] [LOG] 
[2025-10-08T03:38:43.211Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:43.211Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:43.212Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:43.212Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:43.213Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:38:43.213Z] [LOG] ============================================================
[2025-10-08T03:38:43.428Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:43.428Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:43.530Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:43.633Z] [LOG] 📅 Weekend absence check for employee 0143ac0c-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:43.634Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:43.634Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:43.635Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:43.635Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:43.635Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:38:43.636Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:43.636Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:43.636Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:43.637Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:43.637Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:43.638Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:43.638Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:43.638Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:43.639Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:43.639Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:43.642Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:43.642Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:43.643Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:43.643Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:43.644Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:43.644Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:43.644Z] [LOG] Regular deductions for Ishara null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:43.646Z] [LOG] Combined deductions for Ishara null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:38:43.750Z] [LOG] Creating components for record 6c92b124-3b6e-4f98-997f-cbce5602e5e7: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:43.751Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:38:43.856Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:43.958Z] [LOG] Created payroll_record_component: 70e5f340-59a0-41f0-b453-25d0f681cbcd for Working Hours Shortfall
[2025-10-08T03:38:44.264Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:44.266Z] [ERROR] ❌ Error updating financial balances for employee 0143ac0c-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:44.267Z] [LOG] ✅ Ishara null: Calculation completed successfully
[2025-10-08T03:38:44.268Z] [LOG] 📊 Progress: 19/34 (55.9%)
[2025-10-08T03:38:44.268Z] [LOG] 
🧮 Processing: customer null (EMP000036)
[2025-10-08T03:38:44.269Z] [LOG] 📋 Record ID: 6cbd80e6-0c60-431a-9d89-8d07ba20ae24
[2025-10-08T03:38:44.678Z] [LOG] 🔍 Component filtering for employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:44.678Z] [LOG]    Total components: 7
[2025-10-08T03:38:44.679Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:44.679Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-08T03:38:45.296Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:45.401Z] [LOG] 🔍 Fetched 4 attendance records for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:45.504Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:45.716Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:46.036Z] [LOG] Employee 014409a2-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:46.036Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:46.037Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:46.037Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:46.038Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:46.039Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:46.039Z] [LOG] ================================================================================
[2025-10-08T03:38:46.039Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:46.039Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:46.040Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:46.040Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:46.041Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:46.041Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:46.042Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:46.042Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:46.042Z] [LOG] ================================================================================
[2025-10-08T03:38:46.042Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:46.043Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:46.043Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:46.043Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:46.044Z] [LOG] ================================================================================
[2025-10-08T03:38:46.159Z] [LOG] 🔄 Processing financial records for employee 014409a2-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:46.160Z] [LOG] 🔄 Processing financial records for employee 014409a2-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:46.271Z] [LOG] 📊 Found 0 active loans for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:46.730Z] [LOG] 📊 Found 0 active advances for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:46.834Z] [LOG] 📊 Found 0 approved bonuses for employee 014409a2-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:46.834Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:46.835Z] [LOG] 💰 GROSS CALCULATION for customer null:
[2025-10-08T03:38:46.835Z] [LOG]    Base Salary: 0
[2025-10-08T03:38:46.836Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:46.938Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:47.044Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:47.559Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:47.560Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:47.661Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:47.764Z] [LOG] Employee 014409a2-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:47.765Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:47.765Z] [LOG] ============================================================
[2025-10-08T03:38:47.766Z] [LOG] 👤 Employee ID: 014409a2-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:47.766Z] [LOG] 💰 Base Salary: 0
[2025-10-08T03:38:47.766Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:47.767Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:47.767Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:47.767Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:47.768Z] [LOG] 💵 Per-Day Salary: 0.00 (0 ÷ 25)
[2025-10-08T03:38:47.768Z] [LOG] ⏱️  Hourly Rate: 0.00 (0.00 ÷ 8.5)
[2025-10-08T03:38:47.768Z] [LOG] 
[2025-10-08T03:38:47.769Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:47.769Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:47.770Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:47.770Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:47.770Z] [LOG]    💸 Shortfall Deduction: 8.5h × 0.00 = 0.00
[2025-10-08T03:38:47.771Z] [LOG] ============================================================
[2025-10-08T03:38:47.991Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:47.991Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:48.100Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:48.206Z] [LOG] 📅 Weekend absence check for employee 014409a2-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:48.206Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:48.208Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:48.208Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:48.209Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:48.209Z] [LOG]    Gross Salary: 0
[2025-10-08T03:38:48.209Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:48.209Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:48.209Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:48.210Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:48.210Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:48.210Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:48.210Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:48.210Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:48.210Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:48.211Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:48.211Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:48.211Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:48.211Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:48.211Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:48.212Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:48.212Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:48.212Z] [LOG] Regular deductions for customer null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:48.212Z] [LOG] Combined deductions for customer null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 0,
      "details": "8.5 hours × 0.00"
    }
  ],
  "total": 0
}
[2025-10-08T03:38:48.322Z] [LOG] Creating components for record 6cbd80e6-0c60-431a-9d89-8d07ba20ae24: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:48.323Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 0
}
[2025-10-08T03:38:48.426Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:48.528Z] [LOG] Created payroll_record_component: f1edce66-0f9a-4c05-95e6-993e1cc218a0 for Working Hours Shortfall
[2025-10-08T03:38:48.844Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:48.845Z] [ERROR] ❌ Error updating financial balances for employee 014409a2-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:48.846Z] [LOG] ✅ customer null: Calculation completed successfully
[2025-10-08T03:38:48.847Z] [LOG] 📊 Progress: 20/34 (58.8%)
[2025-10-08T03:38:48.847Z] [LOG] 
🧮 Processing: Prasanthan null (EMP000001)
[2025-10-08T03:38:48.848Z] [LOG] 📋 Record ID: 7a83a6fd-4ce2-48e0-a671-13d72b510f3f
[2025-10-08T03:38:49.685Z] [LOG] 🔍 Component filtering for employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:49.685Z] [LOG]    Total components: 7
[2025-10-08T03:38:49.686Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:49.686Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-08T03:38:50.310Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:50.412Z] [LOG] 🔍 Fetched 4 attendance records for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:50.527Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:50.732Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:51.048Z] [LOG] Employee 014397c7-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:51.048Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:51.049Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:51.050Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:51.051Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:51.051Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:51.051Z] [LOG] ================================================================================
[2025-10-08T03:38:51.052Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:51.052Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:51.053Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:51.053Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:51.054Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:51.054Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:51.056Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:51.057Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:51.058Z] [LOG] ================================================================================
[2025-10-08T03:38:51.059Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:51.059Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:51.060Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:51.060Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:51.060Z] [LOG] ================================================================================
[2025-10-08T03:38:51.173Z] [LOG] 🔄 Processing financial records for employee 014397c7-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:51.174Z] [LOG] 🔄 Processing financial records for employee 014397c7-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:51.276Z] [LOG] 📊 Found 0 active loans for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:51.378Z] [LOG] 📊 Found 0 active advances for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:51.481Z] [LOG] 📊 Found 0 approved bonuses for employee 014397c7-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:51.482Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:51.482Z] [LOG] 💰 GROSS CALCULATION for Prasanthan null:
[2025-10-08T03:38:51.483Z] [LOG]    Base Salary: 150000
[2025-10-08T03:38:51.483Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:51.596Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:51.706Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:52.489Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:52.491Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:52.594Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:52.697Z] [LOG] Employee 014397c7-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:52.698Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:52.699Z] [LOG] ============================================================
[2025-10-08T03:38:52.699Z] [LOG] 👤 Employee ID: 014397c7-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:52.699Z] [LOG] 💰 Base Salary: 150,000
[2025-10-08T03:38:52.700Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:52.700Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:52.700Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:52.701Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:52.701Z] [LOG] 💵 Per-Day Salary: 6000.00 (150000 ÷ 25)
[2025-10-08T03:38:52.701Z] [LOG] ⏱️  Hourly Rate: 705.88 (6000.00 ÷ 8.5)
[2025-10-08T03:38:52.702Z] [LOG] 
[2025-10-08T03:38:52.702Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:52.702Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:52.703Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:52.703Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:52.704Z] [LOG]    💸 Shortfall Deduction: 8.5h × 705.88 = 6000.00
[2025-10-08T03:38:52.704Z] [LOG] ============================================================
[2025-10-08T03:38:52.910Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:52.911Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:53.018Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:53.130Z] [LOG] 📅 Weekend absence check for employee 014397c7-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:53.131Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:53.131Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:53.132Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:53.132Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:53.132Z] [LOG]    Gross Salary: 150000
[2025-10-08T03:38:53.133Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:53.133Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:53.133Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:53.134Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:53.134Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:53.135Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:53.135Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:53.135Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:53.136Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:53.136Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:53.137Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:53.137Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:53.138Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:53.138Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:53.138Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:53.139Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:53.139Z] [LOG] Regular deductions for Prasanthan null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:53.142Z] [LOG] Combined deductions for Prasanthan null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 6000,
      "details": "8.5 hours × 705.88"
    }
  ],
  "total": 6000
}
[2025-10-08T03:38:53.246Z] [LOG] Creating components for record 7a83a6fd-4ce2-48e0-a671-13d72b510f3f: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 1
}
[2025-10-08T03:38:53.247Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 6000
}
[2025-10-08T03:38:53.362Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:53.465Z] [LOG] Created payroll_record_component: 03d9bc66-6154-4328-a7ac-8d6f59e0a6ee for Working Hours Shortfall
[2025-10-08T03:38:53.465Z] [LOG] Processing component: {
  "name": "Income Tax",
  "type": "tax",
  "amount": 3000
}
[2025-10-08T03:38:53.772Z] [ERROR] Failed to create component INCOME_TAX: Data truncated for column 'component_type' at row 1
[2025-10-08T03:38:53.773Z] [ERROR] Component data: {
  "code": "INCOME_TAX",
  "name": "Income Tax",
  "type": "tax",
  "category": "tax",
  "amount": 3000
}
[2025-10-08T03:38:53.775Z] [ERROR] Full error: {
  "message": "Data truncated for column 'component_type' at row 1",
  "code": "WARN_DATA_TRUNCATED",
  "errno": 1265,
  "sql": "\n                        INSERT INTO payroll_components (\n                            id, client_id, component_name, component_type, category, \n                            calculation_type, is_taxable, is_mandatory\n                        ) VALUES (?, ?, ?, ?, ?, 'fixed', ?, ?)\n                    ",
  "sqlState": "01000",
  "sqlMessage": "Data truncated for column 'component_type' at row 1"
}
[2025-10-08T03:38:53.777Z] [LOG] Attempting alternative insertion for component: Income Tax
[2025-10-08T03:38:54.084Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:54.085Z] [ERROR] ❌ Error updating financial balances for employee 014397c7-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:54.086Z] [LOG] ✅ Prasanthan null: Calculation completed successfully
[2025-10-08T03:38:54.087Z] [LOG] 📊 Progress: 21/34 (61.8%)
[2025-10-08T03:38:54.087Z] [LOG] 
🧮 Processing: Safna Nawas null (EMP000021)
[2025-10-08T03:38:54.088Z] [LOG] 📋 Record ID: 819d9a8a-2d0e-4011-b4f0-31cb7b16966a
[2025-10-08T03:38:54.498Z] [LOG] 🔍 Component filtering for employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:54.499Z] [LOG]    Total components: 7
[2025-10-08T03:38:54.499Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:54.499Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-08T03:38:55.114Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:55.217Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:55.319Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:55.526Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:55.839Z] [LOG] Employee 0143c977-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:55.840Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:38:55.840Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:38:55.841Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:38:55.843Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:55.843Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:38:55.843Z] [LOG] ================================================================================
[2025-10-08T03:38:55.844Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:55.844Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:55.844Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:55.845Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:55.845Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:38:55.845Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:38:55.846Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:38:55.846Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:38:55.847Z] [LOG] ================================================================================
[2025-10-08T03:38:55.847Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:38:55.847Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:38:55.847Z] [LOG]    Expected hours: 34h
[2025-10-08T03:38:55.848Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:38:55.848Z] [LOG] ================================================================================
[2025-10-08T03:38:55.963Z] [LOG] 🔄 Processing financial records for employee 0143c977-7105-11f0-a50f-98e743540430...
[2025-10-08T03:38:55.963Z] [LOG] 🔄 Processing financial records for employee 0143c977-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:38:56.066Z] [LOG] 📊 Found 0 active loans for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:56.170Z] [LOG] 📊 Found 0 active advances for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:56.278Z] [LOG] 📊 Found 0 approved bonuses for employee 0143c977-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:56.279Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:38:56.280Z] [LOG] 💰 GROSS CALCULATION for Safna Nawas null:
[2025-10-08T03:38:56.281Z] [LOG]    Base Salary: 50000
[2025-10-08T03:38:56.282Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:38:56.384Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:38:56.487Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:56.999Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:38:57.000Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:38:57.103Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:38:57.207Z] [LOG] Employee 0143c977-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:38:57.209Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:38:57.209Z] [LOG] ============================================================
[2025-10-08T03:38:57.210Z] [LOG] 👤 Employee ID: 0143c977-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:57.210Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:38:57.211Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:38:57.211Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:38:57.212Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:38:57.212Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:38:57.212Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:38:57.213Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:38:57.213Z] [LOG] 
[2025-10-08T03:38:57.214Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:38:57.215Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:38:57.216Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:38:57.217Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:38:57.218Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:38:57.218Z] [LOG] ============================================================
[2025-10-08T03:38:57.423Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:38:57.424Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:38:57.528Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:38:57.632Z] [LOG] 📅 Weekend absence check for employee 0143c977-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:57.633Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:38:57.633Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:38:57.634Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:38:57.634Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:38:57.635Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:38:57.635Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:38:57.635Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:38:57.636Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:57.636Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:38:57.636Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:57.637Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:38:57.637Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:57.637Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:38:57.638Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:57.638Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:38:57.639Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:57.639Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:38:57.640Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:57.641Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:38:57.642Z] [LOG]    Fixed amount: 0
[2025-10-08T03:38:57.644Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:38:57.644Z] [LOG] Regular deductions for Safna Nawas null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:38:57.645Z] [LOG] Combined deductions for Safna Nawas null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:38:57.762Z] [LOG] Creating components for record 819d9a8a-2d0e-4011-b4f0-31cb7b16966a: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:38:57.763Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:38:57.865Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:38:57.968Z] [LOG] Created payroll_record_component: 05c84f1a-3097-4af3-882c-d68cc07c7430 for Working Hours Shortfall
[2025-10-08T03:38:58.276Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:58.277Z] [ERROR] ❌ Error updating financial balances for employee 0143c977-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:38:58.279Z] [LOG] ✅ Safna Nawas null: Calculation completed successfully
[2025-10-08T03:38:58.279Z] [LOG] 📊 Progress: 22/34 (64.7%)
[2025-10-08T03:38:58.280Z] [LOG] 
🧮 Processing: G.M Supathala Sadaru Madhushan null (EMP000042)
[2025-10-08T03:38:58.280Z] [LOG] 📋 Record ID: 83d9b666-3878-496a-a31c-fc5292d988e1
[2025-10-08T03:38:58.697Z] [LOG] 🔍 Component filtering for employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-08T03:38:58.698Z] [LOG]    Total components: 7
[2025-10-08T03:38:58.698Z] [LOG]    Applicable components: 7
[2025-10-08T03:38:58.698Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-08T03:38:59.343Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:38:59.444Z] [LOG] 🔍 Fetched 4 attendance records for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-08T03:38:59.545Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:38:59.749Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:00.060Z] [LOG] Employee 0144315c-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:00.060Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:00.060Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:00.061Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:00.061Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:00.061Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:00.062Z] [LOG] ================================================================================
[2025-10-08T03:39:00.062Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:00.062Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:00.062Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:00.062Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:00.063Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:00.063Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:00.063Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:00.063Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:00.063Z] [LOG] ================================================================================
[2025-10-08T03:39:00.063Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:00.064Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:00.064Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:00.064Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:00.064Z] [LOG] ================================================================================
[2025-10-08T03:39:00.166Z] [LOG] 🔄 Processing financial records for employee 0144315c-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:00.166Z] [LOG] 🔄 Processing financial records for employee 0144315c-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:00.271Z] [LOG] 📊 Found 0 active loans for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:00.373Z] [LOG] 📊 Found 0 active advances for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:00.478Z] [LOG] 📊 Found 0 approved bonuses for employee 0144315c-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:00.479Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:00.480Z] [LOG] 💰 GROSS CALCULATION for G.M Supathala Sadaru Madhushan null:
[2025-10-08T03:39:00.481Z] [LOG]    Base Salary: 50000
[2025-10-08T03:39:00.481Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:00.585Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:00.696Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:01.302Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:01.302Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:01.418Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:01.524Z] [LOG] Employee 0144315c-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:01.525Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:01.525Z] [LOG] ============================================================
[2025-10-08T03:39:01.526Z] [LOG] 👤 Employee ID: 0144315c-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:01.526Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:39:01.527Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:01.527Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:01.528Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:01.528Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:01.528Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:39:01.530Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:39:01.530Z] [LOG] 
[2025-10-08T03:39:01.530Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:01.531Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:01.531Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:01.531Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:01.532Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:39:01.533Z] [LOG] ============================================================
[2025-10-08T03:39:01.744Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:01.744Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:01.865Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:01.977Z] [LOG] 📅 Weekend absence check for employee 0144315c-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:01.978Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:01.978Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:01.979Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:01.979Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:01.980Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:39:01.980Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:01.980Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:01.981Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:01.981Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:01.981Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:01.982Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:01.982Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:01.982Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:01.983Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:01.983Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:01.984Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:01.986Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:01.986Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:01.987Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:01.988Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:01.993Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:01.995Z] [LOG] Regular deductions for G.M Supathala Sadaru Madhushan null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:01.995Z] [LOG] Combined deductions for G.M Supathala Sadaru Madhushan null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:39:02.109Z] [LOG] Creating components for record 83d9b666-3878-496a-a31c-fc5292d988e1: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:02.110Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:39:02.224Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:02.336Z] [LOG] Created payroll_record_component: 4b01b624-590e-4b04-93ad-de19b24dd6c6 for Working Hours Shortfall
[2025-10-08T03:39:02.643Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:02.644Z] [ERROR] ❌ Error updating financial balances for employee 0144315c-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:02.645Z] [LOG] ✅ G.M Supathala Sadaru Madhushan null: Calculation completed successfully
[2025-10-08T03:39:02.646Z] [LOG] 📊 Progress: 23/34 (67.6%)
[2025-10-08T03:39:02.647Z] [LOG] 
🧮 Processing: Rasanga null (EMP000028)
[2025-10-08T03:39:02.647Z] [LOG] 📋 Record ID: 88462403-6853-42f6-a1f5-bc42cd6ad216
[2025-10-08T03:39:03.064Z] [LOG] 🔍 Component filtering for employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:03.064Z] [LOG]    Total components: 7
[2025-10-08T03:39:03.064Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:03.065Z] [LOG]    Employee dept: undefined, designation: Sales Executive
[2025-10-08T03:39:03.683Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:03.785Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:03.888Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:04.115Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:04.439Z] [LOG] Employee 0143eaec-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:04.439Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:04.441Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:04.441Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:04.443Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:04.444Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:04.445Z] [LOG] ================================================================================
[2025-10-08T03:39:04.446Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:04.446Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:04.447Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:04.448Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:04.448Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:04.449Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:04.449Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:04.450Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:04.450Z] [LOG] ================================================================================
[2025-10-08T03:39:04.450Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:04.450Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:04.451Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:04.451Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:04.452Z] [LOG] ================================================================================
[2025-10-08T03:39:04.554Z] [LOG] 🔄 Processing financial records for employee 0143eaec-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:04.555Z] [LOG] 🔄 Processing financial records for employee 0143eaec-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:04.660Z] [LOG] 📊 Found 0 active loans for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:04.766Z] [LOG] 📊 Found 0 active advances for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:04.875Z] [LOG] 📊 Found 0 approved bonuses for employee 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:04.877Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:04.877Z] [LOG] 💰 GROSS CALCULATION for Rasanga null:
[2025-10-08T03:39:04.878Z] [LOG]    Base Salary: 50000
[2025-10-08T03:39:04.878Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:04.980Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:05.083Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:05.611Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:05.611Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:05.713Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:05.816Z] [LOG] Employee 0143eaec-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:05.816Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:05.817Z] [LOG] ============================================================
[2025-10-08T03:39:05.817Z] [LOG] 👤 Employee ID: 0143eaec-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:05.817Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:39:05.817Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:05.818Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:05.818Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:05.818Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:05.819Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:39:05.819Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:39:05.819Z] [LOG] 
[2025-10-08T03:39:05.819Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:05.820Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:05.820Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:05.820Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:05.820Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:39:05.821Z] [LOG] ============================================================
[2025-10-08T03:39:06.027Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:06.027Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:06.136Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:06.239Z] [LOG] 📅 Weekend absence check for employee 0143eaec-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:06.239Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:06.240Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:06.241Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:06.242Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:06.242Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:39:06.242Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:06.243Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:06.243Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:06.243Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:06.244Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:06.244Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:06.245Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:06.246Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:06.246Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:06.247Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:06.247Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:06.248Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:06.248Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:06.249Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:06.250Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:06.253Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:06.254Z] [LOG] Regular deductions for Rasanga null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:06.254Z] [LOG] Combined deductions for Rasanga null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:39:06.366Z] [LOG] Creating components for record 88462403-6853-42f6-a1f5-bc42cd6ad216: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:06.366Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:39:06.471Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:06.596Z] [LOG] Created payroll_record_component: 1f05bafe-696d-424a-a093-12cfe07d78b9 for Working Hours Shortfall
[2025-10-08T03:39:06.917Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:06.918Z] [ERROR] ❌ Error updating financial balances for employee 0143eaec-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:06.919Z] [LOG] ✅ Rasanga null: Calculation completed successfully
[2025-10-08T03:39:06.920Z] [LOG] 📊 Progress: 24/34 (70.6%)
[2025-10-08T03:39:06.920Z] [LOG] 
🧮 Processing: Kaushal Thambi (EMP465256103)
[2025-10-08T03:39:06.920Z] [LOG] 📋 Record ID: 95559e94-fd85-4ca9-bee0-787d1954a5b4
[2025-10-08T03:39:07.320Z] [LOG] 🔍 Component filtering for employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-08T03:39:07.320Z] [LOG]    Total components: 7
[2025-10-08T03:39:07.321Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:07.321Z] [LOG]    Employee dept: undefined, designation: Designer
[2025-10-08T03:39:07.957Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:08.059Z] [LOG] 🔍 Fetched 4 attendance records for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-08T03:39:08.162Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:08.372Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:08.683Z] [LOG] Employee 9e8125c4-ce58-411a-b617-9f75d481c613 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:08.684Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:08.684Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:08.684Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:08.685Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-08T03:39:08.685Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:08.685Z] [LOG] ================================================================================
[2025-10-08T03:39:08.685Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:08.685Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:08.686Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:08.686Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:08.686Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:08.686Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:08.687Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:08.687Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:08.687Z] [LOG] ================================================================================
[2025-10-08T03:39:08.687Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:08.687Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:08.687Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:08.687Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:08.688Z] [LOG] ================================================================================
[2025-10-08T03:39:08.789Z] [LOG] 🔄 Processing financial records for employee 9e8125c4-ce58-411a-b617-9f75d481c613...
[2025-10-08T03:39:08.790Z] [LOG] 🔄 Processing financial records for employee 9e8125c4-ce58-411a-b617-9f75d481c613 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:08.892Z] [LOG] 📊 Found 0 active loans for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-08T03:39:08.995Z] [LOG] 📊 Found 0 active advances for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-08T03:39:09.096Z] [LOG] 📊 Found 0 approved bonuses for employee 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-08T03:39:09.096Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:09.097Z] [LOG] 💰 GROSS CALCULATION for Kaushal Thambi:
[2025-10-08T03:39:09.097Z] [LOG]    Base Salary: 50000
[2025-10-08T03:39:09.097Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:09.199Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:09.310Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:09.866Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:09.866Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:09.984Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:10.095Z] [LOG] Employee 9e8125c4-ce58-411a-b617-9f75d481c613 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:10.095Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:10.095Z] [LOG] ============================================================
[2025-10-08T03:39:10.096Z] [LOG] 👤 Employee ID: 9e8125c4-ce58-411a-b617-9f75d481c613
[2025-10-08T03:39:10.096Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:39:10.096Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:10.096Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:10.096Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:10.096Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:10.096Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:39:10.096Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:39:10.097Z] [LOG] 
[2025-10-08T03:39:10.097Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:10.097Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:10.097Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:10.097Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:10.097Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:39:10.097Z] [LOG] ============================================================
[2025-10-08T03:39:10.295Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:10.296Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:10.396Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:10.497Z] [LOG] 📅 Weekend absence check for employee 9e8125c4-ce58-411a-b617-9f75d481c613:
[2025-10-08T03:39:10.497Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:10.498Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:10.498Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:10.498Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:10.498Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:39:10.499Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:10.499Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:10.499Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:10.500Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:10.500Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:10.500Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:10.501Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:10.501Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:10.501Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:10.501Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:10.502Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:10.502Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:10.502Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:10.503Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:10.503Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:10.503Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:10.504Z] [LOG] Regular deductions for Kaushal Thambi: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:10.504Z] [LOG] Combined deductions for Kaushal Thambi: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:39:10.608Z] [LOG] Creating components for record 95559e94-fd85-4ca9-bee0-787d1954a5b4: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:10.609Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:39:10.711Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:10.812Z] [LOG] Created payroll_record_component: 1417c760-ebea-4fe7-ab00-ed69191974ca for Working Hours Shortfall
[2025-10-08T03:39:11.142Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:11.143Z] [ERROR] ❌ Error updating financial balances for employee 9e8125c4-ce58-411a-b617-9f75d481c613: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:11.144Z] [LOG] ✅ Kaushal Thambi: Calculation completed successfully
[2025-10-08T03:39:11.144Z] [LOG] 📊 Progress: 25/34 (73.5%)
[2025-10-08T03:39:11.145Z] [LOG] 
🧮 Processing: Sujevan Selvaratnam null (EMP000026)
[2025-10-08T03:39:11.145Z] [LOG] 📋 Record ID: 97e22495-ee80-4b6c-bc5a-26b704b4ae7e
[2025-10-08T03:39:11.559Z] [LOG] 🔍 Component filtering for employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:11.559Z] [LOG]    Total components: 7
[2025-10-08T03:39:11.559Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:11.560Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-08T03:39:12.203Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:12.307Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:12.410Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:12.623Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:12.938Z] [LOG] Employee 0143e6c3-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:12.939Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:12.939Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:12.940Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:12.942Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:12.942Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:12.943Z] [LOG] ================================================================================
[2025-10-08T03:39:12.943Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:12.943Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:12.944Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:12.944Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:12.944Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:12.944Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:12.945Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:12.945Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:12.946Z] [LOG] ================================================================================
[2025-10-08T03:39:12.946Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:12.946Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:12.946Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:12.946Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:12.946Z] [LOG] ================================================================================
[2025-10-08T03:39:13.052Z] [LOG] 🔄 Processing financial records for employee 0143e6c3-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:13.052Z] [LOG] 🔄 Processing financial records for employee 0143e6c3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:13.155Z] [LOG] 📊 Found 0 active loans for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:13.270Z] [LOG] 📊 Found 0 active advances for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:13.372Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:13.372Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:13.373Z] [LOG] 💰 GROSS CALCULATION for Sujevan Selvaratnam null:
[2025-10-08T03:39:13.373Z] [LOG]    Base Salary: 1
[2025-10-08T03:39:13.374Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:13.476Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:13.578Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:14.104Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:14.104Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:14.215Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:14.512Z] [LOG] Employee 0143e6c3-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:14.768Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:14.773Z] [LOG] ============================================================
[2025-10-08T03:39:14.773Z] [LOG] 👤 Employee ID: 0143e6c3-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:14.906Z] [LOG] 💰 Base Salary: 1
[2025-10-08T03:39:15.218Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:15.223Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:15.223Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:15.223Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:15.228Z] [LOG] 💵 Per-Day Salary: 0.04 (1 ÷ 25)
[2025-10-08T03:39:15.228Z] [LOG] ⏱️  Hourly Rate: 0.00 (0.04 ÷ 8.5)
[2025-10-08T03:39:15.228Z] [LOG] 
[2025-10-08T03:39:15.229Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:15.229Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:15.229Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:15.230Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:15.231Z] [LOG]    💸 Shortfall Deduction: 8.5h × 0.00 = 0.04
[2025-10-08T03:39:15.231Z] [LOG] ============================================================
[2025-10-08T03:39:15.455Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:15.456Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:15.568Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:15.691Z] [LOG] 📅 Weekend absence check for employee 0143e6c3-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:15.692Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:15.692Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:15.693Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:15.693Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:15.693Z] [LOG]    Gross Salary: 1
[2025-10-08T03:39:15.694Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:15.694Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:15.695Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:15.695Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:15.695Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:15.696Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:15.696Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:15.696Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:15.697Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:15.697Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:15.697Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:15.697Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:15.698Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:15.698Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:15.698Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:15.698Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:15.699Z] [LOG] Regular deductions for Sujevan Selvaratnam null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:15.699Z] [LOG] Combined deductions for Sujevan Selvaratnam null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 0.04,
      "details": "8.5 hours × 0.00"
    }
  ],
  "total": 0.04
}
[2025-10-08T03:39:15.831Z] [LOG] Creating components for record 97e22495-ee80-4b6c-bc5a-26b704b4ae7e: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:15.832Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 0.04
}
[2025-10-08T03:39:15.937Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:16.056Z] [LOG] Created payroll_record_component: 5a374f58-682e-421f-865a-a3e023080fc1 for Working Hours Shortfall
[2025-10-08T03:39:16.365Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:16.366Z] [ERROR] ❌ Error updating financial balances for employee 0143e6c3-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:16.367Z] [LOG] ✅ Sujevan Selvaratnam null: Calculation completed successfully
[2025-10-08T03:39:16.368Z] [LOG] 📊 Progress: 26/34 (76.5%)
[2025-10-08T03:39:16.368Z] [LOG] 
🧮 Processing: Chemil null (EMP000040)
[2025-10-08T03:39:16.368Z] [LOG] 📋 Record ID: b38610b4-7a31-4fa8-a3fd-6f3cc9f4ee5a
[2025-10-08T03:39:17.188Z] [LOG] 🔍 Component filtering for employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:17.188Z] [LOG]    Total components: 7
[2025-10-08T03:39:17.188Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:17.188Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-08T03:39:17.840Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:17.942Z] [LOG] 🔍 Fetched 4 attendance records for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:18.050Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:18.269Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:18.579Z] [LOG] Employee 01442599-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:18.579Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:18.579Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:18.580Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:18.581Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:18.581Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:18.582Z] [LOG] ================================================================================
[2025-10-08T03:39:18.582Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:18.582Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:18.582Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:18.583Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:18.583Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:18.583Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:18.584Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:18.584Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:18.584Z] [LOG] ================================================================================
[2025-10-08T03:39:18.584Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:18.585Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:18.585Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:18.585Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:18.585Z] [LOG] ================================================================================
[2025-10-08T03:39:18.687Z] [LOG] 🔄 Processing financial records for employee 01442599-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:18.687Z] [LOG] 🔄 Processing financial records for employee 01442599-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:18.791Z] [LOG] 📊 Found 0 active loans for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:18.894Z] [LOG] 📊 Found 0 active advances for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:19.003Z] [LOG] 📊 Found 0 approved bonuses for employee 01442599-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:19.004Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:19.005Z] [LOG] 💰 GROSS CALCULATION for Chemil null:
[2025-10-08T03:39:19.005Z] [LOG]    Base Salary: 250000
[2025-10-08T03:39:19.005Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:19.109Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:19.211Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:19.720Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:19.721Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:19.822Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:19.936Z] [LOG] Employee 01442599-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:19.936Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:19.936Z] [LOG] ============================================================
[2025-10-08T03:39:19.937Z] [LOG] 👤 Employee ID: 01442599-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:19.937Z] [LOG] 💰 Base Salary: 250,000
[2025-10-08T03:39:19.937Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:19.937Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:19.937Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:19.937Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:19.938Z] [LOG] 💵 Per-Day Salary: 10000.00 (250000 ÷ 25)
[2025-10-08T03:39:19.938Z] [LOG] ⏱️  Hourly Rate: 1176.47 (10000.00 ÷ 8.5)
[2025-10-08T03:39:19.938Z] [LOG] 
[2025-10-08T03:39:19.938Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:19.938Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:19.938Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:19.938Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:19.939Z] [LOG]    💸 Shortfall Deduction: 8.5h × 1176.47 = 10000.00
[2025-10-08T03:39:19.939Z] [LOG] ============================================================
[2025-10-08T03:39:20.141Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:20.141Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:20.243Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:20.346Z] [LOG] 📅 Weekend absence check for employee 01442599-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:20.346Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:20.347Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:20.347Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:20.347Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:20.347Z] [LOG]    Gross Salary: 250000
[2025-10-08T03:39:20.348Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:20.348Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:20.348Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:20.348Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:20.348Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:20.348Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:20.348Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:20.349Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:20.349Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:20.349Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:20.349Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:20.349Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:20.349Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:20.349Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:20.350Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:20.350Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:20.350Z] [LOG] Regular deductions for Chemil null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:20.350Z] [LOG] Combined deductions for Chemil null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 10000,
      "details": "8.5 hours × 1176.47"
    }
  ],
  "total": 10000
}
[2025-10-08T03:39:20.459Z] [LOG] Creating components for record b38610b4-7a31-4fa8-a3fd-6f3cc9f4ee5a: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 1
}
[2025-10-08T03:39:20.460Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 10000
}
[2025-10-08T03:39:20.561Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:20.665Z] [LOG] Created payroll_record_component: 0f0977b3-9e24-48b6-ad73-1aae0db189d6 for Working Hours Shortfall
[2025-10-08T03:39:20.665Z] [LOG] Processing component: {
  "name": "Income Tax",
  "type": "tax",
  "amount": 12000
}
[2025-10-08T03:39:20.895Z] [ERROR] Failed to create component INCOME_TAX: Data truncated for column 'component_type' at row 1
[2025-10-08T03:39:20.895Z] [ERROR] Component data: {
  "code": "INCOME_TAX",
  "name": "Income Tax",
  "type": "tax",
  "category": "tax",
  "amount": 12000
}
[2025-10-08T03:39:20.896Z] [ERROR] Full error: {
  "message": "Data truncated for column 'component_type' at row 1",
  "code": "WARN_DATA_TRUNCATED",
  "errno": 1265,
  "sql": "\n                        INSERT INTO payroll_components (\n                            id, client_id, component_name, component_type, category, \n                            calculation_type, is_taxable, is_mandatory\n                        ) VALUES (?, ?, ?, ?, ?, 'fixed', ?, ?)\n                    ",
  "sqlState": "01000",
  "sqlMessage": "Data truncated for column 'component_type' at row 1"
}
[2025-10-08T03:39:20.897Z] [LOG] Attempting alternative insertion for component: Income Tax
[2025-10-08T03:39:21.628Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:21.629Z] [ERROR] ❌ Error updating financial balances for employee 01442599-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:21.630Z] [LOG] ✅ Chemil null: Calculation completed successfully
[2025-10-08T03:39:21.630Z] [LOG] 📊 Progress: 27/34 (79.4%)
[2025-10-08T03:39:21.630Z] [LOG] 
🧮 Processing: Saruban null (EMP000007)
[2025-10-08T03:39:21.631Z] [LOG] 📋 Record ID: c360d41f-c8ac-40d1-82d2-c259569614e0
[2025-10-08T03:39:22.050Z] [LOG] 🔍 Component filtering for employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:22.050Z] [LOG]    Total components: 7
[2025-10-08T03:39:22.050Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:22.051Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-08T03:39:23.483Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:23.612Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:23.718Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:23.923Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:24.229Z] [LOG] Employee 0143a6e3-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:24.230Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:24.230Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:24.230Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:24.232Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:24.232Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:24.232Z] [LOG] ================================================================================
[2025-10-08T03:39:24.233Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:24.233Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:24.233Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:24.234Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:24.234Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:24.234Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:24.234Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:24.235Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:24.235Z] [LOG] ================================================================================
[2025-10-08T03:39:24.235Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:24.236Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:24.236Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:24.236Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:24.238Z] [LOG] ================================================================================
[2025-10-08T03:39:24.339Z] [LOG] 🔄 Processing financial records for employee 0143a6e3-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:24.339Z] [LOG] 🔄 Processing financial records for employee 0143a6e3-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:24.442Z] [LOG] 📊 Found 0 active loans for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:24.547Z] [LOG] 📊 Found 0 active advances for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:24.649Z] [LOG] 📊 Found 0 approved bonuses for employee 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:24.650Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:24.650Z] [LOG] 💰 GROSS CALCULATION for Saruban null:
[2025-10-08T03:39:24.650Z] [LOG]    Base Salary: 0
[2025-10-08T03:39:24.651Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:24.754Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:24.864Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:25.436Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:25.436Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:25.537Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:25.649Z] [LOG] Employee 0143a6e3-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:25.649Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:25.649Z] [LOG] ============================================================
[2025-10-08T03:39:25.649Z] [LOG] 👤 Employee ID: 0143a6e3-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:25.650Z] [LOG] 💰 Base Salary: 0
[2025-10-08T03:39:25.650Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:25.650Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:25.650Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:25.650Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:25.650Z] [LOG] 💵 Per-Day Salary: 0.00 (0 ÷ 25)
[2025-10-08T03:39:25.651Z] [LOG] ⏱️  Hourly Rate: 0.00 (0.00 ÷ 8.5)
[2025-10-08T03:39:25.651Z] [LOG] 
[2025-10-08T03:39:25.651Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:25.651Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:25.651Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:25.651Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:25.651Z] [LOG]    💸 Shortfall Deduction: 8.5h × 0.00 = 0.00
[2025-10-08T03:39:25.652Z] [LOG] ============================================================
[2025-10-08T03:39:25.855Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:25.855Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:25.964Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:26.070Z] [LOG] 📅 Weekend absence check for employee 0143a6e3-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:26.071Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:26.071Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:26.071Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:26.071Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:26.072Z] [LOG]    Gross Salary: 0
[2025-10-08T03:39:26.072Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:26.072Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:26.073Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:26.073Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:26.073Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:26.073Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:26.074Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:26.075Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:26.075Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:26.076Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:26.076Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:26.076Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:26.077Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:26.077Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:26.077Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:26.077Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:26.077Z] [LOG] Regular deductions for Saruban null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:26.078Z] [LOG] Combined deductions for Saruban null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 0,
      "details": "8.5 hours × 0.00"
    }
  ],
  "total": 0
}
[2025-10-08T03:39:26.180Z] [LOG] Creating components for record c360d41f-c8ac-40d1-82d2-c259569614e0: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:26.181Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 0
}
[2025-10-08T03:39:26.296Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:26.398Z] [LOG] Created payroll_record_component: f92fe84c-cddb-47e0-9c16-c893e5cba10b for Working Hours Shortfall
[2025-10-08T03:39:26.804Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:26.805Z] [ERROR] ❌ Error updating financial balances for employee 0143a6e3-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:26.806Z] [LOG] ✅ Saruban null: Calculation completed successfully
[2025-10-08T03:39:26.807Z] [LOG] 📊 Progress: 28/34 (82.4%)
[2025-10-08T03:39:26.807Z] [LOG] 
🧮 Processing: Saru null (EMP000022)
[2025-10-08T03:39:26.808Z] [LOG] 📋 Record ID: ca037cec-84cf-4a23-a4f0-9c6fcd528b73
[2025-10-08T03:39:27.234Z] [LOG] 🔍 Component filtering for employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:27.234Z] [LOG]    Total components: 7
[2025-10-08T03:39:27.234Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:27.235Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-08T03:39:28.259Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:28.363Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:28.519Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:28.738Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:29.043Z] [LOG] Employee 0143cc7e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:29.043Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:29.044Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:29.044Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:29.045Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:29.045Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:29.046Z] [LOG] ================================================================================
[2025-10-08T03:39:29.046Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:29.046Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:29.047Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:29.047Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:29.047Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:29.047Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:29.048Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:29.048Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:29.048Z] [LOG] ================================================================================
[2025-10-08T03:39:29.049Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:29.049Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:29.049Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:29.049Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:29.050Z] [LOG] ================================================================================
[2025-10-08T03:39:29.151Z] [LOG] 🔄 Processing financial records for employee 0143cc7e-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:29.151Z] [LOG] 🔄 Processing financial records for employee 0143cc7e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:29.251Z] [LOG] 📊 Found 0 active loans for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:29.354Z] [LOG] 📊 Found 0 active advances for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:29.456Z] [LOG] 📊 Found 0 approved bonuses for employee 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:29.457Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:29.458Z] [LOG] 💰 GROSS CALCULATION for Saru null:
[2025-10-08T03:39:29.459Z] [LOG]    Base Salary: 50000
[2025-10-08T03:39:29.459Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:29.562Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:29.664Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:30.206Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:30.207Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:30.363Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:30.466Z] [LOG] Employee 0143cc7e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:30.466Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:30.467Z] [LOG] ============================================================
[2025-10-08T03:39:30.467Z] [LOG] 👤 Employee ID: 0143cc7e-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:30.467Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:39:30.467Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:30.467Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:30.468Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:30.468Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:30.468Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:39:30.468Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:39:30.468Z] [LOG] 
[2025-10-08T03:39:30.469Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:30.469Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:30.469Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:30.469Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:30.469Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:39:30.469Z] [LOG] ============================================================
[2025-10-08T03:39:30.688Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:30.688Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:30.792Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:30.894Z] [LOG] 📅 Weekend absence check for employee 0143cc7e-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:30.894Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:30.894Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:30.894Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:30.895Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:30.895Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:39:30.895Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:30.895Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:30.895Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:30.895Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:30.896Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:30.896Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:30.896Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:30.896Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:30.896Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:30.896Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:30.896Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:30.897Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:30.897Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:30.897Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:30.897Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:30.897Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:30.897Z] [LOG] Regular deductions for Saru null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:30.898Z] [LOG] Combined deductions for Saru null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:39:31.001Z] [LOG] Creating components for record ca037cec-84cf-4a23-a4f0-9c6fcd528b73: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:31.002Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:39:31.109Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:31.211Z] [LOG] Created payroll_record_component: 524140f8-ced5-4ffe-8873-bbe2ad6cf69c for Working Hours Shortfall
[2025-10-08T03:39:31.520Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:31.521Z] [ERROR] ❌ Error updating financial balances for employee 0143cc7e-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:31.522Z] [LOG] ✅ Saru null: Calculation completed successfully
[2025-10-08T03:39:31.522Z] [LOG] 📊 Progress: 29/34 (85.3%)
[2025-10-08T03:39:31.522Z] [LOG] 
🧮 Processing: Jessie null (EMP000013)
[2025-10-08T03:39:31.523Z] [LOG] 📋 Record ID: def0b297-fdfe-4886-a6e7-f88d24c11413
[2025-10-08T03:39:31.932Z] [LOG] 🔍 Component filtering for employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:31.933Z] [LOG]    Total components: 7
[2025-10-08T03:39:31.933Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:31.934Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-08T03:39:32.562Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:32.683Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:32.786Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:32.992Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:33.297Z] [LOG] Employee 0143ae6e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:33.297Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:33.297Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:33.298Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:33.299Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:33.299Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:33.299Z] [LOG] ================================================================================
[2025-10-08T03:39:33.300Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:33.300Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:33.301Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:33.301Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:33.302Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:33.302Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:33.302Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:33.302Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:33.303Z] [LOG] ================================================================================
[2025-10-08T03:39:33.303Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:33.304Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:33.304Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:33.304Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:33.304Z] [LOG] ================================================================================
[2025-10-08T03:39:33.404Z] [LOG] 🔄 Processing financial records for employee 0143ae6e-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:33.405Z] [LOG] 🔄 Processing financial records for employee 0143ae6e-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:33.509Z] [LOG] 📊 Found 1 active loans for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:33.615Z] [LOG] 📊 Found 1 active advances for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:33.720Z] [LOG] 📊 Found 0 approved bonuses for employee 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:33.722Z] [LOG] 💰 Loan 9b6e1dda-8dcb-4c30-9d68-604489d94453: Deducting LKR 5012.5 (Remaining: LKR 10025.01)
[2025-10-08T03:39:33.722Z] [LOG] 💸 Advance d1db4f71-1c1e-4611-a1c5-6cec09c476d8: Deducting LKR 17000 (Remaining: LKR 17000)
[2025-10-08T03:39:33.723Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 5012.5,
  "advances": 17000,
  "bonuses": 0,
  "netAdjustment": -22012.5
}
[2025-10-08T03:39:33.724Z] [LOG] 💰 GROSS CALCULATION for Jessie null:
[2025-10-08T03:39:33.724Z] [LOG]    Base Salary: 60000
[2025-10-08T03:39:33.725Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:33.854Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:33.955Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:34.488Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:34.489Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:34.591Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:34.708Z] [LOG] Employee 0143ae6e-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:34.709Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:34.709Z] [LOG] ============================================================
[2025-10-08T03:39:34.709Z] [LOG] 👤 Employee ID: 0143ae6e-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:34.709Z] [LOG] 💰 Base Salary: 60,000
[2025-10-08T03:39:34.710Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:34.710Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:34.710Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:34.710Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:34.710Z] [LOG] 💵 Per-Day Salary: 2400.00 (60000 ÷ 25)
[2025-10-08T03:39:34.711Z] [LOG] ⏱️  Hourly Rate: 282.35 (2400.00 ÷ 8.5)
[2025-10-08T03:39:34.711Z] [LOG] 
[2025-10-08T03:39:34.711Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:34.711Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:34.711Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:34.711Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:34.712Z] [LOG]    💸 Shortfall Deduction: 8.5h × 282.35 = 2400.00
[2025-10-08T03:39:34.712Z] [LOG] ============================================================
[2025-10-08T03:39:34.962Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:34.963Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:35.075Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:35.179Z] [LOG] 📅 Weekend absence check for employee 0143ae6e-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:35.180Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:35.180Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:35.180Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:35.181Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:35.181Z] [LOG]    Gross Salary: 60000
[2025-10-08T03:39:35.181Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:35.182Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:35.182Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:35.182Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:35.182Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:35.183Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:35.183Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:35.183Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:35.184Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:35.184Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:35.184Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:35.184Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:35.185Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:35.185Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:35.186Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:35.186Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:35.187Z] [LOG] Regular deductions for Jessie null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:35.187Z] [LOG] Combined deductions for Jessie null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2400,
      "details": "8.5 hours × 282.35"
    },
    {
      "code": "LOAN_DED",
      "name": "Loan Deductions",
      "type": "deduction",
      "category": "loan",
      "amount": 5012.5,
      "details": "1 loan(s)"
    },
    {
      "code": "ADVANCE_DED",
      "name": "Advance Deductions",
      "type": "deduction",
      "category": "other",
      "amount": 17000,
      "details": "1 advance(s)"
    }
  ],
  "total": 24412.5
}
[2025-10-08T03:39:35.295Z] [LOG] Creating components for record def0b297-fdfe-4886-a6e7-f88d24c11413: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 3,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:35.295Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2400
}
[2025-10-08T03:39:35.397Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:35.499Z] [LOG] Created payroll_record_component: a811eb70-8a13-4219-9b0f-44b397d73ad1 for Working Hours Shortfall
[2025-10-08T03:39:35.500Z] [LOG] Processing component: {
  "name": "Loan Deductions",
  "type": "deduction",
  "amount": 5012.5
}
[2025-10-08T03:39:35.600Z] [LOG] Using existing component ID: 64a0d7d8-8fdb-4968-a7a2-057590b481c7
[2025-10-08T03:39:35.701Z] [LOG] Created payroll_record_component: 8c54b733-cb52-4e3a-89ee-198e43cf869a for Loan Deductions
[2025-10-08T03:39:35.702Z] [LOG] Processing component: {
  "name": "Advance Deductions",
  "type": "deduction",
  "amount": 17000
}
[2025-10-08T03:39:35.805Z] [LOG] Using existing component ID: 212471aa-dc59-47a4-9969-235f68be2fa4
[2025-10-08T03:39:35.906Z] [LOG] Created payroll_record_component: b1bca96d-605d-419e-b873-e614ebf83c20 for Advance Deductions
[2025-10-08T03:39:36.245Z] [LOG] ✅ Updated loan 9b6e1dda-8dcb-4c30-9d68-604489d94453: Remaining LKR 5012.51, Status: active
[2025-10-08T03:39:36.477Z] [LOG] ✅ Updated advance d1db4f71-1c1e-4611-a1c5-6cec09c476d8: Remaining LKR 0, Status: completed
[2025-10-08T03:39:36.698Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:36.699Z] [ERROR] ❌ Error updating financial balances for employee 0143ae6e-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:36.700Z] [LOG] ✅ Jessie null: Calculation completed successfully
[2025-10-08T03:39:36.700Z] [LOG] 📊 Progress: 30/34 (88.2%)
[2025-10-08T03:39:36.701Z] [LOG] 
🧮 Processing: Ammaar Ilham (EMP000023)
[2025-10-08T03:39:36.701Z] [LOG] 📋 Record ID: e1be1351-f702-4ab5-99ed-9bd03711072b
[2025-10-08T03:39:37.129Z] [LOG] 🔍 Component filtering for employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:37.129Z] [LOG]    Total components: 7
[2025-10-08T03:39:37.130Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:37.130Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-08T03:39:37.749Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:37.850Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:37.951Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:38.161Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:38.469Z] [LOG] Employee 0143de00-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:38.470Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:38.470Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:38.471Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:38.472Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:38.472Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:38.472Z] [LOG] ================================================================================
[2025-10-08T03:39:38.473Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:38.473Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:38.473Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:38.474Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:38.475Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:38.475Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:38.475Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:38.476Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:38.476Z] [LOG] ================================================================================
[2025-10-08T03:39:38.476Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:38.477Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:38.477Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:38.477Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:38.478Z] [LOG] ================================================================================
[2025-10-08T03:39:38.578Z] [LOG] 🔄 Processing financial records for employee 0143de00-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:38.578Z] [LOG] 🔄 Processing financial records for employee 0143de00-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:38.683Z] [LOG] 📊 Found 0 active loans for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:38.786Z] [LOG] 📊 Found 0 active advances for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:38.888Z] [LOG] 📊 Found 0 approved bonuses for employee 0143de00-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:38.889Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:38.889Z] [LOG] 💰 GROSS CALCULATION for Ammaar Ilham:
[2025-10-08T03:39:38.890Z] [LOG]    Base Salary: 70000
[2025-10-08T03:39:38.890Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:38.996Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:39.097Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:39.610Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:39.611Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:39.730Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:39.833Z] [LOG] Employee 0143de00-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:39.834Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:39.834Z] [LOG] ============================================================
[2025-10-08T03:39:39.835Z] [LOG] 👤 Employee ID: 0143de00-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:39.835Z] [LOG] 💰 Base Salary: 70,000
[2025-10-08T03:39:39.835Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:39.836Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:39.836Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:39.837Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:39.837Z] [LOG] 💵 Per-Day Salary: 2800.00 (70000 ÷ 25)
[2025-10-08T03:39:39.837Z] [LOG] ⏱️  Hourly Rate: 329.41 (2800.00 ÷ 8.5)
[2025-10-08T03:39:39.838Z] [LOG] 
[2025-10-08T03:39:39.839Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:39.839Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:39.840Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:39.840Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:39.842Z] [LOG]    💸 Shortfall Deduction: 8.5h × 329.41 = 2800.00
[2025-10-08T03:39:39.842Z] [LOG] ============================================================
[2025-10-08T03:39:40.079Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:40.080Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:40.186Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:40.302Z] [LOG] 📅 Weekend absence check for employee 0143de00-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:40.303Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:40.303Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:40.303Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:40.304Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:40.304Z] [LOG]    Gross Salary: 70000
[2025-10-08T03:39:40.304Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:40.305Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:40.305Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:40.306Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:40.306Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:40.307Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:40.307Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:40.308Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:40.309Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:40.309Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:40.310Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:40.310Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:40.311Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:40.311Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:40.312Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:40.312Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:40.312Z] [LOG] Regular deductions for Ammaar Ilham: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:40.315Z] [LOG] Combined deductions for Ammaar Ilham: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2800,
      "details": "8.5 hours × 329.41"
    }
  ],
  "total": 2800
}
[2025-10-08T03:39:40.418Z] [LOG] Creating components for record e1be1351-f702-4ab5-99ed-9bd03711072b: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:40.419Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2800
}
[2025-10-08T03:39:40.519Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:40.623Z] [LOG] Created payroll_record_component: e8f66741-972b-475e-a623-c27bb421e2dc for Working Hours Shortfall
[2025-10-08T03:39:40.930Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:40.931Z] [ERROR] ❌ Error updating financial balances for employee 0143de00-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:40.932Z] [LOG] ✅ Ammaar Ilham: Calculation completed successfully
[2025-10-08T03:39:40.933Z] [LOG] 📊 Progress: 31/34 (91.2%)
[2025-10-08T03:39:40.933Z] [LOG] 
🧮 Processing: P.D.P Dilini Madushani null (EMP000043)
[2025-10-08T03:39:40.933Z] [LOG] 📋 Record ID: e432fd23-51e9-49dd-95a8-87409e20728f
[2025-10-08T03:39:41.346Z] [LOG] 🔍 Component filtering for employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:41.347Z] [LOG]    Total components: 7
[2025-10-08T03:39:41.347Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:41.347Z] [LOG]    Employee dept: undefined, designation: null
[2025-10-08T03:39:41.977Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:42.081Z] [LOG] 🔍 Fetched 4 attendance records for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:42.186Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:42.432Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:42.898Z] [LOG] Employee 014435dc-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:42.899Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:42.899Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:42.900Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:42.901Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:42.902Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:42.902Z] [LOG] ================================================================================
[2025-10-08T03:39:42.902Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:42.903Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:42.903Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:42.903Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:42.904Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:42.905Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:42.906Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:42.907Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:42.909Z] [LOG] ================================================================================
[2025-10-08T03:39:42.910Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:42.911Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:42.912Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:42.912Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:42.913Z] [LOG] ================================================================================
[2025-10-08T03:39:43.023Z] [LOG] 🔄 Processing financial records for employee 014435dc-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:43.023Z] [LOG] 🔄 Processing financial records for employee 014435dc-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:43.150Z] [LOG] 📊 Found 0 active loans for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:43.261Z] [LOG] 📊 Found 0 active advances for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:43.366Z] [LOG] 📊 Found 0 approved bonuses for employee 014435dc-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:43.366Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:43.367Z] [LOG] 💰 GROSS CALCULATION for P.D.P Dilini Madushani null:
[2025-10-08T03:39:43.367Z] [LOG]    Base Salary: 50000
[2025-10-08T03:39:43.367Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:43.468Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:43.572Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:44.089Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:44.090Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:44.194Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:44.296Z] [LOG] Employee 014435dc-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:44.297Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:44.297Z] [LOG] ============================================================
[2025-10-08T03:39:44.297Z] [LOG] 👤 Employee ID: 014435dc-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:44.297Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:39:44.297Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:44.297Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:44.297Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:44.297Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:44.298Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:39:44.298Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:39:44.298Z] [LOG] 
[2025-10-08T03:39:44.298Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:44.298Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:44.298Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:44.298Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:44.299Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:39:44.299Z] [LOG] ============================================================
[2025-10-08T03:39:44.510Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:44.510Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:44.613Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:44.726Z] [LOG] 📅 Weekend absence check for employee 014435dc-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:44.726Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:44.727Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:44.727Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:44.728Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:44.728Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:39:44.728Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:44.729Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:44.729Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:44.730Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:44.731Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:44.731Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:44.731Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:44.733Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:44.733Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:44.733Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:44.733Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:44.734Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:44.734Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:44.734Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:44.734Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:44.734Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:44.735Z] [LOG] Regular deductions for P.D.P Dilini Madushani null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:44.735Z] [LOG] Combined deductions for P.D.P Dilini Madushani null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:39:44.848Z] [LOG] Creating components for record e432fd23-51e9-49dd-95a8-87409e20728f: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:44.849Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:39:44.952Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:45.059Z] [LOG] Created payroll_record_component: 1a9f6ed5-2bdc-497a-9201-31edbb02f973 for Working Hours Shortfall
[2025-10-08T03:39:45.409Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:45.411Z] [ERROR] ❌ Error updating financial balances for employee 014435dc-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:45.412Z] [LOG] ✅ P.D.P Dilini Madushani null: Calculation completed successfully
[2025-10-08T03:39:45.412Z] [LOG] 📊 Progress: 32/34 (94.1%)
[2025-10-08T03:39:45.413Z] [LOG] 
🧮 Processing: Nimdiya Ranasinghe null (EMP000045)
[2025-10-08T03:39:45.413Z] [LOG] 📋 Record ID: f41f50f6-9b68-45e4-9243-7800c004ca62
[2025-10-08T03:39:45.878Z] [LOG] 🔍 Component filtering for employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:45.879Z] [LOG]    Total components: 7
[2025-10-08T03:39:45.879Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:45.879Z] [LOG]    Employee dept: undefined, designation: Web Developer
[2025-10-08T03:39:46.542Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:46.683Z] [LOG] 🔍 Fetched 4 attendance records for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:46.856Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:47.071Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:47.384Z] [LOG] Employee 01444074-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:47.384Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:47.385Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:47.385Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:47.386Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:47.386Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:47.387Z] [LOG] ================================================================================
[2025-10-08T03:39:47.387Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:47.387Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:47.388Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:47.388Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:47.388Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:47.389Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:47.389Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:47.389Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:47.390Z] [LOG] ================================================================================
[2025-10-08T03:39:47.390Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:47.391Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:47.392Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:47.392Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:47.393Z] [LOG] ================================================================================
[2025-10-08T03:39:47.495Z] [LOG] 🔄 Processing financial records for employee 01444074-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:47.496Z] [LOG] 🔄 Processing financial records for employee 01444074-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:47.598Z] [LOG] 📊 Found 0 active loans for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:47.702Z] [LOG] 📊 Found 0 active advances for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:47.802Z] [LOG] 📊 Found 0 approved bonuses for employee 01444074-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:47.803Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:47.804Z] [LOG] 💰 GROSS CALCULATION for Nimdiya Ranasinghe null:
[2025-10-08T03:39:47.804Z] [LOG]    Base Salary: 35000
[2025-10-08T03:39:47.805Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:47.929Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:48.075Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:48.777Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:48.778Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:48.883Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:49.002Z] [LOG] Employee 01444074-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:49.002Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:49.003Z] [LOG] ============================================================
[2025-10-08T03:39:49.003Z] [LOG] 👤 Employee ID: 01444074-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:49.003Z] [LOG] 💰 Base Salary: 35,000
[2025-10-08T03:39:49.004Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:49.004Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:49.004Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:49.005Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:49.005Z] [LOG] 💵 Per-Day Salary: 1400.00 (35000 ÷ 25)
[2025-10-08T03:39:49.005Z] [LOG] ⏱️  Hourly Rate: 164.71 (1400.00 ÷ 8.5)
[2025-10-08T03:39:49.005Z] [LOG] 
[2025-10-08T03:39:49.006Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:49.007Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:49.008Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:49.010Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:49.011Z] [LOG]    💸 Shortfall Deduction: 8.5h × 164.71 = 1400.00
[2025-10-08T03:39:49.011Z] [LOG] ============================================================
[2025-10-08T03:39:49.277Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:49.278Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:49.408Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:49.511Z] [LOG] 📅 Weekend absence check for employee 01444074-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:49.512Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:49.512Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:49.512Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:49.512Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:49.513Z] [LOG]    Gross Salary: 35000
[2025-10-08T03:39:49.513Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:49.513Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:49.513Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:49.514Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:49.514Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:49.514Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:49.514Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:49.515Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:49.515Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:49.515Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:49.515Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:49.516Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:49.516Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:49.516Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:49.517Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:49.517Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:49.517Z] [LOG] Regular deductions for Nimdiya Ranasinghe null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:49.518Z] [LOG] Combined deductions for Nimdiya Ranasinghe null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 1400,
      "details": "8.5 hours × 164.71"
    }
  ],
  "total": 1400
}
[2025-10-08T03:39:49.622Z] [LOG] Creating components for record f41f50f6-9b68-45e4-9243-7800c004ca62: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:49.623Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 1400
}
[2025-10-08T03:39:49.728Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:49.834Z] [LOG] Created payroll_record_component: 39011ebb-4d0d-45bb-aa2f-0d84311c35b6 for Working Hours Shortfall
[2025-10-08T03:39:50.180Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:50.181Z] [ERROR] ❌ Error updating financial balances for employee 01444074-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:50.182Z] [LOG] ✅ Nimdiya Ranasinghe null: Calculation completed successfully
[2025-10-08T03:39:50.182Z] [LOG] 📊 Progress: 33/34 (97.1%)
[2025-10-08T03:39:50.183Z] [LOG] 
🧮 Processing: Piyumi null (EMP000025)
[2025-10-08T03:39:50.183Z] [LOG] 📋 Record ID: fab10f4a-a120-46e3-b18f-c8de3b3889cd
[2025-10-08T03:39:50.700Z] [LOG] 🔍 Component filtering for employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:50.701Z] [LOG]    Total components: 7
[2025-10-08T03:39:50.701Z] [LOG]    Applicable components: 7
[2025-10-08T03:39:50.702Z] [LOG]    Employee dept: undefined, designation: Customer Executive
[2025-10-08T03:39:51.366Z] [LOG]    Using overtime_rate_multiplier from settings: 1.5x
[2025-10-08T03:39:51.479Z] [LOG] 🔍 Fetched 4 attendance records for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:51.582Z] [LOG] Error loading working hours from system settings, using defaults: SettingsHelper is not a constructor
[2025-10-08T03:39:51.799Z] [LOG] 📅 Calculating expected hours from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:52.150Z] [LOG] Employee 0143e565-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to Wed Oct 08 2025 00:00:00 GMT+0530 (India Standard Time)): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:52.153Z] [LOG] ✅ Expected hours calculation (WEEKDAYS ONLY): 4 weekday days × 8.5h = 34h
[2025-10-08T03:39:52.153Z] [LOG]    📊 Working days breakdown: Total=5, Weekdays=4, Weekend=1
[2025-10-08T03:39:52.154Z] [ERROR] Error checking overtime enabled setting: {
  "message": "Bind parameters must not contain undefined. To pass SQL NULL specify JS null"
}
[2025-10-08T03:39:52.155Z] [LOG] 
📊 DAILY WORKED HOURS BREAKDOWN for Employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:52.156Z] [LOG] ⚙️  Overtime Enabled: NO
[2025-10-08T03:39:52.156Z] [LOG] ================================================================================
[2025-10-08T03:39:52.156Z] [LOG] 📅 2025-10-02 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:52.157Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:52.159Z] [LOG] 📅 2025-10-03 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:52.159Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:52.160Z] [LOG] 📅 2025-10-04 (WEEKEND): 8.5h worked → 4.5h counted → OVERLAP 08:30-13:00 = 4.500h (attendance table)
[2025-10-08T03:39:52.160Z] [LOG]    ⏭️  Skipped weekend hours (handled separately): 4.5h
[2025-10-08T03:39:52.161Z] [LOG] 📅 2025-10-07 (WEEKDAY): 8.5h worked → 8.5h counted → OVERLAP 08:30-17:00 = 8.500h (attendance table)
[2025-10-08T03:39:52.161Z] [LOG]    ✅ Added to weekday total: 8.5h
[2025-10-08T03:39:52.162Z] [LOG] ================================================================================
[2025-10-08T03:39:52.162Z] [LOG] 📊 TOTAL WORKED HOURS CALCULATION:
[2025-10-08T03:39:52.163Z] [LOG]    Sum of all daily counted hours (rounded): 25.5h
[2025-10-08T03:39:52.163Z] [LOG]    Expected hours: 34h
[2025-10-08T03:39:52.163Z] [LOG]    Shortfall: 8.50h
[2025-10-08T03:39:52.164Z] [LOG] ================================================================================
[2025-10-08T03:39:52.326Z] [LOG] 🔄 Processing financial records for employee 0143e565-7105-11f0-a50f-98e743540430...
[2025-10-08T03:39:52.327Z] [LOG] 🔄 Processing financial records for employee 0143e565-7105-11f0-a50f-98e743540430 in period 2025-10-01 to 2025-10-31
[2025-10-08T03:39:52.459Z] [LOG] 📊 Found 0 active loans for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:52.623Z] [LOG] 📊 Found 0 active advances for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:52.812Z] [LOG] 📊 Found 0 approved bonuses for employee 0143e565-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:52.813Z] [LOG] ✅ Financial adjustments calculated: {
  "loans": 0,
  "advances": 0,
  "bonuses": 0,
  "netAdjustment": 0
}
[2025-10-08T03:39:52.814Z] [LOG] 💰 GROSS CALCULATION for Piyumi null:
[2025-10-08T03:39:52.814Z] [LOG]    Base Salary: 50000
[2025-10-08T03:39:52.815Z] [LOG]    📋 Processing 0 configured earning components
[2025-10-08T03:39:52.929Z] [LOG] ⚠️  No overtime enable setting found for client it-signature, defaulting to disabled
[2025-10-08T03:39:53.050Z] [LOG] 🗓️  PAYROLL PERIOD: 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:53.803Z] [LOG] 📊 CALCULATED WORKING DAYS UP TO TODAY: 5 days (excluding weekends & holidays)
[2025-10-08T03:39:53.804Z] [LOG] 📊 FULL MONTH WORKING DAYS: 25 days (for salary rate calculation)
[2025-10-08T03:39:53.959Z] [LOG] 🏗️  WEEKEND WORKING BREAKDOWN (FULL MONTH): {
  "standard_working_days": 21,
  "weekend_working_days": 4,
  "weekend_full_day_weight": 4,
  "weekend_proportional_days": 0,
  "effective_working_days": 25
}
[2025-10-08T03:39:54.077Z] [LOG] Employee 0143e565-7105-11f0-a50f-98e743540430 scheduled hours from attendance (from period 2025-10-01 to 2025-10-31): 08:30:00 - 17:00:00 = 8.5 hours
[2025-10-08T03:39:54.079Z] [LOG] 
📊 PAYROLL CALCULATION - EMPLOYEE SHORTFALL ANALYSIS
[2025-10-08T03:39:54.079Z] [LOG] ============================================================
[2025-10-08T03:39:54.079Z] [LOG] 👤 Employee ID: 0143e565-7105-11f0-a50f-98e743540430
[2025-10-08T03:39:54.080Z] [LOG] 💰 Base Salary: 50,000
[2025-10-08T03:39:54.081Z] [LOG] 📅 FULL MONTH Working Days: 25 days (for rate calculation)
[2025-10-08T03:39:54.081Z] [LOG] 📅 UP TO TODAY Working Days: 5 days (for expected hours)
[2025-10-08T03:39:54.082Z] [LOG] 🎯 Effective Working Days (with weekend weights): 25
[2025-10-08T03:39:54.082Z] [LOG] ⏰ Employee Daily Hours: 8.5h/day
[2025-10-08T03:39:54.082Z] [LOG] 💵 Per-Day Salary: 2000.00 (50000 ÷ 25)
[2025-10-08T03:39:54.083Z] [LOG] ⏱️  Hourly Rate: 235.29 (2000.00 ÷ 8.5)
[2025-10-08T03:39:54.083Z] [LOG] 
[2025-10-08T03:39:54.084Z] [LOG] 📈 ATTENDANCE SUMMARY:
[2025-10-08T03:39:54.084Z] [LOG]    Expected Hours (up to today): 34
[2025-10-08T03:39:54.084Z] [LOG]    Worked Hours: 25.5
[2025-10-08T03:39:54.085Z] [LOG]    ⚠️  Shortfall Hours: 8.5
[2025-10-08T03:39:54.085Z] [LOG]    💸 Shortfall Deduction: 8.5h × 235.29 = 2000.00
[2025-10-08T03:39:54.085Z] [LOG] ============================================================
[2025-10-08T03:39:54.411Z] [LOG] ✅ Weekend Day Met: 2025-10-04 (Saturday)
[2025-10-08T03:39:54.414Z] [LOG]    Scheduled: 4.5h, Payable: 4.500h - No shortfall
[2025-10-08T03:39:54.584Z] [LOG] 📅 Checking weekend absences from 2025-10-01 to 2025-10-07 (today or period end)
[2025-10-08T03:39:54.740Z] [LOG] 📅 Weekend absence check for employee 0143e565-7105-11f0-a50f-98e743540430:
[2025-10-08T03:39:54.740Z] [LOG]    Scheduled weekend dates: 1 days
[2025-10-08T03:39:54.742Z] [LOG]    Attended weekend dates: 1 days
[2025-10-08T03:39:54.742Z] [LOG]    Absent weekend dates: 0 days
[2025-10-08T03:39:54.743Z] [LOG] 💸 DEDUCTION CALCULATION:
[2025-10-08T03:39:54.743Z] [LOG]    Gross Salary: 50000
[2025-10-08T03:39:54.743Z] [LOG]    📋 Processing 7 configured deduction components
[2025-10-08T03:39:54.744Z] [LOG] 🧮 Calculating component: Weekend Shortfall Deduction (fixed)
[2025-10-08T03:39:54.744Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:54.744Z] [LOG] 🧮 Calculating component: Unpaid Leave Deduction (fixed)
[2025-10-08T03:39:54.745Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:54.745Z] [LOG] 🧮 Calculating component: Advance Deductions (fixed)
[2025-10-08T03:39:54.746Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:54.746Z] [LOG] 🧮 Calculating component: Loan Deductions (fixed)
[2025-10-08T03:39:54.747Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:54.748Z] [LOG] 🧮 Calculating component: Weekend Absent Days (fixed)
[2025-10-08T03:39:54.748Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:54.749Z] [LOG] 🧮 Calculating component: Employee Provident Fund (8%) (fixed)
[2025-10-08T03:39:54.749Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:54.750Z] [LOG] 🧮 Calculating component: Working Hours Shortfall (fixed)
[2025-10-08T03:39:54.751Z] [LOG]    Fixed amount: 0
[2025-10-08T03:39:54.752Z] [LOG]    📊 Total Deductions: 0
[2025-10-08T03:39:54.752Z] [LOG] Regular deductions for Piyumi null: {
  "components": [],
  "total": 0
}
[2025-10-08T03:39:54.752Z] [LOG] Combined deductions for Piyumi null: {
  "components": [
    {
      "code": "SHORTFALL_DED",
      "name": "Working Hours Shortfall",
      "type": "deduction",
      "category": "other",
      "amount": 2000,
      "details": "8.5 hours × 235.29"
    }
  ],
  "total": 2000
}
[2025-10-08T03:39:54.878Z] [LOG] Creating components for record fab10f4a-a120-46e3-b18f-c8de3b3889cd: {
  "grossComponentsCount": 0,
  "deductionComponentsCount": 1,
  "taxComponentsCount": 0
}
[2025-10-08T03:39:54.878Z] [LOG] Processing component: {
  "name": "Working Hours Shortfall",
  "type": "deduction",
  "amount": 2000
}
[2025-10-08T03:39:55.194Z] [LOG] Using existing component ID: c83b8de7-0615-4be4-ab99-1d8732ca0acd
[2025-10-08T03:39:55.330Z] [LOG] Created payroll_record_component: 7dd2da79-2866-4eeb-a3b1-0e5ea0ed70cf for Working Hours Shortfall
[2025-10-08T03:39:55.683Z] [ERROR] ❌ Error updating financial balances: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:55.684Z] [ERROR] ❌ Error updating financial balances for employee 0143e565-7105-11f0-a50f-98e743540430: {
  "message": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist",
  "code": "ER_NO_SUCH_TABLE",
  "errno": 1146,
  "sql": "\n            INSERT INTO payroll_audit_logs (\n                id, run_id, employee_id, action, details, created_at\n            ) VALUES (?, ?, ?, 'financial_adjustment', ?, NOW())\n        ",
  "sqlState": "42S02",
  "sqlMessage": "Table 'u770612336_attendance_sys.payroll_audit_logs' doesn't exist"
}
[2025-10-08T03:39:55.685Z] [LOG] ✅ Piyumi null: Calculation completed successfully
[2025-10-08T03:39:55.686Z] [LOG] 📊 Progress: 34/34 (100.0%)
[2025-10-08T03:39:55.686Z] [LOG] 
============================================================
[2025-10-08T03:39:55.686Z] [LOG] 📈 Processing Summary: 34 successful, 0 failed
[2025-10-08T03:39:56.710Z] [LOG] 🎉 Payroll calculation completed successfully!
[2025-10-08T03:39:56.711Z] [LOG] 📊 Final Summary: 34 processed, 0 errors
[2025-10-08T03:39:56.711Z] [INFO] ================================================================================
[2025-10-08T03:39:56.711Z] [INFO] ⏰ Completed at: 2025-10-08T03:39:56.711Z
[2025-10-08T03:39:56.711Z] [INFO] 📊 Total log entries: 3371